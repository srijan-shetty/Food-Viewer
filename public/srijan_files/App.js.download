
function getCorrectMegamenuConfig(e){if(e.Megamenu.length>1){var t=e.Megamenu,n=-1;return angular.forEach(e.Megamenu,function(e){var i=e["@configFilter"]||"",o=new RegExp(i,"i");i.length>n&&o.test(window.location.href)&&(t=e,n=i.length)}),t}return 1==e.Megamenu.length?e.Megamenu[0]:e.Megamenu}function megaMenuCheckItemsHeight(){$(".navigationTree").each(function(e,t){$(this).attr("style","position:absolute;visibility:hidden;display:block !important");var n=0;$(this).find(".Column").each(function(e,t){$(this).height()>n&&(n=$(this).height())}),$(this).find(".Column").css({"min-height":n}),$(this).removeAttr("style")})}function HasScrollBar(){var e=document.getElementById("s4-workspace"),t=e.scrollHeight>e.clientHeight;e.scrollWidth>e.clientWidth;return t}function createServicemenu(e){var t=$("<div></div>").addClass("wizdom-dot-container").addClass("pull-right"),n=$("<div></div>").addClass("wizdom-service"),i=$('<a href="javascript:void(0);"><i class="glyphicon glyphicon-option-horizontal dotIcon"></i></a>').on("click",function(){$(".dotIcon").removeClass("glyphicon glyphicon-option-horizontal").addClass("glyphicon glyphicon-remove"),$(".dotIcon").hasClass("glyphicon glyphicon-remove")?$("#wt-servicemenu").stop().css({height:$(".wtsite-service-list").height()+10}):($("#wt-servicemenu").stop().css({height:0}),$(".dotIcon").removeClass("glyphicon glyphicon-remove").addClass("glyphicon glyphicon-option-horizontal"))});return n.append(i),t.append(n),t}function createMobileMenu(){var e=$('<div id="wizdom-mobile-container"></div>').addClass("wizdom-mobile-container").addClass("pull-right"),t=$("<div></div>").addClass("wizdom-mobile"),n=$('<a href="javascript:void(0);"><i class="burger-menu glyphicon glyphicon-menu-hamburger"></i></a>').on("click",function(){ActivateMobileMenuClick(),$("html").toggleClass("active_mobile_menu"),$("html").hasClass("active_mobile_menu")?$(".burger-menu").removeClass("glyphicon glyphicon-remove").addClass("glyphicon glyphicon-menu-hamburger"):$(".burger-menu").removeClass("glyphicon glyphicon-menu-hamburger").addClass("glyphicon glyphicon-remove")});return t.append(n),e.append(t),e}function createSearchmenu(e){var t=$("<div></div>").addClass("wizdom-search-container").addClass("pull-right"),n=$("<div></div>").addClass("wizdom-search"),i=$('<a href="javascript:void(0);"><i class="glyphicon glyphicon-search searchIcon"></i></a>').on("click",function(){$(".searchIcon").removeClass("glyphicon glyphicon-search").addClass("glyphicon glyphicon-remove"),$(".searchIcon").hasClass("glyphicon glyphicon-remove")?($("#DeltaPlaceHolderSearchArea").stop().css({height:"40px"}),$("#DeltaPlaceHolderSearchArea").find("input").focus()):($("#DeltaPlaceHolderSearchArea").stop().css({height:0}),$(".searchIcon").removeClass("glyphicon glyphicon-remove").addClass("glyphicon glyphicon-search"))});return n.append(i),t.append(n),t}function setupServices(){setTimeout(function(){$("#s4-ribbonrow").append(createMobileMenu())},50)}function ActivateMobileMenuClick(){function e(t){var n=$("<ul></ul>").addClass("submenu");return t.find(">li").each(function(t,i){if($(this).find(">ul").length>0){var o=$("<li></li").addClass("column"),r=$("<ul></ul>"),a=$('<h3 class="sub-h3"></h3>').append($(this).find(">.menu-item").clone().text());$(a).on("click",function(){$(this).parent().find(">.submenu").toggleClass("active")}),r.append(a),r.append(e($(this).find(">ul").clone())),o.append(r),n.append(o)}else{var o=$("<li></li>").addClass("sectionLink").addClass("column");o.append($(this).find(">.menu-item").clone().removeClass()),n.append(o)}}),n}function t(t){var n=$("<div></div>");return $(t).find(">ul>li").each(function(t,i){var o=$("<div></div>").addClass("m-column");if($(this).find(">ul").length>0){var r=$("<h3></h3>").append($(this).find(">.menu-item").clone());r.prepend("<i style='margin-right:2px;' class='ms-Icon ms-Icon--ChevronRight'></i>");var a=function(){return $(r).parent().toggleClass("expanded"),$(r).find("i").length>0&&($(r).find("i").toggleClass("ms-Icon--ChevronRight"),$(r).find("i").toggleClass("ms-Icon--ChevronDown")),$(r).parent().hasClass("expanded")?$(r).parent().css({"min-height":"auto"}):$(r).parent().css({"min-height":"20px"}),!1},l=$(r).find("a");l&&l.attr("href")?$(r).find("i").on("click",a):$(r).on("click",a),o.append(r),o.append(e($(this).find(">ul").clone())),o.css("padding-left","25px"),o.find(">ul").css("padding-left","13px")}else{var r=$("<h3></h3>").append($(this).find(">a").clone());r.append($(this).find(">span").clone()),0==$(r).find(".ms-navedit-editSpan").length&&o.append(r)}n.append(o)}),n}function n(){var e=$("<div class='s4-notdlg' id='mobile-navigation'><div class='list-group'><hr /><a class='mobile-toggle' href='javascript:void(0);'><img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkFGREM2MDY5QTM1QzExRTQ5RUFDOEM4QTVDQjhCQjg4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkFGREM2MDZBQTM1QzExRTQ5RUFDOEM4QTVDQjhCQjg4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QUZEQzYwNjdBMzVDMTFFNDlFQUM4QzhBNUNCOEJCODgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QUZEQzYwNjhBMzVDMTFFNDlFQUM4QzhBNUNCOEJCODgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7Fm3WdAAAArUlEQVR42lyQzQ4BQRCE2xocxXvhxpI44knmFSTcNoS1frNPJV5h90BVUqSp5JuZ9NR0qqcRY9yaWR/Mwc1+lYIN6wmWIeiBAoycaQr2oAsGAcsCHEDQbjrvQBNUYMnCWZfenIhKne9BJppf4CgzVYMJTaZXH3X+BuFd21wWagYyZapVa2kYqgjKkLngqcv6NbOwdqYxKNWFmXOZV8xxAQ/9YekyXtX9CU5vAQYA+polIueOcuUAAAAASUVORK5CYII=' /></a></div></div>"),n=$(".spTopNav"),i=t(n);$(e).find(".list-group").append(i),$(e).find(".mobile-toggle").on("click",function(){$("html").toggleClass("active_mobile_menu")});var o;if($(window).resize(function(){clearTimeout(o),o=setTimeout(function(){$(".active_mobile_menu").length>0&&$("html").toggleClass("active_mobile_menu")},100)}),!$("html").hasClass("hideLeftNavigation")){$(e).find(".list-group").append("<hr /><div class='left-navigation'></div>");var r=$(".spLeftNav").clone().removeClass(),a=t(r);$(e).find(".left-navigation").addClass("m-column-left").append(a)}$("#contentRow").append(e)}function i(){var e=$("<div class='s4-notdlg' id='mobile-navigation'><div class='list-group'><hr /><a class='mobile-toggle' href='javascript:void(0);'><img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkFGREM2MDY5QTM1QzExRTQ5RUFDOEM4QTVDQjhCQjg4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkFGREM2MDZBQTM1QzExRTQ5RUFDOEM4QTVDQjhCQjg4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QUZEQzYwNjdBMzVDMTFFNDlFQUM4QzhBNUNCOEJCODgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QUZEQzYwNjhBMzVDMTFFNDlFQUM4QzhBNUNCOEJCODgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7Fm3WdAAAArUlEQVR42lyQzQ4BQRCE2xocxXvhxpI44knmFSTcNoS1frNPJV5h90BVUqSp5JuZ9NR0qqcRY9yaWR/Mwc1+lYIN6wmWIeiBAoycaQr2oAsGAcsCHEDQbjrvQBNUYMnCWZfenIhKne9BJppf4CgzVYMJTaZXH3X+BuFd21wWagYyZapVa2kYqgjKkLngqcv6NbOwdqYxKNWFmXOZV8xxAQ/9YekyXtX9CU5vAQYA+polIueOcuUAAAAASUVORK5CYII=' /></a></div></div>"),n=$(".Megamenu");$(n).find(".TopItems li").each(function(t,i){var o=$(this).attr("id");if($(n).find("#"+o+"Section li").length>0){var r=$(n).find("#"+o+"Section").clone();r.removeClass().addClass("m-column"),1==r.find(">ul li").length?r.find(">ul li.topLink").parent().remove():r.find(">ul li.topLink").remove();var a=$(i).find("a").parent().html();if(a||(a=$(i).html()),r.find("h3").html(a),r.find("h3 a").css("color","#6d6d6d"),r.find(">ul li").length>0){r.find("h3").prepend("<i style='margin-right:2px;' class='ms-Icon ms-Icon--ChevronRight'></i>"),r.css("padding-left","25px"),r.find(">ul").css("padding-left","13px");var l=function(e){r.toggleClass("expanded"),r.find("h3 i").length>0&&(r.find("h3 i").toggleClass("ms-Icon--ChevronRight"),r.find("h3 i").toggleClass("ms-Icon--ChevronDown")),r.hasClass("expanded")&&r.find(">ul").length>0?r.css({"min-height":"auto"}):r.css({"min-height":"20px"})};r.find("h3 a").length>0&&r.find("h3 a").attr("href")?r.find("h3 i").on("click",l):r.find("h3").on("click",l)}else r.css({cursor:"default"}),r.find("h3").css({cursor:"default"});$(e).find(".list-group").append(r)}}).find("a").on("click",function(e){e.stopPropagation()}),$(e).find(".mobile-toggle").on("click",function(){$("html").toggleClass("active_mobile_menu")});var i;if($(window).resize(function(){clearTimeout(i),i=setTimeout(function(){$(".active_mobile_menu").length>0&&$("html").toggleClass("active_mobile_menu")},100)}),!$("html").hasClass("hideLeftNavigation")){$(e).find(".list-group").append("<hr /><div class='left-navigation'></div>");var o=$(".spLeftNav").clone().removeClass(),r=t(o);$(e).find(".left-navigation").addClass("m-column-left").append(r)}$("#contentRow").append(e)}var o=window.Wizdom365Config;if(!$("html").hasClass("mobileMenuActivated")){var r=!1,a=!1,l=window.getCorrectMegamenuConfig,s=l(o);r="true"==s.Enabled,r||(a=!0),r&&(i(),megaMenuCheckItemsHeight()),a&&n(),$("html").addClass("mobileMenuActivated")}}function WizdomPrintContentArea(e){var t,n,i=document.getElementById("ctl00_onetidHeadbnnr2").getAttribute("src"),o=document.getElementsByTagName("div");for(t=0;t<o.length;t++)"wt-footer"==o[t].getAttribute("class")&&(n=o[t].innerHTML);var e,r=document.getElementsByTagName("h1");for(t=0;t<r.length;t++)r[t].getAttribute("class")==e&&(e=r[t].innerHTML);var a=document.getElementsByTagName("link"),l=document.getElementById("wizdomPageLayout"),s=0,c=0;screen&&(s=screen.width/2-450,c=screen.height/2-300);var d=window.open("","_blank","width=900, height=600, resizable=1, scrollbars=yes, dependent=yes"),u=d.document;for(u.open(),u.write("<HTML><head><title>"+e+'</title><style type="text/css">p { font-size: 8pt; } span.wt-news-date-date { font-size: 8pt; } h1.wt-news-title { font-size: 14pt; } td { font-size: 8pt; } table { padding-right:10px; }</style>'),t=0;t<a.length;t++)u.write('<link rel="stylesheet" type="text/css" href="'+a[t].getAttribute("href")+'"/>');return u.write("</head><body class='wt-print' onload='window.print();window.close();'><div style=\"padding-top:10px; padding-left:10px; margin-right:10px; \">"),u.write('<div class="s4-notdlg" style="text-align:left; padding-bottom:10px;"><a href="/"><img id="ctl00_onetidHeadbnnr2" border="0" src="'+i+'"/></a></div>'),u.write('<div id ="copy" style="margin-right:10px; ">'+l.innerHTML+"</div>"),u.write("<div class='wt-footer s4-notdlg' style='padding-top:20px;'>"+n+"</div></div></body></HTML>"),u.close(),window.focus&&d.focus(),!1}function handleOverflows(){try{if("INPUT"==document.activeElement.tagName||"TEXTAREA"==document.activeElement.tagName)return void $(document.activeElement).on("blur",handleOverflows)}catch(e){}$("div.hideOverflow").contents().unwrap(),$("div.hideOverflowParent").contents().unwrap(),$("div.webpartOverflowChangerParent").remove();$.map($("div.wt-webpartzone"),function(e){handleOverflowsInZone($(e))})}function handleOverflowsInZone(e){$(e).find(".ms-webpartzone-cell").each(function(e){$(this).data("position",$(this).css("position")),$(this).css("position","absolute")});var t=$(e).width()+2;$.map($(e).find(".ms-webpartzone-cell"),function(e){var n=$(e);n.css("width",t);var i=n.width();if(n.css({position:n.data("position")}),i-intSpaceBetweenColumns>t){var o=!0;try{n.attr("data-handleOverflow")&&"false"==n.attr("data-handleOverflow")&&(o=!1)}catch(r){}o&&wrapElementWithOverflowParent(n,t)}else n.css("width","100%"),n.find(".webpartOverflowTitle").length>0&&n.find(".webpartOverflowTitle").each(function(){$(this).contents().unwrap()})})}function wrapElementWithOverflowParent(e,t){var n="<div class='hideOverflow'></div>",i="<div class='hideOverflowParent' style='width: "+t+"px;'></div>",o="<div class='webpartOverflowTitle' style='width: "+t+"px;'></div>";e.wrap(n),e.parent().wrap(i),e.attr("id")||(e.attr("id","wt-controlId"+intControlCounter),intControlCounter+=1);var r=e.attr("id"),a='<div class="webpartOverflowChangerParent" style="width: '+t+'px;"><div class="webpartOverflowChanger" style="width: '+t+'px;" onclick="overflowChange(\''+r+"', "+e.width()+", "+t+');"></div></div>';e.parent().parent().prepend(a),e.find(".ms-webpart-titleText").wrap(o)}function overflowChange(e,t,n){var i=$("#"+e).parent(),o=$(i).closest(".ms-webpart-zone.ms-fullWidth"),r=$(i).closest("div.hideOverflowParent"),a="<div class='webpartOverflowTitle' style='width: "+n+"px;'></div>",l={};if("hidden"!=$(i).css("overflow")){var s=$(r).find("div.webpartOverflowChangerOpen");l.width=n+"px",r.animate(l,200),$(i).css("overflow","hidden"),s.css("width",n),s.toggleClass("webpartOverflowChangerOpen webpartOverflowChanger"),s.closest("div.webpartOverflowChangerParent").css("width",n),$(i).css("z-index","20"),o.css("position","relative"),o.css("z-index","20"),i.find(".ms-webpart-titleText").wrap(a)}else{var s=$(r).find("div.webpartOverflowChanger");l.width=t+"px",r.animate(l,200),$(i).css("overflow","visible"),s.toggleClass("webpartOverflowChanger webpartOverflowChangerOpen"),s.closest("div.webpartOverflowChangerParent").css("width",t),$(i).css("z-index","21"),o.css("position","relative"),o.css("z-index","21");$.map($(o).find(".ms-webpartzone-cell"),function(t){e!=$(t).attr("id")&&($(t).css("width",n),$(t).css("margin-left","0"))});$(i).find(".webpartOverflowTitle").each(function(){$(this).contents().unwrap()})}}var wizdom365ExternalDependencies=[];wizdom365ExternalDependencies.push("angularMoment"),wizdom365ExternalDependencies.push("ui.sortable"),wizdom365ExternalDependencies.push("ui.tinymce"),wizdom365ExternalDependencies.push("ui.bootstrap"),window.isSaaS||wizdom365ExternalDependencies.push("ngSanitize"),wizdom365ExternalDependencies.push("mentio"),wizdom365ExternalDependencies.push("mgcrea.ngStrap"),wizdom365ExternalDependencies.push("checklist-model"),wizdom365ExternalDependencies.push("formly"),wizdom365ExternalDependencies.push("colorpicker.module"),wizdom365ExternalDependencies.push("perfect_scrollbar"),wizdom365ExternalDependencies.push("angular.vertilize"),wizdom365ExternalDependencies.push("treeControl"),wizdom365ExternalDependencies.push("oc.lazyLoad");var wizdom365Modules=[];wizdom365Modules.push("Wizdom365.Branding"),wizdom365Modules.push("Wizdom365.Mobile"),wizdom365Modules.push("Wizdom365.Powerpanel"),wizdom365Modules.push("Wizdom365.Megamenu"),wizdom365Modules.push("Wizdom365.Noticeboard"),wizdom365Modules.push("Wizdom365.PersonalLink"),wizdom365Modules.push("Wizdom365.CorporateNews"),wizdom365Modules.push("Wizdom365.PageContact"),wizdom365Modules.push("Wizdom365.PageRelations"),wizdom365Modules.push("Wizdom365.PageRevision"),wizdom365Modules.push("Wizdom365.Footer"),wizdom365Modules.push("Wizdom365.FavIcon"),wizdom365Modules.push("Wizdom365.LogoRedirect"),wizdom365Modules.push("Wizdom365.Servicemenu"),wizdom365Modules.push("Wizdom365.Breadcrumb"),wizdom365Modules.push("Wizdom365.PrefixPostfix"),wizdom365Modules.push("Wizdom365.ImageSlider"),wizdom365Modules.push("Wizdom365.HeaderBackground"),wizdom365Modules.push("Wizdom365.Validation"),wizdom365Modules.push("Wizdom365.Validation.Config"),wizdom365Modules.push("Wizdom365.FAQ"),wizdom365Modules.push("Wizdom365.PageInfo"),wizdom365Modules.push("Wizdom365.Phonebook"),wizdom365Modules.push("Wizdom365.ContentStore"),wizdom365Modules.push("Wizdom365.Printcontent"),wizdom365Modules.push("Wizdom365.Weather"),wizdom365Modules.push("Wizdom365.Charts"),wizdom365Modules.push("Wizdom365.ReplaceContacts"),wizdom365Modules.push("Wizdom365.TemplateManager"),wizdom365Modules.push("Wizdom365.ExportImport"),wizdom365Modules.push("Wizdom365.ServiceTickets"),wizdom365Modules.push("Wizdom365.PageTranslation"),wizdom365Modules.push("Wizdom365.Analytics"),wizdom365Modules.push("Wizdom365.Yammer"),wizdom365Modules.push("Wizdom365.ContentPage"),wizdom365Modules.push("Wizdom365.Notification"),wizdom365Modules.push("Wizdom365.RichText"),wizdom365Modules.push("Wizdom365.LoadingBanner"),wizdom365Modules.push("Wizdom365.GovernMetadata"),("AppCore"===window.Wizdom365Appload||"AppFull"===window.Wizdom365Appload)&&(wizdom365Modules.push("Wizdom365.ProfileProgress"),wizdom365Modules.push("Wizdom365.CanteenMenu"),wizdom365Modules.push("Wizdom365.Currentmenu"),wizdom365Modules.push("Wizdom365.EditorRevision"),wizdom365Modules.push("Wizdom365.DepartmentUsers"),wizdom365Modules.push("Wizdom365.Manual"),wizdom365Modules.push("Wizdom365.Employees"),wizdom365Modules.push("Wizdom365.Birthday"),wizdom365Modules.push("Wizdom365.Webform"),wizdom365Modules.push("Wizdom365.Poll"),wizdom365Modules.push("Wizdom365.ProjectSpace"),wizdom365Modules.push("Wizdom365.Gamification"),wizdom365Modules.push("Wizdom365.TemplateManager"),wizdom365Modules.push("Wizdom365.CourseManagement"),wizdom365Modules.push("Wizdom365.Helpdesk"),wizdom365Modules.push("Wizdom365.BusinessApps"),wizdom365Modules.push("Wizdom365.LightningPages"),wizdom365Modules.push("Wizdom365.Kanban"),wizdom365Modules.push("Wizdom365.LiveTiles")),1==window.isSaaS?(angular.module("Wizdom365",["Wizdom365.Translations"].concat(wizdom365ExternalDependencies,wizdom365Modules,window.adminDependencies||[])).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|sip|tel|callto|skype|facetime):/)}]),angular.module("Wizdom365Auth").requires.push("Wizdom365"),angular.module("Wizdom365.Translations",[]).value("translations",{}).filter("translate",["translations",function(e){return function(e,t,n){return e}}])):angular.module("Wizdom365",["Wizdom365.Translations"].concat(wizdom365ExternalDependencies,wizdom365Modules,window.adminDependencies||[])).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|sip|tel|callto|skype|facetime):/)}]),angular.module("Wizdom365").config(["$compileProvider","$httpProvider",function(e,t){window.Wizdom365BlobUrl&&e.debugInfoEnabled(!1),t.useApplyAsync(!0)}]),angular.module("Wizdom365").run(["$filter","$rootScope","log","userContextInfo","webApiProxy","sessionStorageService","configuration",function(e,t,n,i,o,r,a){function l(){try{var e="CurrentUserLanguageChecked";if(!r.getItem(e)){var t=window.SP;t&&t.SOD.executeFunc("sp.js","SP.ClientContext",function(){t.SOD.executeFunc("userprofile","SP.UserProfiles.PeopleManager",function(){var l=new t.ClientContext.get_current,s=new t.UserProfiles.PeopleManager(l),c=s.getMyProperties();l.load(c),l.executeQueryAsync(function(){var t=c.get_userProfileProperties()["SPS-MUILanguages"];t&&a.Wizdom365&&a.Wizdom365.Languages&&i.currentUser().then(function(e){n("Current user ProfileProperties languages:",t),n("Wizdom languages:",a.Wizdom365.Languages),n("Current registered userlanguage:",e.languageTag),t=t.toLowerCase().split(",");for(var i=0;i<t.length;i++)for(var r=0;r<a.Wizdom365.Languages.length;r++)if(0==a.Wizdom365.Languages[r].Tag.toLowerCase().indexOf(t[i]))return n("found language match",t[i],a.Wizdom365.Languages[r].Tag.toLowerCase()),void(e.languageTag!=a.Wizdom365.Languages[r].Tag.toLowerCase()?(n("updating wizdom principal"),o.principals.updateCurrentUserLanguage(a.Wizdom365.Languages[r].Tag.toLowerCase())):n("wizdom principal already uptodate"))}),r.setItem(e,(new Date).toUTCString())},function(e,t){n("Failed to get user language from SharePoint"+t.get_message()+"\n"+t.get_stackTrace())})})})}}catch(l){l&&l.message&&n("Failed to check current user Wizdom language"+l.message)}}n("Wizdom running"),t.loading=!1,t.isSaaS=1==window.isSaaS;var s="<span class='bootstrap-wrapper'><span wizdom365-template-manager-panel></span></span><span class='bootstrap-wrapper'><span wizdom365-configuration-nav-panel></span></span>",c=$(".ms-cui-TabRowRight .bootstrap-wrapper:last");c.length>0?$(s).insertAfter(c):$(".ms-cui-TabRowRight").prepend(s);var d=50,u=function(){$(".jsgrid-widget-dock").length?$(".jsgrid-widget-dock").parent().addClass("bootstrapGanttFix"):d-->0&&setTimeout(u,100)};u(),$(".ms-webpart-zone-title").each(function(){$(this).text(e("translate")($(this).text()))}),-1==document.body.className.indexOf("wizdom-bootstrap-wrapper-visible")&&(document.body.className+=" wizdom-bootstrap-wrapper-visible"),window.angularDigests=0,t.$watch(function(){window.angularDigests=window.angularDigests+1}),l()}]),angular.module("Wizdom365.Analytics",[]).run(["configuration","$window","contextInfo","analyticsApi","log",function(e,t,n,i,o){var r=t.wizdomClientSideFeatureToggles&&"Local"==t.wizdomClientSideFeatureToggles.CDNType,a=JSON.parse((e.Analytics.SnooperEnabled["#text"]||e.Analytics.SnooperEnabled).toString().toLowerCase()),l=JSON.parse((e.Analytics.AnalyticsEnabled["#text"]||e.Analytics.AnalyticsEnabled).toString().toLowerCase());r||!l&&!a||(o("Analytics started "),$.getScript("//az416426.vo.msecnd.net/scripts/a/ai.0.js",function(){function n(e){var t=window.Microsoft;try{if(window&&JSON)if(e){var n=new t.ApplicationInsights.Initialization(e),i=n.loadAppInsights();for(var o in i)e[o]=i[o];n.emptyQueue(),n.pollInteralLogs(i),n.addHousekeepingBeforeUnload(i)}else t.ApplicationInsights.AppInsights.defaultConfig=t.ApplicationInsights.Initialization.getDefaultConfig()}catch(r){t.ApplicationInsights._InternalLogging.warnToConsole("Failed to initialize AppInsights JS SDK: "+r.message)}return e}if(a){n(t.wizdomInsights)}l&&i.getAnalyticsConfig().then(function(o){t.customerInsights.config.instrumentationKey=o.wizdom_instrumentationkey;var r=n(t.customerInsights);if(r.setAuthenticatedUserContext(o.user_loginname),!r.queue){var a=e["@version"];r.context.addTelemetryInitializer(function(e){var t=e.data.baseData;t.properties=t.properties||{},t.properties.wizdomVersion=a,t.properties.user_loginname=o.user_loginname,t.properties.user_displayname=o.user_displayname,t.properties.user_department=o.user_department,t.properties.user_location=o.user_location,t.measurements=t.measurements||{}}),i.trackPageView()}})}))}]),angular.module("Wizdom365.Charts",["tc.chartjs"]),angular.module("Wizdom365.ContentStore",[]),angular.module("Wizdom365.ContentPage",[]),angular.module("Wizdom365.CorporateNews",["ngAnimate","ngTouch"]),angular.module("Wizdom365.Breadcrumb",[]),angular.module("Wizdom365.Breadcrumb").factory("breadcrumbConfig",["configuration","contextInfo",function(e,t){function n(){return angular.isObject(window.WizdomScriptLoaderVars)&&angular.isArray(window.WizdomScriptLoaderVars.CurrentMenuUrls)&&angular.isString(t.spWebUrl)&&null!=_.find(window.WizdomScriptLoaderVars.CurrentMenuUrls,function(e){return e==encodeURI(t.spWebUrl.toLowerCase())})}return{isCurrentmenuRequired:n()}}]),angular.module("Wizdom365.Breadcrumb").run(["configuration","contextInfo","breadcrumbConfig","$timeout",function(e,t,n,i){if(!t.pageColumns||!t.pageColumns.hideBreadCrumb){var o=!1;t.listContext&&(o=angular.isArray(t.listContext)?null!=_.find(t.listContext,function(e){return location.href.indexOf(encodeURIComponent(decodeURIComponent(e.dirUrl)))>-1}):location.href.indexOf(decodeURIComponent(t.listContext.dirUrl))>-1);null!=t.listContext&&location.href.indexOf("?RootFolder")>-1&&location.href.indexOf(encodeURIComponent(decodeURIComponent(t.listContext.dirUrl)))<location.href.length-encodeURIComponent(decodeURIComponent(t.listContext.dirUrl)).length;"true"!=e.Breadcrumb.Enabled||t.isDialogPage||("true"==e.Breadcrumb.UseMetaBreadcrumb&&(t.friendUrlTermId||n.isCurrentmenuRequired)?jQuery("#wt-breadcrumb-placeholder").prepend("<div wizdom365-breadcrumb-meta></div>"):jQuery("#wt-breadcrumb-placeholder").prepend("<div wizdom365-breadcrumb></div>"))}}]),angular.module("Wizdom365.ExportImport",[]),angular.module("Wizdom365.FavIcon",[]),function(){function e(e){var n=e.FavIcon.IconUrl;n&&""!==n&&angular.isString(n)&&($("#favicon").length>0&&$("#favicon").remove(),t(n))}function t(e){var t=document.createElement("link");t.type="image/x-icon",t.rel="icon",t.id="favicon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}angular.module("Wizdom365.FavIcon").run(e),e.$inject=["configuration"]}(),angular.module("Wizdom365.FAQ",["ngAnimate"]),angular.module("Wizdom365.Footer",[]),function(){function e(e,t,n,i){"true"!=i.Enabled||t.isSettingsPage||t.isDialogPage||0==jQuery("#wt-footer").length&&jQuery("#s4-workspace").append('<div id="wt-footer" wizdom365-footer></div>'),n.addCallbackForNewConfigurationFilter("Footer",function(e){e.ViewId&&(e.ViewId=null),e.FooterText&&(e.FooterText["#text"]="")})}angular.module("Wizdom365.Footer").run(e),e.$inject=["configuration","contextInfo","SpecificConfigurationService","footerConfig"]}(),angular.module("Wizdom365.GovernMetadata",[]),angular.module("Wizdom365.HeaderBackground",[]),function(){function e(e,t){try{var n=e.HeaderBackground.ImageUrl,i="#s4-titlerow";if(0==n.indexOf("#"))jQuery(i).css("background-color","'"+n+"'");else{var o=e.HeaderBackground.ImageRepeat,r={url:n,repeat:o};r.url.length>0&&(jQuery(i).css("background-image","url('"+r.url+"')"),jQuery(i).css("background-repeat",r.repeat),jQuery(i).css("background-position-y","50%"))}}catch(a){}}angular.module("Wizdom365.HeaderBackground").run(e),e.$inject=["configuration","contextInfo"]}(),angular.module("Wizdom365.ImageSlider",[]),angular.module("Wizdom365.LoadingBanner",[]),angular.module("Wizdom365.LoadingBanner").run(function(){$("#s4-titlerow").append("<div wizdom365-loading-banner></div>")}),angular.module("Wizdom365.LogoRedirect",[]),function(){function e(e,t){try{var n=e.LogoRedirect.RedirectUrl;n=n.replace("[SiteCollection.Url]",t.spHostUrl);var i=jQuery(".ms-siteicon-a");i.click(function(e){var t=jQuery(this).attr("href");jQuery(this).attr("href","javascript:void(0)"),n&&""!==n?window.location.href=n:window.location.href=t})}catch(o){}}angular.module("Wizdom365.LogoRedirect").run(e),e.$inject=["configuration","contextInfo"]}(),angular.module("Wizdom365.Megamenu",["ui.sortable"]),angular.module("Wizdom365.Megamenu").run(["configuration","megamenuConfig","contextInfo","SpecificConfigurationService",function(e,t,n,i){"true"==t.Enabled&&($(".ms-core-listMenu-horizontalBox").length||$("<div class='ms-core-listMenu-horizontalBox' />").appendTo("#DeltaTopNavigation"),$(".ms-core-listMenu-horizontalBox").attr("wizdom-load","Wizdom365").attr("wizdom365-megamenu-desktop","").html("")),$("#DeltaTopNavigation").attr("style","display:inline-block !important"),i.addCallbackForNewConfigurationFilter("Megamenu",function(e){e.View&&e.View.id&&(e.View={})})}]),angular.module("Wizdom365.Noticeboard",[]),angular.module("Wizdom365.Noticeboard").run(["configuration","contextInfo",function(e,t){}]),angular.module("Wizdom365.PageContact",[]),angular.module("Wizdom365.Notification",[]),angular.module("Wizdom365.Notification").run(["configuration","contextInfo",function(e,t){$(".ms-cui-TabRowRight").prepend("<span class='bootstrap-wrapper'><span wizdom365-notification-panel></span></span>")}]),angular.module("Wizdom365.PageInfo",[]),angular.module("Wizdom365.PageRelations",[]),angular.module("Wizdom365.PageRevision",[]),angular.module("Wizdom365.PageTranslation",[]),function(){function e(e,t,n){}angular.module("Wizdom365.PageTranslation").run(e),e.$inject=["configuration","contextInfo","$compile"]}(),angular.module("Wizdom365.PersonalLink",[]),angular.module("Wizdom365.Phonebook",[]).config(["$compileProvider",function(e){}]),angular.module("Wizdom365.PrefixPostfix",[]),function(){function e(e){if(!window.location.search.match(/[?&]isdlg=1/i)){var t=e.PrefixPostfix.Prefix,n=e.PrefixPostfix.Postfix;"string"==typeof n&&""!==n&&(window.document.title=window.document.title+" "+n),"string"==typeof t&&""!==t&&(window.document.title=t+" "+window.document.title)}}angular.module("Wizdom365.PrefixPostfix").run(e),e.$inject=["configuration"]}(),angular.module("Wizdom365.Powerpanel",["ngAnimate"]),function(){function e(e){var t=e.getApplyingConfiguration("Powerpanel"),n=t.EnabledClassic&&JSON.parse(t.EnabledClassic["#text"]||t.EnabledClassic);n&&($("#s4-ribbonrow").before("<div wizdom365-powerpanel></div>"),$("html").addClass("powerPanelEnabled")),e.addCallbackForNewConfigurationFilter("Powerpanel",function(e){e.ModernView&&e.ModernView.id&&(e.ModernView={}),e.ClassicView&&e.ClassicView.id&&(e.ClassicView={})})}angular.module("Wizdom365.Powerpanel").run(e),e.$inject=["SpecificConfigurationService"]}(),angular.module("Wizdom365.Printcontent",[]),function(){function e(e){try{this.WizdomPrintContentArea=function(e){var t,n,i=document.getElementById("ctl00_onetidHeadbnnr2").getAttribute("src"),o=document.getElementsByTagName("div");for(t=0;t<o.length;t++)"wt-footer"==o[t].getAttribute("class")&&(n=o[t].innerHTML);var e,r=document.getElementsByTagName("h1");for(t=0;t<r.length;t++)r[t].getAttribute("class")==e&&(e=r[t].innerHTML);var a=document.getElementsByTagName("link"),l=document.getElementById("wizdomPageLayout"),s=0,c=0;screen&&(s=screen.width/2-450,c=screen.height/2-300);var d=window.open("","_blank","width=900, height=600, resizable=1, scrollbars=yes, dependent=yes"),u=d.document;for(u.open(),u.write("<HTML><head><title>"+e+'</title><style type="text/css">p { font-size: 8pt; } span.wt-news-date-date { font-size: 8pt; } h1.wt-news-title { font-size: 14pt; } td { font-size: 8pt; } table { padding-right:10px; }</style>'),t=0;t<a.length;t++)u.write('<link rel="stylesheet" type="text/css" href="'+a[t].getAttribute("href")+'"/>');return u.write("</head><body class='wt-print' onload='window.print();window.close();'><div style=\"padding-top:10px; padding-left:10px; margin-right:10px; \">"),u.write('<div class="s4-notdlg" style="text-align:left; padding-bottom:10px;"><a href="/"><img id="ctl00_onetidHeadbnnr2" border="0" src="'+i+'"/></a></div>'),u.write('<div id ="copy" style="margin-right:10px; ">'+l.innerHTML+"</div>"),u.write("<div class='wt-footer s4-notdlg' style='padding-top:20px;'>"+(n?n:"")+"</div></div></body></HTML>"),u.close(),window.focus&&d.focus(),!1},jQuery(".wt-printcontent").html("<a href='javascript:void(0)' onClick='WizdomPrintContentArea(\"wt-page-title\")'></a>")}catch(t){}}angular.module("Wizdom365.Printcontent").run(e),e.$inject=["configuration"]}(),angular.module("Wizdom365.ReplaceContacts",[]),angular.module("Wizdom365.RichText",[]),angular.module("Wizdom365.Servicemenu",[]),function(){function e(e,t,n){var i=e.Servicemenu.Searchbar||"None",o=e.Servicemenu.Toolbar||"None";$("#DeltaPlaceHolderSearchArea").children().length>0&&("Expanded"==i||"FloatingBottomRight"==o?($("#DeltaTopNavigation").addClass("v2"),$("#s4-titlerow").append($("#DeltaPlaceHolderSearchArea").removeClass().addClass("v2"))):$("#s4-titlerow").append($("#DeltaPlaceHolderSearchArea").removeClass())),("None"!=i||"None"!=o)&&($("#s4-titlerow").append("<div wizdom365-servicemenubuttons></div>"),$("#s4-ribbonrow").append("<div wizdom365-servicemenumobilebuttons></div>"),"None"!=o&&("FloatingBottomRight"==o?jQuery("#s4-titlerow").append('<div id="wt-servicemenu" class="v2" wizdom365-servicemenu></div>'):jQuery("#s4-titlerow").append('<div id="wt-servicemenu" wizdom365-servicemenu></div>')),"None"!==i&&$("html").addClass("searchEnabled"),"None"!==o&&$("html").addClass("servicemenuEnabled"))}angular.module("Wizdom365.Servicemenu").run(e),e.$inject=["configuration","contextInfo","$compile"]}(),angular.module("Wizdom365.ServiceTickets",[]),angular.module("Wizdom365.TemplateManager",[]),function(){function e(e){"true"==e.TemplateManager.Enabled&&$("#createnewsite").closest("td").attr("wizdom365-template-manager","")}angular.module("Wizdom365.TemplateManager").run(e),e.$inject=["configuration"]}(),angular.module("Wizdom365.Weather",[]),angular.module("Wizdom365.Mobile",[]),function(){function e(e,t){try{e.changeLocale(t.language.split("-")[0])}catch(n){}}angular.module("Wizdom365").run(e),e.$inject=["amMoment","contextInfo"]}(),function(){function e(e){e.interceptors.push("httpInterceptor")}function t(e,t,n,i,o,r,a,l){var s=0;window.wizdomClientSideFeatureToggles=window.wizdomClientSideFeatureToggles||{};var c=!("false"===window.wizdomClientSideFeatureToggles.GetTemplatesFromCDN),d="Local"==window.wizdomClientSideFeatureToggles.CDNType;return{request:function(n){if(-1!=n.url.indexOf(".html")&&(s+=1),null==r.get(n.url)){if("/"==n.url.slice(0,"/".length))n.url=t.appUrl+n.url;else if("http"!=n.url.toLowerCase().slice(0,"http".length))if("../"==n.url.slice(0,"../".length))n.url=t.appUrl+"modules/"+n.url;else if(t.appUrl.toLowerCase().indexOf("localhost")>0||"SAAS"==t.wizdomEnvironment||""===t.blobUrl)n.url=t.appUrl+"modules/"+n.url;else if(t.wizdomEnvironmentIsOnPrem&&t.blobUrl)n.url=t.blobUrl+"WizdomTemplates/"+n.url;else if(c&&!d){var i=window.wizdomCDNs,o="",l=n.url.length%3;0==l&&(o=i.libsOne+"/templates/"),1==l&&(o=i.libsTwo+"/templates/"),2==l&&(o=i.libsThree+"/templates/"),o+=a["@version"],n.url=o+"/"+n.url}else n.url=t.blobUrl+"WizdomTemplates/"+n.url;if(-1==n.url.indexOf(t.wizdomVersion)){var u=n.url.indexOf("?")>0?"&":"?";n.url=n.url+u+"v="+t.wizdomVersion}}return n||e.when(n)},response:function(t){return t||e.when(t)},responseError:function(t){return i(t.content?t.content:t.data),e.reject(t)}}}angular.module("Wizdom365").factory("httpInterceptor",t).config(e),e.$inject=["$httpProvider"],t.$inject=["$q","contextInfo","$injector","log","notificationService","$templateCache","configuration","$timeout"]}(),function(){function e(e){var t=window.wizdomClientSideFeatureToggles=window.wizdomClientSideFeatureToggles||{},n=window.wizdomCDNs={wizdom:"//wizdom.azureedge.net",libsOne:"//wizdom-libs-one.azureedge.net",libsTwo:"//wizdom-libs-two.azureedge.net",libsThree:"//wizdom-libs-three.azureedge.net"};n.wizdom=t["CDN-Host-Wizdom"]||t["CDN-Host-All"]||n.wizdom,n.libsOne=t["CDN-Host-WizdomOne"]||t["CDN-Host-All"]||n.libsOne,n.libsTwo=t["CDN-Host-WizdomTwo"]||t["CDN-Host-All"]||n.libsTwo,n.libsThree=t["CDN-Host-WizdomThree"]||t["CDN-Host-All"]||n.libsThree;var i=({CDNType:t.CDNType},[{"name":"wizdom365-birthday","files":["Base/Bundles/Modules/Birthday.js"]},{"name":"wizdom365-canteen-menu","files":["Base/Bundles/Modules/CanteenMenu.js"]},{"name":"wizdom365-course-management","files":["Base/Bundles/Modules/Webform.js","Base/Bundles/Modules/BusinessApps.js","Base/Bundles/Modules/CourseManagement.js"]},{"name":"wizdom365-currentmenu","files":["Base/Bundles/Modules/Currentmenu.js"]},{"name":"wizdom365-department-users","files":["Base/Bundles/Modules/DepartmentUsers.js"]},{"name":"wizdom365-revision","files":["Base/Bundles/Modules/EditorRevision.js"]},{"name":"wizdom365-employees","files":["Base/Bundles/Modules/Employees.js"]},{"name":"wizdom365-gf","files":["Base/Bundles/Modules/Gamification.js"]},{"name":"wizdom365-helpdesk","files":["Base/Bundles/Modules/BusinessApps.js","Base/Bundles/Modules/Webform.js","Base/Bundles/Modules/ProjectSpace.js","Base/Bundles/Modules/Helpdesk.js"]},{"name":"wizdom365-kanban","files":["Base/Bundles/Modules/Kanban.js"]},{"name":"","files":["Base/Bundles/Modules/LightningPages.js"]},{"name":"wizdom365-livetiles","files":["Base/Bundles/Modules/LiveTiles.js"]},{"name":"wizdom365-manual","files":["Base/Bundles/Modules/Manual.js"]},{"name":"wizdom365-poll","files":["Base/Bundles/Modules/Gamification.js","Base/Bundles/Modules/Poll.js"]},{"name":"wizdom365-profile-progress","files":["Base/Bundles/Modules/ProfileProgress.js"]},{"name":"wizdom365-projectspace","files":["Base/Bundles/Modules/Webform.js","Base/Bundles/Modules/BusinessApps.js","Base/Bundles/Modules/ProjectSpace.js"]},{"name":"wizdom365-webform","files":["Base/Bundles/Modules/Webform.js"]}]);i.length>1&&e.config({modules:i.map(function(e){return e.files=e.files.map(function(e){return window.Wizdom365ResourcesUrl+e}),e.name=e.name||"not-empty-entry",e})})}angular.module("Wizdom365").config(e),e.$inject=["$ocLazyLoadProvider"]}(),function(){function e(e){e.options.backdrop="static"}angular.module("Wizdom365").config(e),e.$inject=["$modalProvider"]}(),angular.module("Wizdom365.Branding",[]),function(){function e(e,t){$("div.ms-webpart-chrome:not(:has(.ms-webpart-chrome-title)):not(:has(.ms-WPBorderBorderOnly)):not(body.wizdom-bootstrap-wrapper-system div.ms-webpart-chrome)").addClass("wt-chromeNone"),$("div.ms-webpart-chrome:has(.ms-webpart-chrome-title):not(:has(.ms-WPBorder))").addClass("wt-chromeTitleOnly"),$("div.ms-webpart-chrome:has(.ms-webpart-chrome-title):has(.ms-WPBorder)").addClass("wt-chromeTitleAndBorder"),e.StyleBehaviour&&"false"==e.StyleBehaviour.WebpartChromeTypeBehaviourAsSharepoint&&!t.isSettingsPage&&$(".webpartPage div.ms-webpart-chrome:has(.ms-webpart-chrome-title):not(:has(.ms-WPBorder))").addClass("wt-chromeTitleAndBorder").removeClass("wt-chromeTitleOnly")}angular.module("Wizdom365.Branding").run(e),e.$inject=["configuration","contextInfo"]}(),angular.module("Wizdom365.Yammer",[]),angular.module("Wizdom365.Yammer").run(["configuration","contextInfo","$window","yammerApi",function(e,t,n,i){try{var o=e.Yammer&&angular.isDefined(e.Yammer.YammerNotifyEnability["#checkbox"])?$.parseJSON(e.Yammer.YammerNotifyEnability["#checkbox"]):!1;o&&$(".ms-cui-TabRowRight").prepend("<span class='bootstrap-wrapper'><span wizdom365-Yammer-notification-panel></span></span>")}catch(r){}}]),function(){function e(e,t,n,i,o){var r=(JSON.parse((o.Analytics.SnooperEnabled["#text"]||o.Analytics.SnooperEnabled).toString().toLowerCase()),JSON.parse((o.Analytics.AnalyticsEnabled["#text"]||o.Analytics.AnalyticsEnabled).toString().toLowerCase())),a=(e.wizdomInsights,e.customerInsights),l={baseUrl:"api/wizdom/analytics",trackPageView:function(e,t,n,i,o){void 0===e&&(e=void 0),void 0===t&&(t=void 0),void 0===n&&(n=void 0),void 0===i&&(i=void 0),void 0===o&&(o=void 0),r&&a&&a.trackPageView(e,t,n,i,o)},getAnalyticsConfig:function(){return t.get(this.baseUrl+"/getanalyticsconfig")}};return l}angular.module("Wizdom365.Analytics").factory("analyticsApi",e),e.$inject=["$window","webapiService","contextInfo","$http","configuration"]}(),function(){function e(e){function n(e,t,n){}return{scope:{},template:'<div class="bootstrap-wrapper wizdom-chart">\n                        <div class="container-fluid">\n                            <div class="row">\n                                <div class="col-sm-12 col-md-6 text-center">\n                                    <div class="chart">\n                                        <canvas tc-chartjs-doughnut chart-data="chart.data" chart-options="chart.options" width="150" height="150"></canvas>\n                                    </div>\n                                </div>\n                                <div class="col-sm-12 col-md-6">\n                                    <ul class="legend list-group">\n                                        <li class="list-group-item list-group-item-success"><span>Lukkede</span><span class="badge">82</span></li>\n                                        <li class="list-group-item list-group-item-warning"><span>I gang</span><span class="badge">5</span></li>\n                                        <li class="list-group-item list-group-item-danger"><span>Nye</span><span class="badge">2</span></li>\n                                    </ul>\n                                </div>\n                            </div>\n                     </div> \n                    </div>',link:n,controllerAs:"chart",controller:t}}function t(){function e(){t.data=[{value:82,color:"#5cb85c",highlight:"#5cb85c",label:"Lukkede"},{value:5,color:"#f0ad4e",highlight:"#f0ad4e",label:"I gang"},{value:2,color:"#d9534f",highlight:"#d9534f",label:"Nye"}],t.options={animation:!1,responsive:!1,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:1,percentageInnerCutout:40}}var t=this;t.data={},t.options={},e()}angular.module("Wizdom365.Charts").directive("wizdom365ChartsPie",e),e.$inject=["webpartPropertiesService"],t.$inject=[]}(),function(){function e(e){var t={baseUrl:"api/wizdom/contentPage",getSocialOverview:function(t){return e.get(this.baseUrl+"/social/overview/"+t.pageListId+"/"+t.pageItemId+"/?webServerRelativeUrl="+t.webServerRelativeUrl)}};return t}angular.module("Wizdom365.ContentPage").factory("contentpageApi",e),e.$inject=["webapiService"]}(),angular.module("Wizdom365.CorporateNews").animation(".slide-animation-carousel",function(){return{beforeAddClass:function(e,t,n){var i=e.attr("direction"),o=JSON.parse(e.attr("currentIndex"));if("ng-hide"==t){var r=e.parent().width();"right"!==i&&(r=-r);var a=0===o?0:147*-o,l=147*-(o+1),s=$(".carousel-list-railSearch");window.TweenLite.fromTo(s,.5,{css:{marginTop:a}},{css:{marginTop:l},onComplete:n}),window.TweenLite.to(e,.5,{left:r,onComplete:n})}else n()},removeClass:function(e,t,n){var i=e.attr("direction");if("ng-hide"==t){e.removeClass("ng-hide");var o=e.parent().width();"right"===i&&(o=-o),window.TweenLite.fromTo(e,.5,{left:o},{left:0,onComplete:n})}else n()}}}),angular.module("Wizdom365.CorporateNews").animation(".slide-animation-carousel5",function(){return{beforeAddClass:function(e,t,n){var i=e.attr("direction"),o=JSON.parse(e.attr("currentIndex")),r=JSON.parse(e.attr("slides"));if("ng-hide"==t){var a=e.parent().width();"right"!==i&&(a=-a);var l=2;l=r.length>4?2:r.length>2?1:0;var s=0===o?0:147*-o,c=147*-(o+1),d=147*-(o+l),u=147*-(o+l+1),m=$("#carousel-list-rail1"),p=$("#carousel-list-rail2");window.TweenLite.fromTo(m,.5,{css:{marginTop:s}},{css:{marginTop:c},onComplete:n}),window.TweenLite.fromTo(p,.5,{css:{marginTop:d}},{css:{marginTop:u},onComplete:n}),window.TweenLite.to(e,.5,{left:a,onComplete:n})}else n()},removeClass:function(e,t,n){var i=e.attr("direction");if("ng-hide"==t){e.removeClass("ng-hide");var o=e.parent().width();"right"===i&&(o=-o),window.TweenLite.fromTo(e,.5,{left:o},{left:0,onComplete:n})}else n()}}}),angular.module("Wizdom365.CorporateNews").animation(".slide-animation-carousel-new-design",function(){return{beforeAddClass:function(e,t,n){var i=e.attr("direction");if("ng-hide"==t){var o=e.parent().width();"right"!==i&&(o=-o),window.TweenLite.to(e,.5,{left:o,onComplete:n})}else n()},removeClass:function(e,t,n){var i=e.attr("direction");if("ng-hide"==t){e.removeClass("ng-hide");var o=e.parent().width();"right"===i&&(o=-o),window.TweenLite.fromTo(e,.5,{left:o},{left:0,onComplete:n})}else n()}}}),angular.module("Wizdom365.CorporateNews").animation(".slide-animation-rotator",function(){return{beforeAddClass:function(e,t,n){var i=e.attr("direction");if("ng-hide"==t){var o=e.parent().width(),r=-e.parent().height();"right"!==i&&(o=-o,r=-r);var a=$(".carousel2-list-railAngular");window.TweenLite.fromTo(a,.5,{"margin-top":r},{"margin-top":0,onComplete:n}),window.TweenLite.to(e,.5,{left:o,onComplete:n})}else n()},removeClass:function(e,t,n){var i=e.attr("direction");if("ng-hide"==t){e.removeClass("ng-hide");var o=e.parent().width();"right"===i&&(o=-o),window.TweenLite.fromTo(e,.5,{left:o},{left:0,onComplete:n})}else n()}}}),angular.module("Wizdom365.CorporateNews").animation(".slide-animation-slider",function(){return{beforeAddClass:function(e,t,n){var i=e.attr("direction");if("ng-hide"==t){var o=e.parent().width();"right"!==i&&(o=-o),window.TweenLite.to(e,.5,{left:o,onComplete:n})}else n()},removeClass:function(e,t,n){var i=e.attr("direction");if("ng-hide"==t){e.removeClass("ng-hide");var o=e.parent().width();"right"===i&&(o=-o),window.TweenLite.fromTo(e,.5,{left:o},{left:0,onComplete:n})}else n()}}}),angular.module("Wizdom365.ContentPage").directive("wizdom365ContentPageInfo",function(){return{controller:"wizdom365ContentPageInfo"}}).controller("wizdom365ContentPageInfo",["$scope","contextInfo","configuration","contentpageApi",function(e,t,n,i){if(e.socialFeatureEnabled=n.ContentPage?$.parseJSON(n.ContentPage.SocialFeature.Enabled):!1,e.socialEnabledOnItem=t.pageColumns.newsEnableSocial,e.socialId=t.pageColumns.pageInstanceId||t.pageItemId+t.pageListId,e.socialFeatureEnabled&&e.socialEnabledOnItem){var o={pageListId:t.pageListId,pageItemId:t.pageItemId,webServerRelativeUrl:window.encodeURIComponent(t.webServerRelativeUrl)};i.getSocialOverview(o).then(function(n){e.item=n.item,e.item&&(e.item.id=e.socialId),e.pageListId=t.pageListId,e.pageItemId=t.pageItemId})}}]),angular.module("Wizdom365.CorporateNews").directive("wizdom365CorporateNewsInfo",function(){return{controller:"wizdom365CorporateNewsInfo"}}).controller("wizdom365CorporateNewsInfo",["$scope","contextInfo","configuration","corporateNewsApi",function(e,t,n,i){if(e.socialFeatureEnabled=n.CorporateNews?$.parseJSON(n.CorporateNews.SocialFeature.Enabled):!1,e.socialEnabledOnItem=t.pageColumns.newsEnableSocial,e.socialId=t.pageColumns.pageInstanceId||t.pageItemId+t.pageListId,e.socialFeatureEnabled&&e.socialEnabledOnItem){var o={pageListId:t.pageListId,pageItemId:t.pageItemId,webServerRelativeUrl:window.encodeURIComponent(t.webServerRelativeUrl)};i.getSocialOverview(o).then(function(n){e.item=n.item,e.item&&(e.item.id=e.socialId),e.pageListId=t.pageListId,e.pageItemId=t.pageItemId})}}]),angular.module("Wizdom365.CorporateNews").filter("htmlToPlainText",[function(){return function(e){if("undefined"!=typeof e&&null!=e&&e.length>0){var t=document.createElement("DIV");e=e.replace(/<[^>]+>/gm,""),t.innerHTML=e,e=t.textContent||t.innerText||"",e.length>150&&(e=e.substring(0,150)+"...")}return e}}]),angular.module("Wizdom365.CorporateNews").filter("stripImageSrc",[function(){return function(e){var t="";try{if("undefined"!=typeof e&&null!=e){e.replace("&#58",":");var n=new RegExp('<img.*?src="(.*/(.*?))".*?>',"g");t=n.exec(e)[1],-1!==t.toString().indexOf("RenditionID")&&(t=t.substring(0,t.indexOf("?")))}}catch(i){}return t||e}}]),angular.module("Wizdom365.CorporateNews").filter("stripImageSrcAddCover",[function(){return function(e){var t="";try{if("undefined"!=typeof e&&null!=e){e.replace("&#58",":");var n=new RegExp('<img.*?src="(.*/(.*?))".*?>',"g");t=n.exec(e)[1],-1!==t.toString().indexOf("RenditionID")&&(t=t.substring(0,t.indexOf("?")))}if(""!==t)return"background-image:url("+t+"?width=801);background-size:cover;background-position:50%,50%;"}catch(i){}return{}}}]),angular.module("Wizdom365.CorporateNews").directive("setContainerDimensionsCarousel",["$window",function(e){function t(e,t,n){var i,o;o=t.parent().parent(),t.width=o.width(),o.width()>e.minWidth?i=o.find("#carousel-list").css("width",200):o.find("#carousel-list").hide(),e.style=function(){return{height:"294px",width:o.width()>e.minWidth?o.width()-208+"px":o.width()+"px"}},e.styleBackground=function(t,n,i){var r={height:"294px",width:o.width()>e.minWidth?o.width()-208+"px":o.width()+"px"};if(t&&""!==t){var a="undefined"!=typeof n?"?width="+n:"",l=""!==a?"&":"?",s="undefined"!=typeof i?l+"height="+i:"";r["background-image"]="url('"+t+a+s+"')"}return r},e.getDimensions=function(){return{w:o.width()}},e.styleRail=function(){return{height:"294px",width:o.width()>e.minWidth?o.width()-208+"px":"100%"}},e.$watch(e.getDimensions,function(t,n){t!==n&&(t.w>e.minWidth?i=o.find("#carousel-list").css("width",200).show():o.find("#carousel-list").hide(),e.style=function(){return{height:"294px",width:t.w>e.minWidth?t.w-208+"px":t.w+"px"}},e.styleBackground=function(n,i,o){var r={height:"294px",width:t.w>e.minWidth?t.w-208+"px":t.w+"px"};if(n&&""!==n){var a="undefined"!=typeof i?"?width="+i:"",l=""!==a?"&":"?",s="undefined"!=typeof o?l+"height="+o:"";r["background-image"]="url('"+n+a+s+"')"}return r},e.styleRail=function(){return{height:"294px",width:t.w>e.minWidth?t.w-208+"px":"100%"}})},!0)}return{link:t}}]),angular.module("Wizdom365.CorporateNews").directive("setContainerDimensionsCarouselFive",["$window","$timeout",function(e,t){function n(e,t,n){var i,o;o=t.parent().parent(),t.width=o.width(),o.width()>e.minWidth||o.find("#carousel-list").hide(),e.style=function(){return{height:"294px",width:o.width()>e.minWidth?o.width()-421+"px":o.width()+"px"}},e.styleBackground=function(t,n,i){var r={height:"294px",width:o.width()>e.minWidth?o.width()-421+"px":o.width()+"px"};if(t&&""!==t){var a="undefined"!=typeof n?"?width="+n:"",l=""!==a?"&":"?",s="undefined"!=typeof i?l+"height="+i:"";r["background-image"]="url('"+t+a+s+"')"}return r},e.getDimensions=function(){return{w:o.width()}},e.$watch(e.getDimensions,function(t,n){t!==n&&(t.w>e.minWidth?i=o.find("#carousel-list").show():o.find("#carousel-list").hide(),e.style=function(){return{height:"294px",width:t.w>e.minWidth?t.w-421+"px":t.w+"px"}},e.styleBackground=function(n,i,o){var r={height:"294px",width:t.w>e.minWidth?t.w-421+"px":t.w+"px"};if(n&&""!==n){var a="undefined"!=typeof i?"?width="+i:"",l=""!==a?"&":"?",s="undefined"!=typeof o?l+"height="+o:"";r["background-image"]="url('"+n+a+s+"')"}return r})},!0)}return{link:n}}]),angular.module("Wizdom365.CorporateNews").directive("setContainerDimensionsCarouselNewDesign",["$window",function(e){function t(e,t,n){var i;i=t.parent().parent(),t.width="100%",e.getDimensions=function(){return{w:"100%"}},e.styleRail=function(){return{height:"344px",width:"100%"}},e.styleBackground=function(e,t,n){var i={height:"344px",width:"100%"};if(e&&""!==e){var o="undefined"!=typeof t?"?width="+t:"",r=""!==o?"&":"?",a="undefined"!=typeof n?r+"height="+n:"";i["background-image"]="linear-gradient(rgba(0, 0, 0, 0),rgba(0, 0, 0, 0.6)),url('"+e+o+a+"')"}return i},e.style=function(){return{height:"344px",width:"100%"}}}return{link:t}}]),angular.module("Wizdom365.CorporateNews").directive("setContainerDimensionsRotator",["$window",function(e){function t(e,t,n){var i;e.smallScreen=!1,i=t.parent().parent(),t.width=i.width(),i.width()>e.minWidth?e.smallScreen=!1:e.smallScreen=!0,e.style=function(){return{height:"294px",width:i.width()>e.minWidth?i.width()-210+"px":i.width()+"px"}},e.styleBackground=function(t,n,o){var r={height:"294px",width:i.width()>e.minWidth?i.width()-210+"px":i.width()+"px"};if(t&&""!==t){var a="undefined"!=typeof n?"?width="+n:"",l=""!==a?"&":"?",s="undefined"!=typeof o?l+"height="+o:"";r["background-image"]="url('"+t+a+s+"')"}return r},e.getDimensions=function(){return{w:i.width()}},e.$watch(e.getDimensions,function(t,n){if(t!==n){i.width()>e.minWidth?e.smallScreen=!1:e.smallScreen=!0;var o=t.w>e.minWidth?t.w-210:t.w;e.style=function(){return{height:"294px",width:o+"px"}},e.styleBackground=function(e){var t={height:"294px",width:o+"px"};return e&&""!==e&&(t["background-image"]="url('"+e+"?width="+o+"')"),t}}},!0)}return{link:t}}]),angular.module("Wizdom365.CorporateNews").directive("setContainerDimensionsSlider",["$window",function(e){function t(e,t,n){var i;i=t.parent().parent(),t.width=i.width(),e.style=function(){return{height:i.width()>e.minWidth?"294px":"500px",width:i.width()+"px"}},e.styleHeight=function(){return{height:i.width()>e.minWidth?"294px":"500px"}},e.getDimensions=function(){return{w:i.width(),height:i.width()>e.minWidth?"294px":"500px"}},e.$watch(e.getDimensions,function(t,n){t!==n&&(e.style=function(){return{height:t.w>e.minWidth?"294px":"500px",width:t.w+"px"}},e.styleHeight=function(){return{height:t.w>e.minWidth?"294px":"500px"}})},!0)}return{link:t}}]),function(){function e(){function e(e,t,n,i){}return{scope:{},template:'<div class="bootstrap-wrapper">\n                            <div class="webpart-edit-button-container" ng-if="editMode">\n                                <button class="editWebpartButton btn" ng-click="editWebpart()" type="button" title=\'{{"Edit Webpart" | translate}}\'>\n                                    <span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{"Edit" | translate}}</span>\n                                </button>\n                            </div>\n                         <div class="alert alert-danger" ng-if="errorMessage" ng-bind-html="errorMessage"></div>\n                         <div wizdom-include=\'webpartProperties.templateUrl\'></div>\n                        </div>',link:e,controller:t}}function t(e,t,n,i,o,r,a,l,s,c,d,u){function m(e){var t=Date.parse(e+"Z");return isNaN(t)?new Date(e):new Date(t)}function p(){if(e.dataReady=!1,"1"===e.webpartProperties.queryMode&&0==e.webpartProperties.path.length){var t=c("translate")("Query mode")+": "+c("translate")("SharePoint Search Based")+"<br/>"+c("translate")("Please specify Url for corporate news");return e.errorMessage=t,void(e.dataReady=!0)}var n=g();n&&(e.slides=n,e.dataReady=!0),"0"===e.webpartProperties.queryMode?a.getNews(e.webpartProperties.path,e.webpartProperties.numberOfNews,e.webpartProperties.typeNews,e.webpartProperties.orderBy,e.webpartProperties.ascending,e.webpartProperties.cachingType,e.webpartProperties.resultSource,e.webpartProperties.selectProperties,e.webpartProperties.languageFilterUseDynamic?e.webpartProperties.languageFilterDynamic:e.webpartProperties.languageFilter.map(function(e){return e.label}).join(";"),e.webpartProperties.departmentFilterUseDynamic?e.webpartProperties.departmentFilterDynamic:e.webpartProperties.departmentFilter.map(function(e){return e.label}).join(";"),e.webpartProperties.locationFilterUseDynamic?e.webpartProperties.locationFilterDynamic:e.webpartProperties.locationFilter.map(function(e){return e.label}).join(";"),e.webpartProperties.languageFilterUseDynamic,e.webpartProperties.departmentFilterUseDynamic,e.webpartProperties.locationFilterUseDynamic,e.webpartProperties.includeModernNews,e.webpartProperties.pathModern,e.webpartProperties.includeClassicNews).then(function(t){try{for(var n=0;n<t.length;n++)t[n].date=m(t[n].date)}catch(i){}e.slides=t,e.dataReady=!0,e.startAnimation(),f(t)}):a.getNewsCaml(e.webpartProperties.path,e.webpartProperties.numberOfNews,e.webpartProperties.typeNews,e.webpartProperties.orderBy,e.webpartProperties.ascending,e.webpartProperties.languageFilterUseDynamic?e.webpartProperties.languageFilterDynamic:e.webpartProperties.languageFilter.map(function(e){return e.label}).join(";"),e.webpartProperties.departmentFilterUseDynamic?e.webpartProperties.departmentFilterDynamic:e.webpartProperties.departmentFilter.map(function(e){return e.label}).join(";"),e.webpartProperties.locationFilterUseDynamic?e.webpartProperties.locationFilterDynamic:e.webpartProperties.locationFilter.map(function(e){return e.label}).join(";"),e.webpartProperties.languageFilterUseDynamic,e.webpartProperties.departmentFilterUseDynamic,e.webpartProperties.locationFilterUseDynamic,e.webpartProperties.includeModernNews,e.webpartProperties.pathModern,e.webpartProperties.includeClassicNews).then(function(t){try{for(var n=0;n<t.length;n++)t[n].date=m(t[n].date)}catch(i){}e.slides=t,e.dataReady=!0,e.startAnimation(),f(t)})}function g(){return JSON.parse(u.getItem("corporateNews:"+e.webpartId))}function f(t){var n=angular.copy(t);angular.forEach(n,function(e){if(e.summary){var t=e.summary.trim().replace(/(<|&lt;)br\s*\/*(>|&gt;)|(\u200B)/g,"");t?e.content=null:e.summary=null}}),u.setItem("corporateNews:"+e.webpartId,JSON.stringify(n))}e.webpartId=i.getWebpartId(t),e.editMode=i.isInEditMode(t),i.hideEditCode(t);var h=n.webpartProperties?JSON.parse(n.webpartProperties):null,w="1",v="LastModifiedTime",b="w365NewsDate";e.isOnPrem&&(w="0"),h&&h.queryMode&&(w=h.queryMode),h&&h.orderBy?v=h.orderBy:"0"==w&&o.isSortable(b).then(function(){v=b}),e.webpartProperties={numberOfNews:h&&h.numberOfNews||5,speed:h&&h.speed||1e4,path:h&&h.path||"",typeNews:h&&h.typeNews||"2",orderBy:v,ascending:h&&h.ascending||"false",cachingType:h&&h.cachingType||"0",templateUrl:h&&h.templateUrl||"CorporateNews/Templates/ViewTemplates/newslist.html",resultSource:h&&h.resultSource||"8413cd39-2156-4e00-b54d-11efd9abdb89",queryMode:w,selectProperties:h&&h.selectProperties||[],locationFilter:h&&h.locationFilter||[],departmentFilter:h&&h.departmentFilter||[],languageFilter:h&&h.languageFilter||[],locationFilterDynamic:h&&h.locationFilterDynamic||"",departmentFilterDynamic:h&&h.departmentFilterDynamic||"",languageFilterDynamic:h&&h.languageFilterDynamic||"",locationFilterUseDynamic:h&&h.locationFilterUseDynamic||!1,departmentFilterUseDynamic:h&&h.departmentFilterUseDynamic||!1,languageFilterUseDynamic:h&&h.languageFilterUseDynamic||!1,includeModernNews:h&&h.includeModernNews||!1,pathModern:h&&h.pathModern||"",includeClassicNews:h&&null!==h.includeClassicNews?h.includeClassicNews:!0};var C=function(){e.$applyAsync(function(){e.startAnimation()})},y=function(){e.$applyAsync(function(){e.stopAnimation()})},I=angular.element(d);I.on("focus",C),I.on("blur",y),e.dataReady=!1,e.currentIndex=0,e.direction="left",e.currentIndex=0,e.minWidth=600,e.isOnPrem=r.wizdomEnvironmentIsOnPrem;var S;e.editWebpart=function(){s.open({templateUrl:"CorporateNews/Templates/Dialogs/EditWebpartCorporateNews.html",controller:"corporateNewsEditWebpartCtrl",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return e.webpartId},webpartProperties:function(){return e.webpartProperties}}}).result.then(function(t){t&&(e.webpartProperties=t,p())})},p(),e.isCurrentSlideIndex=function(t){return e.currentIndex===t},e.setCurrentSlideIndex=function(t){e.direction=t>e.currentIndex?"left":"right",e.currentIndex=t},e.nextSlide=function(){e.direction="left",e.currentIndex=e.currentIndex<e.slides.length-1?++e.currentIndex:0},e.prevSlide=function(){e.direction="right",e.currentIndex=e.currentIndex>0?e.currentIndex-1:e.slides.length-1},e.startAnimation=function(){angular.isDefined(S)||-1!==e.webpartProperties.templateUrl.search("newsgallery")||-1!==e.webpartProperties.templateUrl.search("newslist")||(S=l(function(){e.nextSlide()},e.webpartProperties.speed))},e.stopAnimation=function(){angular.isDefined(S)&&(l.cancel(S),S=void 0)},e.redirectTo=function(e){d.location=e},e.$on("$destroy",function(){l.cancel(S),S=void 0}),e.styleBackgroundList=function(e,t,n){var i={height:t+"px",width:t+"px"};if(e&&""!==e){var o="undefined"!=typeof t?"?width="+t:"",r=""!==o?"&":"?",a="undefined"!=typeof n?r+"height="+n:"";i["background-image"]="url('"+e+o+a+"')"}return i},e.goToSlide=function(t){t!=e.currentIndex&&(t<e.currentIndex?(e.stopAnimation(),e.direction="right",e.currentIndex=t):t>e.currentIndex&&(e.stopAnimation(),e.direction="left",e.currentIndex=t))}}angular.module("Wizdom365.CorporateNews").directive("wizdom365CorporateNews",e),e.$inject=[],t.$inject=["$scope","$element","$attrs","webpartPropertiesService","managedProperty","contextInfo","corporateNewsApi","$interval","$modal","$filter","$window","sessionStorageService"]}(),function(){function e(e){var t={baseUrl:"api/wizdom/corporateNews",getNews:function(t,n,i,o,r,a,l,s,c,d,u,m,p,g,f,h,w){void 0===c&&(c=""),void 0===d&&(d=""),void 0===u&&(u=""),void 0===m&&(m=!1),void 0===p&&(p=!1),void 0===g&&(g=!1),void 0===f&&(f=!1),void 0===h&&(h=""),void 0===w&&(w=!0);var v="";return"undefined"!=typeof s&&angular.forEach(s,function(e){v+="&selectProperties="+e}),e.getAppCached(this.baseUrl+"/news?path="+t+"&numberOfNews="+n+"&typeNews="+i+"&orderBy="+o+"&ascending="+r+"&cachingType="+a+"&resultSource="+l+"&languageFilter="+encodeURIComponent(c)+"&departmentFilter="+encodeURIComponent(d)+"&locationFilter="+encodeURIComponent(u)+"&languageFilterUseDynamic="+encodeURIComponent(m.toString())+"&departmentFilterUseDynamic="+encodeURIComponent(p.toString())+"&locationFilterUseDynamic="+encodeURIComponent(g.toString())+"&includeModernNews="+encodeURIComponent(f.toString())+"&modernPath="+encodeURIComponent(h.toString())+"&includeClassicNews="+encodeURIComponent(w.toString())+v)},updateNewsDateProp:function(){return e.getAppCached(this.baseUrl+"/news/updateSiteSearch")},getNewsCaml:function(t,n,i,o,r,a,l,s,c,d,u,m,p,g){return void 0===a&&(a=""),void 0===l&&(l=""),void 0===s&&(s=""),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===u&&(u=!1),void 0===m&&(m=!1),void 0===p&&(p=""),void 0===g&&(g=!0),e.getAppCached(this.baseUrl+"/news/caml?path="+encodeURIComponent(t.toString())+"&numberOfNews="+n+"&typeNews="+i+"&orderBy="+o+"&languageFilter="+encodeURIComponent(a)+"&departmentFilter="+encodeURIComponent(l)+"&locationFilter="+encodeURIComponent(s)+"&languageFilterUseDynamic="+encodeURIComponent(c.toString())+"&departmentFilterUseDynamic="+encodeURIComponent(d.toString())+"&locationFilterUseDynamic="+encodeURIComponent(u.toString())+"&includeModernNews="+encodeURIComponent(m.toString())+"&modernPath="+encodeURIComponent(p.toString())+"&includeClassicNews="+encodeURIComponent(g.toString())+"&ascending="+r)},getTopNews:function(t,n,i,o,r,a,l,s,c){return void 0===i&&(i=""),void 0===o&&(o=""),void 0===r&&(r=""),void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===s&&(s=!1),void 0===c&&(c=!1),e.getAppCached(this.baseUrl+"/news?path="+t+"&numberOfNews="+n+"&typeNews=1&orderBy=LastModifiedTime&ascending="+!1+"&cachingType=0&languageFilter="+encodeURIComponent(i)+"&departmentFilter="+encodeURIComponent(o)+"&locationFilter="+encodeURIComponent(r)+"&languageFilterUseDynamic="+encodeURIComponent(a.toString())+"&departmentFilterUseDynamic="+encodeURIComponent(l.toString())+"&locationFilterUseDynamic="+encodeURIComponent(s.toString())+"&includeModernNews="+encodeURIComponent(c.toString())+"&resultSource=")},getLatestNews:function(t,n,i,o,r,a,l,s,c){return void 0===i&&(i=""),void 0===o&&(o=""),void 0===r&&(r=""),void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===s&&(s=!1),void 0===c&&(c=!1),e.getAppCached(this.baseUrl+"/news?path="+t+"&numberOfNews="+n+"&typeNews=0&orderBy=LastModifiedTime&ascending="+!1+"&cachingType=0&languageFilter="+encodeURIComponent(i)+"&departmentFilter="+encodeURIComponent(o)+"&locationFilter="+encodeURIComponent(r)+"&languageFilterUseDynamic="+encodeURIComponent(a.toString())+"&departmentFilterUseDynamic="+encodeURIComponent(l.toString())+"&locationFilterUseDynamic="+encodeURIComponent(s.toString())+"&includeModernNews="+encodeURIComponent(c.toString())+"&resultSource=")},getSocialOverview:function(t){return e.get(this.baseUrl+"/social/overview/"+t.pageListId+"/"+t.pageItemId+"/?webServerRelativeUrl="+t.webServerRelativeUrl)}};return t}angular.module("Wizdom365.CorporateNews").factory("corporateNewsApi",e),e.$inject=["webapiService"]}(),function(){function e(e){var t={breadcrumb:{baseUrl:"api/wizdom/branding/breadcrumb",getBreadcrumb:function(t){return e.getAppCached(this.baseUrl+"/"+t.pageListId+"/"+t.pageItemId+"/"+(t.pageVersion?t.pageVersion.replace(".","_"):"current")+"/?requestPath="+t.requestPath+"&webServerRelativeUrl="+t.webServerRelativeUrl+"&siteServerRelativeUrl="+t.siteServerRelativeUrl+"&listItemId="+t.listItemId+"&webTitle="+encodeURIComponent(t.webTitle)+"&isCheckedOutToUser="+t.isCheckedOutToUser)}},breadcrumbMeta:{baseUrl:"api/wizdom/branding/breadcrumbmeta",getBreadcrumbMeta:function(t){return e.getAppCached(this.baseUrl+"/"+t.pageListId+"/"+t.pageItemId+"/"+(t.pageVersion?t.pageVersion.replace(".","_"):"current")+"/?requestPath="+t.requestPath+"&webServerRelativeUrl="+t.webServerRelativeUrl+"&siteServerRelativeUrl="+t.siteServerRelativeUrl+"&termId="+t.termId+"&termSetId="+t.termSetId+"&termStoreId="+t.termStoreId+"&webTitle="+encodeURIComponent(t.webTitle))},getCurrentMenuNavigation:function(t,n){return void 0===n&&(n=!1),e.getAppCached("api/wizdom/currentMenu/currentNavigation?CurrentSite="+t+(n?"&IncludeHostLink=true":""))}}};return t}angular.module("Wizdom365.Breadcrumb").factory("breadcrumbApi",e),e.$inject=["webapiService"]}(),angular.module("Wizdom365.Breadcrumb").directive("wizdom365Breadcrumb",function(){return{scope:{},template:"<div wizdom-include='::templateUrl'></div>",link:function(e,t,n){},controller:["$scope","$http","contextInfo","breadcrumbApi","configuration",function(e,t,n,i,o){function r(){$.map($("#DeltaPlaceHolderPageTitleInTitleArea").find("a"),function(t){""!=$(t).text()&&e.breadCrumb.push({name:$(t).text(),url:$(t).attr("href")})});e.breadCrumb.push({name:$.trim($(document).find("title").text()),url:window.location.href})}function a(){var t=angular.isArray(s)?_.find(s,function(e){return 0==decodeURIComponent(l("RootFolder")||"").toLowerCase().indexOf(decodeURIComponent(e.dirUrl).toLowerCase())}):n.listContext;if(t){var i=t.dirUrl;if(location.pathname.indexOf(i)>=0)e.breadCrumb.push({name:t.title,url:location.pathname+"?RootFolder="+i});else{var o=e.breadCrumb[e.breadCrumb.length-1];o.url=o.url||location.pathname}var r=l("RootFolder");if(r){var a=decodeURIComponent(i),c=decodeURIComponent(r);r=c.substring(a.length+1,c.length);for(var d=a+"/";r.length>0;){var u=r.substring(0,-1==r.indexOf("/")?r.length:r.indexOf("/"));e.breadCrumb.push({name:u,url:location.pathname+"?RootFolder="+encodeURIComponent(d+u)}),d+=u+"/",r=r.substring(u.length+1,r.length)}}}}function l(e){var t=_.map(decodeURIComponent(window.location.search.substring(1)).split("&"),function(e){return{key:e.split("=")[0],value:e.split("=")[1]}}),n=_.find(t,function(t){return t.key==e});return n?n.value:null}console.time("Wizdom Breadcrumb");var s=n.listContext;e.spHostUrl=n.spHostUrl,e.showBreadcrumb=!1,e.templateUrl=o.Breadcrumb.TemplateUrl;var c={pageListId:n.pageListId,pageItemId:n.pageItemId,pageVersion:n.pageFileVersionForDisplay?n.pageFileVersionForDisplay:"current",requestPath:window.encodeURIComponent(n.currentPage),webServerRelativeUrl:window.encodeURIComponent(n.webServerRelativeUrl),siteServerRelativeUrl:window.encodeURIComponent(n.siteServerRelativeUrl),listItemId:l("ID"),webTitle:n.webTitle,isCheckedOutToUser:n.pageIsCheckedOutTocurrentUser};i.breadcrumb.getBreadcrumb(c).then(function(t){e.breadCrumb=t.links;var n=l("RecSrc");s&&!n?a():e.breadCrumb[e.breadCrumb.length-1].url||(e.breadCrumb[e.breadCrumb.length-1].url=window.location.href),t.links.length>0&&(e.showBreadcrumb=!0),window.location.href.indexOf("_layouts/")>-1&&-1==window.location.href.indexOf("_catalogs/")&&$(document).ready(function(){r()}),console.timeEnd("Wizdom Breadcrumb")})}]}}),angular.module("Wizdom365.Breadcrumb").directive("wizdom365BreadcrumbMeta",function(){return{scope:{},template:"<div wizdom-include='::templateUrl'></div>",link:function(e,t,n){},controller:["$scope","$http","contextInfo","breadcrumbApi","breadcrumbConfig","configuration",function(e,t,n,i,o,r){function a(){var t=angular.isArray(c)?_.find(c,function(e){return(l("RootFolder")||"").startsWith(e.dirUrl)}):n.listContext;if(t){var i=t.dirUrl;if(location.pathname.indexOf(i)>=0)e.breadCrumb.push({name:t.title,url:location.pathname+"?RootFolder="+i});else{var o=e.breadCrumb[e.breadCrumb.length-1];o.url=o.url||location.pathname}var r=l("RootFolder");if(r){var a=decodeURIComponent(i),s=decodeURIComponent(r);r=s.substring(a.length+1,s.length);for(var d=a+"/";r.length>0;){var u=r.substring(0,-1==r.indexOf("/")?r.length:r.indexOf("/"));e.breadCrumb.push({name:u,url:location.pathname+"?RootFolder="+encodeURIComponent(d+u)}),d+=u+"/",r=r.substring(u.length+1,r.length)}}}}function l(e){var t=_.map(decodeURIComponent(window.location.search.substring(1)).split("&"),function(e){return{key:e.split("=")[0],value:e.split("=")[1]}}),n=_.find(t,function(t){return t.key==e});return n?n.value:null}function s(e,t,n){for(var i=angular.isArray(e)?e:[e],o=0;o<i.length;o++){var e=i[o];if(e.childs){var r=t.length;if(s(e.childs,t,n),r<t.length)return void t.push({url:e.url,name:e.name})}if(0==n.indexOf(e.url))return void t.push({url:e.url,name:e.name})}}console.time("Wizdom Breadcrumb Meta");var c=n.listContext;e.spHostUrl=n.spHostUrl,e.showBreadcrumb=!1,e.buildFoldersStructure=a,e.templateUrl=r.Breadcrumb.TemplateUrl;var d=(encodeURIComponent(location.href),n.friendUrlTermId),u=n.friendUrlTermSetId,m=n.friendUrlTermStoreId;if(d.length>0&&u.length>0&&m.length>0){var p={pageListId:n.pageListId,pageItemId:n.pageItemId,pageVersion:n.pageFileVersionForDisplay?n.pageFileVersionForDisplay:"current",requestPath:window.encodeURIComponent(n.currentPage),webServerRelativeUrl:window.encodeURIComponent(n.webServerRelativeUrl),siteServerRelativeUrl:window.encodeURIComponent(n.siteServerRelativeUrl),termId:d,termSetId:u,termStoreId:m,webTitle:n.webTitle};i.breadcrumbMeta.getBreadcrumbMeta(p).then(function(t){e.breadCrumb=t.links,c&&a(),t.links.length>0&&(e.showBreadcrumb=!0),console.timeEnd("Wizdom Breadcrumb Meta")})}else o.isCurrentmenuRequired?i.breadcrumbMeta.getCurrentMenuNavigation(window.encodeURIComponent(n.spWebUrl),!0).then(function(t){var n=[];s(t,n,location.href),e.breadCrumb=n.reverse(),c&&a(),e.showBreadcrumb=!0}):c&&(e.breadCrumb=[],a(),e.showBreadcrumb=!0)}]}}),function(){function e(e){var t={faqSet:{baseUrl:"api/wizdom/faq",getGlobalSets:function(){return e.get(this.baseUrl+"/sets/global")},getAllSets:function(){return e.get(this.baseUrl+"/sets")},addSet:function(t){return e.post(this.baseUrl+"/sets",t)},updateSet:function(t){return e.put(this.baseUrl+"/sets",t)},deleteSet:function(t){return e["delete"](this.baseUrl+"/sets/"+t)},setAsGlobal:function(t){return e.put(this.baseUrl+"/sets/"+t+"/makeGlobal")}},faqView:{baseUrl:"api/wizdom/faq/view",getView:function(t){return e.get(this.baseUrl+"/"+t)},addOrUpdateView:function(t){return e.post(this.baseUrl,t)}}};return t}angular.module("Wizdom365.FAQ").factory("faqApi",e),e.$inject=["webapiService"]}(),angular.module("Wizdom365.FAQ").controller("Wizdom365FAQEditCategoryController",["$scope","$modalInstance","category",function(e,t,n){e.category=n,e.save=function(){t.close(e.question)},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("Wizdom365.FAQ").controller("Wizdom365FAQEditQuestionController",["$scope","$modalInstance","faqQuestion",function(e,t,n){e.question=n,e.question.icon=e.question.icon||"glyphicon glyphicon-question-sign",e.question.modernIcon=e.question.modernIcon||{icon:"ms-Icon ms-Icon--Help",color:"",backgroundColor:""},e.save=function(){t.close(e.question)},e.cancel=function(){t.dismiss("cancel")},e.tinyMceOptions={init_instance_callback:function(t){e.iframeElement=t.iframeElement,t.on("SetAttrib",function(e){"style"==e.attrName&&setTimeout(function(){t.execCommand("mceRepaint")})}),$(".ie11focusfix").focus()}}}]),angular.module("Wizdom365.FAQ").controller("Wizdom365FAQEditSetController",["$scope","$modalInstance","faqApi","$modal","faqSet","$filter","notificationService",function(e,t,n,i,o,r,a){e.faqSet=o,e.sortableOptions={items:".link-container:not(.not-sortable)",connectWith:".categorylinks-container"},e.sortableOptionsCategory={items:".link-collection-content:not(.not-sortable)",connectWith:".category-container","ui-floating":!0},e.save=function(){n.faqSet.addSet(e.faqSet).then(function(e){t.close(e)})},e.cancel=function(){t.dismiss("cancel")},e.deleteCategory=function(t){a.showConfirmationDialog({text:r("translate")("Are you sure that you want to delete the category")+" "+e.faqSet.categories[t].title+"?",type:"warning",layout:"center",successCalback:function(){e.faqSet.categories.splice(t,1),e.$apply()},errorCalback:function(){}})},e.deleteQuestion=function(t,n){a.showConfirmationDialog({text:r("translate")("Are you sure that you want to delete this question")+"?",type:"warning",layout:"center",successCalback:function(){n.questions.splice(t,1),e.$apply()},errorCalback:function(){}})},e.moveQuestion=function(e,t,n){var i=e+t;if(!(0>i||i>n.questions.length-1)){if(i>=n.questions.length)for(var o=i-n.questions.length;o--+1;)n.questions.push(void 0);n.questions.splice(i,0,n.questions.splice(e,1)[0])}},e.moveCategory=function(t,n,i){var o=t+n;if(!(0>o||o>e.faqSet.categories.length-1)){if(o>=e.faqSet.categories.length)for(var r=o-e.faqSet.categories.length;r--+1;)e.faqSet.categories.push(void 0);e.faqSet.categories.splice(o,0,e.faqSet.categories.splice(t,1)[0])}},e.editQuestion=function(e,t,n){var o=angular.copy(e);i.open({templateUrl:"FAQ/Templates/Dialogs/EditQuestion.html",controller:"Wizdom365FAQEditQuestionController",windowClass:"bootstrap-wrapper",resolve:{faqQuestion:function(){return e}}}).result.then(function(e){e&&n&&t.questions.push(e)},function(){angular.copy(o,e)})},e.editCategory=function(t,n){n&&(t={title:"",pictureUrl:"",questions:[],isRoot:!1,order:""});var o=angular.copy(t);i.open({templateUrl:"FAQ/Templates/Dialogs/EditCategory.html",controller:"Wizdom365FAQEditCategoryController",windowClass:"bootstrap-wrapper",resolve:{category:function(){return t}}}).result.then(function(i){n&&e.faqSet.categories.push(t)},function(){angular.copy(o,t)})}}]),angular.module("Wizdom365.FAQ").controller("Wizdom365FAQEditWebpartController",["$scope","webpartPropertiesService","$modalInstance","webpartId","webpartProperties","faqApi","$modal","dialogMode","pageUrl","notificationService","$filter",function(e,t,n,i,o,r,a,l,s,c,d){function u(){g=e.view.faqSet,e.view={pageUrl:s,webpartId:i,useGlobalSet:!0,faqSet:{}}}function m(){e.view={webpartId:i,pageUrl:s,useGlobalSet:!1},g?e.view.faqSet=g:e.view.faqSet={title:"",isGlobal:!1,categories:[{title:"Root",pictureUrl:"",isRoot:!0,questions:[],order:""}]}}function p(){m(),e.loading=!0,e.globalSets=[],r.faqView.getView(i).then(function(t){null!=t&&(t.pageUrl=s,e.view=t),r.faqSet.getGlobalSets().then(function(t){e.globalSets=t,e.loading=!1})})}e.mode="editview";var g=void 0;e.changeView=function(t){e.mode=t},e.isActive=function(t){return e.mode===t},e.dialogMode=l,e.sortableOptions={items:".link-container:not(.not-sortable)",connectWith:".categorylinks-container"},e.sortableOptionsCategory={items:".link-collection-content:not(.not-sortable)",connectWith:".category-container","ui-floating":!0},e.webpartProperties=angular.copy(o),e.webpartProperties||(e.webpartProperties=t.getProperties(i)),e.save=function(){e.loading=!0,r.faqView.addOrUpdateView(e.view).then(function(o){"webpart"==l&&t.setProperties(i,e.webpartProperties),n.close(o,e.webpartProperties)})},e.cancel=function(){n.dismiss("cancel")},e.manageGlobalSettings=function(){e.view.useGlobalSet?u():m()},p(),e.deleteCategory=function(t){c.showConfirmationDialog({text:d("translate")("Are you sure that you want to delete the category")+" "+e.view.faqSet.categories[t].title+"?",type:"warning",layout:"center",successCalback:function(){e.view.faqSet.categories.splice(t,1),e.$apply()},errorCalback:function(){}})},e.deleteQuestion=function(t,n){c.showConfirmationDialog({text:d("translate")("Are you sure that you want to delete this question")+"?",type:"warning",layout:"center",successCalback:function(){n.questions.splice(t,1),e.$apply()},errorCalback:function(){}})},e.moveQuestion=function(e,t,n){var i=e+t;if(!(0>i||i>n.questions.length-1)){if(i>=n.questions.length)for(var o=i-n.questions.length;o--+1;)n.questions.push(void 0);n.questions.splice(i,0,n.questions.splice(e,1)[0])}},e.moveCategory=function(t,n,i){var o=t+n;if(!(0>o||o>e.view.faqSet.categories.length-1)){if(o>=e.view.faqSet.categories.length)for(var r=o-e.view.faqSet.categories.length;r--+1;)e.view.faqSet.categories.push(void 0);e.view.faqSet.categories.splice(o,0,e.view.faqSet.categories.splice(t,1)[0])}},e.editCategory=function(t,n){n&&(t={title:"",pictureUrl:"",questions:[],isRoot:!1,order:""});var i=angular.copy(t);a.open({templateUrl:"FAQ/Templates/Dialogs/EditCategory.html",controller:"Wizdom365FAQEditCategoryController",windowClass:"bootstrap-wrapper",resolve:{category:function(){return t}}}).result.then(function(i){n&&e.view.faqSet.categories.push(t)},function(){angular.copy(i,t)})},e.editQuestion=function(e,t,n){var i=angular.copy(e);a.open({templateUrl:"FAQ/Templates/Dialogs/EditQuestion.html",controller:"Wizdom365FAQEditQuestionController",windowClass:"bootstrap-wrapper",resolve:{faqQuestion:function(){return e}}}).result.then(function(e){e&&n&&t.questions.push(e)},function(){angular.copy(i,e)})}}]),angular.module("Wizdom365.FAQ").controller("Wizdom365FAQShowController",["$scope","$modalInstance","item",function(e,t,n){e.item=n,e.save=function(){t.close()},e.cancel=function(){t.close()}}]),function(){function e(){return{restrict:"C",compile:function(e,t){var n=e.html();return e.html('<div class="slideable_content" style="margin:0 !important; padding:0 !important" >'+n+"</div>"),function(e,t,n){n.duration=n.duration?n.duration:"1s",n.easing=n.easing?n.easing:"ease-in-out",t.css({overflow:"hidden",height:"0px",transitionProperty:"height",transitionDuration:n.duration,transitionTimingFunction:n.easing})}}}}angular.module("Wizdom365.FAQ").directive("wizdom365FaqSlideable",e)}(),function(){function e(e){return{restrict:"A",scope:{watchmodel:"="},link:function(t,n,i){var o,r;i.expanded=!1;var a=function(e,t,n){try{if(e||(e=document.querySelector(n.wizdom365FaqSlideToggle)),e&&(t||(t=e.querySelector(".slideable_content")),n.expanded)){t.style.border="1px solid rgba(0,0,0,0)";var i=t.clientHeight;t.style.border=0,e.style.height=i+"px"}}catch(o){}};t.watchmodel&&t.$watch("watchmodel",function(t,n){e(function(){a(o,r,i)})},!0),t.$watch(function(){return n.height()},function(e,t){a(o,r,i)},!0),n.bind("click",function(){a(o,r,i)})}}}angular.module("Wizdom365.FAQ").directive("wizdom365FaqSlideToggle",e),e.$inject=["$timeout"]}(),function(){function e(){function e(e,t,n){}return{scope:{},template:'<div class="bootstrap-wrapper">\n                         <div ng-if="editMode" class="left-corner">\n                                <div class="webpart-edit-button-container">\n                                    <button class="editWebpartButton btn" ng-click="editWebpart()" type="button" title=\'{{"Edit Webpart" | translate}}\'>\n                                        <span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{"Edit" | translate}}</span>\n                                    </button>\n                                </div>\n                          <br /><br />\n                         </div>\n                         <div class="wizdom-fullview faq">\n                          <div wizdom365-spinner="" loading="loading"></div>\n                          <div ng-hide="loading">\n                           <div ng-show="notConfigured" class="left-corner">\n                            {{\'Please configure the webpart\' |  translate }}\n                           </div>\n                           <div ng-hide="notConfigured">\n                            <div wizdom-include=\'webpartProperties.templateUrl\'></div>\n                           </div>\n                          </div>\n                         </div>\n                        </div>',link:e,controller:t}}function t(e,t,n,i,o,r,a,l,s,c,d){function u(){var t=m();t?(e.view=t,e.notConfigured=!1,e.loading=!1):(e.loading=!0,angular.copy({},e.view)),s.faqView.getView(e.webpartId).then(function(t){null!=t&&(e.notConfigured=!1,e.view=t,p(t)),e.loading=!1},function(){e.loading=!1})}function m(){return JSON.parse(d.getItem("faq:"+e.webpartId))}function p(t){d.setItem("faq:"+e.webpartId,JSON.stringify(t))}e.webpartId=i.getWebpartId(t),e.editMode=i.isInEditMode(t),i.hideEditCode(t);var g=n.webpartProperties?JSON.parse(n.webpartProperties):null;e.webpartProperties={templateUrl:g&&g.templateUrl||"FAQ/Templates/ViewTemplates/webpartSimpleList.html",useDialog:g&&g.useDialog||!1},e.appUrl=r.appUrl,e.editWebpart=function(){a.open({templateUrl:"FAQ/Templates/Dialogs/EditWebpart.html",controller:"Wizdom365FAQEditWebpartController",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return e.webpartId},webpartProperties:function(){return e.webpartProperties},dialogMode:function(){return"webpart"},pageUrl:function(){return r.requestPath},size:"lg"}}).result.then(function(t,n){t&&(e.webpartProperties=n,e.webpartProperties||(e.webpartProperties=i.getProperties(t.webpartId)),u())})},e.openDialog=function(t){var n={heading:t.question,content:t.answer};e.showFaqModal(n)},e.showFaqModal=function(e){a.open({templateUrl:"FAQ/Templates/Dialogs/ShowFAQ.html",controller:"Wizdom365FAQShowController",windowClass:"bootstrap-wrapper",resolve:{item:function(){return e}}}).result.then(function(){})},e.view={},e.loading=!0,e.notConfigured=!0,u(),e.onSelect=function(t,n,i){e.showFaqModal(t),e.selected=void 0},e.selected=void 0,e.getSearchResults=function(t){var n=[];return angular.forEach(e.view.faqSet.categories,function(e){angular.forEach(e.questions,function(i){(i.question.toLowerCase().indexOf(t.toLowerCase())>-1||i.answer.toLowerCase().indexOf(t.toLowerCase())>-1)&&n.push({heading:i.question,content:i.answer,image:e.pictureUrl,category:e})})}),n}}angular.module("Wizdom365.FAQ").directive("wizdom365FaqOverview",e),e.$inject=[],t.$inject=["$scope","$element","$attrs","webpartPropertiesService","configuration","contextInfo","$modal","log","faqApi","$http","localStorageService"]}(),function(){function e(){return{scope:{},template:"<div wizdom-include='::vm.footer.templateUrl'></div>",controller:t,controllerAs:"vm"}}function t(e,t,n,i,o){function r(){n.views.getOrAddView(s.footer.viewId,!1).then(function(e){s.footer=e,s.footer.templateUrl=s.templateUrl,s.shouldShowEditLinksIcon=l()})}function a(){e.open({templateUrl:"PersonalLink/Templates/Dialogs/EditLinks.html",controller:"PersonalLinkEditLinksDialogController",controllerAs:"vm",windowClass:"bootstrap-wrapper",resolve:{webpart:function(){return angular.copy(s.footer)}}}).result.then(function(e){e&&(s.footer=e.webpart,n.categories.setLinkOrder(s.footer.viewId,s.footer.categories,!1).then(function(e){}),s.shouldShowEditLinksIcon=l())})}function l(){return s.footer&&s.footer.categories&&(s.footer.allowPersonalLinks||s.footer.allowDeleteLinks||s.footer.allowSortLinks)}var s=this;s.footer={viewId:o.ViewId},s.footerText=o.FooterText,s.templateUrl=o.TemplateUrl||"Footer/Templates/ViewTemplates/Footer.html",s.editServiceMenu=a,s.showEditLinksIcon=l,s.shouldShowEditLinksIcon=l(),r()}angular.module("Wizdom365.Footer").directive("wizdom365Footer",e),t.$inject=["$modal","$scope","footerApi","smartWordsService","footerConfig"]}(),function(){function e(){function e(e,t,n){var i=+angular.element("#s4-bodyContainer").css("padding-bottom").replace("px",""),o=angular.element("#s4-workspace").height()-angular.element("#s4-bodyContainer").height()-angular.element("#wt-footer").height()-i;o>0?t.css("position","fixed").css("bottom",0).css("left",0).css("width","100%"):t.css("position","static"),e.__height=angular.element("#s4-bodyContainer").height(),e.$watch(e.__height,function(){var n=+angular.element("#s4-bodyContainer").css("padding-bottom").replace("px",""),i=angular.element("#s4-workspace").height()-e.__height-angular.element("#wt-footer").height()-n;i>0?t.css("position","fixed").css("bottom",0).css("left",0):t.css("position","static").css("bottom","auto").css("left","auto")},!0)}return{link:e}}angular.module("Wizdom365.Footer").directive("wizdom365FooterPlaceFooter",e)}(),function(){function e(e,t,n){var i={views:{baseUrl:"api/wizdom/personalLink/views/",allowBatching:!1,batchGroup:"personalLink",getOrAddView:function(i,o){var r=n.getItem("footer.timestamp");return e.get(this.baseUrl+"getoradd/"+i+"/"+o+"?browserCacheDays=30&footerTimestamp="+t.Footer.Timestamp+"&personalFooterTimestamp="+r,this.allowBatching,this.batchGroup)},updateView:function(t){var i=e.put(this.baseUrl+"update",t);return i.then(function(e){n.setItem("footer.timestamp",new Date)}),i}},categories:{baseUrl:"api/wizdom/personalLink/categories/",setLinkOrder:function(t,i,o){var r=e.post(this.baseUrl+"order/set/"+t+"/"+o,i);return r.then(function(e){n.setItem("footer.timestamp",(new Date).getTime())}),r}}};return i}angular.module("Wizdom365.Footer").factory("footerApi",e),e.$inject=["webapiService","configuration","localStorageService"]}(),function(){angular.module("Wizdom365.Footer").factory("footerConfig",["configuration",function(e){if(e.Footer.length>1){var t=e.Footer,n=-1;return angular.forEach(e.Footer,function(e){var i=e["@configFilter"]||"",o=new RegExp(i,"i");i.length>n&&o.test(window.location.href)&&(t=e,n=i.length)}),t}return 1==e.Footer.length?e.Footer[0]:e.Footer}])}(),function(){function e(e,t,n,i){return{itemTypes:{get:function(e){return i.get("api/wizdom/GovernMetadata/v1/ItemTypes/"+e)},getAll:function(){return i.get("api/wizdom/GovernMetadata/v1/ItemTypes")},create:function(e){return i.post("api/wizdom/GovernMetadata/v1/ItemTypes",e)},update:function(e,t){return i.put("api/wizdom/GovernMetadata/v1/ItemTypes/"+e,t)},"delete":function(e){return i["delete"]("api/wizdom/GovernMetadata/v1/ItemTypes/"+e)},getMetadata:function(e){return i.get("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/metadatadefinitions")},addMetadata:function(e,t){return i.post("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/metadatadefinitions",{metadataId:t})},updateMetadata:function(e,t,n){return i.put("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/metadatadefinitions/"+t,{sortOrder:n})},removeMetadata:function(e,t){return i["delete"]("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/metadatadefinitions/"+t)},eventregistrations:{get:function(e,t){return i.get("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/Eventregistrations/"+t)},getAll:function(e){return i.get("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/Eventregistrations")},create:function(e,t){return i.post("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/Eventregistrations",t)},update:function(e,t,n){return i.put("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/Eventregistrations/"+t,n)},"delete":function(e,t){return i["delete"]("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/Eventregistrations/"+t)},getHistory:function(e,t,n){return i.get("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/Eventregistrations/"+t+"/history"+n)},repeatHistory:function(e,t,n){return i.post("api/wizdom/GovernMetadata/v1/ItemTypes/"+e+"/Eventregistrations/"+t+"/history/"+n+"/Actions/Repeat")}}},metadataDefinitions:{get:function(e){return i.get("api/wizdom/GovernMetadata/v1/metadataDefinitions/"+e)},getAll:function(){return i.get("api/wizdom/GovernMetadata/v1/metadataDefinitions")},create:function(e){return i.post("api/wizdom/GovernMetadata/v1/metadataDefinitions",e)},update:function(e,t){return i.put("api/wizdom/GovernMetadata/v1/metadataDefinitions/"+e,t)},"delete":function(e){return i["delete"]("api/wizdom/GovernMetadata/v1/metadataDefinitions/"+e)},undelete:function(e){return i.put("api/wizdom/GovernMetadata/v1/metadataDefinitions/"+e+"/action/undelete")},schemas:{getValidTypes:function(){return i.get("api/wizdom/GovernMetadata/v1/metadataDefinitions/Types")}}},events:{getAll:function(){return i.get("api/wizdom/GovernMetadata/v1/Events")},getSchema:function(e){return i.get("api/wizdom/GovernMetadata/v1/Events/samples/"+e)}},proxy:{requests:{getAll:function(){return i.get("api/wizdom/GovernMetadata/v1/proxy/safelistedrequests")},create:function(e){return i.post("api/wizdom/GovernMetadata/v1/proxy/safelistedrequests",e)},update:function(e,t){return i.put("api/wizdom/GovernMetadata/v1/proxy/safelistedrequests/"+e,t)},"delete":function(e){return i["delete"]("api/wizdom/GovernMetadata/v1/proxy/safelistedrequests/"+e)}}}}}angular.module("Wizdom365.GovernMetadata").factory("governmetadataApi",e),e.$inject=["$q","SpecificConfigurationService","contextInfo","webapiService"]}(),function(){function e(){return function(e){return e&&""!==e?"background-image:url("+e+"?width=801);background-size:cover;background-position:50%,50%;":e}}angular.module("Wizdom365.ImageSlider").filter("wizdom365ImageSliderSrcAddCoverImage",e)}(),function(){function e(e){var t={baseUrl:"api/wizdom/imageslider",getImages:function(t){return e.getAppCached(this.baseUrl+"/images?rowLimit="+t.rowLimit+"&orderBy="+t.orderBy+"&webUrl="+t.webUrl+"&folderUrl="+t.folderUrl+"&linkField="+t.linkField)},getFieldNames:function(t){return e.getAppCached(this.baseUrl+"/fieldNames?webUrl="+t.webUrl+"&folderUrl="+t.folderUrl)}};return t}angular.module("Wizdom365.ImageSlider").factory("imageSliderApi",e),e.$inject=["webapiService"]}(),function(){function e(){return{beforeAddClass:t,removeClass:n}}function t(e,t,n){var i=e.attr("direction");if("ng-hide"==t){var o=e.parent().width();"right"!==i&&(o=-o),window.TweenLite.to(e,.5,{left:o,onComplete:n})}else n()}function n(e,t,n){var i=e.attr("direction");if("ng-hide"==t){e.removeClass("ng-hide");var o=e.parent().width();"right"===i&&(o=-o),window.TweenLite.fromTo(e,.5,{left:o},{left:0,onComplete:n})}else n()}angular.module("Wizdom365.ImageSlider").animation(".slide-animation-imageslider",e)}(),function(){function e(){function e(e,t,n){}return{scope:{},template:'<style>\r\n #wizdomDishImageSlider {\r\n  position: relative;\r\n  height: 420px;\r\n  overflow: hidden;\r\n }\r\n\r\n .dishImage {\r\n  position: absolute;\r\n  width: 100%;\r\n  top: 0;\r\n  left: 0;\r\n }\r\n\r\n .dishHeading, .dishDescription {\r\n  width: 100%;\r\n  text-align: center;\r\n }\r\n\r\n .dishHeading {\r\n  padding-top: 40px;\r\n }\r\n\r\n .dishDescription {\r\n  padding-top: 25px;\r\n }\r\n\r\n .dishHeading span {\r\n  text-transform: uppercase;\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  color: #282c2e;\r\n }\r\n\r\n .dishDescription span {\r\n  font-size: 14px;\r\n  color: #282c2e;\r\n  opacity: 0.6;\r\n }\r\n\r\n .dish-controls-newdesign ul {\r\n  position: absolute;\r\n  text-align: center;\r\n  bottom: 0;\r\n  width: 100%;\r\n  list-style: none;\r\n  margin: 0;\r\n  padding: 0 0 0 0;\r\n  margin-bottom: 40px;\r\n }\r\n\r\n\r\n .dish-controls-newdesign li.currentitem {\r\n  cursor: default;\r\n  position: relative;\r\n }\r\n\r\n\r\n .dish-controls-newdesign li {\r\n  margin: 2px;\r\n  display: inline-block;\r\n  cursor: pointer;\r\n }\r\n</style><div class="webpart-edit-button-container" ng-if="editMode"><button class="editWebpartButton btn" ng-click="editWebpart()" type="button" title=\'{{"Edit Webpart" | translate}}\'><span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{"Edit" | translate}}</span></button></div><div style="width:100%;"><div id="wizdomDishImageSlider" ng-if="configured && !loading && images" ng-mouseleave="startAnimation()" ng-mouseover="stopAnimation()" class="wizdom-fullview-left wizdom-fullview-right"><div class="dishImage slide-animation-imageslider" direction="{{direction}}" ng-repeat="item in images" ng-swipe-left="nextSlide(true)" ng-swipe-right="prevSlide(true)" ng-hide="!isCurrentSlideIndex($index)"><div ng-style="styleBackground((item.url))"><div class="dishHeading"><span ng-bind="item.title"></span></div><div class="dishDescription"><span ng-bind="item.description"></span></div></div><div class="dish-controls-newdesign"><ul><li class="icon-dot-dark-dims" ng-class="{\'icon-dot-dark\':isCurrentSlideIndex($index), \'icon-dot-dark-transparent\':!isCurrentSlideIndex($index)}" ng-repeat="item in images" ng-click="setCurrentSlideIndex($index);"></li></ul></div></div></div><div wizdom365-spinner loading="loading"></div></div>',link:e,controller:t}}function t(e,t,n,i,o,r,a,l,s){function c(){e.configured=!1,e.loading=!0,e.webpartProperties.webUrl?(e.configured=!0,a.get("api/wizdom/imageslider/images?rowLimit="+e.webpartProperties.rowLimit+"&orderBy="+e.webpartProperties.orderBy+"&webUrl="+e.webpartProperties.webUrl+"&folderUrl="+e.webpartProperties.folderUrl+"&linkField="+e.webpartProperties.linkField).success(function(t){e.images=t,e.loading=!1,e.startAnimation()})):e.loading=!1}if(e.webpartId=i.getWebpartId(t),i.hideEditCode(t),e.editMode=i.isInEditMode(t),e.webpartProperties={rowLimit:5,orderBy:"",webUrl:"",folderUrl:"",linkField:"",imgWidth:"",imgHeight:"194",speed:1e4},n.webpartProperties){var d=JSON.parse(n.webpartProperties);d.rowLimit&&(e.webpartProperties.rowLimit=d.rowLimit),d.orderBy&&(e.webpartProperties.orderBy=d.orderBy),d.webUrl&&(e.webpartProperties.webUrl=d.webUrl),d.folderUrl&&(e.webpartProperties.folderUrl=d.folderUrl),d.linkField&&(e.webpartProperties.linkField=d.linkField),d.imgWidth&&(e.webpartProperties.imgWidth=d.imgWidth),d.imgHeight&&(e.webpartProperties.imgHeight=d.imgHeight),d.speed&&(e.webpartProperties.speed=d.speed)}r.pageListId,r.pageItemId;e.spHostUrl=r.spHostUrl,e.editWebpart=function(){s.open({templateUrl:"ImageSlider/Templates/Dialogs/EditWebpart.html",controller:"Wizdom365ImageSliderEditWebpartController",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return e.webpartId},webpartProperties:function(){return e.webpartProperties}}}).result.then(function(t){t&&(e.webpartProperties=t,c())})},e.styleBackground=function(t){var n={height:e.webpartProperties.imgHeight+"px",width:parseInt(e.webpartProperties.imgWidth)?parseInt(e.webpartProperties.imgWidth)+"px":"100%"};return t&&""!==t&&(n["max-height"]=e.webpartProperties.imgHeight+"px",n["background-image"]="url('"+t+"')",n["background-size"]="cover",n["background-position"]="50%,50%"),n},c(),e.getWebSizeImage=function(e){var t=e.substring(e.lastIndexOf("/")+1),n=t.split(".").pop(),i=t.replace("."+n,"_"+n)+".jpg";return e.substring(0,e.lastIndexOf("/")+1)+"_w/"+i},e.currentIndex=0,e.isCurrentSlideIndex=function(t){return e.currentIndex===t},e.direction="left",e.currentIndex=0,e.setCurrentSlideIndex=function(t){e.direction=t>e.currentIndex?"left":"right",e.currentIndex=t},e.isCurrentSlideIndex=function(t){return e.currentIndex===t},e.nextSlide=function(t){t&&e.stopAnimation(),e.direction="left",e.currentIndex=e.currentIndex<e.images.length-1?++e.currentIndex:0},e.prevSlide=function(t){t&&e.stopAnimation(),e.direction="right",e.currentIndex=e.currentIndex>0?e.currentIndex-1:e.images.length-1},e.goToSlide=function(t){t!=e.currentIndex&&(t<e.currentIndex?(e.stopAnimation(),e.direction="right",e.currentIndex=t):t>e.currentIndex&&(e.stopAnimation(),e.direction="left",e.currentIndex=t))};var u;e.startAnimation=function(){angular.isDefined(u)||(u=l(function(){e.nextSlide(!1)},e.webpartProperties.speed))},e.stopAnimation=function(){angular.isDefined(u)&&(l.cancel(u),u=void 0)},e.minWidth=500}angular.module("Wizdom365.ImageSlider").directive("wizdom365DishImageslider",e),e.$inject=[],t.$inject=["$scope","$element","$attrs","webpartPropertiesService","$http","contextInfo","webapiService","$interval","$modal"]}(),function(){function e(){function e(e,t,n){}return{scope:{},template:'<div class="bootstrap-wrapper">\n                            <div class="webpart-edit-button-container" ng-if="editMode">\n                                <button class="editWebpartButton btn" ng-click="editWebpart()" type="button" title=\'{{"Edit Webpart" | translate}}\'>\n                                    <span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{"Edit" | translate}}</span>\n                                </button>\n                            </div>\n                         <div wizdom-include=\'webpartProperties.templateUrl\'></div>\n                         <div wizdom365-spinner="" loading="loading"></div>\n                        </div>',link:e,controller:t}}function t(e,t,n,i,o,r,a,l,s,c,d){function u(){e.nextPrevButtonMarginTop=e.webpartProperties.imgHeight?"margin-top:"+(parseFloat(e.webpartProperties.imgHeight)/2-25)+"px":"";var t=c.getItem("imageSlider:"+e.webpartId);if(t&&e.webpartProperties.webUrl?(e.images=JSON.parse(t),e.configured=!0,e.loading=!1):(e.configured=!1,e.loading=!0),e.webpartProperties.webUrl){e.configured=!0;var n={rowLimit:e.webpartProperties.rowLimit,orderBy:e.webpartProperties.orderBy,webUrl:e.webpartProperties.webUrl,folderUrl:e.webpartProperties.folderUrl,linkField:e.webpartProperties.linkField};a.getImages(n).then(function(t){e.images=t,e.loading=!1,e.startAnimation();var n=e.images.length>3?_.take(e.images,3):e.images;c.setItem("imageSlider:"+e.webpartId,JSON.stringify(n))},function(t){e.loading=!1})}else e.loading=!1}e.webpartId=i.getWebpartId(t),i.hideEditCode(t),e.editMode=i.isInEditMode(t);var m=n.webpartProperties?JSON.parse(n.webpartProperties):null;e.webpartProperties={rowLimit:m&&m.rowLimit||5,orderBy:m&&m.orderBy||"",webUrl:m&&m.webUrl||"",folderUrl:m&&m.folderUrl||"",linkField:m&&m.linkField||"",imgWidth:m&&m.imgWidth||"",imgHeight:m&&m.imgHeight||"",speed:m&&m.speed||1e4,templateUrl:m&&m.templateUrl||"ImageSlider/Templates/ViewTemplates/default.html"};var p=function(){e.$applyAsync(function(){u(),e.startAnimation()})},g=function(){e.$applyAsync(function(){e.stopAnimation()})},f=angular.element(d);f.on("focus",p),f.on("blur",g);r.pageListId,r.pageItemId;e.spHostUrl=r.spHostUrl,e.editWebpart=function(){s.open({templateUrl:"ImageSlider/Templates/Dialogs/EditWebpart.html",controller:"Wizdom365ImageSliderEditWebpartController",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return e.webpartId},webpartProperties:function(){return e.webpartProperties}}}).result.then(function(t){t&&(e.webpartProperties=t,u())})},u(),e.getWebSizeImage=function(e){var t=e.substring(e.lastIndexOf("/")+1),n=t.split(".").pop(),i=t.replace("."+n,"_"+n)+".jpg";return e.substring(0,e.lastIndexOf("/")+1)+"_w/"+i},e.currentIndex=0,e.isCurrentSlideIndex=function(t){return e.currentIndex===t},e.direction="left",e.currentIndex=0,e.setCurrentSlideIndex=function(t){e.direction=t>e.currentIndex?"left":"right",e.currentIndex=t;},e.isCurrentSlideIndex=function(t){return e.currentIndex===t},e.nextSlide=function(){e.direction="left",e.currentIndex=e.currentIndex<e.images.length-1?++e.currentIndex:0},e.prevSlide=function(){e.direction="right",e.currentIndex=e.currentIndex>0?e.currentIndex-1:e.images.length-1},e.goToSlide=function(t){t!=e.currentIndex&&(t<e.currentIndex?(e.stopAnimation(),e.direction="right",e.currentIndex=t):t>e.currentIndex&&(e.stopAnimation(),e.direction="left",e.currentIndex=t))};var h;e.startAnimation=function(){angular.isDefined(h)||(h=l(function(){e.nextSlide()},e.webpartProperties.speed))},e.stopAnimation=function(){angular.isDefined(h)&&(l.cancel(h),h=void 0)},e.minWidth=500}angular.module("Wizdom365.ImageSlider").directive("wizdom365Imageslider",e),e.$inject=[],t.$inject=["$scope","$element","$attrs","webpartPropertiesService","$http","contextInfo","imageSliderApi","$interval","$modal","localStorageService","$window"]}(),function(){function e(e){function t(e,t,n){var i;i=t.parent().parent(),t.width=i.width(),t.height=e.webpartProperties.imgHeight,e.getDimensions=function(){return{w:parseInt(e.webpartProperties.imgWidth)?parseInt(e.webpartProperties.imgWidth)+"px":"100%"}},e.style=function(){return parseInt(e.webpartProperties.imgHeight)||0!=e.currHeight?{height:parseInt(e.webpartProperties.imgHeight)?e.webpartProperties.imgHeight+"px":o+"px",width:parseInt(e.webpartProperties.imgWidth)?parseInt(e.webpartProperties.imgWidth)+"px":"100%"}:void 0};var o=0;e.styleBackground=function(n,i){if(parseInt(e.webpartProperties.imgHeight)){var o={height:e.webpartProperties.imgHeight+"px",width:parseInt(e.webpartProperties.imgWidth)?parseInt(e.webpartProperties.imgWidth)+"px":"100%"};return n&&""!==n&&(o["background-image"]="url('"+n+"')",o["background-size"]="cover",o["background-position"]="50%,50%"),o}if(e.isCurrentSlideIndex(i)&&0!=t.find(".sImage"+i).parent().height()){var r=t.find(".sImage"+i).parent().height();t.find("#button-next").css({"margin-top":parseInt(r)/2-25+"px"}),t.find("#button-previous").css({"margin-top":parseInt(r)/2-25+"px"}),t.css({height:r})}},e.$watch(e.getDimensions,function(t,n){t!==n&&(e.style=function(){return{height:e.webpartProperties.imgHeight+"px",width:parseInt(e.webpartProperties.imgWidth)?parseInt(e.webpartProperties.imgWidth)+"px":t.w+"px"}})},!0)}return{link:t}}angular.module("Wizdom365.ImageSlider").directive("wizdom365ImagesliderSetContainerDimensions",e),e.$inject=["$window"]}(),function(){function e(e){function t(e,t,n){var i;i=t.parent().parent(),t.width=i.width(),t.height=e.webpartProperties.imgHeight,e.getDimensions=function(){return{w:"100%"}},e.style=function(){return parseInt(e.webpartProperties.imgHeight)||0!=e.currHeight?{height:parseInt(e.webpartProperties.imgHeight)?e.webpartProperties.imgHeight+"px":o+"px",width:parseInt(e.webpartProperties.imgWidth)?parseInt(e.webpartProperties.imgWidth)+"px":"100%"}:void 0};var o=0;e.styleBackground=function(n,i){if(parseInt(e.webpartProperties.imgHeight)){o=t.find(".sImage"+i).height();var r={height:e.webpartProperties.imgHeight+"px",width:parseInt(e.webpartProperties.imgWidth)?parseInt(e.webpartProperties.imgWidth)+"px":"100%"};return n&&""!==n&&(r["background-image"]="url('"+n+"')",r["background-size"]="cover",r["background-position"]="50%,50%"),r}if(e.isCurrentSlideIndex(i)&&0!=t.find(".sImage"+i).parent().height()){var a=t.find(".sImage"+i).parent().height();t.find("#button-next").css({"margin-top":parseInt(a)/2-25+"px"}),t.find("#button-previous").css({"margin-top":parseInt(a)/2-25+"px"}),t.css({height:a})}}}return{link:t}}angular.module("Wizdom365.ImageSlider").directive("wizdom365ImagesliderSetContainerDimensionsFull",e),e.$inject=["$window"]}(),function(){function e(){return{scope:{},template:"<div wizdom-include='vm.templateUrl'></div>",controller:t,controllerAs:"vm"}}function t(e,t,n,i,o,r){function a(){i.sitecollectionTasks.taskStatus(n.spHostUrl).then(function(e){"done"===e.upgradeStatus.toLowerCase()?(s.installDone=!0,s.upgradeInProgress=!1):(s.upgradePercentDone=e.percentDone,s.upgradeProgressMessage=e.upgradeProgress_Message,s.upgradeTaskType=e.upgradeTaskType.toLowerCase(),s.upgradeStatus=e.upgradeStatus.toLowerCase(),o(a,c))},function(e){})}function l(){t.location.reload()}var s=this;s.templateUrl=r.LoadingBanner.SelectedTemplate,s.upgradeInProgress=!1,s.upgradePercentDone=0,s.upgradeProgressMessage="",s.upgradeTaskType="",s.upgradeStatus="pending",s.refreshPageAfterUpdate=l;var c=5e3;n.upgradeInProgress().then(function(e){s.upgradeInProgress=e,e===!0&&a()},function(e){})}angular.module("Wizdom365.LoadingBanner").directive("wizdom365LoadingBanner",e),t.$inject=["$scope","$window","contextInfo","webApiProxy","$timeout","configuration"]}(),function(){function e(e){return{scope:{},templateUrl:e.Template||"Megamenu/Templates/ViewTemplates/MenuTemplateDesktop.html",controller:t,controllerAs:"vm"}}function t(e,t,n,i,o,r,a){function l(e){m.topItems=e.content.children,s(m.topItems),m.currentTopItem&&(m.currentTopItem=_.find(m.topItems,{id:m.currentTopItem.id}));var n=_.map(m.topItems,function(e){return _.clone(e)});u?n={timestamp:t.Timestamp||"noTimeStamp",topItems:n}:_.forEach(n,function(e){return e.children=[]}),o.setItem(d(),JSON.stringify(n)),m.loading=!1,window.megaMenuIsReadyForBurgerLink=!0,r.trigger("megaMenuIsReadyForBurgerLink"),console.timeEnd("Wizdom Megamenu")}function s(e){e.forEach(function(e){null==e.templatePath&&(e.templatePath=m.getTemplatePath(e),e.children.forEach(function(e){e.templatePath=m.getTemplatePath(e),e.children.forEach(function(e){e.templatePath=m.getTemplatePath(e)})}))})}function c(){return u&&(o.removeItem("Megamenu.TopItems.Cache:"+window.Wizdom365AppUrl+":"+t["@configFilter"]),m.topItems&&m.topItems.timestamp&&m.topItems.timestamp==(t.Timestamp||"noTimeStamp"))?(m.loading=!1,window.megaMenuIsReadyForBurgerLink=!0,void r.trigger("megaMenuIsReadyForBurgerLink")):(m.loading=!0,void(t.View&&t.View.id&&n.root.getPersonalizedRoot(t.View.id,u).then(l)))}function d(){return(u?"Megamenu.FullCache:"+e.userLoginName+":":"Megamenu.TopItems.Cache:")+window.Wizdom365AppUrl+":"+e.language+":"+t["@configFilter"]}console.time("Wizdom Megamenu");var u=window.wizdomClientSideFeatureToggles&&"true"==window.wizdomClientSideFeatureToggles.SkipRedisForMegamenu,m=this;m.fullWidth="Full width"==t.Width,m.enableHoverOnTopLinks="true"==t.TopItemHover,m.enableHoverOnLinks="true"==t.LinkItemHover,m.enableHoverOnHeadings="true"==t.HeadingItemHover,m.enableHoverOnHtml="true"==t.HtmlItemHover,m.currentTopItem=null,m.loading=!0;var p=null,g=null,f=null,h=500;m.getTranslatedText=function(e,t){return"title"==t?e.translatedTitle||e.title:e.translatedValue&&e.translatedValue[t]||e.value&&e.value[t]},m.getTemplatePath=function(e){return t.ElementTypes[e.contentType]?t.ElementTypes[e.contentType].ViewTemplateUrl:"Megamenu/Templates/ViewTemplates/ElementTypes/Text_view.html"},m.clickedItem="",m.clickTopItem=function(e,t,n){return m.isDeviceiPad()?(n.preventDefault&&n.preventDefault(),void(m.clickedItem!=e+t.title&&t.children&&0!==t.children.length?m.clickedItem=e+t.title:e&&e.length>0&&window.location.assign(e))):!0},m.isDeviceiPad=function(){var e=["iPad Simulator","iPad"];if(navigator.platform)for(;e.length;)if(navigator.platform===e.pop())return!0;return!1},m.overTopItem=function(e,t){a.cancel(f),e&&(g=a(function(){m.fullWidth||m.setPositionOnContainer(t),m.currentTopItem=e,h=0},h)),null!=p&&(a.cancel(p),p=null)},m.leaveTopItem=function(){a.cancel(g),p=a(function(){m.currentTopItem=null}),f=a(function(){h=500},1e3)},m.overTopItemV2=function(e,t){m.elementId=t,$(".navigationTree").css("display","none"),e.children.length&&(m.fullWidth||(m.setPositionOnContainer(t),$(".navigationTree").removeClass("ng-hide")),$("#tab"+t+"Section").css("display","block"))},m.leaveTopItemV2=function(){$(".navigationTree").css("display","none")},m.overFoldOutContainer=function(){$("#tab"+m.elementId+"Section").css("display","block")},m.leavingFoldOutContainer=function(){$("#tab"+m.elementId+"Section").css("display","none")},m.trustHTML=function(e){return i.trustAsHtml(e)},m.setPositionOnContainer=function(e){$(".FoldOutContainer").removeAttr("style");var t=document.querySelector("#tab"+e),n=$("#tab"+e+"Section"),i=t.offsetLeft;$(n).removeClass("ng-hide");var o=$("#tab"+e+"Section > ul"),r=$(o).width(),a=parseInt($(o).css("margin-left"),10)+parseInt($(o).css("margin-right"),10);r+=a;var l=r,s=l+i;$(n).addClass("ng-hide"),s>$(document).width()?$(".FoldOutContainer").css({right:0}):$(".FoldOutContainer").css({left:i})};try{var w=JSON.parse(o.getItem(d()));u?(m.topItems=w.topItems,m.topItems.timestamp=w.timestamp,s(m.topItems)):m.topItems=w}catch(v){}c()}angular.module("Wizdom365.Megamenu").directive("wizdom365MegamenuDesktop",["megamenuConfig",e]),t.$inject=["contextInfo","megamenuConfig","megamenuApi","$sce","localStorageService","$element","$timeout"]}(),function(){function e(e,t,n){var i={root:{baseUrl:"api/Wizdom/StructuredContent/v1",getPersonalizedRoot:function(i,o){return e.get(this.baseUrl+"/personal/"+i+"?language="+t.language+"&browserCacheDays=30&megamenuTimestamp="+n.Timestamp+"&noCache="+!!o)}}};return i}angular.module("Wizdom365.Megamenu").factory("megamenuApi",e),e.$inject=["webapiService","contextInfo","megamenuConfig"]}(),function(){angular.module("Wizdom365.Megamenu").factory("megamenuConfig",["configuration",function(e){return getCorrectMegamenuConfig(e)}])}(),function(){function e(e,t,n,i,o,r,a){function l(){r.startdate&&(t.filters.startdate=r.startdate,r.startdate.toString()==t.filters.startdate.toString()&&(t.filters.dateModified=!0)),null==r.startdate&&(t.filters.startdate=null),r.enddate&&(t.filters.enddate=r.enddate,r.enddate.toString()==t.filters.enddate.toString()&&(t.filters.dateModified=!0)),null==r.enddate&&(t.filters.enddate=null),r.authors.length&&(t.filters.authors=r.authors),n.views.getMyChannelsSelection(t.viewId).then(function(e){t.channelList=e,0!=t.channelList.length?(r.channels.length&&(t.filters.channels=r.channels),t.mode="loadComplete"):t.mode="nodata"})}function s(e,i){return!t.filters.peopleSearch||t.filters.peopleSearch.length<1?[]:(i=i||!1,n.principals.searchForPrincipalAuthors(e,i).then(function(e){return e}))}function c(e){t.filters.peopleSearch="",0==t.filters.authors.length?t.filters.authors.push(e):t.filters.authors[0]=e}function d(e){t.filters.authors=[]}function u(){i.close(t.filters)}t.viewId=o,t.mode="loading",t.channelList=[],t.filters={channels:[],authors:[],startdate:new Date((new Date).setDate((new Date).getDate()-7)),enddate:new Date,dateModified:!1},t.initialize=l,t.cancel=u,t.searchForPrincipal=s,t.addPrincipal=c,t.removePrincipal=d,t.enddateMinDate=t.filters.startdate,t.$watch("filters.startdate",function(n,i){n&&i&&n.toString()==i.toString()||(n?(t.enddateMinDate=t.filters.startdate,n&&t.filters.enddate&&n.getTime()>t.filters.enddate.getTime()&&(a.showErrorMessage(e("translate")("The start-date can not be greater than the end-date.")),t.filters.enddate=t.enddateMinDate)):t.enddateMinDate="0001-01-01",t.filters.dateModified=!0)}),t.$watch("filters.enddate",function(n,i){n&&i&&n.toString()==i.toString()||(n&&t.filters.startdate&&n.getTime()<t.filters.startdate.getTime()&&(a.showErrorMessage(e("translate")("The end-date can not be lesser than the start-date.")),t.filters.enddate=t.enddateMinDate),t.filters.dateModified=!0)}),l()}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardArchiveFilterController",e),e.$inject=["$filter","$scope","noticeboardApi","$modalInstance","webpartId","filters","notificationService"]}(),function(){function e(e,t,n,i,o,r,a){function l(){var e=_.map(t.selectedchannels,function(e){return e.id});o.views.updateMyChannelSelection(t.viewId,e).then(function(){n.close(e)})}function s(){n.dismiss("cancel")}function c(){o.views.getMyChannelsSelection(t.viewId).then(function(e){if(t.loading=!1,t.availableChannels=e,t.availableChannels.length>0){var n=d(t.availableChannels,t.channelsTree);n<=r.noticboard.channelMax&&f(t.channelsTree,!0)}})}function d(e,n){var i=0;return _.forEach(_.filter(e,function(e){return e.canContainItems||e.childs.length>0}),function(e){var o={name:e.name,id:e.id,enabled:e.canContainItems,visible:!1,childs:[],childrenVisible:!1,folderClass:"ms-Icon ms-Icon--ChevronRightMed",expandAll:!1,item:e};i+=1+d(e.childs,o.childs),o.visible=o.enabled||o.childs.length>0,o.folderClass=o.childs.length>0?o.folderClass:null,(e.isMandatoryForCurrentUser||e.isSuggestedForCurrentUser||e.isPersonalSelectedForCurrentUser)&&t.selectedchannels.push(e),o.visible&&n.push(o),o.enabled||t.toggleChildren(o)}),i}function u(e){m(e,!e.childrenVisible)}function m(e,t){null!=e.folderClass&&(e.childrenVisible=t,e.folderClass=t?"ms-Icon ms-Icon--ChevronDown":"ms-Icon ms-Icon--ChevronRightMed")}function p(e,n){null==n&&(n=!e.expandAll),e.expandAll=n,e.enabled&&!e.item.isMandatoryForCurrentUser&&e.item.isPersonalSelectedForCurrentUser!=n&&(e.item.isPersonalSelectedForCurrentUser=n,t.updateSelectedChannel(e)),m(e,!0),_.forEach(e.childs,function(e){t.selectParentChannel(e,n)})}function g(e){!e.enabled&&e.childs.length>0?m(e,!e.childrenVisible):e.enabled&&!e.item.isMandatoryForCurrentUser&&(e.item.isPersonalSelectedForCurrentUser=!e.item.isPersonalSelectedForCurrentUser,t.updateSelectedChannel(e))}function f(e,t){_.forEach(e,function(e){m(e,t),f(e.childs,t)})}function h(e){e.item.isPersonalSelectedForCurrentUser&&e.item.isSuggestedForCurrentUser&&(e.item.isSuggestedForCurrentUser=e.item.isPersonalSelectedForCurrentUser=!1),e.item.isPersonalSelectedForCurrentUser?t.selectedchannels.push(e.item):_.remove(t.selectedchannels,function(t){return t.id==e.item.id})}t.viewId=a,t.loading=!0,t.availableChannels=[],t.channelsTree=[],t.selectedchannels=[],t.save=l,t.cancel=s,t.initialize=c,t.toggleChildren=u,t.selectParentChannel=p,t.selectChannel=g,t.updateSelectedChannel=h,c()}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardChooseChannelsController",e),e.$inject=["$filter","$scope","$modalInstance","$timeout","noticeboardApi","valueService","viewId"]}(),function(){function e(e,t,n,i,o,r,a){function l(){null!=i&&(r("comments overview initialization"),_.forEach(i,function(e){t.itemList.push(p(e))}),t.itemList=_(_.sortBy(t.itemList,function(e){return new Date(e.displayDate)})).reverse().value(),s())}function s(){0==t.itemList.length?t.mode="nodata":t.mode="dataLoaded"}function c(){o.close()}function d(){n.social.dismissComments(_.map(t.itemList,function(e){return e.id}).join()).then(function(){a.unreadComments.remove(t.itemList),t.itemList=[],s(),c()})}function u(e){n.social.dismissComments(e.id).then(function(){a.unreadComments.remove(e),_.remove(t.itemList,function(t){return t.id==e.id}),s()})}function m(e){o.close(e)}function p(e){return{id:e.id,heading:e.heading,comments:e.comments,displayText:g(e),displayDate:null!=e.comments[0].datePosted?e.comments[0].datePosted:e.comments[0].datePosted,displayUser:e.comments[0].author}}function g(t){return 1==t.comments.length?e("translate")("commented on"):2==t.comments.length?e("translate")("and {0} commented on",t.comments[1].author.displayName):t.comments.length>2?e("translate")("and {0} others commented on",t.comments.length-1):""}t.mode="loading",t.itemList=[],t.countUnreadComments=0,t.initialize=l,t.updateData=s,t.cancel=c,t.dismissAll=d,t.dismiss=u,t.openItem=m,t.prepareItem=p,t.prepareText=g,l()}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardCommentsOverviewController",e),e.$inject=["$filter","$scope","noticeboardApi","unreadComments","$modalInstance","log","socialNotificationService"]}(),function(){function e(e,t,n,i,o,r,a,l){function s(){n.views.getAllAvailableChannelsWithContentTypes(i).then(function(e){t.channelscache=e.channels;var n;for(n=0;n<e.contenttypes.length;n++)e.contenttypes[n].id<=4&&(null==e.contenttypes[n].metaData.isVisible||1==e.contenttypes[n].metaData.isVisible)&&t.contenttypescache.push(e.contenttypes[n]);null!=o?(c(),t.mode="firstScene"):1!=t.contenttypescache.length||1!=t.channelscache.length||t.channelscache[0].childs&&0!=t.channelscache[0].childs.length?0!=t.contenttypescache.length&&0!=t.channelscache.length?(m(t.contenttypescache[0]),t.mode="firstScene"):t.mode="nodata":(m(t.contenttypescache[0]),t.selectItem(t.channelscache[0]),t.showHideChannels(),t.next())})}t.mode="loading",t.webpartId=i,t.editItem=null,t.channelsTree=[],t.channelscache=[],t.contenttypescache=[],t.selectedchannels=[],t.selectedcontenttype,t.templateUrl=null,t.showAllChannels=!1,t.showAllChannelsText=e("translate")("Show all"),t.channelOverview="",t.isActiveContentType=function(e){return!!t.selectedcontenttype&&t.selectedcontenttype.name==e.name};var c=function(){n.views.getItem(i,o).then(function(e){t.editItem=e.newsItem,t.editItem.startDate.indexOf("Z")<0&&(t.editItem.startDate=t.editItem.startDate+"Z"),t.editItem.endDate.indexOf("Z")<0&&(t.editItem.endDate=t.editItem.endDate+"Z"),t.editItem.startDate=new Date(t.editItem.startDate),t.editItem.endDate=new Date(t.editItem.endDate);var n=_.find(t.contenttypescache,function(e){return e.id==t.editItem.contentType.id});n||(n=t.editItem.contentType,t.contenttypescache.push(n)),m(n),_.forEach(t.editItem.channels,function(e){t.selectedchannels.push(e.id)}),t.showHideChannels(),g(t.channelsTree,!0)})},d=function(e,n){return e.isExternal?!1:e.canContainItems&&e.writeAccessForCurrentUser&&(t.showAllChannels||e.isMandatoryForCurrentUser||e.isPersonalSelectedForCurrentUser||e.isSuggestedForCurrentUser)?e.contentTypes.some(function(e){return e.id===n.id}):!1},u=function(e,n){0!=e.length&&_.forEach(e,function(e){var i={name:e.name,id:e.id,enabled:d(e,t.selectedcontenttype),childs:[],childrenVisible:!1,folderClass:"ms-Icon ms-Icon--ChevronRightMed",expandAll:!1};(i.enabled||0!=e.childs.length)&&(u(e.childs,i.childs),(i.enabled||i.childs.length>0)&&n.push(i),i.enabled||t.toggleChildren(i),0==i.childs.length&&(i.folderClass=null))})},m=function(e){t.selectedcontenttype=e,t.channelsTree=[],u(t.channelscache,t.channelsTree)};t.changeSelectedContentType=function(e){e!=t.selectedcontenttype&&(t.selectedchannels=[],m(e))},t.next=function(){switch(t.selectedcontenttype.name.toLowerCase()){case"news":t.templateUrl=r.news||"Noticeboard/Templates/ViewTemplates/Webpart/NewEditForm/CreateAndEdit.html";break;case"video":t.templateUrl=r.video||"Noticeboard/Templates/ViewTemplates/Webpart/NewEditForm/CreateAndEdit.html";break;default:t.templateUrl=r.news||"Noticeboard/Templates/ViewTemplates/Webpart/NewEditForm/CreateAndEdit.html"}t.mode="secondScene"},t.back=function(){t.mode="firstScene"},t.save=function(){t.$broadcast("saveNews")},t.cancel=function(){a.close()},t.deleteNewsItem=function(i){l.showConfirmationDialog({text:e("translate")("Are you sure you want to delete this item")+"?",type:"confirmation",layout:"center",successCalback:function(){n.items.deleteItem(i).then(function(){t.cancel()})},errorCalback:function(){}})},t.showHideChannels=function(){t.showAllChannels=!t.showAllChannels,t.showAllChannelsText=t.showAllChannels?e("translate")("Show suggested"):e("translate")("Show all"),m(t.selectedcontenttype),g(t.channelsTree,!0)},t.toggleChildren=function(e){p(e,!e.childrenVisible)},t.selectItem=function(e){if(!e.enabled&&e.childs.length>0)p(e,!e.childrenVisible);else{var n=t.selectedchannels.indexOf(e.id);n>-1?t.selectedchannels.splice(n,1):t.selectedchannels.push(e.id)}};var p=function(e,t){null!=e.folderClass&&(e.childrenVisible=t,e.folderClass=t?"ms-Icon ms-Icon--ChevronDown":"ms-Icon ms-Icon--ChevronRightMed")};t.selectParentChannel=function(e,n){var i=t.selectedchannels.indexOf(e.id);null==n&&(n=!e.expandAll),e.expandAll=n,i>-1&&t.selectedchannels.splice(i,1),n&&e.enabled&&t.selectedchannels.push(e.id),p(e,!0),_.forEach(e.childs,function(e){t.selectParentChannel(e,n)})};var g=function(e,t){_.forEach(e,function(e){p(e,t),g(e.childs,t)})};t.$on("closeDialog",function(e){t.cancel()}),s()}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardCreateItemController",e),e.$inject=["$filter","$scope","noticeboardApi","webpartId","itemId","template","$modalInstance","notificationService"]}(),function(){function e(e,t,n){function i(){function t(n){_.chain(n).forEach(function(n){e.limitedVisibility=e.limitedVisibility||n.isVisibleInCurrentView,t(n.childs)}).value()}function n(t){var i=!e.limitedVisibility;return _.chain(t).forEach(function(t){t.childIsVisible=n(t.childs),t.isVisibleInContext=!1,e.limitedVisibility&&(t.isVisibleInContext=t.isVisibleInCurrentView||t.mandatoryPrincipals.length>0||t.suggestedPrincipals.length>0),i=i||t.isVisibleInCurrentView||t.childIsVisible}).value(),i}e.limitedVisibility=!1,t(e.channels),n(e.channels)}function o(){e.$parent.viewId?t.views.getAllChannelSelections(e.$parent.viewId).then(function(t){e.channels=t,i()}):t.channelsets.getAllChannelSelections(e.view.channelSetId).then(function(t){e.channels=t,i()})}function r(e,t){return _.find(e,function(e){return 1==t.type?e.loginName==t.loginName:2==t.type?e.groupId==t.groupId:void 0})}e.selectedChannel=null,e.selectedChannelIsVisible=!1,e.limitedVisibility=!1,e.channels=[],e.setChannelVisibility=function(){e.selectedChannel.isVisibleInCurrentView=e.selectedChannel.selectedChannelIsVisible?!0:null,e.selectedChannel.isVisibleInCurrentView?t.channelsets.setChannelVisibility(e.view.channelSetId,e.selectedChannel.id).then(i):t.channelsets.removeChannelVisibility(e.view.channelSetId,e.selectedChannel.id).then(i)},e.selectChannel=function(t){e.selectedChannel=t,e.selectedChannel.selectedChannelIsVisible=e.selectedChannel.isVisibleInCurrentView?!0:!1,e.selectedChannel.mandatoryFor=0==e.selectedChannel.mandatoryPrincipals.length?"none":_.find(e.selectedChannel.mandatoryPrincipals,function(e){return"Everybody"==e.loginName})?"everybody":"selected",e.selectedChannel.suggestedFor=0==e.selectedChannel.suggestedPrincipals.length?"none":_.find(e.selectedChannel.suggestedPrincipals,function(e){return"Everybody"==e.loginName})?"everybody":"selected"},e.changeSuggestedFor=function(){if("none"==e.selectedChannel.suggestedFor&&e.selectedChannel.suggestedPrincipals.length>0&&(t.channelsets.removeAllSuggestedPrincipals(e.view.channelSetId,e.selectedChannel.id),e.selectedChannel.suggestedPrincipals=[],i()),"everybody"==e.selectedChannel.suggestedFor){var n={displayName:"Everybody",loginName:"Everybody",type:"1"};t.channelsets.addSuggestedPrincipal(e.view.channelSetId,e.selectedChannel.id,n).then(function(t){e.selectedChannel.suggestedPrincipals.push(t),i()})}if("selected"==e.selectedChannel.suggestedFor){var o=_.find(e.selectedChannel.suggestedPrincipals,function(e){return"Everybody"==e.loginName});"undefined"!=typeof o&&null!=o&&t.channelsets.removeSuggestedPrincipal(e.view.channelSetId,e.selectedChannel.id,o.principalID).then(function(t){e.selectedChannel.suggestedPrincipals=_.without(e.selectedChannel.suggestedPrincipals,o),i()})}},e.changeMandatoryFor=function(){if("none"==e.selectedChannel.mandatoryFor&&e.selectedChannel.mandatoryPrincipals.length>0&&(t.channelsets.removeAllMandatoryPrincipals(e.view.channelSetId,e.selectedChannel.id),e.selectedChannel.mandatoryPrincipals=[],i()),"everybody"==e.selectedChannel.mandatoryFor){var n={displayName:"Everybody",loginName:"Everybody",type:"1"};t.channelsets.addMandatoryPrincipal(e.view.channelSetId,e.selectedChannel.id,n).then(function(t){e.selectedChannel.mandatoryPrincipals.push(t),i()})}if("selected"==e.selectedChannel.mandatoryFor){var o=_.find(e.selectedChannel.mandatoryPrincipals,function(e){return"Everybody"==e.loginName});"undefined"!=typeof o&&null!=o&&t.channelsets.removeMandatoryPrincipal(e.view.channelSetId,e.selectedChannel.id,o.principalID).then(function(t){e.selectedChannel.mandatoryPrincipals=_.without(e.selectedChannel.mandatoryPrincipals,o),i()})}},e.addMandatoryPrincipal=function(n){r(e.selectedChannel.mandatoryPrincipals,n)||t.channelsets.addMandatoryPrincipal(e.view.channelSetId,e.selectedChannel.id,n).then(function(t){e.selectedChannel.mandatoryPrincipals.push(t),e.mandatoryPrincipalSearchTerm="",i()})},e.addSuggestedPrincipal=function(n){r(e.selectedChannel.suggestedPrincipals,n)||t.channelsets.addSuggestedPrincipal(e.view.channelSetId,e.selectedChannel.id,n).then(function(t){e.selectedChannel.suggestedPrincipals.push(t),e.suggestedPrincipalSearchTerm="",i()})},e.removeMandatory=function(n){t.channelsets.removeMandatoryPrincipal(e.view.channelSetId,e.selectedChannel.id,n.principalID).then(function(t){e.selectedChannel.mandatoryPrincipals=_.without(e.selectedChannel.mandatoryPrincipals,n),i()})},e.removeSuggested=function(n){t.channelsets.removeSuggestedPrincipal(e.view.channelSetId,e.selectedChannel.id,n.principalID).then(function(t){e.selectedChannel.suggestedPrincipals=_.without(e.selectedChannel.suggestedPrincipals,n),i()})},e.searchForPrincipal=function(e,n){return!e||e.length<2?[]:(n=n||!1,t.principals.searchForPrincipal(e,n).then(function(e){return e}))};var a=function(){o()};a()}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardEditChannelSetController",e),e.$inject=["$scope","noticeboardApi","$timeout"]}(),function(){function e(e,t){e.saveView=function(){t.views.updateView(e.view)}}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardEditViewPropertiesController",e),e.$inject=["$scope","noticeboardApi"]}(),function(){function e(){return{scope:{channelList:"=channelList",selectedChannels:"=selectedChannels"},template:'<div ng-show="channelsTree.length > 0"><ul style="list-style:none;padding-left:0;"><li style="padding-left:18px;cursor:pointer;"><input id="selectAll" type="checkbox" ng-model="selectAll" ng-change="toggleAll();"> <label for="selectAll" style="margin-bottom:0;">{{\'Select all\' | translate}}</label></li><li ng-repeat="channel in channelsTree" wizdom-include="::\'channelTree\'"></li></ul></div><script type="text/ng-template" id="channelTree"><div style="margin-bottom:5px;" class="channelItem"> <span class="pointer" ng-class="channel.folderClass" ng-click="toggleChildren(channel)"></span> <span class="channelItem-common"> <span class="ms-Icon ms-Icon--FolderHorizontal" ng-show="!channel.enabled && channel.childs.length > 0" ng-click="toggleChildren(channel)"></span> <input type="checkbox" checklist-model="selectedChannels" checklist-value="channel.source" ng-show="channel.enabled" ng-disabled="!channel.enabled" style="vertical-align:top;" /> <span ng-click="selectItem(channel);" style="cursor:pointer">{{channel.name}}</span> <a style="cursor:pointer" ng-show="channel.childs.length > 0" ng-click="selectParentChannel(channel, null)">{{(channel.expandAll ? \'None\' : \'All\') | translate}}</a> </span> </div> <ul ng-if="channel.childs && channel.childrenVisible" style="list-style:none;padding-left:32px;"> <li ng-repeat="channel in channel.childs" wizdom-include="\'channelTree\'"></li> </ul></script>',controller:t}}function t(e,t,n){function i(){"undefined"!=typeof e.channelList&&null!=e.channelList&&o()}function o(){p=0,e.channelsTree=[],a(e.channelList,e.channelsTree),p<=n.noticboard.channelMax&&m(e.channelsTree,!0)}function r(t){return t.canContainItems&&(e.showAllChannels||t.isMandatoryForCurrentUser||t.isPersonalSelectedForCurrentUser||t.isSuggestedForCurrentUser)?!0:!1}function a(t,n){0!=t.length&&_.forEach(t,function(t){var i={name:t.name,id:t.id,enabled:r(t),childs:[],childrenVisible:!1,folderClass:"ms-Icon ms-Icon--ChevronDown",expandAll:!1,source:t};(i.enabled||0!=t.childs.length)&&(p++,a(t.childs,i.childs),(i.enabled||i.childs.length>0)&&n.push(i),i.enabled||e.toggleChildren(i),0==i.childs.length&&(i.folderClass=null))})}function l(){e.showAllChannels=!e.showAllChannels,e.showAllChannelsText=e.showAllChannels?t("translate")("Hide not actual channels"):t("translate")("Show all channels"),e.selectedChannels=[],o(),m(e.channelsTree,!0)}function s(e){d(e,!e.childrenVisible)}function c(t){if(!t.enabled&&t.childs.length>0)d(t,!t.childrenVisible);else{var n=_.findIndex(e.selectedChannels,function(e){return e.id==t.id});n>-1?e.selectedChannels.splice(n,1):e.selectedChannels.push(t.source)}}function d(e,t){null!=e.folderClass&&(e.childrenVisible=t,e.folderClass=t?"ms-Icon ms-Icon--ChevronUp":"ms-Icon ms-Icon--ChevronDown")}function u(t,n){var i=_.findIndex(e.selectedChannels,function(e){return e.id==t.id});null==n&&(n=!t.expandAll),t.expandAll=n,i>-1&&e.selectedChannels.splice(i,1),n&&t.enabled&&e.selectedChannels.push(t.source),d(t,!0),_.forEach(t.childs,function(t){e.selectParentChannel(t,n)})}function m(e,t){_.forEach(e,function(e){d(e,t),m(e.childs,t)})}var p=0;e.channelsTree=[],e.showAllChannels=!0,e.initialize=i,e.loadTree=o,e.showHideChannels=l,e.toggleChildren=s,e.selectParentChannel=u,e.selectItem=c,e.$watch("channelList",function(e,t){e!==t&&i()},!0),e.toggleAll=function(){var t=e.selectedChannels.length;e.selectedChannels.splice(0,t),_.forEach(e.channelsTree,function(t){e.selectAll&&c(t),t.childs.length>0&&u(t,e.selectAll)})},i()}angular.module("Wizdom365.Noticeboard").directive("wizdom365NoticeboardChannelTree",e),t.$inject=["$scope","$filter","valueService"]}(),function(){function e(e,n,i){return{scope:{webpartId:"=?"},template:'<div class="bootstrap-wrapper" ng-class="responsiveClass">\n                         <div class="wd-noticeboard">\n                          <a id="{{::webpartId}}"></a>  \n                          <div class="editmode-button" ng-if="::editMode">\n                                    <div class="webpart-edit-button-container">\n                                        <button class="editWebpartButton btn" ng-click="editWebpart()" type="button" title="{{\'Edit Webpart\' | translate}}">\n                                            <span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{\'Edit\' | translate}}</span>\n                                        </button>\n                                    </div>\n                          </div>\n                          <div ng-if="needToConfigureWebpart">{{\'Please configure the web part\' | translate}}</div>\n                          <div wizdom-include="::view.extendedProperties.overviewTemplate"></div>\n                         </div>\n                        </div>',controller:t}}function t(e,t,n,i,o,r,a,l,s,c,d,u,m,p,g,f,h){function w(){t.editMode=o.isInEditMode(n),t.webpartId=t.webpartId||o.getWebpartId(n),t.webpartProperties=i.webpartProperties?JSON.parse(i.webpartProperties):{},o.hideEditCode(n)}function v(){t.editMode&&null==t.webpartProperties.channelSetId&&a.views.getViewById(t.webpartId).then(function(e){e&&(e.editableByCurrentUser=null,o.setProperties(t.webpartId,e))})}function b(e){null!=e&&"number"==typeof e&&t.editNewsItem(e)}function C(e){t.selection=e,t.unreadActionTooltip="Unread"==e?" ("+h("translate")("click to show all elements")+")":" ("+h("translate")("click to show unread elements only")+")","All"===e?t.filters.path="current":"Unread"===e?t.filters.path="current/unread":"Mine"===e&&(t.filters.path="archived/current/future/mine"),t.webpartProperties.extendedProperties&&t.webpartProperties.extendedProperties.itemsPerPage?t.filters.itemsPerPage=t.webpartProperties.extendedProperties.itemsPerPage:l.getItem("nbItemsPerPage"+t.webpartId)&&(t.filters.itemsPerPage=l.getItem("nbItemsPerPage"+t.webpartId)),t.filters.path+="?$take="+t.filters.itemsPerPage,t.filters.path+="&$skip="+t.currentPage*t.filters.itemsPerPage;var n=a.views.getItems(t.webpartId,t.filters.path).then(function(n){return t.items=n.items?n.items:[],t.items=t.items.filter(function(e){return e.contentType.id<=4}),t.count=n.count,t.count<=t.filters.itemsPerPage&&t.currentPage>0?(t.currentPage=0,void C(e)):(t.restartingTimer=!1,void(t.totalPageableIds=n.pageableIds?n.pageableIds:0))});return P=e,n}function y(){var e=l.getItem("nbSelect"+t.webpartId);null!=e&&C(e),t.webpartProperties.channelSetId?I(t.webpartProperties):a.views.getViewById(t.webpartId).then(function(e){I(e)}),S(),U||(U=!0,g.onResponsizeChange(n,function(e){t.responsiveClass=e,t.$applyAsync();}))}function I(e){t.view=e,t.view||(t.needToConfigureWebpart=!0);var n=l.getItem("nbSelect"+t.webpartId);t.view&&(null==n&&t.view.extendedProperties&&t.view.extendedProperties.defaultSelection&&C(t.view.extendedProperties.defaultSelection),l.setItem("nbItemsPerPage"+t.webpartId,t.view.extendedProperties.itemsPerPage),x()),document.displayNoticeboardNewsIdOnPageLoad||(document.displayNoticeboardNewsIdOnPageLoad=k("newsId"))&&t.ShowItem(document.displayNoticeboardNewsIdOnPageLoad)}function S(){a.notifications.getOverview(t.webpartId).then(function(e){t.channelIds=e.channelIds,t.unreadComments=e.unreadComments||[],t.unreadCommentsCount=t.unreadComments.length,t.unreadNews=e.unreadNews||[],t.unreadNewsCount=t.unreadNews.length})}function k(e){var t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}w(),v(),t.dataReady=!1,t.socialFeatureEnabled=d.Noticeboard?$.parseJSON(d.Noticeboard.SocialFeature.Enabled):!1,t.enableSocialOnOldItems=d.Noticeboard?$.parseJSON(d.Noticeboard.SocialFeature.EnableSocialOnItemByDefault):!1,t.enableSocialOnItemByDefault=d.Noticeboard?$.parseJSON(d.Noticeboard.SocialFeature.EnableSocialOnItemByDefault):!1,t.socialOverviewComments=d.Noticeboard?$.parseJSON(d.Noticeboard.SocialFeature.OverviewComments):!1,t.view=null,t.needToConfigureWebpart=!1,t.items=[],t.count=0,t.currentPage=0,t.unreadNews=[],t.unreadNewsCount=0,t.unreadComments=[],t.unreadCommentsCount=0,t.listenerExist=!1,t.autoUpdatesRunning=!0,t.restartingTimer=!1,t.channelIds=[],t.filters={path:"",itemsPerPage:5},t.$on("NoticeboardNewsItemRead",function(e,n){var i=_.find(t.items,function(e){return e.id===n.id});i&&(i.isRead=!0),"Unread"==t.selection&&C(t.selection),_.remove(t.unreadNews,function(e){return e.id===n.id}),t.unreadNewsCount=t.unreadNews.length}),t.$on("NoticeboardNewsItemUnread",function(e,n){var i=_.find(t.items,function(e){return e.id===n.id});i&&(i.isRead=!1);var o=[];_.forEach(n.channels,function(e){return o.push(e.id)});var r=_.intersection(o,t.channelIds);if(r.length>0){if("Unread"==t.selection){t.items.push(n);var a=_.sortBy(t.items,function(e){return e.startDate}).reverse();t.items=a}t.unreadNews.push(n),t.unreadNewsCount=t.unreadNews.length}}),t.$on("NoticeboardNewsAllRead",function(){_.forEach(t.items,function(e){e.isRead=!0,_.remove(t.unreadNews,function(t){return t.id===e.id})}),t.unreadNewsCount=t.unreadNews.length}),t.$on("NoticeboardNewsItemCreated",function(e,t){y()}),t.$on("NoticeboardNewsItemEdited",function(e,t){y()}),t.$on("NoticeboardCommentRead",function(e,n){_.remove(t.unreadComments,function(e){return e.id===n.id}),t.unreadCommentsCount=t.unreadComments.length}),t.editWebpart=function(){u.open({templateUrl:"Noticeboard/Templates/Dialogs/EditWebpart.html",controller:"Wizdom365NoticeboardEditWebpartController",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return t.webpartId}}}).result.then(function(e){a.views.getViewById(t.webpartId).then(function(e){t.view=e,e.editableByCurrentUser=null,o.setProperties(t.webpartId,e),y()})})},t.ShowItem=function(e){u.open({templateUrl:t.view.extendedProperties.showItemTemplate,controller:"Wizdom365NoticeboardShowNewsController",windowClass:"bootstrap-wrapper",size:"lg",resolve:{webpartId:function(){return t.webpartId},item:function(){var n=_.find(t.items,{id:e});if(n)return n;var i=f.defer();return a.views.getItem(t.webpartId,e).then(function(e){e.status?i.resolve(e.newsItem):i.reject()}),i.promise},pageableIds:function(){return t.totalPageableIds||(t.totalPageableIds=[]),t.totalPageableIds.length<1&&_.each(t.unreadComments,function(e){t.totalPageableIds.push(e.id)}),t.totalPageableIds},itemInfo:function(){return{itemId:e,shouldNotMarkRead:!0}}}}).result.then(b,b)},t.changeDisplayMode=function(e){t.currentPage=0,t.count=0,l.setItem("nbSelect"+t.webpartId,e),C(e),t.showSettings=!1},t.toggleDisplayMode=function(){t.currentPage=0,t.count=0,C("Unread"==t.selection?"All":"Unread")},t.filter=function(e){return"Unread"==t.selection?!e.isRead:!0},t.changeReadStatus=function(n){var i=!n.isRead,o=(new Date).toJSON();i?a.items.markRead(n.id).then(function(){o>n.endDate||o<n.startDate?t.$broadcast("NoticeboardNewsItemRead",n):e.$broadcast("NoticeboardNewsItemRead",n)}):a.items.markUnread(n.id).then(function(){o>n.endDate||o<n.startDate?t.$broadcast("NoticeboardNewsItemUnread",n):e.$broadcast("NoticeboardNewsItemUnread",n)})},t.changeReadStatusForAll=function(){a.items.markAllRead(_.map(t.unreadNews,function(e){return e.id})).then(function(){_.forEach(t.unreadNews,function(t){a.items.markRead(t.id).then(function(){e.$broadcast("NoticeboardNewsItemRead",t)})})})},t.selectPersonalChannels=function(){u.open({templateUrl:"Noticeboard/Templates/Dialogs/ChooseChannels.html",controller:"Wizdom365NoticeboardChooseChannelsController",windowClass:"bootstrap-wrapper",resolve:{viewId:function(){return t.webpartId}}}).result.then(function(e){y()})},t.setPage=function(e){t.currentPage=e,C(t.selection)};var P="",x=function(){t.archiveLink="",t.view.extendedProperties.archiveUrl&&""!==t.view.extendedProperties.archiveUrl?t.archiveLink=t.view.extendedProperties.archiveUrl:t.archiveLink=d.Noticeboard.ArchiveUrl};t.goToArchive=function(){c.location.href=t.archiveLink};var T,U=!1;t.startAutoUpdateTimer=function(){y(),t.autoUpdatesRunning=!0,T&&s.cancel(T);var e=5;T=s(function(){t.autoUpdatesRunning=e>0,t.autoUpdatesRunning&&y(),e--},6e5)},t.startAutoUpdateTimer(),t.reStartAutoUpdateTimer=function(){t.restartingTimer=!0,t.startAutoUpdateTimer()},t.$on("$destroy",function(e){s.cancel(T)}),t.createNews=function(){u.open({templateUrl:"Noticeboard/Templates/Dialogs/CreateItem.html",controller:"Wizdom365NoticeboardCreateItemController",windowClass:"bootstrap-wrapper noticeboard-newform-modal",size:"lg",resolve:{webpartId:function(){return t.webpartId},itemId:function(){return null},template:function(){return{news:t.view.extendedProperties.createEditNewsTemplate,video:t.view.extendedProperties.createEditVideoTemplate}}}}).result.then(function(t){e.$broadcast("NoticeboardNewsItemCreated",t)})},t.editNewsItem=function(n){u.open({templateUrl:"Noticeboard/Templates/Dialogs/CreateItem.html",controller:"Wizdom365NoticeboardCreateItemController",windowClass:"bootstrap-wrapper noticeboard-editform-modal",size:"lg",resolve:{webpartId:function(){return t.webpartId},itemId:function(){return n},template:function(){return{news:t.view.extendedProperties.createEditNewsTemplate,video:t.view.extendedProperties.createEditVideoTemplate}}}}).result.then(function(t){e.$broadcast("NoticeboardNewsItemEdited",t)})},t.showUnreadComments=function(){u.open({template:'<div class="bootstrap-wrapper wt-noticeboard-unread-comments"><div class="modal-header"><button type="button" class="close closebtn" data-dismiss="modal" data-ng-click="cancel()" aria-hidden="true">&times;</button><h1 class="modal-title"><span class="wizdom-icon icon-bubble-2">&nbsp;{{\'Unread comments\' | translate}}</span></h1></div><div class="modal-body"><div ng-show="mode == \'loading\'" class="container-fluid"><div class="row"><div class="col-sm-12">{{\'loading\' | translate}}</div></div></div><div ng-show="mode == \'nodata\'"><div class="alert alert-warning" role="alert">{{\'No new comments.\' | translate}}</div></div><div ng-show="mode == \'dataLoaded\'"><button type="button" class="btn btn-primary pull-right" ng-click="dismissAll();">{{\'Dismiss all\' | translate}}</button><div class="wizdom-unreadComment-topSpace"></div><hr class="wizdom-unreadComment-horisontalDevider"><span ng-repeat="item in itemList" wizdom-include="::\'commentsSummary\'"></span><div class="wizdom-unreadComment-bottomSpace"></div><script type="text/ng-template" id="commentsSummary"><div class="wizdom-unreadComment-table"> <div class="wizdom-unreadComment-imgColumn"> <div style="display:inline-block" class="presence" wizdom365-presence-picture="" size="AVATAR" accountname="::item.displayUser.loginName" name="::item.displayUser.displayName"></div> </div> <div class="wizdom-unreadComment-txtColumn"> <span style="display:inline-block; top: 0;" class="presence" wizdom365-presence-picture="" type="defaultrender" size="EXTRASMALL" accountname="::item.displayUser.loginName" name="::item.displayUser.displayName"> </span> {{::item.displayText}} <span class="media-heading wd-noticeboard-media-heading anchored" ng-click="openItem(item.id);">{{::item.heading}}</span> <br /> <span class="wt-commentDate" am-time-ago="(item.displayDate | wizdom365FormatDate)"></span> </div> <div class="wizdom-unreadComment-iconColumn"> <label ng-click="dismiss(item);"><span class="glyphicon glyphicon-remove"></span> <a href="">{{\'Dismiss\' | translate}}</a></label> </div> </div> <hr class="wizdom-unreadComment-horisontalDevider" /></script></div></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="cancel();">{{\'Back to news view\' | translate}}</button></div></div>',controller:"Wizdom365NoticeboardCommentsOverviewController",windowClass:"bootstrap-wrapper",size:"lg",resolve:{unreadComments:function(){return t.unreadComments}}}).result.then(function(e){"undefined"!=typeof e&&null!=e?t.ShowItem(e):S()})},t.checkForLongLinkText=function(e){return h("checkForLongLinkText")(e)},t.checkForLongLinkTextV2=function(e,t,n){return h("checkForLongLinkTextV2")(e,t,n)},t.showPicture=function(e){u.open({templateUrl:"Wizdom365/Templates/Dialogs/Image.html",controller:"Wizdom365ShowImageController",windowClass:"bootstrap-wrapper",size:"lg",resolve:{imgUrl:function(){return e}}}).result.then()}}angular.module("Wizdom365.Noticeboard").directive("wizdom365Noticeboard",e),e.$inject=["$window","log","$filter"],t.$inject=["$rootScope","$scope","$element","$attrs","webpartPropertiesService","contextInfo","noticeboardApi","localStorageService","$interval","$window","configuration","$modal","log","socialNotificationService","responsive","$q","$filter"]}(),function(){function e(){function e(e,t,n){}return{scope:{},template:'<div class="bootstrap-wrapper">\n                         <div class="noticeboard-archive">\n                          <a id="{{::webpartId}}"></a>  \n                          <div class="editmode-button" ng-if="::editMode">\n                                    <div class="webpart-edit-button-container">\n                                        <button class="editWebpartButton btn" ng-click="editWebpart()" type="button" title="{{\'Edit Webpart\' | translate}}">\n                                            <span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{\'Edit\' | translate}}</span>\n                                        </button>\n                                    </div>\n                          </div>\n                          <div ng-if="needToConfigureWebpart">{{\'Please configure the web part\' | translate}}</div>\n                          <div wizdom-include="::view.extendedProperties.overviewTemplate"></div>\n                          <div wizdom365-spinner="" loading="loading"></div>\n                         </div>\n                        </div>',link:e,controller:t}}function t(e,t,n,i,o,r,a,l,s,c,d,u,m){function p(e){null!=e&&"number"==typeof e&&t.editNewsItem(e)}function g(e){try{var t=e.replace(/[\/\[\]\%*&]/gi," ");return""!==t?t:"empty"}catch(n){return"empty"}}function f(){t.dataReady=!1,a.views.getViewById(t.webpartId).then(function(e){t.view=e,t.view||(t.needToConfigureWebpart=!0),t.view&&(t.numPerPage=t.view.extendedProperties.itemsPerPage,t.maxnumPages=t.view.extendedProperties.maxNumberOfPages,t.dataReady=!0,(t.channelFilter.length>0||t.personFilter.length>0||t.dateFilter||t.searchObj.text&&""!==t.searchObj.text)&&t.search()),document.displayNoticeboardNewsIdOnPageLoad||(document.displayNoticeboardNewsIdOnPageLoad=h("newsId"))&&t.ShowItem(document.displayNoticeboardNewsIdOnPageLoad)})}function h(e){var t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}t.webpartId=o.getWebpartId(n),t.webpartProperties=i.webpartProperties?JSON.parse(i.webpartProperties):{},o.hideEditCode(n),t.editMode=o.isInEditMode(n),u.k?t.searchObj={text:decodeURIComponent(u.k)}:t.searchObj={text:""},t.dataReady=!1,t.searchReady=!1,t.data=[],t.searchedAtleastOnce=!1,t.channelFilter=[],t.personFilter=[],t.startdateFilter="",t.enddateFilter="",t.dateFilter=!1,t.socialFeatureEnabled=c.Noticeboard?$.parseJSON(c.Noticeboard.SocialFeature.Enabled):!1,t.enableSocialOnOldItems=c.Noticeboard?$.parseJSON(c.Noticeboard.SocialFeature.EnableSocialOnItemByDefault):!1,t.enableSocialOnItemByDefault=c.Noticeboard?$.parseJSON(c.Noticeboard.SocialFeature.EnableSocialOnItemByDefault):!1,t.socialOverviewComments=c.Noticeboard?$.parseJSON(c.Noticeboard.SocialFeature.OverviewComments):!1,t.view=null,t.needToConfigureWebpart=!1,t.loading=!1,t.listenerExist=!1,t.$on("NoticeboardNewsItemRead",function(e,n){var i=_.find(t.data,function(e){return e.id===n.id});i&&(i.isRead=!0)}),t.$on("NoticeboardNewsItemUnread",function(e,n){var i=_.find(t.data,function(e){return e.id===n.id});i&&(i.isRead=!1)}),t.editWebpart=function(){s.open({templateUrl:"Noticeboard/Templates/Dialogs/EditWebpartArchive.html",controller:"Wizdom365NoticeboardEditWebpartArchiveController",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return t.webpartId}}}).result.then(function(e){f()})},t.ShowItem=function(e){s.open({templateUrl:t.view.extendedProperties.showItemTemplate,controller:"Wizdom365NoticeboardShowNewsController",windowClass:"bootstrap-wrapper",size:"lg",resolve:{webpartId:function(){return t.webpartId},item:function(){var n=_.find(t.items,{id:e});if(n)return n;var i=m.defer();return a.views.getItem(t.webpartId,e).then(function(e){i.resolve(e.newsItem)}),i.promise},pageableIds:function(){return t.totalPageableIds||(t.totalPageableIds=[]),t.totalPageableIds.length<1&&_.each(t.unreadComments,function(e){t.totalPageableIds.push(e.id)}),t.totalPageableIds},itemInfo:function(){return{itemId:e,shouldNotMarkRead:!0}}}}).result.then(p,p)},t.editNewsItem=function(e){s.open({templateUrl:"Noticeboard/Templates/Dialogs/CreateItem.html",controller:"Wizdom365NoticeboardCreateItemController",windowClass:"bootstrap-wrapper",size:"lg",resolve:{webpartId:function(){return t.webpartId},itemId:function(){return e},template:function(){return{news:t.view.extendedProperties.createEditNewsTemplate,video:t.view.extendedProperties.createEditVideoTemplate}}}}).result.then(function(e){f()})},t.changeReadStatus=function(n){var i=!n.isRead,o=(new Date).toJSON();i?a.items.markRead(n.id).then(function(){o>n.endDate||o<n.startDate?t.$broadcast("NoticeboardNewsItemRead",n):e.$broadcast("NoticeboardNewsItemRead",n)}):a.items.markUnread(n.id).then(function(){o>n.endDate||o<n.startDate?t.$broadcast("NoticeboardNewsItemUnread",n):e.$broadcast("NoticeboardNewsItemUnread",n)})},t.showFilter=function(){s.open({templateUrl:"Noticeboard/Templates/Dialogs/ArchiveFilter.html",controller:"Wizdom365NoticeboardArchiveFilterController",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return t.webpartId},filters:function(){return{channels:t.channelFilter,authors:t.personFilter,startdate:t.startdateFilter,enddate:t.enddateFilter}}}}).result.then(function(e){e&&((e.channels.length>0||e.authors.length>0)&&(t.channelFilter=e.channels,t.personFilter=e.authors),e.dateModified&&(t.startdateFilter=e.startdate,t.enddateFilter=e.enddate),e.dateModified||0!=e.channels.length||0!=e.authors.length?t.dateFilter=!0:t.dateFilter=!1,t.search())})},t.removeStartDateFilter=function(){t.startdateFilter="",t.search()},t.removeEndDateFilter=function(){t.enddateFilter="",t.search()},t.removePersonFilter=function(){t.personFilter=[],t.search()},t.filterOnPerson=function(e){t.personFilter.push(e),t.search()},t.removeChannelFilterItem=function(e){var n=_.findIndex(t.channelFilter,e);n>-1&&t.channelFilter.splice(n,1),t.search()},t.filterOnChannel=function(e){t.channelFilter.push(e),t.search()},t.search=function(e){void 0===e&&(e=!1),t.loading=!0,t.searchReady=!1,t.totalPages=0;var n={searchTerm:g(t.searchObj.text),viewId:t.webpartId,channels:[],fromDate:"",toDate:"",authorId:null,take:t.numPerPage,skip:null,language:r.language};if(t.channelFilter.length>0){for(var i=[],o=0;o<t.channelFilter.length;o++)i.push(t.channelFilter[o].id);n.channels=i}t.dateFilter&&(null!=t.startdateFilter&&""!=t.startdateFilter&&(n.fromDate=t.startdateFilter.toISOString()),null!=t.enddateFilter&&""!=t.enddateFilter&&(n.toDate=t.enddateFilter.toISOString())),t.personFilter.length>0&&(n.authorId=t.personFilter[0].principalID),e?n.skip=(t.currentPage-1)*t.numPerPage:t.setcurrentPage(0),a.search.searchNewsByFilter(n).then(function(e){t.data=e.searchResult.items,t.totalPages=e.searchResult.count,t.totalPageableIds=e.searchResult.pageableIds,t.searchReady=!0,t.loading=!1,t.searchedAtleastOnce=!0})},t.currentPage=0,t.numPerPage=2,t.numPages=function(){if(t.searchReady){var e=Math.ceil(t.totalPages/t.numPerPage);return t.numberOfPages=t.maxnumPages>e?e:t.maxnumPages}return 0},t.getId=function(e){return e==t.currentPage?"PagingSelf":"PagingLink"},t.setcurrentPage=function(e){t.currentPage=e,0!=e&&t.search(!0)},t.showPicture=function(e){s.open({templateUrl:"Wizdom365/Templates/Dialogs/Image.html",controller:"Wizdom365ShowImageController",windowClass:"bootstrap-wrapper",size:"lg",resolve:{imgUrl:function(){return e}}}).result.then()},f()}angular.module("Wizdom365.Noticeboard").directive("wizdom365NoticeboardArchive",e),e.$inject=[],t.$inject=["$rootScope","$scope","$element","$attrs","webpartPropertiesService","contextInfo","noticeboardApi","$filter","$modal","configuration","socialNotificationService","queryString","$q"]}(),angular.module("Wizdom365").directive("clickListAnimation",function(){function e(e,t,n){e.autoIndex=0,e.currentItemId=0,e.$watch("items",function(){e.autoIndex>e.items.length&&(e.autoIndex=0)});var i=function(){e.stopAnimation()},o=function(){e.startAnimation()},r=angular.element(n);r.on("focus",o),r.on("blur",i),e.showNewsItem=function(t){e.currentItemId=t.id,e.stopAnimation()},e.isFirstLoad=function(t,n){return 0==n&&0==e.currentItemId?(e.autoIndex=n,e.startAnimation(),!0):!1};var a=void 0;e.startAnimation=function(){angular.isDefined(a)||(a=t(function(){e.autoIndex==e.items.length&&(e.autoIndex=0),e.items.length>0&&(e.currentItemId=e.items[e.autoIndex].id,e.autoIndex++)},5e3))},e.stopAnimation=function(){angular.isDefined(a)&&(t.cancel(a),a=void 0)}}return e.$inject=["$scope","$interval","$window"],{controller:e}}),function(){function e(){return function(e,t){e=e||"";var n="";return n=Array(t).join("--")+" "+e}}angular.module("Wizdom365.Noticeboard").filter("wizdom365NoticeboardChannelLevel",e)}(),function(){function e(){return function(e,t){return t=+t,e.slice(t)}}angular.module("Wizdom365.Noticeboard").filter("wizdom365NoticeboardStartFrom",e)}(),function(){function e(e,t,n){function i(e){var t=[];return e?(Object.keys(e).forEach(function(n){null!=e[n]&&(Array.isArray(e[n])?t.push(n+"="+e[n].join(",")):t.push(n+"="+e[n]))}),t.join("&")):""}function o(e){e.start=new Date(e.start),e.end=new Date(e.end),e.comments&&e.comments.data&&e.comments.data.forEach(function(e){e.posted=new Date(e.posted),e.replies&&e.replies.data&&e.replies.data.forEach(function(e){return e.posted=new Date(e.posted)})})}var r={channels:{baseUrl:"api/wizdom/noticeboard/channels",createChannel:function(t){return e.post(this.baseUrl,t)},createExternalChannel:function(t){return e.post(this.baseUrl+"/external",t)},deleteChannel:function(t){return e["delete"](this.baseUrl+"/"+t)},breakInheritance:function(t){return e.post(this.baseUrl+"/"+t+"/breakInheritance/")},canEditOnlyItsOwn:function(t,n){return n?e.post(this.baseUrl+"/"+t+"/caneditonlyitsown/"):e.post(this.baseUrl+"/"+t+"/caneditall/")},getRootChannel:function(){return e.get(this.baseUrl+"/rootchannel")},getExternalChannel:function(t){return e.get(this.baseUrl+"/external/"+t)},getOffice365VideoChannels:function(){return e.get(this.baseUrl+"/office365video")},getChannelsWithRights:function(){return e.get(this.baseUrl+"/WithAllRights")},getChannelsWithoutRights:function(){return e.get(this.baseUrl+"/WithoutRights")},setInheritance:function(t){return e.post(this.baseUrl+"/"+t+"/setInheritance/")},addReadPrincipalToChannel:function(t,n){return e.post(this.baseUrl+"/"+t+"/readPrincipal/",n)},removeReadPrincipalFromChannel:function(t,n){var i=this.baseUrl+"/"+t+"/readPrincipal/";return n&&(i+=n),e["delete"](i)},addWritePrincipalToChannel:function(t,n){return e.post(this.baseUrl+"/"+t+"/writePrincipal/",n)},removeWritePrincipalFromChannel:function(t,n){var i=this.baseUrl+"/"+t+"/writePrincipal/";return n&&(i+=n),e["delete"](i)},validateRssFeed:function(t){return e.post("api/wizdom/noticeboard/v1/channels/validateRssFeed/",t)}},channelsets:{baseUrl:"api/wizdom/noticeboard/channelsets",addMandatoryPrincipal:function(t,n,i){return e.post(this.baseUrl+"/"+t+"/channels/"+n+"/mandatoryPrincipals/",i)},addSuggestedPrincipal:function(t,n,i){return e.post(this.baseUrl+"/"+t+"/channels/"+n+"/suggestedPrincipals/",i)},getAllChannelSelections:function(t){return e.get(this.baseUrl+"/"+t+"/AllChannelSelections")},getSharedChannelsets:function(){return e.get(this.baseUrl+"/shared")},createSharedChannelsets:function(t){return e.post(this.baseUrl+"/shared",t)},removeAllMandatoryPrincipals:function(t,n){return e["delete"](this.baseUrl+"/"+t+"/channels/"+n+"/mandatoryPrincipals/")},removeAllSuggestedPrincipals:function(t,n){return e["delete"](this.baseUrl+"/"+t+"/channels/"+n+"/suggestedPrincipals/")},removeChannelVisibility:function(t,n){return e["delete"](this.baseUrl+"/"+t+"/channels/"+n+"/visible")},removeMandatoryPrincipal:function(t,n,i){return e["delete"](this.baseUrl+"/"+t+"/channels/"+n+"/mandatoryPrincipals/"+i)},removeSuggestedPrincipal:function(t,n,i){return e["delete"](this.baseUrl+"/"+t+"/channels/"+n+"/suggestedPrincipals/"+i)},setChannelVisibility:function(t,n){return e.post(this.baseUrl+"/"+t+"/channels/"+n+"/visible")},setChannelsetToNotShared:function(t){return e.post(this.baseUrl+"/"+t+"/setnotshared")}},contentTypes:{baseUrl:"api/wizdom/noticeboard/contentTypes",getAllContentTypes:function(){return e.get(this.baseUrl)},addContentType:function(t){return e.post(this.baseUrl,t)},updateContentType:function(t){return e.put(this.baseUrl,t)},deleteContentType:function(t){return e["delete"](this.baseUrl+"/"+t)}},principals:{baseUrl:"api/wizdom/noticeboard/principals",searchForPrincipal:function(t,n){return n=n||!1,e.get(this.baseUrl+"/search?searchTerm="+encodeURIComponent(t)+"&includeWizdomGroups="+n)},searchForPrincipalAuthors:function(t){return e.get(this.baseUrl+"/searchAuthors?searchTerm="+encodeURIComponent(t))},ensurePrincipal:function(t){return e.post(this.baseUrl+"/ensureprincipal",t)},groupPrincipals:function(t){return e.get(this.baseUrl+"/groupPrincipals/"+t)}},settings:{baseUrl:"api/wizdom/noticeboard/settings",getAdministrators:function(){return e.get(this.baseUrl+"/Administrators")},clearAdministratorCache:function(){return e.post(this.baseUrl+"/Administrators/ClearCache")}},social:{baseUrl:"api/wizdom/noticeboard/social/",getMentioOverview:function(t){return e.get(this.baseUrl+"mentio/overview/"+t)},dismissMentio:function(t){return e["delete"](this.baseUrl+"mentio/dismiss/"+t)},getCommentsOverview:function(t){return e.get(this.baseUrl+"comments/overview2/"+t)},dismissComments:function(t){return e.post(this.baseUrl+"comments/dismiss/"+t)}},search:{baseUrl:"api/wizdom/noticeboard/search",searchNewsByFilter:function(t){var n=this.baseUrl+"/newsarchive?searchTerm="+encodeURIComponent(t.searchTerm)+"&params=&viewId="+t.viewId+"&channels="+t.channels+"&fromDate="+t.fromDate+"&toDate="+t.toDate+(null!=t.authorId?"&authorId="+t.authorId:"")+"&$take="+t.take+(null!=t.skip?"&$skip="+t.skip:"")+"&language="+t.language;return e.get(n)},installSearchCenter:function(t){return e.post(this.baseUrl+"/install",{searchCenterUrl:t.url,searchResultRedirectUrl:t.redirectUrl})},uninstallSearchCenter:function(t){return e.post(this.baseUrl+"/uninstall",{searchCenterUrl:t.url})},removeAllSyncronizedData:function(){return e.post(this.baseUrl+"/removeAllSyncronizedData")}},templates:{baseUrl:"api/wizdom/noticeboard/templates",getTemplates:function(t,n,i){var o=i||!1;return e.get(this.baseUrl+"/device/"+t+"/type/"+n+"?recursive="+o)}},views:{baseUrl:"api/wizdom/noticeboard/views",createView:function(t){return e.post(this.baseUrl,t)},createNewView:function(t){var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)});return e.post("api/wizdom/noticeboard/views",{id:n,deviceIdentifier:t})},getAllAvailableChannelsWithContentTypes:function(t){return e.get(this.baseUrl+"/"+t+"/AllAvailableChannelsWithContentTypes")},getAllChannelSelections:function(t){return e.get(this.baseUrl+"/"+t+"/AllChannelSelections")},getItem:function(t,n){return e.get(this.baseUrl+"/"+t+"/items/"+n+"/")},getItems:function(t,n){return e.get(this.baseUrl+"/"+t+"/items2/"+n)},getMyChannelsSelection:function(t){return e.get(this.baseUrl+"/"+t+"/MyChannelSelection")},getViewById:function(t){var n=!1,i="noticeboard";return e.get(this.baseUrl+"/ny/"+t,n,i)},getUnreadNews:function(t){return e.get(this.baseUrl+"/"+t+"/items/unread")},removeMyChannelSelection:function(t,n){return e["delete"](this.baseUrl+"/"+t+"/MyChannelSelection?channelId="+n)},setMyChannelSelection:function(t,n){return e.post(this.baseUrl+"/"+t+"/MyChannelSelection?channelId="+n)},updateMyChannelSelection:function(t,n){return e.post(this.baseUrl+"/"+t+"/MyChannelSelection",n)},updateView:function(t){return e.put(this.baseUrl,t)}},items:{baseUrl:"api/wizdom/noticeboard/items/",createNews:function(t){return e.post(this.baseUrl,t)},deleteItem:function(t){return e["delete"](this.baseUrl+t)},markRead:function(t){return e.post(this.baseUrl+t+"/markRead")},markUnread:function(t){return e.post(this.baseUrl+t+"/markUnread")},markAllRead:function(t){return e.post(this.baseUrl+"markAllRead",t)}},notifications:{baseUrl:"api/wizdom/noticeboard/notification/",getOverview:function(t){return e.get(this.baseUrl+"overview2/"+t)}},insights:{baseUrl:"api/wizdom/noticeboard/insights/",getActiveReaders:function(t,n,i){return e.get(this.baseUrl+"readers/"+t+"/"+n+"/"+i)},getMostReadNews:function(t,n,i){return e.get(this.baseUrl+"news/mostread/"+t+"/"+n+"/"+i)},getMostCommentedNews:function(t,n,i){return e.get(this.baseUrl+"news/mostcommented/"+t+"/"+n+"/"+i)},getMostActiveChannels:function(t,n,i){return e.get(this.baseUrl+"channels/activechannels/"+t+"/"+n+"/"+i)},getMostActiveAuthors:function(t,n,i){return e.get(this.baseUrl+"authors/"+t+"/"+n+"/"+i)}},v3:{ChannelSet:{GetItems:function(t,n){return e.get("api/wizdom/noticeboard/v3/channelsets/"+t+"/items?"+i(n)).then(function(e){return e.data.forEach(o),e})}},View:{GetItems:function(t,n){return e.get("api/wizdom/noticeboard/v3/views/"+t+"/items?"+i(n)).then(function(e){return e.data.forEach(o),e})}},Item:{GetItems:function(t){return e.get("api/wizdom/noticeboard/v3/items/?"+i(t)).then(function(e){return e.data.forEach(o),e})},GetItem:function(t,n){return e.get("api/wizdom/noticeboard/v3/items/"+t+"?"+i(n)).then(function(e){return o(e),e})},PostItem:function(t,n){return e.post("api/wizdom/noticeboard/v3/items/?"+i(n),t).then(function(e){return o(e),e})},PutItem:function(t,n,r){return e.put("api/wizdom/noticeboard/v3/items/"+t+"?"+i(r),n).then(function(e){return o(e),e})}},Image:{UploadImage:function(t){return e.post("api/wizdom/noticeboard/v3/imageupload",'"'+t+'"',{accept:"application/json","Content-Type":"application/json"}).then(function(e){return e.links})}},OEmbed:{Get:function(t,n){try{return e.get("api/wizdom/noticeboard/v3/oembed/?url="+encodeURIComponent(t)+"&"+i(n))}catch(o){throw o}}},Integrations:{Reach:{TestConnection:function(){return e.get("api/wizdom/noticeboard/v3/integrations/reach/test").then(function(e){return e})},GetChannels:function(){return e.get("api/wizdom/noticeboard/v3/integrations/reach/channels").then(function(e){return e})},GetGroups:function(){return e.get("api/wizdom/noticeboard/v3/integrations/reach/groups").then(function(e){return e})}}}},utilities:{Base64EncodeImageFromUrl:function(e){var i=n.defer(),o=i.promise;return t.get(e,{responseType:"blob"}).then(function(e){var t=new FileReader;t.onload=function(){i.resolve(t.result)},t.readAsDataURL(e.data)}),o}}};(function(){function e(){}return e})(),function(){function e(){}return e}(),function(){function e(){}return e}(),function(){function e(){}return e}(),function(){function e(){}return e}(),function(){function e(){}return e}(),function(){function e(){}return e}(),function(){function e(){}return e}(),function(){function e(){}return e}();return r}angular.module("Wizdom365.Noticeboard").factory("noticeboardApi",e),e.$inject=["webapiService","$http","$q"]}(),function(){function e(){return{scope:{},template:"<div wizdom-include='::vm.templateUrl' ng-if='::vm.showPageContact'></div>",controller:t,controllerAs:"vm"}}function t(e,t,n,i,o,r){var a=this;if(a.showPageContact=!0,"true"!=r.PageContact.Enabled.toLowerCase()||n.pageColumns.hidePageContact)return void(a.showPageContact=!1);a.templateUrl=r.PageContact.TemplateUrl||"PageContact/Templates/ViewTemplates/DefaultPageContact.html",a.useDepartment=n.pageColumns.useDepartmentContact,a.useDepartment||(a.pageContact={wizdomUser:{name:void 0===n.pageColumns.publishingContact||n.pageIsInEditMode?" ":n.pageColumns.publishingContact}});var l={pageListId:n.pageListId,pageItemId:n.pageItemId,pageVersion:n.pageFileVersionForDisplay,webServerRelativeUrl:window.encodeURIComponent(n.webServerRelativeUrl)};o.getPageContact(l).then(function(e){(e.wizdomUser||e.useDepartment)&&(a.pageContact=e),a.contactReady=!0})}angular.module("Wizdom365.PageContact").directive("wizdom365Pagecontact",e),t.$inject=["$scope","$q","contextInfo","webApiProxy","pageContactApi","configuration"]}(),function(){function e(e){var t={baseUrl:"api/wizdom/branding/pagecontact",allowBatching:!1,getPageContact:function(t){return e.getAppCached(this.baseUrl+"/"+t.pageListId+"/"+t.pageItemId+"/"+(t.pageVersion?t.pageVersion.replace(".","_"):"current")+"/?webServerRelativeUrl="+t.webServerRelativeUrl,this.allowBatching)}};return t}angular.module("Wizdom365.PageContact").factory("pageContactApi",e),e.$inject=["webapiService"]}(),function(){function e(){return{scope:{},template:'\n            <span class="wt-notificationPanel" ng-show="uiReady == \'loadComplete\'">\n                <span class="ms-promotedActionButton no-icon" style="cursor:pointer" ng-click="showHideMenu()" ng-if="notificationEnabled && notificationViewId" ng-mouseover="mouseover()">\n              <span class="no-has-unread" ng-show="(mentioItemList.value && mentioItemList.value.length > 0) || (unreadComments.value && unreadComments.value.length > 0) || (unreadNewsCount > 0)" title="{{\'You have new notifications\' | translate}}">{{(mentioItemList.value.length + unreadComments.value.length + unreadNewsCount) > 99 ? "99+" : (mentioItemList.value.length + unreadComments.value.length + unreadNewsCount) }}</span>\n                    <span class="glyphicons glyphicons-conversation no-button wt-icon" title="{{(mentioItemList.value && mentioItemList.value.length > 0) || (unreadComments.value && unreadComments.value.length > 0) || (unreadNewsCount > 0) ? (\'You have new notifications\' | translate) : (\'You have no new notifications\' | translate) }}"></span>\n                </span>\n            </span>\n            <div class="no-panel" wizdom-include="\'Notifications/Templates/ViewTemplates/Notification/NotificationPanel.html\'" ng-if="downloadTemplates"></div>\n            ',controller:t}}function t(e,t,n,i,o,r,a,l,s,c,d,u){function m(e){for(var n=e.target;n&&n!==$(".no-panel")[0]&&n!==$(".wt-notificationPanel")[0];)n=n.parentNode;if(!n)for(n=e.target;n&&n!==$(".no-panel-parent .modal-content")[0]&&n!==$(".no-panel-parent")[0];)n=n.parentNode;n||1!=t.downloadTemplates||($(".no-button").stop().removeClass("is-active"),$(".no-has-unread").show(),$(".no-panel").stop().removeClass("expanded"),$(".no-icon").removeClass("is-active"))}function p(){if(t.downloadTemplates=!0,!$(".no-icon").is(":hidden")){var e=$(document).width()-($(".no-icon").offset().left+$(".no-icon").width()-23);$(".no-button").hasClass("is-active")?($(".no-button").stop().removeClass("is-active"),$(".no-has-unread").show(),$(".no-panel").stop().removeClass("expanded"),$(".no-icon").removeClass("is-active")):($(".no-has-unread").hide(),$(".no-icon").addClass("is-active"),$(".no-panel").stop().addClass("expanded").css({width:e}),$(".no-button").stop().addClass("is-active"),$(".no-panel").perfectScrollbar())}}function g(){var e=JSON.parse(s.getItem("Notifications.Panel"));h(e),n(f,1e3),t.$watch(l.getOpenItem,function(e,n){e!=n&&null!=e&&0!=e.id&&t.showItem(e.id)}),b&&o.cancel(b);var i=5;b=o(function(){i>0&&f(),i--},6e5),t.$on("$destroy",function(e){o.cancel(b)})}function f(){t.notificationViewId&&t.notificationEnabled&&(t.mentioMode=t.unreadCommentsMode=t.unreadNewsMode="loading",a.notifications.getOverview(t.notificationViewId).then(function(e){h(e),s.setItem("Notifications.Panel",JSON.stringify(e)),t.mentioMode=t.unreadCommentsMode=t.unreadNewsMode="loadComplete"}))}function h(e){null!=e&&(e.unreadNews?t.unreadNewsCount=e.unreadNews.length:t.unreadNewsCount=0,t.channelIds=e.channelIds,l.mentioList.set(e.mentions,e.spMentions),l.unreadNews.set(e.unreadNews),t.socialFeatureEnabled&&l.unreadComments.set(e.unreadComments,e.unreadSPComments))}function w(e){var n=[];_.each(t.unreadNews.value,function(e){n.push(e.id)}),i.open({templateUrl:l.getShowItemTemplate(),controller:"Wizdom365NoticeboardShowNewsController",windowClass:"bootstrap-wrapper no-panel-parent",size:"lg",resolve:{webpartId:function(){return t.notificationViewId},itemInfo:function(){return{itemId:e,shouldNotMarkRead:!0,canEdit:!1}},item:function(){var n=_.find(t.unreadNews.value,{id:e});if(n)return n;var i=c.defer();return d.views.getItem(t.notificationViewId,e).then(function(e){i.resolve(e.newsItem)}),i.promise},pageableIds:function(){return n}}})}function v(e){i.open({templateUrl:"Noticeboard/Templates/Dialogs/ChooseChannels.html",controller:"Wizdom365NoticeboardChooseChannelsController",windowClass:"bootstrap-wrapper no-panel-parent",resolve:{viewId:function(){return e}}}).result.then(function(){return f()})}t.notificationView,t.notificationViewId=r.Noticeboard.Notification.ViewID,t.emailNotificationView,t.emailNotificationViewId=r.Noticeboard.EmailNotification.ViewID,t.notificationEnabled=r.Noticeboard?$.parseJSON(r.Noticeboard.Notification.Enabled):!1,t.socialFeatureEnabled=r.Noticeboard?$.parseJSON(r.Noticeboard.SocialFeature.Enabled):!1,t.emailNotificationEnabled=r.Noticeboard?$.parseJSON(r.Noticeboard.EmailNotification.Enabled):!1,t.emailNotificationUseBCC=r.Noticeboard&&null!=r.Noticeboard.EmailNotification.EmailNotificationUseBCC?$.parseJSON(r.Noticeboard.EmailNotification.EmailNotificationUseBCC):!0,t.emailNotificationMaxRecipients=r.Noticeboard&&null!=r.Noticeboard.EmailNotification.EmailNotificationMaxRecipients?parseInt($.parseJSON(r.Noticeboard.EmailNotification.EmailNotificationMaxRecipients),10):100,t.uiReady="loadComplete",t.templateUnreadItems="Notifications/Templates/ViewTemplates/Notification/UnreadElements.html",t.templateUnreadComments="Notifications/Templates/ViewTemplates/Notification/UnreadComments.html",t.templateMentions="Notifications/Templates/ViewTemplates/Notification/Mentions.html",t.channelIds=[],t.mentioItemList=l.mentioList.get(),t.unreadComments=l.unreadComments.get(),t.unreadNews=l.unreadNews.get(),t.loadData=f,t.showItem=w,t.chooseChannels=v,t.listenerExist=!1,t.downloadTemplates=!1,t.mouseover=function(){t.downloadTemplates=!0},t.notificationEnabled&&g(),t.showHideMenu=p,u.on("click",m),t.$on("NoticeboardNewsItemRead",function(e,n){_.remove(t.unreadNews.value,function(e){return e.id===n.id}),t.unreadNewsCount=t.unreadNews.value.length}),t.$on("NoticeboardNewsItemUnread",function(e,n){t.unreadNews.value.push(n),t.unreadNewsCount=t.unreadNews.value.length}),t.$on("NoticeboardNewsAllRead",function(){t.unreadNews.value=[],t.unreadNewsCount=t.unreadNews.value.length}),t.$on("NoticeboardNewsItemCreated",function(e,t){g()});var b=null}angular.module("Wizdom365.Notification").directive("wizdom365NotificationPanel",e),t.$inject=["$filter","$scope","$timeout","$modal","$interval","configuration","notificationApi","socialNotificationService","sessionStorageService","$q","noticeboardApi","$document"]}(),function(){function e(e){function t(e,t){angular.forEach(f,function(n){n(e,t)})}function n(e){var t=_.find(d.value,function(t){return t.id==e});t&&(t.isRead=!0),_.remove(g.value,function(t){return t.id==e}),o(e)}function i(){var e=_.map(d.value,function(e){return e.id});_.forEach(e,function(e){n(e)})}function o(e){_.remove(c.value,function(t){return(t.hasOwnProperty("targetId")?t.targetId:t.id)==e}),_.remove(p.value,function(t){return(t.hasOwnProperty("targetId")?t.targetId:t.id)==e})}function r(){var e=_.map(c.value,function(e){return e.hasOwnProperty("targetId")?e.targetId:e.id});_.forEach(e,function(e){o(e)})}function a(e){_.remove(s.value,function(t){return(t.hasOwnProperty("targetId")?t.targetId:t.id)==e})}function l(){var e=_.map(s.value,function(e){return e.hasOwnProperty("targetId")?e.targetId:e.id});_.forEach(e,function(e){a(e)})}var s={value:[]},c={value:[]},d={value:[]},u=[],m={id:0},p={value:[]},g={value:[]},f=[],h={registerCallback:function(e){f.push(e)},unregisterCallback:function(e){_.pull(f,e)},mentioList:{get:function(){return s},set:function(e,n){void 0!==n?s.value=e.concat(n):s.value=e,t("addMentions",[])},remove:function(e){a(e),t("removeMentions",[e])},removeAll:function(){l(),t("removeMentions",[])}},unreadComments:{get:function(){return c},set:function(e,n){void 0!==n?c.value=e.concat(n):c.value=e,t("addUnreadComments",[])},remove:function(e){var n;n=angular.isArray(e)?angular.copy(e):[angular.copy(e)],_.forEach(n,function(e){return o(e.hasOwnProperty("targetId")?e.targetId:e.id)}),t("removeUnreadComments",n)},removeAll:function(){var e=angular.copy(c.value);r(),t("removeUnreadComments",e)}},unreadNews:{get:function(){return d},set:function(e){d.value=e,t("addUnreadNewsBase",[])},remove:function(e){var i;i=angular.isArray(e)?angular.copy(e):[angular.copy(e)],_.forEach(i,function(e){return n(e.id)}),t("removeUnreadNews",i)},removeAll:function(){var e=angular.copy(d.value);i(),t("removeUnreadNews",e)}},noticeboard:{unreadComments:{get:function(){return p},set:function(e){angular.isArray(e)||(e=[e]);var n=[];_.forEach(e,function(e){_.any(p.value,function(t){return t.id==e.id})||(n.push(e),p.value.push(e))}),n.length>0&&t("addUnreadComments",n)}}},getSelectedChannels:function(){return u},setSelectedChannels:function(e){u=e},getOpenItem:function(){return m},setOpenItem:function(e){m=e},getNotificationWebpartId:function(){return e.Noticeboard.Notification.ViewID},getShowItemTemplate:function(){return e.Notification.ShowNBItemTemplate}};return h}angular.module("Wizdom365.Notification").factory("socialNotificationService",e),e.$inject=["configuration"]}(),function(){function e(e){function t(e){var t;return t=angular.isArray(e)?angular.copy(e):[angular.copy(e)]}var n={social:{baseUrl:"api/wizdom/noticeboard/social/",dismissMentio:function(t){return e["delete"](this.baseUrl+"mentio/dismiss/"+t)},dismissComments:function(t){return e.post(this.baseUrl+"comments/dismiss/"+t)}},notifications:{baseUrl:"api/wizdom/noticeboard/v2/notification/",getOverview:function(t){return e.get(this.baseUrl+"overview/"+t)},dismissCommentsSP:function(n){return e.post(this.baseUrl+"spitemcomments/dismiss/",t(n))},dismissMentioSP:function(n){return e.post(this.baseUrl+"spitemmentions/dismiss/",t(n))}}};return n}angular.module("Wizdom365.Notification").factory("notificationApi",e),e.$inject=["webapiService"]}(),angular.module("Wizdom365.PageInfo").directive("wizdom365Newsinfo",function(){return{scope:{},template:"<div wizdom-include='templateUrl'></div>",link:function(e,t,n){},controller:["$scope","$http","contextInfo","pageInfoApi","configuration",function(e,t,n,i,o){if(e.templateUrl=o.PageInfo.TemplateUrlNews,e.showPageInfo=!0,"true"!=o.PageInfo.Enabled||n.pageColumns.hidePageInfo)return void(e.showPageInfo=!1);e.pageInfo={newsDate:void 0===n.pageColumns.newsDate||""==n.pageColumns.newsDate.trim()||null===n.pageColumns.newsDate?"":n.pageColumns.newsDate,wizdomUser:{name:void 0===n.pageColumns.pageEditor?"":n.pageColumns.pageEditor,email:""}};var r=n.webServerRelativeUrl,a={pageListId:n.pageListId,pageItemId:n.pageItemId,pageVersion:n.pageFileVersionForDisplay,webServerRelativeUrl:window.encodeURIComponent(r)};i.getPageInfo(a).then(function(t){e.pageInfo.wizdomUser=t.wizdomUser,e.pageInfo.author=t.author,e.dataReady=!0})}]}}),angular.module("Wizdom365.PageInfo").directive("wizdom365Pageinfo",function(){return{scope:{},template:"<div wizdom-include='templateUrl' ng-if='showPageInfo'></div>",link:function(e,t,n){},controller:["$scope","$http","contextInfo","pageInfoApi","configuration",function(e,t,n,i,o){if(e.templateUrl=o.PageInfo.TemplateUrlPage,e.showPageInfo=!0,"true"!=o.PageInfo.Enabled||n.pageColumns.hidePageInfo)return void(e.showPageInfo=!1);e.pageInfo={modifiedDate:void 0===n.pageColumns.pageModified||""==n.pageColumns.pageModified.trim()||null===n.pageColumns.newsDate?"":n.pageColumns.pageModified,wizdomUser:{name:void 0===n.pageColumns.pageEditor?"":n.pageColumns.pageEditor}};var r=n.webServerRelativeUrl,a={pageListId:n.pageListId,pageItemId:n.pageItemId,pageVersion:n.pageFileVersionForDisplay,webServerRelativeUrl:window.encodeURIComponent(r)};i.getPageInfo(a).then(function(t){e.pageInfo.wizdomUser=t.wizdomUser,e.pageInfo.author=t.author,e.dataReady=!0})}]}}).filter("stripTimeFromDate",function(){return function(e){var t=e.indexOf(":");return t>-1?e.substr(0,e.indexOf(":")-2):e}}),function(){function e(e){var t={baseUrl:"api/wizdom/branding/pageinfo",allowBatching:!1,getPageInfo:function(t){return e.getAppCached(this.baseUrl+"/"+t.pageListId+"/"+t.pageItemId+"/"+(t.pageVersion?t.pageVersion.replace(".","_"):"current")+"/?webServerRelativeUrl="+t.webServerRelativeUrl,this.allowBatching)},pageIsInEdit:function(t){return e.getAppCached(this.baseUrl+"/isinedit/"+t.pageListId+"/"+t.pageItemId+"/"+(t.pageVersion?t.pageVersion.replace(".","_"):"current")+"/?module="+t.module+"&pageUrl="+t.pageUrl,this.allowBatching)}};return t}angular.module("Wizdom365.PageInfo").factory("pageInfoApi",e),e.$inject=["webapiService"]}(),angular.module("Wizdom365.PageRelations").directive("wizdom365Relations",function(){return{scope:{},template:'<div class="wizdom-right-column-container">\n                    <div>\n                        <div wizdom-include="documentsTemplateUrl" ng-if="showDocuments && documents && documents.length > 0"></div>\n                        <div wizdom-include="peopleTemplateUrl" ng-if="showPeople && people && people.length > 0"></div>\n                        <div wizdom-include="pagesTemplateUrl" ng-if="showPages && pages && pages.length > 0"></div>                        \n                    </div>\n                </div>',link:function(e,t,n){},controller:["$scope","$http","contextInfo","pageRelationsApi","configuration",function(e,t,n,i,o){e.documentsTemplateUrl=o.Relations.Documents.TemplateUrl,e.peopleTemplateUrl=o.Relations.People.TemplateUrl,e.pagesTemplateUrl=o.Relations.Pages.TemplateUrl;var r=n.pageListId,a=n.pageItemId,l=n.webServerRelativeUrl;if(e.spHostUrl=n.spHostUrl,e.showPeople=o.Relations.People.Enabled&&"false"===o.Relations.People.Enabled.toLowerCase()?!1:n.pageColumns.hideRelatedPeople?!1:!0,e.showNews=o.Relations.News.Enabled&&"false"===o.Relations.News.Enabled.toLowerCase()?!1:n.pageColumns.hideRelatedNews?!1:!0,e.showPages=o.Relations.Pages.Enabled&&"false"===o.Relations.Pages.Enabled.toLowerCase()?!1:n.pageColumns.hideRelatedPages?!1:!0,e.showDocuments=o.Relations.Documents&&"false"===o.Relations.Documents.Enabled.toLowerCase()?!1:n.pageColumns.hideRelatedDocuments?!1:!0,e.showPeople||e.showNews||e.showPages||e.showDocuments){var s={pageListId:r,pageItemId:a,pageVersion:n.pageFileVersionForDisplay,webServerRelativeUrl:window.encodeURIComponent(l)};i.getPageRelations(s).then(function(t){e.people=t.people,e.pages=t.pages,e.documents=t.documents})}e.getDocIco=function(e){return-1!=e.url.indexOf(".doc")||-1!=e.url.indexOf(".docx")?"icon-inline icon-word icon-word-dims":-1!=e.url.indexOf(".ppt")||-1!=e.url.indexOf(".pptx")||-1!=e.url.indexOf(".pptm")?"icon-inline icon-powerpoint icon-powerpoint-dims":-1!=e.url.indexOf(".xls")||-1!=e.url.indexOf(".xlsx")||-1!=e.url.indexOf(".xlsm")?"icon-inline icon-excel icon-excel-dims":-1!=e.url.indexOf(".jpg")||-1!=e.url.indexOf(".bmp")||-1!=e.url.indexOf(".gif")||-1!=e.url.indexOf(".png")||-1!=e.url.indexOf(".jpeg")?"icon-inline icon-picture icon-picture-dims":-1!=e.url.indexOf(".txt")?"icon-inline icon-text icon-text-dims":-1!=e.url.indexOf(".pdf")?"icon-inline icon-pdf icon-pdf-dims":"icon-inline icon-text icon-text-dims"}}]}}),function(){function e(){return{scope:{wizdom365Relatednews:"@"},template:"<div wizdom-include='templateUrl' ng-if=\"showNews && news && news.length > 0\"></div>",controller:t}}function t(e,t,n,i,o){e.templateUrl="newsPage"==e.wizdom365Relatednews?o.Relations.News.TemplateUrl:o.Relations.News.ContentPageTemplateUrl,e.spHostUrl=n.spHostUrl,e.showNews=o.Relations.News.Enabled&&"false"===o.Relations.News.Enabled.toLowerCase()?!1:!0,e.news=[],i.registerForPageRelations(function(t){e.showNews&&(e.news=t.news)}),e.getBackgroundImage=function(e){var t;if(null==e||""==e)return t;var n=/<img[^>]+src="(\/[^">]+)"/g,i=n.exec(e);return null!=i&&i.length>1?(e=i[1],{"background-image":"linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.6)), url("+e+"?width=300)"}):t}}angular.module("Wizdom365.PageRelations").directive("wizdom365Relatednews",e),t.$inject=["$scope","$http","contextInfo","pageRelationsApi","configuration"]}(),angular.module("Wizdom365.PageRevision").directive("wizdom365Pagerevision",[function(){return{scope:{},template:'<div wizdom-include="template" ng-if="showPageRevision"></div>',link:function(e,t,n){},controller:["$scope","$http","contextInfo","pageRevisionApi","configuration",function(e,t,n,i,o){var r=n.pageListId,a=n.pageItemId,l=n.pageFileVersionForDisplay,s=n.webServerRelativeUrl;if(e.spHostUrl=n.spHostUrl,e.appUrl=n.appUrl,e.showPageRevision="true"===o.Revision.Enabled.toLowerCase()?!0:!1,e.template=o.Revision.TemplateUrl,e.showPageRevision){var c={pageListId:r,pageItemId:a,pageVersion:l,webServerRelativeUrl:window.encodeURIComponent(s)};i.getPageRevision(c).then(function(t){e.pageRevision=t})}}]}}]),function(){function e(e){var t={baseUrl:"api/wizdom/branding/relations",allowBatching:!1,registerForPageRelations:function(e){this.registerForPageRelations.callbacks=this.registerForPageRelations.callbacks||[],this.registerForPageRelations.callbacks.push(e)},pageRelationsLoaded:function(e){angular.forEach(this.registerForPageRelations.callbacks,function(t){t(e)})},getPageRelations:function(t,n){var i=this,o=$.Deferred();return e.getAppCached(this.baseUrl+"/"+t.pageListId+"/"+t.pageItemId+"/"+(t.pageVersion?t.pageVersion.replace(".","_"):"current")+"/?webServerRelativeUrl="+t.webServerRelativeUrl,this.allowBatching).then(function(e){o.resolve(e),i.pageRelationsLoaded(e)}),o.promise()}};return t}angular.module("Wizdom365.PageRelations").factory("pageRelationsApi",e),e.$inject=["webapiService"]}(),function(){function e(e){var t={baseUrl:"api/wizdom/branding/revision",allowBatching:!1,getPageRevision:function(t){return e.getAppCached(this.baseUrl+"/"+t.pageListId+"/"+t.pageItemId+"/"+(t.pageVersion?t.pageVersion.replace(".","_"):"current")+"/?webServerRelativeUrl="+t.webServerRelativeUrl,this.allowBatching)}};return t}angular.module("Wizdom365.PageRevision").factory("pageRevisionApi",e),e.$inject=["webapiService"]}(),function(){function e(){return{scope:{ui:"="},template:'<div class="wt-translator-widget" wizdom-include="vm.template" ng-if="vm.ready && vm.ui"></div>',link:function(e,t,n){},controller:t,controllerAs:"vm",bindToController:!0}}function t(e,t,n,i,o,r){}angular.module("Wizdom365.PageTranslation").directive("wizdom365Pagetranslation",e),t.$inject=["$scope","$http","contextInfo","pageTranslationApi","configuration","log"]}(),function(){function e(e){var t={getLanguageMapLocallized:function(){return{af:"Afrikaans",ar:"العربية","bs-Latn":"Bosanski",bg:"български",ca:"Català","zh-CHS":"简体中文","zh-CHT":"中國傳統的",hr:"Hrvatski",cs:"čeština",da:"Dansk",nl:"Nederlands",en:"English",et:"Eesti",fi:"Suomi",fr:"Français",de:"Deutsch",el:"ελληνικά",ht:"kreyòl ayisyen",he:"עברית",hi:"हिन्दी",mww:"Hmong Daw",hu:"Magyar",id:"Indonesia",it:"Italiano",ja:"日本の",ko:"한국의",lv:"Latvijas",lt:"Lietuvos",ms:"Melayu",mt:"Maltese",no:"Norsk",fa:"فارسی",pl:"Polski",pt:"Português",ro:"Românesc",ru:"русский","sr-Cyrl":"Српски језик",sk:"Slovenský",sl:"Slovenski",es:"Español",sv:"Svenska",th:"ไทย",tr:"Türk",uk:"український",ur:"اردو",vi:"tiếng Việt",cy:"Cymraeg"}},getLanguageMap:function(){return{af:"Afrikaans",ar:"Arabic","bs-Latn":"Bosnian(Latin)",bg:"Bulgarian",ca:"Catalan","zh-CHS":"Chinese Simplified","zh-CHT":"Chinese Traditional",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",et:"Estonian",fi:"Finnish",fr:"French",de:"German",el:"Greek",ht:"Haitian Creole",he:"Hebrew",hi:"Hindi",mww:"Hmong Daw",hu:"Hungarian",id:"Indonesian",it:"Italian",ja:"Japanese",ko:"Korean",lv:"Latvian",lt:"Lithuanian",ms:"Malay",mt:"Maltese",no:"Norwegian",fa:"Persian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian","sr-Cyrl":"Serbian(Cyrillic)",sk:"Slovak",sl:"Slovenian",es:"Spanish",sv:"Swedish",th:"Thai",tr:"Turkish",uk:"Ukrainian",ur:"Urdu",vi:"Vietnamese",cy:"Welsh"}},getLanguageKeys:function(){return Object.getOwnPropertyNames(this.getLanguageMap())}};return t}angular.module("Wizdom365.PageTranslation").factory("pageTranslationApi",e),e.$inject=["webapiService"]}(),function(){function e(e,t,n,i){function o(){n.categories.getCorporateCategories().then(function(e){l.categories=_.map(e,function(e){return{id:e.id,name:e.name,collapsed:!0,links:_.map(e.links,function(e){return{model:e,isChecked:_.any(l.links,{id:e.id})}})}})})}function r(){var t=[];_.forEach(l.categories,function(e){_.forEach(e.links,function(e){e.isChecked&&t.push(e.model)})}),e.close(t)}function a(){e.dismiss("cancel")}var l=this;l.categories=[],l.links=i,l.dialog={save:r,cancel:a},o()}angular.module("Wizdom365.PersonalLink").controller("Wizdom365PersonalLinkAddCorporateLinkController",e),e.$inject=["$modalInstance","$filter","personalLinkApi","links"]}(),function(){function e(e,t,n,i,o,r,a,l){function s(){if(_.contains(r,o.name)){var s=t("translate")("Category with specified name already exist");return void i.showErrorMessage(s)}var c;d.saving=!0,c="corporate"==a?0===d.category.id?n.categories.addCorporateCategory(o):n.categories.updateCorporateCategory(o):0===d.category.id?n.categories.addUserCategory(l,o):n.categories.updateUserCategory(l,o),c.then(function(t){d.saving=!1,e.close(""!==t?t:d.category)},function(e){d.saving=!1,d.dialog.cancel()})}function c(){e.dismiss("cancel")}var d=this;d.category=o,d.categoryNames=r,d.title=0==o.id?"Create Category":"Edit Category",d.dialog={save:s,cancel:c},d.saving=!1}angular.module("Wizdom365.PersonalLink").controller("Wizdom365PersonalLinkCreateEditCategoryController",e),e.$inject=["$modalInstance","$filter","personalLinkApi","notificationService","category","categoryNames","categoryType","viewId"]}(),function(){function e(e,t,n,i,o,r,a,l,s,c,d){function u(){I.showUrlWarning=!S.test(I.link.url),console.info("validating url: "+I.showUrlWarning)}function m(){I.showIconWarning=""===I.link.iconName.icon,console.info("validating icon: "+I.showIconWarning)}function p(){if(I.categories&&0!=I.categories.length){var e=_.findWhere(I.categories,{id:a.userCategoryID});I.selectedCategory=e}0==I.link.id||I.link.linkViewers?g(I.link.linkViewers):o.linkviewers.getLinkViewers(I.link.id).then(function(e){g(e)})}function g(e){return void 0==e||0==e.length?void(I.visibleFor=I.visibilityGroups[0].value):1==e.length&&e[0].loginName&&e[0].loginName.toLowerCase()==I.visibilityGroups[0].value?void(I.visibleFor=I.visibilityGroups[0].value):(I.visibleFor=I.visibilityGroups[1].value,void(I.authorizedPrincipals=_.union(I.authorizedPrincipals,e)))}function f(e,t){return _.find(e,function(e){return 1==t.type?e.loginName==t.loginName:2==t.type?e.groupId==t.groupId:void 0})}function h(e){I.authorizedPrincipals=_.without(I.authorizedPrincipals,e)}function w(e){f(I.authorizedPrincipals,e)||(I.authorizedPrincipals.push(e),I.visiblePrincipalSearchTerm="")}function v(e,t){return!e||e.length<2?[]:(t=t||!1,r.principals.searchForPrincipal(e,t).then(function(e){return e}))}function b(){I.link.imageUrl=null}function C(){I.saving=!0;var e=[];switch(I.visibleFor){case"everybody":e=[{displayName:"Everybody",loginName:"Everybody",type:"1"}];break;case"selected":e=I.authorizedPrincipals}I.link.linkViewers=e,I.link.userCategoryID=I.selectedCategory?I.selectedCategory.id:null,0===I.link.id?1==I.link.type?o.links.addCorporateLink(I.link).then(function(e){I.link=e,I.saving=!1,i.close(I.link)},function(e){I.saving=!1,I.dialog.cancel()}):o.links.addLinkToView(c,I.link,d).then(function(e){I.link=e,I.saving=!1,i.close(I.link)},function(e){I.saving=!1,I.dialog.cancel()}):o.links.updateLink(c,I.link,d).then(function(e){I.link=e,I.saving=!1,i.close(I.link)},function(e){I.saving=!1,I.dialog.cancel()})}function y(){i.dismiss("cancel")}var I=this;I.link=a,I.dialog={save:C,cancel:y},I.saving=!1,I.visibilityGroups=[{name:"everybody",value:"everybody"},{name:"selected",value:"selected"}],I.authorizedPrincipals=[],I.categories=s,I.deleteImage=b,I.title=l,I.addLinkViewer=w,I.removeLinkViewer=h,I.searchForPrincipal=v,I.validateUrl=u,I.validateIcon=m,p();var S=/(^(https:\/\/|http:\/\/|\/|mailto:|tel:|file:).+)/}angular.module("Wizdom365.PersonalLink").controller("Wizdom365PersonalLinkCreateEditLinkController",e),e.$inject=["$q","$filter","$scope","$modalInstance","personalLinkApi","noticeboardApi","link","title","categories","viewId","isAdmin"]}(),function(){function e(e,t,n){function i(){e.dismiss("cancel")}function o(){e.close({webpart:r.webpart})}var r=this;r.webpart=t,r.dialog={save:o,cancel:i}}angular.module("Wizdom365.PersonalLink").controller("PersonalLinkEditLinksDialogController",e),e.$inject=["$modalInstance","webpart","personalLinkApi"]}(),function(){function e(e){function i(e,n,i,o){"undefined"==typeof jQuery.ui?$.getScript(window.wizdomResources.js.JqueryUI).done(function(r,a){console.info("Jquery UI js loaded"),e.$applyAsync(function(){t(e,n,i,o)})}).fail(function(e,t,n){console.error("Jquery UI load failed in EditLinklist.ts")}):t(e,n,i,o)}return{scope:{categoryDatasource:"=",accessOptions:"=",viewid:"@",isAdmin:"@",createCategories:"=",onChange:"&",onLinkMoved:"&",panelClass:"@"},template:'<div class="panel panel-default" ng-class="vm.panelClass"><div class="panel-body"><div class="link-sortable link-collection-content"><div class="link-collection-content" ng-repeat="(catIdx, category) in vm.categoryDatasource" ng-init="categoryIcon = category.id == 0 ? \'icon-navigation-menu-4\' : \'icon-folder\'"><div class="link-category"><div class="float-wrapper"><div class="pull-left"><a><i class="streamline" ng-class="categoryIcon"></i> <span ng-if="category.name == \'Uncategorized\'">{{category.name | translate}}</span> <span ng-if="category.name != \'Uncategorized\'">{{category.name}}</span></a></div></div><div class="float-wrapper"><div class="pull-right" style="padding: 5px 0 5px 5px; margin-right: 8px;"><span ng-if="vm.accessOptions.isAdmin || vm.accessOptions.allowPersonalLinks" class="link-move-container"><a ng-click="vm.accessOptions.isAdmin ? vm.addPredefinedLink(category) : vm.addPersonalLink(category)"><i class="streamline icon-add-circle"></i> <span class="wt-linkText ng-binding" title="{{(vm.accessOptions.isAdmin ? \'Add predefined link\' : \'Add personal link\') | translate}}">{{(vm.accessOptions.isAdmin ? \'Add predefined link\' : \'Add personal link\') | translate}}</span></a></span> <a ng-class="{\'icon-hidden\': category.name == \'Uncategorized\' || !vm.accessOptions.isAdmin}"><i class="streamline icon-pencil-1" ng-click="vm.editCategory(category)"></i></a> <a ng-class="{\'icon-hidden\': category.name == \'Uncategorized\' || !vm.accessOptions.isAdmin}"><i class="streamline icon-bin-1" ng-click="vm.removeCategory(category)"></i></a></div></div></div><div ui-sortable="vm.sortableOptions" class="categorylinks-container" ng-model="category.links"><div class="link-container" ng-repeat="link in category.links" ng-class="link.type === 3 || vm.accessOptions.isAdmin || vm.accessOptions.allowSortLinks ? \'sortable\' : \'not-sortable\'"><div class="link"><div class="float-wrapper"><div class="pull-left"><span ng-if="link.type == 1" class="label label-primary">Corp</span> <i class="streamline icon-hyperlink-2"></i> <span ng-bind="link.name"></span></div></div><div ng-if="vm.accessOptions.isAdmin" class="float-wrapper"><div class="pull-right"><span class="link-move-container"><a><i class="streamline icon-arrow-up" ng-click="vm.moveLink(link, $index, catIdx, -1)"></i></a> <a><i class="streamline icon-arrow-down" ng-click="vm.moveLink(link, $index, catIdx, 1)"></i></a></span> <a><i class="streamline icon-pencil-1" ng-class="{\'icon-hidden\': link.type === 1}" ng-click="vm.editPredefinedLink(category.id, $index, link)"></i></a> <a><i class="streamline icon-bin-1" ng-click="vm.removeLinkAdmin($index, link)"></i></a></div></div><div ng-if="!vm.accessOptions.isAdmin" class="float-wrapper"><div class="pull-right"><span ng-if="vm.accessOptions.allowSortLinks || link.type === 3" class="link-move-container"><a><i class="streamline icon-arrow-up" ng-click="vm.moveLink(link, $index, catIdx, -1)"></i></a> <a><i class="streamline icon-arrow-down" ng-click="vm.moveLink(link, $index, catIdx, 1)"></i></a></span> <a><i class="streamline icon-pencil-1" ng-class="{\'icon-hidden\': link.type !== 3}" ng-click="vm.editPredefinedLink(category.id, $index, link)"></i></a> <a><i class="streamline icon-bin-1" ng-class="{\'icon-hidden\': !vm.accessOptions.allowDeleteLinks && link.type !== 3}" ng-click="vm.removeLinkUser($index, link)"></i></a></div></div></div></div></div></div></div></div><div class="panel-heading text-right" style="padding: 10px 25px;" ng-if="vm.accessOptions.isAdmin"><button class="btn btn-primary" ng-click="vm.addCorporateLinks();">{{\'Add corporate link\' | translate}}</button> <button type="button" class="btn btn-primary" ng-click="vm.createCategory()">{{\'Create Category\' | translate}}</button></div></div>',link:i,controller:n,controllerAs:"vm"}}function t(e,t,n,i){i.categoryDatasource=e.categoryDatasource,i.accessOptions=e.accessOptions||{},i.accessOptions.isAdmin="true"==e.isAdmin,i.panelClass=e.panelClass,i.viewId=e.viewid,i.createCategories=e.createCategories,i.onChange=e.onChange||function(){},i.onLinkMoved=e.onLinkMoved||function(){},e.$watch("categoryDatasource",function(t,n){t!=n&&(i.categoryDatasource=e.categoryDatasource)})}function n(e,t,n,i,o,r){function a(e,t){var n=function(){},i={text:e,modal:!0,type:"notification",layout:"center",successCalback:t,cancelCalback:n};o.showConfirmationDialog(i)}function l(e,n){a(t("translate")("Are you sure you want to delete this link? "),function(){1===n.type?i.links.unAssignCorpLinksFromView({key:b.viewId,value:[n]}).then(function(t){var i=_.findWhere(b.categoryDatasource,{id:n.userCategoryID});i.links.splice(e,1),b.onChange()}):i.links.deleteLink(n.id).then(function(t){var i=_.findWhere(b.categoryDatasource,{id:n.userCategoryID});i.links.splice(e,1),b.onChange()})})}function s(e,n){a(t("translate")("Are you sure you want to delete this link? "),function(){switch(n.type){case 1:case 2:i.links.addToDeniedList(b.viewId,n).then(function(t){var i=_.findWhere(b.categoryDatasource,{id:n.userCategoryID});i.links.splice(e,1),b.onChange()});break;case 3:i.links.deleteLink(n.id).then(function(t){var i=_.findWhere(b.categoryDatasource,{id:n.userCategoryID});i.links.splice(e,1),b.onChange()})}})}function c(e,t,n,i){var o=t,r=o+i,a=!b.accessOptions.isAdmin&&!b.accessOptions.allowSortLinks;if(!(0>r||r>b.categoryDatasource[n].links.length-1||a&&3!=e.type)){if(r>=b.categoryDatasource[n].links.length)for(var l=r-b.categoryDatasource[n].links.length;l--+1;)b.categoryDatasource[n].links.push(void 0);b.categoryDatasource[n].links.splice(r,0,b.categoryDatasource[n].links.splice(o,1)[0]),b.onLinkMoved()}}function d(){var e={id:0,name:"",links:[]};p(e).then(function(e){null!==e&&b.categoryDatasource.push({id:e.id,name:e.name,collapsed:!0,links:e.links}),b.onChange()})}function u(e){p(e).then(function(t){t&&(e.name=t.name),b.onChange()})}function m(e){a(t("translate")("Are you sure you want to delete this group? \nAll related data will be removed too"),function(){i.categories.deleteUserCategory(e.id).then(function(t){_.remove(b.categoryDatasource,function(t){return t.id===e.id}),b.onChange()})})}function p(t){return e.open({templateUrl:"PersonalLink/Templates/Dialogs/CreateEditLinkCategory.html",controller:"Wizdom365PersonalLinkCreateEditCategoryController",controllerAs:"vm",windowClass:"bootstrap-wrapper",size:"sm",resolve:{category:function(){return{id:t.id,name:t.name,links:[]}},categoryNames:function(){return _.map(b.categories,function(e){return e.name})},categoryType:function(){return"user"},viewId:function(){return b.viewId}}}).result}function g(){e.open({templateUrl:"PersonalLink/Templates/Dialogs/AddCorporateLink.html",controller:"Wizdom365PersonalLinkAddCorporateLinkController",controllerAs:"vm",windowClass:"bootstrap-wrapper",size:"md",resolve:{links:function(){var e=[];return _.each(b.categoryDatasource,function(t){_.each(t.links,function(t){1==t.type&&e.push(t)})}),e}}}).result.then(function(e){if(e){var t=_.map(e,function(e){return e.id}),o=[],r=[];_.each(b.categoryDatasource,function(t){_.each(t.links,function(t){var n=_.findIndex(e,function(e,n){return 1===t.type&&e.id==t.id});n>-1&&r.push(e[n])})});var a=_.map(r,function(e){return e.id});o=_.difference(t,a).map(function(t){var n=_.findWhere(e,{id:t});return n});var l=[];_.each(b.categoryDatasource,function(t){_.each(t.links,function(n,i){if(1==n.type){var o=_.findIndex(e,function(e,t){return e.id==n.id});-1==o&&l.push(t.links[i])}}),_.each(l,function(e,n){_.remove(t.links,{id:e.id})})});var s=o.length>0?i.links.assignCorpLinksToView(b.categoryDatasource[0].id,{key:b.viewId,value:o}):null,c=l.length>0?i.links.unAssignCorpLinksFromView({key:b.viewId,value:l}):null;n.all([s,c]).then(function(e){_.each(o,function(e,t){b.categoryDatasource[0].links.push(e)}),b.onChange()})}})}function f(e){var t={id:0,name:"",type:2,url:"",description:"",imageUrl:"",openInNewWindow:!1,userCategoryID:e.id};v(t,"Create predefined link").then(function(e){if(e){var t=_.findWhere(b.categoryDatasource,{id:e.userCategoryID});t.links.push(e)}b.onChange()})}function h(e){var t={id:0,name:"",type:3,url:"",description:"",imageUrl:"",openInNewWindow:!1,userCategoryID:e.id};v(t,"Create personal link").then(function(e){if(e){var t=_.findWhere(b.categoryDatasource,{id:e.userCategoryID});t.links.push(e)}b.onChange()})}function w(e,t,n){n.userCategoryID=e,v(n,"Edit predefined link").then(function(n){if(e!=n.userCategoryID){var i=_.findWhere(b.categoryDatasource,{id:e});i.links.splice(t,1);var o=_.findWhere(b.categoryDatasource,{id:n.userCategoryID});o.links.push(n)}else{var r=_.findWhere(b.categoryDatasource,{id:e});r.links[t]=n}b.onChange()})}function v(t,n){return e.open({templateUrl:"PersonalLink/Templates/Dialogs/CreateEditLink.html",controller:"Wizdom365PersonalLinkCreateEditLinkController",controllerAs:"vm",windowClass:"bootstrap-wrapper",size:"md",resolve:{link:function(){return t},title:function(){return n},categories:function(){return b.categoryDatasource},viewId:function(){return b.viewId},isAdmin:function(){return b.accessOptions.isAdmin}}}).result}var b=this;b.addCorporateLinks=g,b.addPredefinedLink=f,b.editPredefinedLink=w,b.addPersonalLink=h,b.createCategory=d,b.editCategory=u,b.removeCategory=m,b.moveLink=c,b.removeLinkAdmin=l,b.removeLinkUser=s;var C=-1;b.sortableOptions={items:".link-container:not(.not-sortable)",connectWith:".categorylinks-container",update:function(e,t){e&&e.timeStamp===C&&b.onLinkMoved(),C=e.timeStamp}}}angular.module("Wizdom365.PersonalLink").directive("wizdom365EditLinklist",e),e.$inject=["webpartPropertiesService"],n.$inject=["$modal","$filter","$q","personalLinkApi","notificationService"]}(),function(){function e(e,n){function i(t,n,i,o){o.editMode=e.isInEditMode(n),o.webpartId=e.getWebpartId(n);var r=i.webpartProperties?JSON.parse(i.webpartProperties):null;o.webpartProperties={templateUrl:r&&r.templateUrl||"PersonalLink/Templates/ViewTemplates/simplelist.html"},e.hideEditCode(n),o.activate()}return{scope:{},template:'<div class="bootstrap-wrapper">\n                        <div ng-if="vm.editMode" class="left-corner">\n                            <div class="webpart-edit-button-container">\n                                <button class="editWebpartButton btn" ng-click="vm.editWebpart()" type="button" title=\'{{"Edit Webpart" | translate}}\'>\n                                    <span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{"Edit" | translate}}</span>\n                                </button>\n                            </div>\n                        </div>\n                        <div class="wizdom-link-collection wizdom-fullview">\n                            <div class="linklist-container" wizdom-include=\'vm.webpartProperties.templateUrl\'></div>\n                    \n                            <div class="left-corner" ng-if="vm.webpart.linkList.length == 0">\n                                {{\'No links have been added yet\' | translate}}\n                            </div>\n                            <div ng-show="vm.showEditLinksIcon" class="pull-right link-collection-content">\n                                <a class="glyphicon glyphicon-pencil right-corner pull-right"\n                                   ng-click="vm.editLinks()">\n                                </a>\n                            </div>\n                        </div>\n                    </div>',link:i,controller:t,controllerAs:"vm"}}function t(e,t,n,i){function o(){u="personalLink:"+d.webpartId,d.webpart=s(),n.views.getOrAddView(d.webpartId,d.editMode).then(function(e){d.webpart=e,d.showEditLinksIcon=l(),c()})}function r(){t.open({templateUrl:"PersonalLink/Templates/Dialogs/EditWebpart.html",controller:"PersonalLinkEditWebpartController",controllerAs:"vm",windowClass:"bootstrap-wrapper",resolve:{webpart:function(){return angular.copy(d.webpart)},webpartProperties:function(){return angular.copy(d.webpartProperties)}}}).result.then(function(e){e&&(d.webpart=e.webpart,d.webpartProperties=e.webpartProperties,c(),o())})}function a(){t.open({templateUrl:"PersonalLink/Templates/Dialogs/EditLinks.html",controller:"PersonalLinkEditLinksDialogController",controllerAs:"vm",windowClass:"bootstrap-wrapper",resolve:{webpart:function(){return angular.copy(d.webpart)}}}).result.then(function(e){e&&(d.webpart=e.webpart,c(),n.categories.setLinkOrder(d.webpart.viewId,d.webpart.categories,!1).then(function(e){o()}))})}function l(){return!d.editMode&&d.webpart&&(d.webpart.allowPersonalLinks||d.webpart.allowDeleteLinks||d.webpart.allowSortLinks)}function s(){return JSON.parse(i.getItem(u))}function c(){i.setItem(u,JSON.stringify(d.webpart))}var d=this,u="";d.webpart=null,d.editWebpart=r,d.editLinks=a,d.activate=o,d.showEditLinksIcon=!1}angular.module("Wizdom365.PersonalLink").directive("wizdom365PersonallinkWebpart",e),e.$inject=["webpartPropertiesService","log"],t.$inject=["$q","$modal","personalLinkApi","localStorageService"]}(),function(){function e(e){var t={linkviewers:{baseUrl:"api/wizdom/personalLink/links/viewers/",getLinkViewers:function(t){return e.get(this.baseUrl+"get/"+t)}},views:{baseUrl:"api/wizdom/personalLink/views/",allowBatching:!1,batchGroup:"personalLink",getOrAddView:function(t,n){return e.get(this.baseUrl+"getoradd/"+t+"/"+n,this.allowBatching,this.batchGroup).then(function(e){for(var t=0;t<e.categories.length;t++)for(var n=0;n<e.categories[t].links.length;n++)e.categories[t].links[n].iconName=e.categories[t].links[n].iconName?JSON.parse(e.categories[t].links[n].iconName):{};return e})},updateView:function(t){for(var n=angular.copy(t),i=0;i<n.categories.length;i++)for(var o=0;o<n.categories[i].links.length;o++)n.categories[i].links[o].iconName=n.categories[i].links[o].iconName?JSON.stringify(n.categories[i].links[o].iconName):JSON.stringify({});return e.put(this.baseUrl+"update",n)},deleteView:function(t){return e["delete"](this.baseUrl+t)}},links:{baseUrl:"api/wizdom/personalLink/links/",addToDeniedList:function(t,n){var i=angular.copy(n);return i.iconName=i.iconName?JSON.stringify(i.iconName):JSON.stringify({}),e.post(this.baseUrl+"addtodeniedlist/"+t,i).then(function(e){return e.iconName=e.IconName?JSON.parse(e.IconName):{},e})},assignCorpLinksToView:function(t,n){for(var i=angular.copy(n),o=0;o<i.value.length;o++)i.value[o].iconName=i.value[o].iconName?JSON.stringify(i.value[o].iconName):JSON.stringify({});return e.post(this.baseUrl+"assign/"+t,i)},unAssignCorpLinksFromView:function(t){for(var n=angular.copy(t),i=0;i<n.value.length;i++)n.value[i].iconName=n.value[i].iconName?JSON.stringify(n.value[i].iconName):JSON.stringify({});return e.post(this.baseUrl+"unassign/",n)},addCorporateLink:function(t){var n=angular.copy(t);return n.iconName=n.iconName?JSON.stringify(n.iconName):JSON.stringify({}),e.post(this.baseUrl+"addcorporate",n).then(function(e){return e.iconName=e.iconName?JSON.parse(e.iconName):{},e})},addLinkToView:function(t,n,i){var o=angular.copy(n);return o.iconName=o.iconName?JSON.stringify(o.iconName):JSON.stringify({}),e.post(this.baseUrl+"add/"+t+"/"+i,o).then(function(e){return e.iconName=e.iconName?JSON.parse(e.iconName):{},e})},updateLink:function(t,n,i){var o=angular.copy(n);return o.iconName=o.iconName?JSON.stringify(o.iconName):JSON.stringify({}),e.put(this.baseUrl+"/"+t+"/"+i,o).then(function(e){return e.iconName=e.iconName?JSON.parse(e.iconName):{},e})},deleteLink:function(t){return e["delete"](this.baseUrl+t)}},categories:{baseUrl:"api/wizdom/personalLink/categories/",getCategoriesForAdmin:function(t){return e.get(this.baseUrl+"list/admin/"+t)},getCategoriesForUser:function(t){return e.get(this.baseUrl+"list/user/"+t)},getUserCategory:function(t){return e.get(this.baseUrl+"usercategory/get/"+t)},addUserCategory:function(t,n){return e.post(this.baseUrl+"usercategory/add/"+t,n)},updateUserCategory:function(t,n){return e.put(this.baseUrl+"usercategory/update/"+t,n)},deleteUserCategory:function(t){return e["delete"](this.baseUrl+"usercategory/delete/"+t)},getCorporateCategories:function(){return e.get(this.baseUrl+"list/corporate").then(function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].links.length;n++)e[t].links[n].iconName=e[t].links[n].iconName?JSON.parse(e[t].links[n].iconName):{};return e})},getCorporateCategory:function(t){return e.get(this.baseUrl+"corporate/get/"+t)},addCorporateCategory:function(t){return e.post(this.baseUrl+"corporate/add",t)},updateCorporateCategory:function(t){return e.put(this.baseUrl+"corporate/update",t)},deleteCorporateCategory:function(t){return e["delete"](this.baseUrl+"corporate/delete/"+t)},setLinkOrder:function(t,n,i){for(var o=angular.copy(n),r=0;r<o.length;r++)for(var a=0;a<o[r].links.length;a++)o[r].links[a].iconName=o[r].links[a].iconName?JSON.stringify(o[r].links[a].iconName):JSON.stringify({});return e.post(this.baseUrl+"order/set/"+t+"/"+i,o).then(function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].links.length;n++)e[t].links[n].iconName=e[t].links[n].iconName?JSON.parse(e[t].links[n].iconName):{};return e})}}};return t}angular.module("Wizdom365.PersonalLink").factory("personalLinkApi",e),e.$inject=["webapiService"]}(),function(){function e(){function e(e,n){var i,o;_.each(n,function(n){_.each(n.links,function(n){i=n.name,o=n.url,n.smartname=t(e,i),n.smarturl=t(e,o)})})}function t(e,t){try{return t.replace(/\[(\w+)\]/gi,function(t,n){return e[n.toString().toLowerCase()]?e[n.toString().toLowerCase()]:""})}catch(n){return""}}var n={extendLinks:e};return n}angular.module("Wizdom365.PersonalLink").factory("smartWordsService",e),e.$inject=[]}(),function(){function e(e,t){return function(t){var n=e("translate")("DayMonthFormat:MMMM d").split(":")[1];return t?e("date")(new Date(t),n):void 0}}angular.module("Wizdom365.Phonebook").filter("wizdom365PhonebookBirthday",e),e.$inject=["$filter","contextInfo"]}(),function(){function e(){return function(e){return e?new Date(e):void 0}}angular.module("Wizdom365.Phonebook").filter("wizdom365PhonebookDateFilter",e)}(),function(){function e(){return function(e){var t=e.indexOf(':"');if(-1!=t&&t<e.length){t+=2;var n=e.length-1-t;return e.substr(t,n).replace(/[^\w\s-#������]/,"")}return e.replace(/[^\w\s-#������]/,"")}}angular.module("Wizdom365.Phonebook").filter("wizdom365ReplaceSearchTerm",e)}(),function(){function e(e,n){function i(t,n,i){t.webpartId=e.getWebpartId(n),t.editMode=e.isInEditMode(n),e.hideEditCode(n);var o=i.webpartProperties?JSON.parse(i.webpartProperties):null;t.webpartProperties={userProperties:o&&o.userProperties||[],numberOfUsersPerPage:o&&o.numberOfUsersPerPage||5,searchTemplateUrl:o&&o.searchTemplateUrl||"Phonebook/Templates/ViewTemplates/SearchTemplates/advancedSearch.html",resultTemplateUrl:o&&o.resultTemplateUrl||"Phonebook/Templates/ViewTemplates/ResultTemplates/extendedResults.html",resultSource:o&&o.resultSource||"b09a7990-05ea-4af9-81ef-edfab16c4e31",paging:o&&o.paging||"Bottom",predefinedQuery:o&&o.predefinedQuery||"",orderProperties:o&&o.orderProperties||[]}}return{scope:{selectDeselectFn:"=",isSelectedFn:"=",canSelectFn:"=",canDeselectFn:"=",getSelectedUsersFn:"=",removeSelectedUsersFn:"="},template:'<div class="bootstrap-wrapper">\n      <div class="webpart-edit-button-container" ng-if="::editMode">\n                            <button class="editWebpartButton btn" ng-click="editWebpart()" type="button" title=\'{{"Edit Webpart" | translate}}\'>\n                                <span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{"Edit" | translate}}</span>\n                            </button>\n                        </div>\n      <div class="divOuterSearch365 bootstrap-wrapper wt-webpart-phonebook">\n       <div class="phonebook-search" wizdom-include="webpartProperties.searchTemplateUrl"></div>\n       <div class="phonebook-pagination phonebook-paging-top" ng-if="users && users.length < totalUsers && (webpartProperties.paging == \'Top\')">\n        <div class="text-center">\n         <pagination total-items="totalUsers" ng-change="goToPage(currentPage)" ng-model="currentPage" items-per-page="webpartProperties.numberOfUsersPerPage" max-size="5" boundary-links="false" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></pagination>\n        </div>\n       </div>\n       <div class="phonebook-results" ng-if="users && users.length > 0" wizdom-include="webpartProperties.resultTemplateUrl"></div>\n       <div class="phonebook-pagination phonebook-paging-bottom" ng-if="users && users.length < totalUsers && (webpartProperties.paging == \'Both\' || webpartProperties.paging == \'Bottom\')">\n        <div class="text-center">\n         <pagination total-items="totalUsers" ng-change="goToPage(currentPage)" ng-model="currentPage" items-per-page="webpartProperties.numberOfUsersPerPage" max-size="5" boundary-links="false" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></pagination>\n        </div>\n       </div>\n      </div>\n     </div>',link:i,controller:t}}function t(e,t,n,i,o,r,a,l){function s(){if(!e.departments){var n="8ed8c9ea-7052-4c1d-a4d7-b9c10bffea6f";t.terms.getAllTermsById(n).then(function(t){e.departments=t})}if(!e.locations){var i="b49f64b3-4722-4336-9a5c-56c326b344d4";t.terms.getAllTermsById(i).then(function(t){e.locations=t})}if(!e.jobTitles){var o="386095d1-c68d-4c6d-b587-48ddaf1aecc9";t.terms.getAllTermsById(o).then(function(t){e.jobTitles=t})}}function c(){var t=["PreferredName","AccountName","Path","WorkPhone","MobilePhone","WorkEmail","Department","w365Birthday","Interests","w365HireDate","Responsibility","BaseOfficeLocation","Location","JobTitle","SipAddress"];return e.webpartProperties.userProperties&&angular.forEach(e.webpartProperties.userProperties,function(e){t.push(e)}),t}function d(t){var n="";if(e.webpartProperties.predefinedQuery&&(n="("+e.webpartProperties.predefinedQuery+") AND "),e.filters.length>0){var i=_.groupBy(e.filters,function(e){return e.group});$.each(i,function(e,t){n+="(";var i="";$.each(t,function(e,t){n+=i+t.filter,i=" OR "}),n+=") AND "})}return n+t}function u(n,i,o){if(n&&n.length>1){if(!o)return;e.index+=1,t.searchPerson.search(n,e.index,e.webpartProperties.numberOfUsersPerPage,i,e.webpartProperties.resultSource,o,e.webpartProperties.orderProperties).then(function(t){t.index==e.index&&(e.users=t.users,e.totalUsers=t.totalUsers,e.searching=!1,e.usersConverted=t.usersConverted,m.users=t.users,m.totalUsers=t.totalUsers,m.usersConverted=t.usersConverted,m.currentPage=o)},function(t){e.searching=!1;var n=l("translate")("Could not execute the search. Check Webpart settings e.g. 'Order by' property only contains sortable properties like 'FirstName'");a.showErrorMessage(n,!0)})}}e.searching=!1,e.isCollapsed=!0,e.filters=[],e.index=1,e.searchTerm="",e.users=null,e.currentPage=1,e.NoOfSelectedUsers=0;var m={users:null,totalUsers:0,usersConverted:null,currentPage:1};e.selectedUsersIsCollapsed=!1,e.selectDeselectUser=function(t){var n=e.selectDeselectFn(t);return e.getSelectedUsers(),n},e.isSelected=function(t){return e.isSelectedFn(t)},e.canSelect=function(){return e.canSelectFn()},e.canDeselect=function(){return e.canDeselectFn()},e.getSelectedUsers=function(){return e.NoOfSelectedUsers=e.getSelectedUsersFn().length,e.NoOfSelectedUsers},e.showSelectedUsers=function(){e.users=e.getSelectedUsersFn(),e.totalUsers=e.users.length,e.searching=!1,e.usersConverted=void 0,e.selectedUsersIsCollapsed=!1},e.showLastResult=function(){e.users=m.users,e.totalUsers=m.totalUsers,e.usersConverted=m.usersConverted,e.currentPage=m.currentPage},e.collapseSelectedUsers=function(){e.selectedUsersIsCollapsed=!e.selectedUsersIsCollapsed,e.selectedUsersIsCollapsed?(e.totalUsers=0,e.users=null):e.showSelectedUsers()},e.removeSelectedUsers=function(){e.removeSelectedUsersFn(),e.showSelectedUsers()},e.editWebpart=function(){o.open({templateUrl:"Phonebook/Templates/Dialogs/EditWebpart.html",controller:"Wizdom365PhonebookEditWebpartController",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return e.webpartId}}}).result.then(function(t){t&&(e.webpartProperties=t)})},e.showAdvancedSearch=function(){e.isCollapsed=!e.isCollapsed,s()},e.filterSelected=function(t,n,i,o){e.filters.push({label:i,filter:o+':"'+i+'"',group:o}),e.searchUser(e.searchTerm,1)},e.removeFilter=function(t){var n=e.filters.indexOf(t);e.filters.splice(n,1),e.searchUser(e.searchTerm,1)},e.$watch("searchTerm",function(){e.totalUsers=0,e.searchUser(e.searchTerm,e.currentPage)}),e.setSearchTerm=function(t,n){e.searchTerm=t+':"'+n+'"'},e.resetSearch=function(){e.searching=!1,e.users=null},e.searchUser=function(t,n){if(t&&t.length>1){e.searching=!0;var i=d(t),o=c();u(i,o,n)}else e.resetSearch()},e.goToPage=function(t){e.searchUser(e.searchTerm,t)}}angular.module("Wizdom365.Phonebook").directive("wizdom365Phonebook",e),e.$inject=["webpartPropertiesService","contextInfo"],t.$inject=["$scope","webApiProxy","$timeout","$sce","$modal","log","notificationService","$filter"]}(),function(){function e(e){function n(e,t,n){t.children("#powerpanel").affix({offset:{top:50}})}return{scope:{},template:'<div id="powerpanel" ng-class="{\'toggled\':vm.selected}">\n                           <a ng-repeat="panel in ::vm.panels | orderBy: \'sortOrder\'" title="{{vm.getTranslatedText(panel, \'label\')}}" ng-click="vm.handleClick(panel)" class="panel-button" ng-class="{\'selected\': vm.selected === panel}">\n                               <i ng-class="::panel.icon"></i>\n                           </a>\n                       </div>\n                       <div class="powerpanel-filler" style="width: 50px"></div>\n                       <div id="powerpanel-flyout" ng-attr-status="{{ vm.selected ? \'open\' : \'closed\' }}" ng-style="{ \'width\': vm.selected ? vm.selected.width : 0 }" ng-if="vm.selected" class="fade">\n                           <div class="flyout-container" ng-if="vm.selected">\n                               <h1 class="powerpanel-title">\n                                   {{vm.getTranslatedText(vm.selected, \'label\')}}\n                               </h1>\n\n        <div ng-repeat="section in vm.selected.sections | orderBy: \'sortOrder\'" ng-class="{ \'powerpanel-section-webpart-background\': section.useWebpartBackground }" class="powerpanel-section {{ section.layout }} fade1 section-container" ng-if="section.webparts.length">\n         \n         <div class="row">\n          \n          <div class="{{vm.getColumnWidth(section, 1)}}">\n           <div ng-repeat="webpart in section.columns[0] | orderBy: \'sortOrder\'" class="powerpanel-webpart">\n              <div wizdom365-webpart webpart-name="webpart.webpartName" properties="webpart.properties"></div>\n             </div>\n          </div>\n          <div class="{{vm.getColumnWidth(section, 2)}}">\n           <div ng-repeat="webpart in section.columns[1] | orderBy: \'sortOrder\'" class="powerpanel-webpart">\n            <div wizdom365-webpart webpart-name="webpart.webpartName" properties="webpart.properties"></div>\n           </div>\n          </div>\n          <div class="{{vm.getColumnWidth(section, 3)}}">\n           <div ng-repeat="webpart in section.columns[2] | orderBy: \'sortOrder\'" class="powerpanel-webpart">\n            <div wizdom365-webpart webpart-name="webpart.webpartName" properties="webpart.properties"></div>\n           </div>\n          </div>\n\n         </div>\n\n        </div>\n\n                           \n\n                           </div>\n                       </div>\n                       <div class="powerpanel-filler" ng-style="{ \'width\': vm.selected ? vm.selected.width : 0 }"></div>',controller:t,controllerAs:"vm",link:n}}function t(e,t){function n(){t.$$phase||t.$root.$$phase?i.selected=null:t.$apply(function(){i.selected=null}),angular.element("#s4-ribbonrow,#s4-workspace").off("click",n)}var i=this;i.selected=null,e.getPowerpanel().then(function(e){i.panels=e}),i.handleClick=function(e){if(i.selected===e)return void n();var t=$("#powerpanel-flyout");t.scrollTop(0),t.perfectScrollbar(null===i.selected?void 0:"update"),i.selected=i.selectPanel(e),angular.element("#s4-ribbonrow,#s4-workspace").on("click",n)},i.selectPanel=function(e){var t=e;return angular.forEach(t.sections,function(e){var t=e.layout;e.columns=[],e.columns.push([]),e.columns.push([]),e.columns.push([]),angular.forEach(e.webparts,function(n){"1column100"==t?e.columns[0].push(n):"2columns50x50"==t||"2columns33x66"==t||"2columns66x33"==t?1==n.column?e.columns[0].push(n):e.columns[1].push(n):"3columns33x33x33"==t&&(1==n.column?e.columns[0].push(n):2==n.column?e.columns[1].push(n):e.columns[2].push(n))})}),t},i.getColumnWidth=function(e,t){return"1column100"==e.layout?1==t?"col-xs-12":"pp-section-hidden":"2columns50x50"==e.layout?2>=t?"col-xs-6":"pp-section-hidden":"3columns33x33x33"==e.layout?"col-xs-4":"2columns33x66"==e.layout?2>=t?1==t?"col-xs-4":"col-xs-8":"pp-section-hidden":"2columns66x33"==e.layout?2>=t?1==t?"col-xs-8":"col-xs-4":"pp-section-hidden":"col-xs-12"},i.getTranslatedText=function(e,t){return e?e.translatedValue&&e.translatedValue[t]||e.label:e.label}}angular.module("Wizdom365.Powerpanel").directive("wizdom365Powerpanel",e),e.$inject=["$timeout"],t.$inject=["powerpanelApi","$scope"]}(),function(){function e(){return{scope:{webpartName:"=",properties:"="},controller:t}}function t(e,t,n,i){function o(){if(r=t.webpartName,a=t.properties,!t.webpartName)return void i.empty();var n=("string"==typeof t.properties?t.properties:JSON.stringify(t.properties||{})).replace(/"/g,"&quot;").trim(),o="<div "+t.webpartName+' webpart-properties="'+n+'">',s=l.filter(function(e){return-1!==t.webpartName.indexOf(e)});s.length&&(o='<div oc-lazy-load="'+JSON.stringify(s).replace(/"/g,"'")+'">'+o+"</div>"),i.html(e(o)(t))}var r,a,l=n.getModules();t.$watch("webpartName",function(e,t,n){(t!==e||r!==e)&&o()}),t.$watch("properties",function(e,t,n){!e||t===e&&a===e||o()},!0)}angular.module("Wizdom365.Powerpanel").directive("wizdom365Webpart",e),t.$inject=["$compile","$scope","$ocLazyLoad","$element"]}(),function(){function e(){return function(e,t,n){var i=[];return n=n||"eq",angular.forEach(e,function(e){"gt"==n?e.value&&e.value.columnIndex>t&&i.push(e):"lt"==n?e.value&&e.value.columnIndex<t&&i.push(e):"eq"==n&&e.value&&e.value.columnIndex==t&&i.push(e)}),i}}angular.module("Wizdom365.Powerpanel").filter("columnFilter",e),e.$inject=[]}(),function(){function e(e,t,n,i){var o=t.getApplyingConfiguration("Powerpanel"),r=o.ClassicView&&o.ClassicView.id,a=n.language,l=function(e,t){var n={Small:"420px",Medium:"700px",Large:"1200px","Full screen":"calc(100vw - 50px)",Custom:t+"px"};return n[e]};return{getPowerpanel:function(){return r?i.get("api/Wizdom/StructuredContent/v1/personal/"+r+"?language="+a+"&timestamp="+o.Timestamp).then(function(e){var t=e.content;return t?t.children.map(function(e){var t=e.children,n=e.sortOrder,i=e.value,o=e.translatedValue,r=t.map(function(e){var t=e.children,n=e.sortOrder,i=e.value,o=t.map(function(e){var t=e.title,n=e.sortOrder,i=e.value;return{label:t,column:i.columnIndex,webpartName:i.directive,properties:i.webpartProperties,sortOrder:n}}).sort(function(e,t){return e.sortOrder-t.sortOrder});return{layout:i.layout.key.slice(1,-1),useWebpartBackground:!i.noWebpartBackground,sortOrder:n,webparts:o}}).sort(function(e,t){return e.sortOrder-t.sortOrder});return{translatedValue:o,label:i.label,icon:i.icon.icon,width:l(i.widthType,i.width),sortOrder:n,sections:r}}).sort(function(e,t){return e.sortOrder-t.sortOrder}):[]}):e(function(e){return e([])})}}}angular.module("Wizdom365.Powerpanel").factory("powerpanelApi",e),e.$inject=["$q","SpecificConfigurationService","contextInfo","webapiService"]}(),function(){function e(){return{scope:{},template:"<div wizdom-include='::vm.templateUrl' class=\"bootstrap-wrapper\"></div>",controller:t,controllerAs:"vm"}}function t(e,t,n,i,o){function r(e){d.serviceMenu=e,d.servicemenuContainsZeroLinks=c(d.serviceMenu.categories),d.personalizationAllowed=d.serviceMenu.allowPersonalLinks||d.serviceMenu.allowDeleteLinks||d.serviceMenu.allowSortLinks,d.isEmpty=d.servicemenuContainsZeroLinks&&!d.personalizationAllowed}function a(){i.hide(),e.open({templateUrl:"PersonalLink/Templates/Dialogs/EditLinks.html",controller:"PersonalLinkEditLinksDialogController",controllerAs:"vm",windowClass:"bootstrap-wrapper",resolve:{webpart:function(){return angular.copy(d.serviceMenu)}}}).result.then(function(e){e&&(d.serviceMenu=e.webpart,d.LastEditLinkId=null,t.categories.setLinkOrder(d.serviceMenu.viewId,d.serviceMenu.categories,!1).then(function(e){var t=!0;i.show(t)}))})}function l(e){e.fontColor||(e.fontColor="#FFF"),e.backgroundColor||(e.backgroundColor="#555");var t={color:e.fontColor,"background-color":e.backgroundColor,height:"110px",width:"110px"};return t}function s(){return d.serviceMenu&&d.serviceMenu.categories&&(d.serviceMenu.allowPersonalLinks||d.serviceMenu.allowDeleteLinks||d.serviceMenu.allowSortLinks)}function c(e){return!_.some(e,function(e){return _.some(e.links)})}var d=this;d.LastEditLinkId,d.serviceMenu=null,d.isEmpty=null,d.renderIconOrImage=l,d.editServiceMenu=a,d.showEditLinksIcon=s,d.click=function(){i.hide()};var u=n.Servicemenu.Items;d.templateUrl=void 0==u.TemplateUrl?"Servicemenu/Templates/ViewTemplates/simplelist.html":u.TemplateUrl,i.onShow(function(e){r(e)})}angular.module("Wizdom365.Servicemenu").directive("wizdom365Servicemenu",e),t.$inject=["$modal","personalLinkApi","configuration","servicemenuShared","sessionStorageService"]}(),function(){function e(){return{scope:{},template:"<div wizdom-include='::vm.templateUrl' class=\"bootstrap-wrapper\"></div>",controller:t,controllerAs:"vm"}}function t(e,t,n){function i(){$("#SearchBox").length||($(".wizdom-search-container").css({display:"none"}),$(".wizdom-dot-container").css({right:"0"}))}function o(){var e=$('<div id="c-mask" class="c-mask"></div>');$("body").prepend(e),$(".c-mask").click(function(e){$(".wizdom-dot-container").hasClass("is-active")&&($(e.target).closest("#wt-servicemenu").length||n.hide())}),$(document).keyup(function(e){27==e.keyCode&&$(".wizdom-dot-container").hasClass("is-active")&&n.hide()});var t;$(window).resize(function(){t=setTimeout(function(){clearTimeout(t),$("#wt-servicemenu").hasClass("expanded")&&n.hide()},100)}),$("#wt-servicemenu").perfectScrollbar()}function r(){var e=!1;$("#DeltaPlaceHolderSearchArea").focusin(function(){$("#DeltaPlaceHolderSearchArea").stop().addClass("is-active"),$("#searchInputBox").stop().addClass("is-active"),$("#DeltaTopNavigation").addClass("is-hidden")}),$("#DeltaPlaceHolderSearchArea").focusout(function(){e||($("#DeltaPlaceHolderSearchArea").stop().removeClass("is-active"),$("#searchInputBox").stop().removeClass("is-active"),$("#DeltaTopNavigation").removeClass("is-hidden")),e=!1}),$(".ms-qSuggest-container").bind("mousedown",function(){e=!0,$("#DeltaPlaceHolderSearchArea").stop().addClass("is-active"),$("#searchInputBox").stop().addClass("is-active"),$("#DeltaTopNavigation").addClass("is-hidden")})}var a=this;a.templateUrl=t.Servicemenu.TemplateUrl,e.searchbarMode=t.Servicemenu.Searchbar||"None",e.toolbarMode=t.Servicemenu.Toolbar||"None","Expanded"==e.searchbarMode&&r(),"FloatingBottomRight"==e.toolbarMode&&o(),e.init=function(t){i(),angular.isDefined(t)&&t===!1&&n.show(),"None"==e.searchbarMode&&"IntegratedTopSide"==e.toolbarMode&&$(".wizdom-dot-container").css({right:"0"}),"Expanded"==e.searchbarMode&&"IntegratedTopSide"==e.toolbarMode&&($("#DeltaPlaceHolderSearchArea").css({right:"40px"}),$(".wizdom-dot-container").css({right:"0"})),"None"!=e.searchbarMode&&"Collapsed"!=e.searchbarMode||"FloatingBottomRight"!=e.toolbarMode||$("#DeltaPlaceHolderSearchArea").stop().removeClass("v2")},e.dotsButton=function(){n.trigger()},$(document).keyup(function(e){27==e.keyCode&&$("#wt-servicemenu").height()>10&&n.hide()}),n.onAfterShow(function(){var t=$("#dotIcon"),n=$("#afterClickDotsIcon");if(t&&n&&!t.is(":hidden"))if($(t).css({display:"none"}),$(n).css({display:"inline-block"}),"FloatingBottomRight"==e.toolbarMode)$(".wizdom-dot-container").stop().addClass("is-active"),$("#wt-servicemenu").stop().addClass("expanded"),$(".c-mask").addClass("is-active"),$("#s4-workspace").addClass("is-active");else{var i=$("#wt-servicemenu").find("div")[1];i?$("#wt-servicemenu").stop().css({height:i.clientHeight}):$("#wt-servicemenu").stop().css({height:$(".wtsite-service-list").height()+10})}}),n.onHide(function(){var t=$("#dotIcon"),n=$("#afterClickDotsIcon");t&&n&&($(t).css({display:"inline-block"}),$(n).css({display:"none"}),"FloatingBottomRight"==e.toolbarMode?($(".wizdom-dot-container").stop().removeClass("is-active"),$("#wt-servicemenu").stop().removeClass("expanded"),$(".c-mask").removeClass("is-active"),$("#s4-workspace").removeClass("is-active")):$("#wt-servicemenu").stop().css({height:0}))}),e.searchButton=function(){var t=$("#searchIcon"),n=$("#afterClickSearchIcon");t.is(":hidden")?($(t).css({display:"inline-block"}),$(n).css({display:"none"}),"Expanded"==e.searchbarMode?$("#DeltaPlaceHolderSearchArea").stop().removeClass("is-active"):$("#DeltaPlaceHolderSearchArea").stop().css({height:0}),$(".searchIcon").removeClass("glyphicon glyphicon-remove").addClass("glyphicon glyphicon-search")):($(t).css({display:"none"}),$(n).css({display:"inline-block"}),"Expanded"==e.searchbarMode?$("#DeltaPlaceHolderSearchArea").stop().addClass("is-active"):$("#DeltaPlaceHolderSearchArea").stop().css({height:"40px"}),$("#DeltaPlaceHolderSearchArea").find("input").focus())},a.openclose=function(){n.trigger()}}angular.module("Wizdom365.Servicemenu").directive("wizdom365Servicemenubuttons",e),t.$inject=["$scope","configuration","servicemenuShared"]}(),function(){function e(){return{scope:{},template:"<div wizdom-include='::vm.templateUrl' class=\"bootstrap-wrapper\"></div>",controller:t,controllerAs:"vm"}}function t(e,t,n,i){function o(){var e=$('<div id="c-mask" class="c-mask"></div>');$("body").prepend(e),$(".c-mask").click(function(e){$(".wizdom-dot-container").hasClass("is-active")&&($(e.target).closest("#wt-servicemenu").length||i.hide())}),$(document).keyup(function(e){27==e.keyCode&&$(".wizdom-dot-container").hasClass("is-active")&&i.hide()});var t;$(window).resize(function(){t=setTimeout(function(){clearTimeout(t),$("#wt-servicemenu").hasClass("expanded")&&i.hide()},100)}),$("#wt-servicemenu").perfectScrollbar()}function r(){var e=$("#searchMobileIcon"),t=$("#afterClickSearchMobile"),n=!1;$("#DeltaPlaceHolderSearchArea").focusin(function(){$("#DeltaPlaceHolderSearchArea").stop().addClass("is-active"),$("#searchInputBox").stop().addClass("is-active"),$("#DeltaTopNavigation").addClass("is-hidden")}),$("#DeltaPlaceHolderSearchArea").focusout(function(){n||($("#DeltaPlaceHolderSearchArea").stop().removeClass("is-active"),$("#searchInputBox").stop().removeClass("is-active"),$("#DeltaTopNavigation").removeClass("is-hidden"),e.show(),t.hide()),n=!1}),$(".ms-qSuggest-container").bind("mousedown",function(){n=!0,$("#DeltaPlaceHolderSearchArea").stop().addClass("is-active"),$("#searchInputBox").stop().addClass("is-active"),$("#DeltaTopNavigation").addClass("is-hidden")})}var a=this;a.templateUrl=t.Servicemenu.TemplateUrl,r(),o(),e.init=function(e){angular.isDefined(e)&&e===!1&&i.show()},e.dotsButton=function(){i.trigger()},i.onAfterShow(function(){var e=$("#dotIcon"),t=$("#afterClickDotsIcon");e&&t&&!e.is(":hidden")&&($(e).css({display:"none"}),$(t).css({display:"inline-block"}),$(".wizdom-dot-container").stop().addClass("is-active"),$("#wt-servicemenu").stop().addClass("expanded"),$(".c-mask").addClass("is-active"),$("#s4-workspace").addClass("is-active"))}),i.onHide(function(){var e=$("#dotIcon"),t=$("#afterClickDotsIcon");e&&t&&($(e).css({display:"inline-block"}),$(t).css({display:"none"}),$(".wizdom-dot-container").stop().removeClass("is-active"),$("#wt-servicemenu").stop().removeClass("expanded"),$(".c-mask").removeClass("is-active"),$("#s4-workspace").removeClass("is-active"))}),e.searchButton=function(){var e=$("#searchIcon"),t=$("#afterClickSearchIcon");e&&t&&!e.is(":hidden")?($(e).css({display:"none"}),$(t).css({display:"inline-block"}),$("#DeltaPlaceHolderSearchArea").stop().addClass("is-active"),$("#DeltaPlaceHolderSearchArea").find("input").focus()):($(e).css({display:"inline-block"}),$(t).css({display:"none"}),$("#DeltaPlaceHolderSearchArea").stop().removeClass("is-active"),$(".searchIcon").removeClass("glyphicon glyphicon-remove").addClass("glyphicon glyphicon-search"))},a.openclose=function(){i.trigger()}}angular.module("Wizdom365.Servicemenu").directive("wizdom365ServicemenubuttonsV2",e),t.$inject=["$scope","configuration","localStorageService","servicemenuShared"]}(),function(){function e(){return{scope:{},template:"<div wizdom-include='::vm.templateUrl' class=\"bootstrap-wrapper\"></div>",controller:t,controllerAs:"vm"}}function t(e,t,n,i){function o(){$("#SearchBox").length||($(".wizdom-search-mobile-container").css({display:"none"}),$(".wizdom-dot-mobile-container").css({right:$(".wizdom-search-mobile-container").css("right")}))}var r=this;r.templateUrl=t.Servicemenu.TemplateMobileUrl,e.searchbarMode=t.Servicemenu.Searchbar||"None",e.toolbarMode=t.Servicemenu.Toolbar||"None",e.init=function(t){i(o,0),angular.isDefined(t)&&t===!1&&n.show(),"None"==e.searchbarMode&&"None"!=e.toolbarMode&&$(".wizdom-dot-mobile-container").css({right:"40px"}),"Expanded"==e.searchbarMode&&"IntegratedTopSide"==e.toolbarMode&&$("#DeltaPlaceHolderSearchArea").css({right:"0"})},e.dotsButton=function(){n.trigger()},n.onAfterShow(function(){var t=$("#dotsMobileIcon"),n=$("#afterClickDotsMobile");if(t&&n&&!t.is(":hidden"))if(t.hide(),n.show(),"FloatingBottomRight"==e.toolbarMode)$(".wizdom-dot-mobile-container").stop().addClass("is-active"),"None"==e.searchbarMode&&$(".wizdom-dot-mobile-container").stop().css({right:"auto"}),$("#wt-servicemenu").stop().addClass("expanded"),$(".c-mask").addClass("is-active"),$("#s4-workspace").addClass("is-active");else var i=20,o=setInterval(function(){($(".wtsite-service-list").length>0||--i<0)&&(clearInterval(o),$("#wt-servicemenu").stop().css({height:$(".wtsite-service-list").height()+20}))},5)}),n.onHide(function(){var t=$("#dotsMobileIcon"),n=$("#afterClickDotsMobile");t&&n&&(t.show(),n.hide(),"FloatingBottomRight"==e.toolbarMode?($(".wizdom-dot-mobile-container").stop().removeClass("is-active"),"None"==e.searchbarMode&&$(".wizdom-dot-mobile-container").stop().css({right:"40px"}),$("#wt-servicemenu").stop().removeClass("expanded"),$(".c-mask").removeClass("is-active"),$("#s4-workspace").removeClass("is-active")):$("#wt-servicemenu").stop().css({height:0}))}),e.searchButton=function(){var t=$("#searchMobileIcon"),n=$("#afterClickSearchMobile");if(t.is(":hidden"))t.show(),n.hide(),$("#DeltaPlaceHolderSearchArea").stop().css({height:0}),$(".searchIcon").removeClass("glyphicon glyphicon-remove").addClass("glyphicon glyphicon-search");else{t.hide(),n.show();var i="0";i="FloatingBottomRight"==e.toolbarMode?"37px":"40px",$("#DeltaPlaceHolderSearchArea").stop().css({height:i}),"Expanded"==e.searchbarMode&&"IntegratedTopSide"==e.toolbarMode&&$("#DeltaPlaceHolderSearchArea").css({right:"0"}),$("#DeltaPlaceHolderSearchArea").find("input").focus()}}}angular.module("Wizdom365.Servicemenu").directive("wizdom365Servicemenumobilebuttons",e),t.$inject=["$scope","configuration","servicemenuShared","$timeout"]}(),function(){function e(){return{scope:{},template:"<div wizdom-include='::vm.templateUrl' class=\"bootstrap-wrapper\"></div>",controller:t,controllerAs:"vm"}}function t(e,t,n,i){function o(){$("#SearchBox").length||($(".wizdom-search-mobile-container").css({display:"none"}),$(".wizdom-dot-mobile-container").css({right:$(".wizdom-search-mobile-container").css("right")}))}var r=this;r.templateUrl=t.Servicemenu.TemplateMobileUrl,i(o,0),e.dotsButton=function(){n.trigger()},n.onAfterShow(function(){var e=$("#dotsMobileIcon"),t=$("#afterClickDotsMobile");e&&t&&!e.is(":hidden")&&(e.hide(),t.show(),$(".wizdom-dot-mobile-container").stop().addClass("is-active"),$("#wt-servicemenu").stop().addClass("expanded"),$(".c-mask").addClass("is-active"),$("#s4-workspace").addClass("is-active"))}),n.onHide(function(){var e=$("#dotsMobileIcon"),t=$("#afterClickDotsMobile");e&&t&&(e.show(),t.hide(),$(".wizdom-dot-mobile-container").stop().removeClass("is-active"),$("#wt-servicemenu").stop().removeClass("expanded"),$(".c-mask").removeClass("is-active"),$("#s4-workspace").removeClass("is-active"))}),e.searchButton=function(){var e=$("#searchMobileIcon"),t=$("#afterClickSearchMobile");e&&t&&!e.is(":hidden")?(e.hide(),t.show(),$("#DeltaPlaceHolderSearchArea").stop().css({height:"37px"}),$("#DeltaPlaceHolderSearchArea").find("input").focus()):(e.show(),t.hide(),$("#DeltaPlaceHolderSearchArea").stop().css({height:0}),$(".searchIcon").removeClass("glyphicon glyphicon-remove").addClass("glyphicon glyphicon-search"))}}angular.module("Wizdom365.Servicemenu").directive("wizdom365ServicemenumobilebuttonsV2",e),t.$inject=["$scope","configuration","servicemenuShared","$timeout"]}(),function(){function e(e,t,n,i,o){function r(){return JSON.parse(i.getItem(s.cacheKey))}function a(e){e.timestamp=new Date,i.setItem(s.cacheKey,JSON.stringify(e))}function l(e){var t=new Date(e),n=new Date,i=5,o=new Date(t.getTime()+6e4*i);return o>n}var s=this;return s.onShowCallbacks=[],s.onAfterShowCallbacks=[],s.onHideCallbacks=[],s.isOpen=!1,s.cacheKey="ServicemenuV1",this.trigger=function(){s.isOpen?s.hide():s.show()},this.onShow=function(e){s.onShowCallbacks.push({invoke:e})},this.onAfterShow=function(e){s.onAfterShowCallbacks.push({invoke:e})},this.show=function(t){void 0===t&&(t=!1);var i=r();i&&l(i.timestamp)&&!t?(angular.forEach(s.onShowCallbacks,function(e){e.invoke(i)}),e(function(){angular.forEach(s.onAfterShowCallbacks,function(e){e.invoke(i)})},0)):s.getData(n.Servicemenu.Items.ViewId).then(function(t){angular.forEach(s.onShowCallbacks,function(e){e.invoke(t)}),e(function(){angular.forEach(s.onAfterShowCallbacks,function(e){e.invoke(t)})},0),a(t)}),s.isOpen=!0},this.onHide=function(e){s.onHideCallbacks.push({invoke:e})},this.hide=function(){s.isOpen=!1,angular.forEach(s.onHideCallbacks,function(e){e.invoke()})},this.getData=function(e){return o.views.getOrAddView(e,!1)},this}angular.module("Wizdom365").factory("servicemenuShared",e),e.$inject=["$timeout","localStorageService","configuration","sessionStorageService","personalLinkApi"]}(),function(){angular.module("Wizdom365.ServiceTickets").filter("start",function(){return function(e,t){return e&&e.length?(t=+t,e.slice(t)):void 0}}),angular.module("Wizdom365.ServiceTickets").filter("module",function(){return function(e){var t=[];if(!e||!e.length)return t;for(var n=0;n<e.length;n++)"black"==e[n].color&&t.push(e[n]);return t}}),angular.module("Wizdom365.ServiceTickets").filter("cardstatus",function(){return function(e,t){if(!e||!e.length)return"";for(var n=0;n<e.length;n++)if(e[n].id==t){var i=e[n].name;return void 0!=i&&(i.search(/high/gi)>-1?i="High Priority":i.search(/medium/gi)>-1?i="Medium Priority":i.search(/low/gi)>-1?i="Low Priority":i.search(/done/gi)>-1&&(i="Done")),i}return""}})}(),angular.module("Wizdom365.ServiceTickets").directive("wizdom365ServiceticketsOverview",[function(){return{scope:{},template:'<div class="bootstrap-wrapper">\n                            <div class="wizdom-service-tickets">\n                                <div class="webpart-edit-button-container" ng-if="editMode">\n                                    <button class="editWebpartButton btn" ng-click="editWebpart()" type="button" title=\'{{"Edit Webpart" | translate}}\'>\n                                        <span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{"Edit" | translate}}</span>\n                                    </button>\n                                </div>\n                                <div wizdom-include=\'webpartProperties.templateUrl\'></div>\n                            </div>\n                        </div>',link:function(e,t,n){},controller:["$scope","$element","$attrs","webpartPropertiesService","$http","contextInfo","serviceTicketsApi","$modal","$interval","sessionStorageService",function(e,t,n,i,o,r,a,l,s,c){function d(){a.getModules().then(function(t){e.modules=t})}function u(){a.getStatuses().then(function(t){e.statuses=t})}function m(){d(),u(),e.searchCards(e.searchParam)}e.webpartId=i.getWebpartId(t);var p=n.webpartProperties?JSON.parse(n.webpartProperties):null;e.webpartProperties={templateUrl:p&&p.templateUrl||"ServiceTickets/Templates/ViewTemplates/DefaultView.html"},i.hideEditCode(t),e.editMode=i.isInEditMode(t),e.editWebpart=function(){l.open({templateUrl:"ServiceTickets/Templates/Dialogs/EditWebpart.html",controller:"serviceTicketsEditCtrl",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return e.webpartId},webpartProperties:function(){return e.webpartProperties}}}).result.then(function(t){t&&(e.webpartProperties=t,m())})},e.numPerPage=20,e.onlyMe=!1,e.searchParam=e.searchParam||{searchText:"",moduleName:"",cardStatus:"",userEmail:"",advanceSearch:!1},e.setcurrentPage=function(t){e.currentPage=t},e.searchCards=function(t,n){e.loading=!0,n?e.searchParam.userEmail=window._spPageContextInfo.userEmail:e.searchParam.userEmail="",a.getCards(t).then(function(t){e.cards=t.cards,e.currentPage=e.currentPage||1,e.totalPages=Math.ceil(e.cards.length/e.numPerPage),e.loading=!1})},e.advanceSearchCards=function(t){e.searchParam.advanceSearch=!e.searchParam.advanceSearch,e.searchCards(t)},e.doSearch=function(t,n){var i=t.which||t.keyCode;13===i&&e.searchCards(n)},e.showDetail=function(t){return l.open({templateUrl:"ServiceTickets/Templates/ViewTemplates/CardDetail.html",controller:"serviceTicketsCardDetailCtrl",windowClass:"bootstrap-wrapper",resolve:{card:function(){return t},statuses:function(){return e.statuses}}}).result.then(function(e){}),!1},m()}]}}]),function(){function e(e,t,n,i){var o={baseUrl:"api/wizdom/documentation/tickets",authorizationCheck:function(t){return t&&t.error?(-1===i.appUrl.indexOf("://localhost")&&n.showErrorMessage(t.error,!1,!0),e.reject(t)):t},getCards:function(e){return e={searchText:e.searchText||"",moduleName:1==e.advanceSearch?e.moduleName||"":"",cardStatus:1==e.advanceSearch?e.cardStatus||"":"",userEmail:1==e.advanceSearch?e.userEmail||"":""},t.get(this.baseUrl+"/searchCards?searchText="+e.searchText+"&moduleName="+e.moduleName+"&status="+e.cardStatus+"&userEmail="+e.userEmail).then(this.authorizationCheck)},getModules:function(){return t.getAppCached(this.baseUrl+"/getModules").then(this.authorizationCheck)},getSwimlaneNameById:function(e){return t.getAppCached(this.baseUrl+"/getSwimlaneNameById?id="+e).then(this.authorizationCheck)},getSwimlanes:function(){return t.getAppCached(this.baseUrl+"/getAllTrelloListsOfBoard").then(this.authorizationCheck)},getStatuses:function(){return t.getAppCached(this.baseUrl+"/getStatuses").then(this.authorizationCheck)}};return o}angular.module("Wizdom365.ServiceTickets").factory("serviceTicketsApi",e),e.$inject=["$q","webapiService","notificationService","contextInfo"]}(),angular.module("Wizdom365.ServiceTickets").controller("serviceTicketsCardDetailCtrl",["$scope","$timeout","serviceTicketsApi","webpartPropertiesService","$modalInstance","card","statuses",function(e,t,n,i,o,r,a){e.loading=!0,e.data=angular.copy(r),e.data.statuses=a,e.loading=!1,e.cancel=function(){o.dismiss("cancel")}}]),function(){function e(){return{template:'<span ng-show="ShowTeamSiteAddPageButton" class="ms-promotedActionButton">\n                            <a ng-click="addWizdomPage();" class="ms-heroCommandLink">\n                                <span title="{{\'New Wizdom page\' | translate}}" class="ms-Icon ms-Icon--CalculatorAddition">            \n                                </span>\n                            </a>\n                        </span>\n                        ',controller:t}}function t(e,t,n,i){var o=i.wizdomClientSideFeatureToggles;e.ShowTeamSiteAddPageButton=t.sitePagesEnabled&&"true"==o.ShowTeamSiteAddPageButton,-1!=window.location.href.indexOf("#showWizdomPageCreatedDialog")&&(window.location.href=window.location.href.replace("showWizdomPageCreatedDialog",""),n.open({templateUrl:"TemplateManager/Templates/Dialogs/PageCreated.html",controller:"PageCreatedController",windowClass:"bootstrap-wrapper"})),e.addWizdomPage=function(){n.open({templateUrl:"TemplateManager/Templates/Dialogs/CreatePage.html",controller:"Wizdom365CreatePageController",windowClass:"bootstrap-wrapper"})}}angular.module("Wizdom365").directive("wizdom365TemplateManagerPanel",e),t.$inject=["$scope","contextInfo","$modal","$window"]}(),function(){function e(){return{scope:{},template:'<div class="bootstrap-wrapper"><span ng-show="ShowDefaultBtn" class="ms-textXLarge ms-vl-appnewsubsitelink"><a id="createnewsite" ng-href="{{spWebUrl + \'/_layouts/15/newsbweb.aspx\'}}" class="ms-heroCommandLink"><span class="ms-list-addnew-imgSpan20"><img class="ms-list-addnew-img20" alt src="/_layouts/15/images/spcommon.png?rev=38"></span>{{\'New subsite\' | translate}}</a></span> <span ng-show="ShowCreateBtn" class="ms-textXLarge ms-vl-appnewsubsitelink">&nbsp; <a ng-click="createSite();" href class="ms-heroCommandLink"><span class="ms-list-addnew-imgSpan20"><img class="ms-list-addnew-img20" alt src="/_layouts/15/images/spcommon.png?rev=38"></span>{{\'New Wizdom subsite\' | translate}}</a></span> <span ng-show="ShowApplyBtn" class="ms-textXLarge ms-vl-appnewsubsitelink">&nbsp; <a ng-click="applyTemplate();" href class="ms-heroCommandLink"><span class="ms-list-addnew-imgSpan20"><img class="ms-list-addnew-img20" alt src="/_layouts/15/images/spcommon.png?rev=38"></span>{{\'Apply Wizdom template\' | translate}}</a></span> <span ng-show="ShowTeamSiteAddPageButton" class="ms-textXLarge ms-vl-appnewsubsitelink">&nbsp; <a ng-click="addWizdomPage();" href class="ms-heroCommandLink"><span class="ms-list-addnew-imgSpan20"><img class="ms-list-addnew-img20" alt src="/_layouts/15/images/spcommon.png?rev=38"></span>{{\'New Wizdom page\' | translate}}</a></span></div>',controller:t}}function t(e,t,n,i,o,r){e.spWebUrl=n.spWebUrl,e.ShowDefaultBtn="true"==t.TemplateManager.ShowDefaultBtn,e.ShowCreateBtn="true"==t.TemplateManager.ShowCreateBtn,e.ShowApplyBtn="true"==t.TemplateManager.ShowApplyBtn,e.ShowTeamSiteAddPageButton=!1,e.createSite=function(){i.open({templateUrl:"TemplateManager/Templates/Dialogs/Create.html",controller:"Wizdom365TemplateManagerCreateSiteController",windowClass:"bootstrap-wrapper"})},e.applyTemplate=function(){i.open({templateUrl:"TemplateManager/Templates/Dialogs/Apply.html",controller:"Wizdom365TemplateManagerApplyTemplateController",windowClass:"bootstrap-wrapper"})},e.addWizdomPage=function(){i.open({templateUrl:"TemplateManager/Templates/Dialogs/CreatePage.html",controller:"Wizdom365CreatePageController",windowClass:"bootstrap-wrapper"})};var a=o.wizdomClientSideFeatureToggles;e.ShowTeamSiteAddPageButton=n.sitePagesEnabled&&"true"==a.ShowTeamSiteAddPageButton}angular.module("Wizdom365.TemplateManager").directive("wizdom365TemplateManager",e),t.$inject=["$scope","configuration","contextInfo","$modal","$window","webApiProxy"]}(),function(){function e(e){var t={templates:{baseUrl:"api/wizdom/templateManager/templates",getTemplates:function(t,n){var i="?includeHidden="+(angular.isUndefined(t)?!1:t);return i+="&filterBySharepointWeb="+(angular.isUndefined(n)?!0:n),e.get(this.baseUrl+i)},getModernOnlyTemplates:function(t,n){var i="?includeHidden="+(angular.isUndefined(t)?!1:t);return i+="&filterBySharepointWeb="+(angular.isUndefined(n)?!0:n),e.get(this.baseUrl+i+"&filter=modernonly")},getSharePointTemplates:function(t){return e.get(this.baseUrl+"/SharePoint?webUrl="+t)}},siteProvisioning:{baseUrl:"api/wizdom/templateManager/SiteProvisioning",applyTemplate:function(t){return e.post(this.baseUrl+"/applytemplate",t)},createSite:function(t){return e.post(this.baseUrl+"/createsite",t)},getApplyError:function(t){return e.get(this.baseUrl+"/error/"+t)},getApplyStatus:function(t){return e.get(this.baseUrl+"/status/"+t)}},pageProvisioning:{baseUrl:"api/wizdom/accelerate",getTemplates:function(){return e.get(this.baseUrl+"/PageTemplates")},deployPageToNonPublishingWeb:function(t){return e.post(this.baseUrl+"/DeployPageToNonPublishingWeb",t)},getApplyStatus:function(t){return e.get(this.baseUrl+"/status/"+t)}}};return t}angular.module("Wizdom365.TemplateManager").factory("templateManagerApi",e),e.$inject=["webapiService"]}(),function(){function e(e,t,n,i,o,r,a,l){e.templates=[],e.selectedTemplate=null,e.pageState="loadingTemplate",e.spWebUrl=n.spWebUrl,e.cancel=function(){r.dismiss("cancel")};var s=function(n,o){e.progress=1*o,"working"==e.pageState&&(0>1*o?t.siteProvisioning.getApplyError(n).then(function(t){e.pageState="siteInfo"}):100>1*o&&i(function(){t.siteProvisioning.getApplyStatus(n).then(function(e){s(n,e)})},500))};e.validateSiteInfo=function(){e.progress=0,e.pageState="working";var r=l.newGuid();s(r,0);var a={processId:r,template:e.selectedTemplate,currentWebUrl:n.spWebUrl};t.siteProvisioning.applyTemplate(a).then(function(t){i(function(){e.pageState="done",document.location.href=t.url},1e3)},function(t){e.pageState="siteInfo",o("error",t)})},t.templates.getTemplates().then(function(t){e.pageState="siteInfo",e.templates=t,e.templates&&(e.selectedTemplate=e.templates[0])})}angular.module("Wizdom365.TemplateManager").controller("Wizdom365TemplateManagerApplyTemplateController",e),e.$inject=["$scope","templateManagerApi","contextInfo","$timeout","log","$modalInstance","notificationService","guidGenerator"]}(),function(){function e(e,t,n,i,o,r,a,l,s){e.spWebUrl=n.spWebUrl,e.templates=[],e.selectedTemplate=null,e.pageState="siteInfo",e.pageTitle="",e.cancel=function(){r.dismiss("cancel")},t.pageProvisioning.getTemplates().then(function(t){e.templates=t,angular.forEach(e.templates,function(e){e.displayName=s("translate")(e.displayName)}),e.selectedTemplate=e.templates[0]}),e.createPage=function(){e.progress=0,e.pageState="working";var n=l.newGuid(),r={processId:n,layoutName:e.selectedTemplate.templateName,pageTitle:e.pageTitle};d(n),t.pageProvisioning.deployPageToNonPublishingWeb(r).then(function(t){i.cancel(c),e.pageState="redirecting",e.progress=100,i(function(){u()},1e3)},function(t){i.cancel(c),e.pageState="siteInfo",t.responseText.indexOf("A page with the same name already exist")>0&&a.showErrorMessage(s("translate")("A page with the same name already exist")),o("error",t)})};var c,d=function(n){c=i(function(){t.pageProvisioning.getApplyStatus(n).then(function(t){e.progress=1*t.PercentDone,1*t.PercentDone<100&&d(n)})},500)},u=function(){document.location.href=n.spWebUrl+"/SitePages/"+e.pageTitle+".aspx?ControlMode=Edit&DisplayMode=Design#showWizdomPageCreatedDialog"}}angular.module("Wizdom365.TemplateManager").controller("Wizdom365CreatePageController",e),e.$inject=["$scope","templateManagerApi","contextInfo","$timeout","log","$modalInstance","notificationService","guidGenerator","$filter"]}(),function(){function e(e,t,n,i,o,r,a,l){e.pageState="loadingTemplate",e.spWebUrl=n.spWebUrl,e.templates=[],e.selectedTemplate=null,e.cancel=function(){r.dismiss("cancel")},e.site={title:"",description:"",url:"",useUniquePermissions:!1,useParentNavigation:!0};var s=function(n,o){e.progress=1*o,"working"==e.pageState&&(0>1*o?t.siteProvisioning.getApplyError(n).then(function(t){e.pageState="siteInfo",a.showErrorMessage(t)}):100>1*o&&i(function(){t.siteProvisioning.getApplyStatus(n).then(function(e){s(n,e)})},3e3))};e.createSite=function(){e.progress=0,e.pageState="working";var r=l.newGuid();s(r,0);var a=angular.extend({processId:r,template:e.selectedTemplate,currentWebUrl:n.spWebUrl},e.site);t.siteProvisioning.createSite(a).then(function(t){t.success&&i(function(){e.pageState="done",document.location.href=t.url},1e3)},function(t){e.pageState="siteInfo",o("error",t)})},e.updateURLName=function(){var t=e.site.title.replace(/ /g,"_").replace(/ø/gi,"oe").replace(/æ/gi,"ae").replace(/å/gi,"aa");e.site.url=encodeURIComponent(t).replace(/%/g,"_")},t.templates.getTemplates().then(function(t){e.pageState="siteInfo",e.templates=[],angular.forEach(t,function(t){"WizdomSite"==t.name?e.templates.unshift(t):e.templates.push(t)}),e.templates&&(e.selectedTemplate=e.templates[0])})}angular.module("Wizdom365.TemplateManager").controller("Wizdom365TemplateManagerCreateSiteController",e),e.$inject=["$scope","templateManagerApi","contextInfo","$timeout","log","$modalInstance","notificationService","guidGenerator"]}(),function(){function e(e,t){e.close=function(){t.dismiss("cancel")}}angular.module("Wizdom365.TemplateManager").controller("PageCreatedController",e),e.$inject=["$scope","$modalInstance"]}(),function(){function e(){return{scope:{},template:'<div class="bootstrap-wrapper"><div class="wizdom-weather"><div class="webpart-edit-button-container" ng-if="editMode"><button class="editWebpartButton btn" ng-click="editWebpart()" type="button" title=\'{{"Edit Webpart" | translate}}\'><span class="ms-Icon ms-Icon--Edit"></span><span class="editWebpartButtonText">{{"Edit" | translate}}</span></button></div><div wizdom-include="webpartProperties.templateUrl"></div></div></div>',controllerAs:"Weather",controller:t}}function t(e,t,n,i,o,r,a,l,s,c,d,u,m,p,g,f){function h(){o.webpartId=e.getWebpartId(n);var i=t.webpartProperties?JSON.parse(t.webpartProperties):null;o.webpartProperties={templateUrl:i&&i.templateUrl||"Weather/Templates/ViewTemplates/FiveDaysView.html",locationType:i&&i.locationType||"fixed",fixedCity:i&&i.fixedCity||{id:2618425,name:"Copenhagen",country:"DK",coord:{lon:12.56553,lat:55.675941}},fallbackCity:i&&i.fallbackCity||{id:2618425,name:"Copenhagen",country:"DK",coord:{lon:12.56553,lat:55.675941}},allowManageLocation:i&&i.allowManageLocation||!1,temperatureUnit:i&&i.temperatureUnit||"metric"},o.editMode=e.isInEditMode(n),e.hideEditCode(n)}function w(e){o.userConfiguration=$(),o.userConfiguration||(o.userConfiguration={fixedCity:o.webpartProperties.fixedCity,temperatureUnit:o.webpartProperties.temperatureUnit}),v(),b(e)}function v(){"fixed"==o.webpartProperties.locationType&&o.webpartProperties.fixedCity&&!D(o.suggestedLocations,o.webpartProperties.fixedCity)&&o.suggestedLocations.push(o.webpartProperties.fixedCity)}function b(e){if(o.webpartProperties.allowManageLocation&&o.userConfiguration.fixedCity)C(o.userConfiguration.fixedCity);else if("fixed"==o.webpartProperties.locationType)C(o.webpartProperties.fixedCity);else{var t=null;e||(t=z()),t?C(t):i.getUserLocation().then(function(e){o.suggestedLocations=[],null!==e&&void 0!==e&&""!==e&&o.suggestedLocations.push({id:1,name:e,favorite:!1});var t=null;t=null===e||void 0===e||""===e?o.webpartProperties.fixedCity?o.webpartProperties.fixedCity:o.webpartProperties.fallbackCity:{id:1,name:e},U(t),C(t)})}}function C(e){var t=P(e);t?(y(t),L.data=t,I()):e&&e.name&&e.country?i.getWeatherByCityName(e.name+","+e.country,o.userConfiguration.temperatureUnit).then(function(t){var n=t.data;t.success&&n.list.length>0?x(e,n):n.errorMessage=t.errorMessage,y(n),L.data=n,I()}):e!==o.webpartProperties.fixedCity?C(o.webpartProperties.fixedCity):e==o.webpartProperties.fixedCity&&C(o.webpartProperties.fallbackCity)}function y(e){var t=o.userConfiguration.temperatureUnit;switch(t){case"metric":e.tempUnit="C";break;case"imperial":e.tempUnit="F";break;case"standard":e.tempUnit="K";break;default:e.tempUnit="",p("Weather: Unknown temperature unit '"+t+"'")}angular.forEach(e.list,function(e,t){e.weekDay=new Date(e.date).toLocaleDateString("en-us",{weekday:"short"}).replace(String.fromCharCode(8206),"").substring(0,3)})}function I(){if(o.webpartProperties.allowManageLocation){var e={content:"",trigger:"click",autoClose:!0,placement:"auto bottom",template:"Weather/Templates/Dialogs/Tooltipbox.html",scope:o,html:!0};g(function(){M=M||u(angular.element(document.querySelector("#lnkLocation_"+o.webpartId)),e)}),angular.element(f).bind("resize",function(){M.hide()})}}function S(){i.getFavourites().then(function(e){o.favoriteLocations=e,k()},function(e){var t=c("translate")("Could not load favourites.");s.showErrorMessage(t,!0)})}function k(){for(var e=0;e<o.suggestedLocations.length;e++)o.suggestedLocations[e].favorite=D(o.favoriteLocations,o.suggestedLocations[e]);for(var t=0;t<o.cities.length;t++)o.cities[t].favorite=D(o.favoriteLocations,o.cities[t])}function P(e){var t=T(e),n=m.local,i=JSON.parse(n.getItem("weatherCache_"+t));return i}function x(e,t){var n=T(e),i=m.local;i.setItem("weatherCache_"+n,JSON.stringify(t),(new Date).getTime()+36e5)}function T(e){return o.webpartId+"_"+e.name+"_"+(o.userConfiguration.temperatureUnit||o.webpartProperties.temperatureUnit)}function U(e){return m.local.setItem("weatherCache_userLocation_"+d.userLoginName,JSON.stringify(e),(new Date).getTime()+432e5)}function z(){return JSON.parse(m.local.getItem("weatherCache_userLocation_"+d.userLoginName))}function $(){var e=N(),t=localStorage.getItem(e);return t?JSON.parse(t):null}function A(e){if(e){var t=N();localStorage.setItem(t,JSON.stringify(e))}}function N(){return"weatherwebpart_"+o.webpartId}function D(e,t){for(var n=0;n<e.length;n++)if(t.id==e[n].id)return!0;return!1}h();var L=this;L.data=null,o.cities=o.cities||[],o.searching=o.searching||!1,o.searchCity="",o.favoriteLocations=o.favoriteLocations||[],o.suggestedLocations=o.suggestedLocations||[],o.userConfiguration={},o.editWebpart=function(){r.open({templateUrl:"Weather/Templates/Dialogs/EditWebpart.html",controller:"weatherEditCtrl",windowClass:"bootstrap-wrapper",resolve:{webpartId:function(){return o.webpartId},webpartProperties:function(){return o.webpartProperties}}}).result.then(function(e){e&&(o.webpartProperties=e,o.webpartPropertiesCopy=angular.copy(e),w(!0))})},w(!1);var M=null;o.$watch("searchCity",function(){o.searchCityList(o.searchCity)}),o.searchCityList=function(e){e&&e.length>2?(o.searching=!0,i.searchCity(e).then(function(e){o.cities=e,o.searching=!1,k()},function(e){o.searching=!1;var t=c("translate")("Could not execute the search.");s.showErrorMessage(t,!0)})):o.resetSearch()},o.resetSearch=function(){o.searching=!1,o.cities=[]},o.selectCity=function(e){o.selectedCity=e,o.searchCity="",o.locationChanged(e)},o.setGeoLocation=function(){if(navigator.geolocation)navigator.geolocation.getCurrentPosition(function(e){p("GEO location:",e),i.getWeatherByPosition(e.coords.latitude,e.coords.longitude,o.webpartProperties.temperatureUnit).then(function(e){o.selectCity(e.data.city)})},function(e){p("Failed to get GEO location:",e);var t=c("translate")("Failed to get GEO location:");s.showErrorMessage(t+e.toString(),!0)});else{p("GEO location isn't supported by browser");var e=c("translate")("GEO location isn't supported by browser");s.showErrorMessage(e,!0)}},o.temperatureUnitChanged=function(e){o.userConfiguration.temperatureUnit=e,A(o.userConfiguration),b(!1),M.hide()},o.locationChanged=function(e){o.userConfiguration.fixedCity=e,A(o.userConfiguration),b(!1),M.hide()},o.loadFav=function(){S(),k()},o.addFavourite=function(e){i.addFavourite(e).then(function(){S(),k()},function(e){var t=c("translate")("Could not add favourites.");s.showErrorMessage(t,!0)})},o.removeFavourite=function(e){i.removeFavourite(e).then(function(){S(),k()},function(e){var t=c("translate")("Could not delete favourites.");s.showErrorMessage(t,!0)})},o.toggleFavorite=function(e){void 0!=e.favorite&&1==e.favorite?o.removeFavourite(e):o.addFavourite(e)}}angular.module("Wizdom365.Weather").directive("wizdom365Weather",e),e.$inject=[],t.$inject=["webpartPropertiesService","$attrs","$element","weatherApi","$scope","$modal","$templateCache","$compile","notificationService","$filter","contextInfo","$popover","clientStorageService","log","$timeout","$window"]}(),function(){function e(e){var t={baseUrl:"api/wizdom/weather",getWeatherByCityName:function(t,n){return e.get(this.baseUrl+"?cityName="+t+"&units="+n)},getWeatherByCityId:function(t,n){return e.get(this.baseUrl+"?cityId="+t+"&units="+n)},getWeatherByPosition:function(t,n,i){return e.get(this.baseUrl+"?latitude="+t+"&longitude="+n+"&units="+i)},getUserLocation:function(){return e.getAppCached(this.baseUrl+"/userLocation")},searchCity:function(t){return e.get(this.baseUrl+"/cityList/"+t)},getFavourites:function(){return e.get(this.baseUrl+"/getFavourite/")},addFavourite:function(t){return e.post(this.baseUrl+"/addFavourite/",t)},removeFavourite:function(t){return e.post(this.baseUrl+"/removeFavourite/",t)},validateKey:function(){return e.get(this.baseUrl+"/validateKey")}};return t}angular.module("Wizdom365.Weather").factory("weatherApi",e),e.$inject=["webapiService"]}(),function(){function e(e,t,n){e.imgUrl=n,e.close=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}angular.module("Wizdom365").controller("Wizdom365ShowImageController",e),e.$inject=["$scope","$modalInstance","imgUrl"]}(),function(){function e(e,t,n,i,o,r,a){function l(t){e.termsTreeData=t,angular.forEach(r,function(t){var n={name:t.label,isAvailableForTagging:angular.isDefined(t.isAvailableForTagging)?t.isAvailabeForTagging:!0,id:angular.isDefined(t.filter)?t.filter.substring(t.filter.indexOf("|")+1):angular.isDefined(t.id)?t.id:"undefined"};o?e.selectedTerms.push(n):e.selectedTerm=n})}function s(){var t,n=[],i=e.termsTreeData;!o&&angular.isDefined(e.selectedTerm.id)?n.push(e.selectedTerm):n=e.selectedTerms;var r=u(i,[],"");for(t=0;t<n.length;t++){var a=_.find(r,{id:n[t].id});angular.isDefined(a)&&angular.isDefined(a.id)&&c(a,r)}}function c(e,t){if(d(e),""!==e.parent){var n=_.find(t,{id:e.parentId});angular.isDefined(n)&&c(n,t)}}function d(t){_.find(e.expandedNodes,{id:t.id})||e.expandedNodes.push({id:t.id,name:t.name,isAvailableForTagging:t.isAvailableForTagging})}function u(e,t,n){var i;for(i=0;i<e.length;i++){var o={id:e[i].id,name:e[i].name,parentId:n,isAvailableForTagging:e[i].isAvailableForTagging};t.push(o),e[i].children.length>0&&u(e[i].children,t,o.id)}return t}e.selectedTerms=[],e.selectedTerm={},e.expandedNodes=[],e.treeOptions={nodeChildren:"children",dirSelectable:!0,multiSelection:o,isSelectable:function(e){return e.isAvailableForTagging}},e.loading=!0,e.errorState=!1,a?t.terms.getAllTermsWithChildrenByFieldName(a).then(function(t){l(t),s(),e.loading=!1},function(t){e.loading=!1,e.errorState=!0}):t.terms.getAllTermsWithChildrenById(n).then(function(t){l(t),s(),e.loading=!1},function(t){e.loading=!1,e.errorState=!0}),e.nodeSelected=function(e,t,n){},e.cancel=function(){i.dismiss("cancel")},e.save=function(){o||e.selectedTerms.push(e.selectedTerm),i.close(e.selectedTerms)}}angular.module("Wizdom365").controller("Wizdom365TaxonomyPickerTreeController",e),e.$inject=["$scope","webApiProxy","termsetId","$modalInstance","multiSelect","preSelectedTerms","fieldName"]}(),function(){function e(e,t,n,i,o){function r(){var r="wonkr/"+i+"/"+l.name+"."+n;return _.some(t,function(e){return e.path.toLocaleLowerCase()==r.toLocaleLowerCase()})?(window.console&&window.console.log("file exists"),void o.showErrorMessage("File with specified name already exist")):void e.close(l.name+"."+n)}function a(){e.dismiss("cancel")}var l=this;l.save=r,l.cancel=a}angular.module("Wizdom365").controller("wizdom365WonkrAddFileController",e),e.$inject=["$modalInstance","existingFiles","extension","path","notificationService"]}(),function(){function e(){var e=function(e,n,i){if(n.length>0){var o=jQuery("#rMenu");o.length>0&&"none"==o.css("display")&&t(e,n.children(".menu-item").eq(0),i)}},t=function(e,t,n){if(t.length>0){var i=t.siblings("ul").eq(0),o=t.parent();i.length>0&&(o.hasClass("shown")||"o"==n?o.removeClass("shown"):o.addClass("shown"))}};return{detectmob:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1},setCookie:function(e,t,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="expires="+i;document.cookie=e+"="+t+"; "+o+";path=/"},getCookie:function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var o=n[i].trim();if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""},BindTopNav:function(n){var i=jQuery("#DeltaTopNavigation ul.root");i.length>0&&i.find("li.dynamic-children").each(function(){var i=jQuery(this).children(".menu-item"),o=i.children("span").eq(0),r=o.children("span.menu-item-text").eq(0);jQuery(this).hover(function(){e(n,jQuery(this),"")},function(){this.HoverTopNav(n,jQuery(this),"o")}),i.is("span")?(i.unbind("click.BindTopNav").bind("click.BindTopNav",function(e){return t(n,jQuery(this),""),!1}),o.unbind("click.BindTopNav").bind("click.BindTopNav",function(e){return t(n,jQuery(this).parent(),""),!1})):(i.unbind("click.BindTopNav").bind("click.BindTopNav",function(e){return e.pageX>=r.offset().left&&e.pageX<=r.offset().left+r.outerWidth(!0)&&e.pageY>=r.offset().top&&e.pageY<=r.offset().top+r.outerHeight(!0)?!0:(t(n,jQuery(this).eq(0),""),!1)}),o.unbind("click.BindTopNav").bind("click.BindTopNav",function(e){return e.pageX>=r.offset().left&&e.pageX<=r.offset().left+r.outerWidth(!0)&&e.pageY>=r.offset().top&&e.pageY<=r.offset().top+r.outerHeight(!0)?window.location.href=jQuery(this).parent("a").eq(0).attr("href"):t(n,jQuery(this).parent("a").eq(0),""),!1}))})}}}angular.module("Wizdom365.Mobile").factory("mobile",e)}(),function(){function e(){return function(e){if(!e)return e;if(e=e.toString(),e.length<30)return e;var t=new RegExp("<a.{30,}?/a>|[^<>\\s]{30,}","gi");return e.replace(/&#10;/g,"\n").replace(t,"<span class='wt-breakThis'>$&</span>").replace(/\n/g,"&#10;")}}angular.module("Wizdom365").filter("checkForLongLinks",e)}(),function(){function e(e){return function(t){var n=[],i="";-1!==t.indexOf(" ")?n=t.split(/(<.+?\s\/>|\s)/):n[0]=t;for(var o=0;o<n.length;o++)n[o].length>30&&(n[o]="<span class='wt-breakThis'>"+n[o]+"</span>"),i+=n[o];return e(i)}}function t(e){return function(t,n,i,o){function r(e){var t=document.createElement("TempDiv");t.innerHTML=e,$(t).find("table").replaceWith("[TABLE]|br|"),$(t).find("ul, ol").replaceWith("[LIST]|br|"),$(t).find("img").replaceWith("[IMG]|br|");var n=t.textContent||t.innerText||"";return n=n.replace(/\[TABLE\]/gi,"<span class='glyphicons glyphicons-table'></span>"),n=n.replace(/\[LIST\]/gi,"<span class='glyphicons glyphicons-list'></span>"),n=n.replace(/\[IMG\]/gi,"<span class='glyphicons glyphicons-picture'></span>")}var a=210,l=25;n&&(a=1*n),(void 0===o||null===o)&&(o=!1),t=t.replace(/\&/g,"&amp;");var s=t.replace(/\<br/gi,"|br|<br").replace(/\<\/p\>/gi,"|br||br|</p>");s=r(s);for(var c=s.split("|br|"),d=[],u=0,m=!1,p=0;p<c.length;p++){if(/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})/gi.test(c[p])){var g="",f=[];-1!==c[p].indexOf(" ")?f=c[p].split(/(<.+?\s\/>|\s)/):f[0]=c[p].trim();for(var h=0;h<f.length;h++)/^www?(.*)/g.test(f[h])&&(f[h]="http://"+f[h]),/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})/gi.test(f[h])&&(f[h].length>i?o?f[h]='<a href="'+f[h]+'" target="_blank">'+f[h].slice(0,i)+"...</a>":f[h]=f[h].slice(0,i)+"...":o&&(f[h]='<a href="'+f[h]+'" target="_blank">'+f[h]+"</a>")),g+=f[h];c[p]=g,f=[],g=""}if(!(a-u>=l||0==p))break;if(r(c[p]).length+u>a){for(var w=c[p].length-r(c[p]).length,v=c[p].substr(0,a-u+w-3).trim(),b=v.length-1;!/\s/.test(v.charAt(b))&&b>0;)b--;d.push(v.substr(0,b-1)+"..."),m=!0}else d.push(c[p].trim());u+=r(c[p]).length}c.length>d.length&&!m&&(d[d.length-1]=d[d.length-1].trim()+"...");for(var C=d.join("<br />");C.indexOf("<br /><br /><br />")>=0;)C=C.replace("<br /><br /><br />","<br /><br />");return e.trustAsHtml(C)}}angular.module("Wizdom365").filter("checkForLongLinkText",e),angular.module("Wizdom365").filter("checkForLongLinkTextV2",t),e.$inject=["wizdomSanitizeAndTrust"],t.$inject=["$sce"]}(),function(){function e(e,t,n){return function(i){var o=e.Wizdom365.Languages;if(void 0!==o)for(var r=0;r<o.length;r++)if(o[r].Tag==t.locale)return n("date")(new Date(i),o[r].DateFormat);return n("date")(new Date(i),"shortDate")}}angular.module("Wizdom365").filter("wizdom365DefaultDate",e),e.$inject=["configuration","contextInfo","$filter"]}(),function(){function e(){return function(e,t){var n=[];if(t)for(var i=0;i<t.length;i++)"tag"==t[i].type&&n.push(t[i]);if(!e||!n)return e;if(n&&0==n.length)return e;for(var o=[],r=0;r<e.length;r++){for(var a=!1,l=0;l<n.length;l++)if("freetext"!=n[l].type&&-1!=e[r].tags.indexOf(n[l].text)){a=!0;break}1==a&&o.push(e[r])}return o}}angular.module("Wizdom365").filter("documentTagsContains",e),e.$inject=[]}(),function(){function e(){return function(e){var t=Date.parse(e);return e.toString().indexOf("GMT+")<0&&e.toString().indexOf("Z")<0&&(t=Date.parse(e+"Z")),isNaN(t)?new Date(e):new Date(t)}}angular.module("Wizdom365").filter("wizdom365FormatDate",e)}(),function(){function e(e,t,n){return function(t){return""!=t?e(t,"L",n.locale).toDate():""}}angular.module("Wizdom365").filter("wizdom365FormatDateMoment",e),e.$inject=["moment","configuration","contextInfo"]}(),function(){function e(e){return function(t,n){if(angular.isDefined(t)&&t){if(n){var i=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");return i=i.replace(/\s+/g,"|"),e(t.replace(new RegExp(i,"gi"),"<b>$&</b>"))}return t}return""}}angular.module("Wizdom365").filter("wizdom365Highlight",e),e.$inject=["wizdomSanitizeAndTrust"]}(),function(){function e(){return function(e,t){if(!angular.isObject(e))return e;var n=[];for(var i in e)n.push(e[i]);return n.sort(function(e,n){return e=parseInt(e[t]),n=parseInt(n[t]),e-n}),n}}angular.module("Wizdom365").filter("orderObjectBy",e)}(),angular.module("Wizdom365").filter("pagination",function(){return function(e,t){t=+t;var n=[];try{n=e.slice(t)}catch(i){n=[]}return n}}),angular.module("Wizdom365").filter("range",function(){return function(e,t){t=parseInt(t);for(var n=0;t>n;n++)e.push(n);return e}}),function(){function e(e){return function(t,n,i){if(void 0!==t){var o=210,r=25;n&&(o=1*n),t=t.replace(/\&/g,"&amp;");var a=t.replace(/\<br/gi,"|br|<br").replace(/\<\/p\>/gi,"|br||br|</p>");a=$("<div />").html(a).text();for(var l=a.split("|br|"),s=[],c=0,d=!1,u=0;u<l.length&&(o-c>=r||0==u);u++)l[u].length+c>o?(s.push(l[u].substr(0,o-c-3).trim()+" ..."),d=!0):s.push(l[u].trim()),c+=l[u].length;l.length>s.length&&!d&&(s[s.length-1]=s[s.length-1].trim()+" ...");for(var m=s.join("<br />");m.indexOf("<br /><br /><br />")>=0;)m=m.replace("<br /><br /><br />","<br /><br />");return e.trustAsHtml(m)}}}angular.module("Wizdom365").filter("wizdom365SmartHtmlStrip",e),e.$inject=["$sce"]}(),function(){angular.module("Wizdom365").filter("startFrom",function(){return function(e,t){return t=+t,e.slice(t)}})}(),function(){function e(){return function(e,t){if(!e)return e;if(t&&0==t.length)return e;for(var n=[],i=0;i<e.length;i++)e[i]&&e[i].length>=t.length&&e[i].substr(0,t.length).toLowerCase()==t.toLowerCase()&&n.push(e[i]);return n}}angular.module("Wizdom365").filter("startWith",e),e.$inject=[]}(),function(){function e(e,t){return function(n,i,o){var r=angular.isArray(i)?i:angular.isObject(i)?i:angular.isDefined(i)?[i]:[],a=window.wizdomClientSideFeatureToggles&&window.wizdomClientSideFeatureToggles.translateConfigurationCenter,l=window.adminDependencies&&!a?"en-us":t.language,s=null!=e[l]&&e[l][n]?e[l][n]:n;return _.forEach(r,function(e,t){var n=new RegExp("[{]"+t+"[}]","g");s=s.replace(n,e||"")}),s}}angular.module("Wizdom365").filter("translate",e),e.$inject=["translations","contextInfo"]}(),function(){function e(e){return function(t){return e.trustAsHtml(t)}}function t(e){return function(t,n){return e(t,n)}}1==window.isSaaS?(angular.module("Wizdom365").filter("wizdom365TrustHtml",e),e.$inject=["$sce"]):(angular.module("Wizdom365").filter("wizdom365TrustHtml",t),t.$inject=["wizdomSanitizeAndTrust"])}(),function(e,t){"use strict";function n(){function n(e,t){var n,i={},o=e.split(",");for(n=0;n<o.length;n++)i[t?s(o[n]):o[n]]=!0;return i}function i(t,n){null===t||void 0===t?t="":"string"!=typeof t&&(t=""+t),I.innerHTML=t;var i=5;do{if(0===i)throw p("uinput","Failed to sanitize html because the input is unstable");i--,e.document.documentMode&&b(I),t=I.innerHTML,I.innerHTML=t}while(t!==I.innerHTML);for(var o=I.firstChild;o;){switch(o.nodeType){case 1:n.start(o.nodeName.toLowerCase(),g(o.attributes));break;case 3:n.chars(o.textContent)}var r;if(!(r=o.firstChild)&&(1===o.nodeType&&n.end(o.nodeName.toLowerCase()),r=C("nextSibling",o),!r))for(;null==r&&(o=C("parentNode",o),o!==I);)r=C("nextSibling",o),1===o.nodeType&&n.end(o.nodeName.toLowerCase());o=r}for(;o=I.firstChild;)I.removeChild(o)}function g(e){for(var t={},n=0,i=e.length;i>n;n++){var o=e[n];t[o.name]=o.value}return t}function f(e){return e.replace(/&/g,"&amp;").replace(S,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(k,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function h(e){var n="",i=e.split(";");return t.forEach(i,function(e){var t=e.split(":"),i=R(t[0].toLowerCase());return W[i]?void(n+=e+";"):void(2===t.length&&(e=R(t[1].toLowerCase()),(("color"===i||"background-color"===i)&&(e.match(/^rgb\([0-9%,\. ]*\)$/i)||e.match(/^rgba\([0-9%,\. ]*\)$/i)||e.match(/^hsl\([0-9%,\. ]*\)$/i)||e.match(/^hsla\([0-9%,\. ]*\)$/i)||e.match(/^#[0-9a-f]{3,6}$/i)||e.match(/^[a-z]*$/i))||"text-align"===i&&("left"===e||"right"===e||"center"===e||"justify"===e)||"float"===i&&("left"===e||"right"===e||"none"===e)||"direction"===i&&("rtl"===e||"ltr"===e)||"font-family"===i&&("arial,helvetica,sans-serif"===e||"georgia,serif"===e||"impact,charcoal,sans-serif"===e||"tahoma,geneva,sans-serif"===e||"'times new roman',times,serif"===e||"verdana,geneva,sans-serif"===e)||("width"===i||"height"===i||"font-size"===i||"margin-left"===i)&&e.match(/[0-9\.]*(px|em|rem|%)/))&&(n+=i+": "+e+";")))}),n}function w(e,t,n,i){return"img"===e&&t["ta-insert-video"]&&("ta-insert-video"===n||"allowfullscreen"===n||"frameborder"===n||"contenteditble"===n&&"false"===i)?!0:!1}function v(e,t){var n=!1,i=o(e,e.push);return{start:function(e,o){e=s(e),!n&&N[e]&&(n=e),n||D[e]!==!0||(i("<"),i(e),a(o,function(n,r){var a=s(r),l="img"===e&&"src"===a||"background"===a;("style"===a&&""!==(n=h(n))||w(e,o,a,n)||E[a]===!0&&(L[a]!==!0||t(n,l)))&&(i(" "),i(r),i('="'),i(f(n)),i('"'))}),i(">"))},end:function(e){e=s(e),n||D[e]!==!0||P[e]===!0||(i("</"),i(e),i(">")),e==n&&(n=!1)},chars:function(e){n||i(f(e))}}}function b(t){for(;t;){if(t.nodeType===e.Node.ELEMENT_NODE)for(var n=t.attributes,i=0,o=n.length;o>i;i++){var r=n[i],a=r.name.toLowerCase();("xmlns:ns1"===a||0===a.lastIndexOf("ns1:",0))&&(t.removeAttributeNode(r),i--,o--)}var l=t.firstChild;l&&b(l),t=C("nextSibling",t)}}function C(e,t){var n=t[e];if(n&&d.call(t,n))throw p("elclob","Failed to sanitize html because the element is clobbered: {0}",t.outerHTML||t.outerText);return n}var y=!1;this.$get=["$$sanitizeUri","configuration",function(e,t){switch(t.Richtext.Security.SanitizationLevel){case"Low":break;case"Medium":N=n("script"),D=r(D,n("style,link,iframe")),M=r(M,n("class,face,id,loginname,itemprop,style")),L=r(L,n("mailto,tel,sms,ftp,data")),W=n("background,background-color,font-family,list-style-type");break;case"High":}return t.Richtext.Security.Custom&&(t.Richtext.Security.Custom.elements&&(D=r(D,n(t.Richtext.Security.Custom.elements))),t.Richtext.Security.Custom.attrs&&(M=r(M,n(t.Richtext.Security.Custom.attrs))),t.Richtext.Security.Custom.styles&&(W=r(W,n(t.Richtext.Security.Custom.styles))),t.Richtext.Security.Custom.uri&&(L=r(L,n(t.Richtext.Security.Custom.uri)))),y&&r(D,A),function(n){if("Low"==t.Richtext.Security.SanitizationLevel)return n;var i=[];return u(n,m(i,function(t,n){return!/^unsafe:/.test(e(t,n))})),i.join("")}}],this.enableSvg=function(e){return l(e)?(y=e,this):y},o=t.bind,r=t.extend,a=t.forEach,l=t.isDefined,s=t.lowercase,c=t.noop,u=i,m=v,d=e.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))};var I,S=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,k=/([^#-~ |!])/g,P=n("area,br,col,hr,img,wbr"),x=n("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),T=n("rp,rt"),U=r({},T,x),z=r({},x,n("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),$=r({},T,n("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),A=n("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),N=n("script,style"),D=r({},P,z,$,U),L=n("background,cite,href,longdesc,src,xlink:href"),M=n("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),F=n("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),W=n("list-style-type,vertical-align"),E=r({},L,F,M);!function(e){var t;if(!e.document||!e.document.implementation)throw p("noinert","Can't create an inert html document");t=e.document.implementation.createHTMLDocument("inert");var n=t.documentElement||t.getDocumentElement(),i=n.getElementsByTagName("body");if(1===i.length)I=i[0];else{var o=t.createElement("html");I=t.createElement("body"),o.appendChild(I),t.appendChild(o)}}(e);var R=function(){return String.prototype.trim?function(e){return t.isString(e)?e.trim():e}:function(e){return t.isString(e)?e.replace(/^\s\s*/,"").replace(/\s\s*$/,""):e}}()}function i(e){var t=[],n=m(t,c);return n.chars(e),t.join("")}var o,r,a,l,s,c,d,u,m,p=t.$$minErr("$sanitize");t.module("ngSanitize",[]).provider("$sanitize",n).info({angularVersion:"1.6.4"}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,o=/^mailto:/i,r=t.$$minErr("linky"),a=t.isDefined,l=t.isFunction,s=t.isObject,c=t.isString;return function(t,d,u){function m(e){e&&b.push(i(e))}function p(e,t){var n,i=w(e);b.push("<a ");for(n in i)b.push(n+'="'+i[n]+'" ');!a(d)||"target"in i||b.push('target="',d,'" '),b.push('href="',e.replace(/"/g,"&quot;"),'">'),m(t),b.push("</a>")}if(null==t||""===t)return t;if(!c(t))throw r("notstring","Expected string but received: {0}",t);for(var g,f,h,w=l(u)?u:s(u)?function(){return u}:function(){return{}},v=t,b=[];g=v.match(n);)f=g[0],g[2]||g[4]||(f=(g[3]?"http://":"mailto:")+f),h=g.index,m(v.substr(0,h)),p(f,g[0].replace(o,"")),v=v.substring(h+g[0].length);return m(v),e(b.join(""))}}])}(window,angular),function(){"use strict";function e(){return{restrict:"E",transclude:!0,template:'<div class="toggle btn" ng-class="wrapperClass" ng-style="wrapperStyle" ng-click="onSwitch($event)">\n                            <div class="toggle-group">\n                                <label class="btn" ng-class="onClass"></label>\n                                <label class="btn active" ng-class="offClass"></label>\n                                <span class="btn btn-default" ng-class="handleClass"></span>\n                            </div>\n                        </div>',scope:{ngModel:"="},require:["wizdom365-toggle","ngModel"],controller:t,controllerAs:"toggle",compile:function(e,t,n){return{pre:function(e,t,n,i){var o=i[0],r=i[1];o.element=t,o.init(r)},post:function(){}}}}}function t(e,t,n,i,o,r,a){var l,s,c,d=this,u=a.controller("ngModel"),m=Object.keys(o);angular.forEach(m,function(i,r){if(angular.isDefined(t[i]))switch(typeof o[i]){case"string":d[i]=n(t[i])(e.$parent);break;case"function":break;default:d[i]=e.$parent.$eval(t[i])}else d[i]=o[i]}),this.init=function(n){u=n,l=d.element.find("label"),s=d.element.find("span"),c=d.element.find("div"),angular.element(l[0]).html(d.on),angular.element(l[1]).html(d.off),d.computeStyle(),u.$render=function(){d.toggle()},angular.isDefined(t.ngChange)&&u.$viewChangeListeners.push(function(){e.$eval(t.ngChange)})},this.computeStyle=function(){if(angular.element(l[0]).attr("disabled",d.disabled),angular.element(l[1]).attr("disabled",d.disabled),angular.element(s[0]).attr("disabled",d.disabled),e.wrapperStyle=d.toggleStyle?e.$parent.$eval(d.toggleStyle):{},d.width)e.wrapperStyle.width=d.width;else{var t=Math.max(l[0].offsetWidth,l[1].offsetWidth),n=c[0].offsetWidth;t>n?e.wrapperStyle.width=t+"px":e.wrapperStyle.width=n+"px"}if(d.height)e.wrapperStyle.height=d.height;else{var i=Math.max(l[0].offsetHeight,l[1].offsetHeight),o=c[1].offsetHeight;i>o&&"btn-xs"!==d.size&&"btn-sm"!==d.size?e.wrapperStyle.height=i+"px":e.wrapperStyle.height=o+"px"}e.onClass=[d.onstyle,d.size,"toggle-on"],e.offClass=[d.offstyle,d.size,"toggle-off"],e.handleClass=[d.size,"toggle-handle"]},this.toggle=function(){angular.isDefined(u.$viewValue)&&u.$viewValue?e.wrapperClass=[d.onstyle,d.size,d.style]:e.wrapperClass=[d.offstyle,"off ",d.size,d.style]},e.onSwitch=function(e){return d.disabled?!1:(u.$setViewValue(!u.$viewValue),u.$render(),!0)},angular.forEach(["ngModel"],function(n){var i=e.$parent.$watch(t[n],function(e){u.$render()});e.$parent.$on("$destroy",function(){i()})}),angular.forEach(m,function(e,n){t.$observe(e,function(t){d[e]!==t&&(d[e]=t,d.computeStyle())})})}angular.module("Wizdom365").directive("wizdom365Toggle",e).value("$toggleSuppressError",!1).constant("toggleConfig",{btnCheckboxFalse:!1,btnCheckboxTrue:!0,on:"On",off:"Off",size:"",onstyle:"btn-primary",offstyle:"btn-default",toggleStyle:"",width:"",height:"",disabled:!1}),e.$inject=[],t.$inject=["$scope","$attrs","$interpolate","$log","toggleConfig","$toggleSuppressError","$element"]}(),function(){function e(e){return{restrict:"A",link:function(e,t,n,i){t.css({height:"auto","overflow-y":"hidden"}),t.on("input",function(){t.css({height:"auto","overflow-y":"hidden"}),t[0].scrollHeight>0&&t.css("height",t[0].scrollHeight+"px")})}}}angular.module("Wizdom365").directive("autoExpand",e),e.$inject=["$timeout"]}(),function(){function e(){return{scope:{video:"="},replace:!0,template:'<a href ng-click="showVideo()" style="display: block; position: relative;"><i class="glyphicon glyphicon-play-circle icon-play"></i> <img style="background-color:black; min-height: 200px" ng-src="{{video.thumbnail}}"></a>',controller:t}}function t(e,t){function n(){t.open({templateUrl:"Wizdom365/Templates/Dialogs/Video.html",controller:"Wizdom365VideoController",size:"lg",windowClass:"bootstrap-wrapper",resolve:{video:function(){return e.video}}})}e.showVideo=n}function n(e,t,n,i){function o(e){return i.trustAsResourceUrl(e)}function r(){t.dismiss("cancel")}e.video=n,e.close=r,e.trustSrc=o}angular.module("Wizdom365").directive("azurePlayer",e),angular.module("Wizdom365").controller("Wizdom365VideoController",n),t.$inject=["$scope","$modal"],n.$inject=["$scope","$modalInstance","video","$sce"]}(),function(){function e(){return{scope:{videolink:"="},replace:!0,template:"<video class='azuremediaplayer amp-default-skin amp-big-play-centered' ng-init='show()'></video>",controller:t}}function t(e){e.player,e.myOptions={nativeControlsForTouch:!1,autoplay:!0,controls:!0,poster:"",width:"100%",height:"100%"},e.show=function(){var t="azuremediaplayer"+e.$id;$("video")[0].id=t,e.player=window.amp(t,e.myOptions),e.player.src([{src:e.videolink,type:"application/vnd.ms-sstr+xml"}])}}angular.module("Wizdom365").directive("azureVideoPlayer",e),t.$inject=["$scope"]}(),function(){function e(){return{scope:{itemid:"=",itemtype:"@",defaultfocus:"@",allowedlevel:"=?",templateUrl:"=?"},template:'<div wizdom-include="::templateUrl"></div>',controller:t}}function t(e,t,n,i,o,r,a,l,s,c,d,u){function m(){t.comments||(t.comments=[]);var e=void 0;e=_.find(t.comments,function(e){return 0==e.commentID}),e?e.editing=!0:(e={commentID:0,editing:!0,targetID:t.itemid,author:{loginName:o.userLoginName,displayName:o.userDisplayName||o.userLoginName},likes:[],datePosted:new Date,level:0,rows:1},t.comments.push(e))}function p(){null!=t.itemid&&(("corporateNews"==t.itemtype||"corporatenews"==t.itemtype)&&(t.templateUrl=r.CorporateNews.SocialFeature.SocialCommentsTemplate,t.allowedlevel="true"==r.CorporateNews.SocialFeature.AllowRepliesToComments?2:1),("manualPage"==t.itemtype||"manualpage"==t.itemtype||"manual"==t.itemtype)&&(t.templateUrl=r.Manual.SocialFeature.SocialCommentsTemplate,t.allowedlevel="true"==r.Manual.SocialFeature.AllowRepliesToComments?2:1),("contentPage"==t.itemtype||"contentpage"==t.itemtype)&&(t.templateUrl=r.ContentPage.SocialFeature.SocialCommentsTemplate,t.allowedlevel="true"==r.ContentPage.SocialFeature.AllowRepliesToComments?2:1),"item"==t.itemtype&&(t.allowedlevel="true"==r.Noticeboard.SocialFeature.AllowRepliesToComments?2:1),(!t.templateUrl||t.templateUrl.indexOf("/CommentsPanel/")<0)&&(t.templateUrl="Wizdom365/Templates/ViewTemplates/Social/CommentsPanel/CommentsPanel.html"),(null==!t.allowedlevel||t.allowedlevel<1)&&(t.allowedlevel=1),i.social.getCommentsTree(t.itemid,t.itemid,t.itemtype,0,t.allowedlevel).then(function(e){e&&(t.comments=e.comments,t.targetTotalComments=e.targetTotalComments,t.isRead=e.isRead,m())}))}function g(){if(!t.loadingMore){t.loadingMore=!0;var e=_.min(t.comments,function(e){return 0==e.commentID?Number.MAX_VALUE:e.commentID}),n=0;e&&e.commentID&&(n=e.commentID),i.social.getCommentsTree(t.itemid,t.itemid,t.itemtype,n,t.allowedlevel).then(function(e){e&&(_.each(e.comments,function(e){t.comments.splice(t.comments.length-1,0,e)}),t.loadingMore=!1)},function(e){t.loadingMore=!1})}}function f(e){if(!e.loadingMore){e.loadingMore=!0;var n=_.min(e.comments,function(e){return 0==e.commentID?Number.MAX_VALUE:e.commentID}),o=0;n&&n.commentID&&(o=n.commentID),i.social.getCommentsTree(t.itemid,e.commentID.toString(),"Comment",o,t.allowedlevel).then(function(t){t&&(_.each(t.comments,function(t){e.comments.push(t)}),e.loadingMore=!1)},function(t){e.loadingMore=!1})}}function h(e){l.open({templateUrl:"Wizdom365/Templates/Dialogs/Image.html",controller:"Wizdom365ShowImageController",windowClass:"bootstrap-wrapper",size:"lg",resolve:{imgUrl:function(){return e}}}).result.then()}function w(e){e.selectedImage=null}function v(e){e.preview=!1,e.previewMetadata=null,e.targetID=t.itemid,e.targetType=L(),e.dateModified=new Date,e.status=1,i.social.saveComment(e).then(function(e){})}function b(n){if(null!=n.selectedImage||null!=n.editingContent&&0!=n.editingContent.length){t.loading=!0,n.commentSaving="loading";var o={commentID:null,targetID:n.targetID,targetType:n.level>0?2:L(),content:n.editingContent,picture:n.selectedImage,preview:!0,previewMetadata:null,datePosted:new Date,dateModified:null};o.commentID=n.commentID,o.preview=n.preview,o.dateModified=new Date,i.social.saveComment(o).then(function(r){if(null!=r){if(0!=t.notifyPrincipals.length){var a=[];_.forEach(t.notifyPrincipals,function(e){if(-1!=n.editingContent.indexOf(N(e.displayName))){var i={receiver:e,targetID:t.itemid.toString(),targetType:L()};a.push(i)}}),a.length>0&&i.social.addMentio(a)}if(0==o.commentID&&o.targetID==t.itemid?(t.comments.pop(),t.comments.splice(0,0,r)):(n.commentID=r.commentID,n.status=r.status,n.author=r.author,n.canEdit=r.canEdit,n.canDelete=r.canDelete,n.picture=n.selectedImage,n.content=n.editingContent,n.selectedImage=null,n.editingContent=null),0==o.commentID)if(0==n.level)d.itemCommentAdded(t.itemid,r);else{var l=k(t.comments,r.targetID);l&&l.childCommentsCount++}t.notifyPrincipals=[],t.searchPrincipals=[],n.editing=!1}else{var c=e("translate")("Some error occurred while comment saving.");s.showErrorMessage(c),t.loading=!1}n.commentSaving="",n.targetID==t.itemid&&0==o.commentID&&m(),t.loading=!1})}}function C(t){window.confirm(e("translate")("Are you sure you want to delete this comment?"))&&i.social.deleteComment(t.commentID).then(function(e){e&&(t.content="",t.dateModified=new Date,t.status=2)})}function y(e){e.editingContent=e.content,e.selectedImage=e.picture,e.content&&(e.rows=e.content.split(/\r\n|\r|\n/).length),e.editing=!0}function I(e){if(2==e.status)return!1;e.comments||(e.comments=[]);var t=void 0;t=_.find(e.comments,function(e){return 0==e.commentID}),t||(t={commentID:0,targetID:e.commentID.toString(),author:{loginName:o.userLoginName,displayName:o.userDisplayName||o.userLoginName},likes:[],datePosted:new Date,level:e.level+1,picture:null,content:"",status:0,rows:1},e.comments.splice(0,0,t)),y(t)}function S(e){if(0==e.commentID){if(e.targetID==t.itemid)t.comments||(t.comments=[]),_.remove(t.comments,function(t){return 0==t.commentID&&t.targetID==e.targetID});else{var n=k(t.comments,e.targetID);n&&(n.comments||(n.comments=[]),_.remove(n.comments,function(t){return 0==t.commentID&&t.targetID==e.targetID}))}e.editing=!1}else e.selectedImage=null,e.editingContent=null,e.editing=!1;t.notifyPrincipals=[],t.searchPrincipals=[]}function k(e,t){e||(e=[]);var n=_.find(e,function(e){return e.commentID.toString()==t});if(n)return n;for(var i=0;i<e.length;i++)if(n=k(e[i].comments,t))return n;return null}function P(e){if(2==e.status)return!1;var n={principal:{loginName:o.userLoginName,displayName:o.userDisplayName||o.userLoginName},targetID:e.commentID.toString(),targetType:2};i.social.likeItem(n).then(function(i){i&&(t.likedByUser(e)?(_.remove(e.likes,function(e){return e.principal.loginName.toLowerCase()==o.userLoginName.toLowerCase()}),e.isLiked=!1):(e.likes.push(n),e.isLiked=!0))})}function x(t){if(0==t.status)return"";var n=" - ";return 1==t.status?n+e("translate")("Edited"):2==t.status?n+e("translate")("Deleted"):void 0}function T(n){var i="";return 0==n.likes.length?i=e("translate")("No likes yet..."):1==n.likes.length?i=n.likes[0].principal.loginName==o.userLoginName?e("translate")("You like this."):e("translate")("{0} likes this.",n.likes[0].principal.displayName):t.likedByUser(n)&&n.likes.length-1==1?i=e("translate")("You and {0} like this.",_.find(n.likes,function(e){return e.principal.loginName.toLowerCase()!=o.userLoginName.toLowerCase()}).principal.displayName):(i=t.likedByUser(n)?e("translate")("You and {0} others like this: <br/>",n.likes.length-1):e("translate")("{0} people like this: <br/>",n.likes.length),_.forEach(n.likes,function(e){e.principal.loginName.toLowerCase()!=o.userLoginName.toLowerCase()&&(i+=e.principal.displayName+"<br/>")})),i}function U(e){return _.find(e.likes,function(e){return e.principal.loginName.toLowerCase()==o.userLoginName.toLowerCase()})}function z(e){return null==e?"":e.replace(/\n/g,"<br/>")}function $(e){return _.contains(t.notifyPrincipals,e)||t.notifyPrincipals.push(e),N(e.displayName)}function A(e,n){return!e||e.length<2?void(t.searchPrincipals=[]):(n=n||!1,c.principals.searchForPrincipalAuthors(e,n).then(function(e){t.searchPrincipals=e}))}function N(e){return"@"+e.replace(/ /g,"")}function D(e,t){10==e.keyCode&&b(t)}function L(){var e=t.itemtype?t.itemtype.toLowerCase():"";return"item"==e||"nbitem"==e?1:"comment"==e?2:"corporatenews"==e?3:"manualpage"==e?4:"contentpage"==e?5:"kanban"==e?6:0}t.loading=!1,t.showComments=t.showComments||!1,t.allowedlevel=t.allowedlevel||1,t.allowedlevel<1&&(t.allowedlevel=1),t.autofocus="true"==t.defaultfocus,t.itemtype=(t.itemtype||"item").toLowerCase(),d.onShowComments(function(e,n){var i=t.$parent?t.$parent.scopeName:"";i||(i=""),e.scopeName||(e.scopeName=""),t.itemid==e.id&&i==e.scopeName&&0==t.showComments&&(t.showComments=!0,p())}),d.onHideComments(function(e,n){t.itemid==e.id&&(t.showComments=!1)}),t.searchPrincipals=[],t.notifyPrincipals=[],t.comments=[],t.targetTotalComments=0,t.isRead=!1,t.showPicture=h,t.initialize=p,t.removeImage=w,t.postComment=b,t.deleteComment=C,t.editComment=y,t.cancelEdit=S,t.likeItem=P,t.likedByUser=U,t.getTooltipText=T,t.getCommentDetails=x,t.removePreview=v,t.convertTextToHtml=z,t.selectUser=$,t.searchForPrincipal=A,t.keypress=D,t.addComment=I,t.showMorePreviousComments=g,t.showMorePreviousChildComments=f,t.$watch("itemid",function(e,t){e!==t&&p()},!0),6==L()&&p()}angular.module("Wizdom365").directive("wizdom365CommentsPanel",e),t.$inject=["$filter","$scope","$rootScope","webApiProxy","contextInfo","configuration","$element","$modal","notificationService","noticeboardApi","commentsPanelCommunication","$sce"]}(),function(){function e(){return{scope:{},template:'\n                <span class="wt-notificationPanel wizdom-configuration-nav-panel">\n                 <a ng-class="{disabled:(!wizdomConfigUrl)}" class="ms-promotedActionButton" href="{{wizdomConfigUrl}}" target="_blank" title="{{\'Wizdom Configuration Center\' | translate}}" ng-if="rolesForCurrentUser.indexOf(\'Admin_Global_Configuration\') != -1">\n                  <span class="glyphicons glyphicons-adjust-alt"></span>\n                 </a>\n                 <a ng-class="{disabled:(!redirUrl)}" class="ms-promotedActionButton" href="{{redirUrl}}" target="_blank" title="{{\'Help & Training Portal\' | translate}}" ng-if="rolesForCurrentUser.indexOf(\'Admin_Global_Documentation\') != -1">\n                  <span class="glyphicons glyphicons-info-sign"></span>\n                 </a>\n                </span>\n                ',controller:t}}function t(e,t,n){e.redirUrl=t.appUrl+"Base/Bundles/Redirect.aspx?redirTo=wizdomsuccess",e.wizdomConfigUrl=decodeURIComponent(t.spWebUrl)+"/_layouts/15/appredirect.aspx?client_id="+t.clientId+"&redirect_uri="+t.appUrl+"/Base/Pages/Configuration.aspx?{StandardTokens}%26userLoginName="+encodeURIComponent(t.userLoginName),n.rolesForCurrentUser().then(function(t){e.rolesForCurrentUser=t})}angular.module("Wizdom365").directive("wizdom365ConfigurationNavPanel",e),t.$inject=["$scope","contextInfo","userContextInfo"]}(),function(){function e(){return{restrict:"EAC",require:"ngModel",link:function(e,t,n,i){i.$formatters.shift()}}}angular.module("Wizdom365").directive("datepickerPopup",e)}(),function(){function e(){return{scope:{date:"=",minDate:"=",disableWeekends:"@",showDatePicker:"@",showTimePicker:"@",displayFormat:"@",disablePreviouslyDates:"@",ngRequired:"=ngRequired",updateFn:"="},template:'<table style="width: 100%; padding: 0;" ng-style="tableStyle" class="dateTimePicker" ng-class="{\'ng-invalid\': (required && (date==null || date==undefined))}"><tr><td ng-show="{{showDatePicker}}"><div class="input-group"><input type="text" ng-disabled="true" class="form-control" min-date="min" datepicker-popup="{{format}}" ng-model="date" is-open="opened" datepicker-options="options" date-disabled="disabled(date, mode)" ng-required="required" close-text="{{\'Close\' | translate}}" clear-text="{{\'Clear\' | translate}}" current-text="{{\'Today\' | translate}}"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button></span></div></td><td ng-show="{{showDatePicker && showTimePicker}}">&nbsp;</td><td ng-show="{{showTimePicker}}" class="timePicker"><timepicker ng-model="date" hour-step="1" minute-step="15" show-meridian="showTwelveHourFormat"></timepicker></td></tr></table>',controller:t}}function t(e,t,n,i){function o(){e.date&&(e.date=t("wizdom365FormatDate")(e.date)),"undefined"!=typeof e.displayFormat?"dd-MMMM-yyyy"==e.displayFormat?e.format=e.formats[0]:"yyyy/MM/dd"==e.displayFormat?e.format=e.formats[1]:"dd.MM.yyyy"==e.displayFormat?e.format=e.formats[2]:e.format=e.formats[3]:e.format=e.formats[2],"en-us"===n.locale&&(e.format=e.americanFormat),"true"===e.disablePreviouslyDates?e.min=new Date:"undefined"!=typeof e.minDate&&(e.min=e.minDate),e.showDatePicker&&(e.showDatePicker=e.$eval(e.showDatePicker)),e.showTimePicker&&(e.showTimePicker=e.$eval(e.showTimePicker)),e.tableStyle=e.showTimePicker?{"margin-top":"-30px"}:{"margin-top":"0"},null==e.ngRequired||void 0==e.ngRequired?e.required=!1:e.required=e.ngRequired}e.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],e.americanFormat="MM/dd/yyyy",e.min=null,e.tableStyle={"margin-top":"-30px"},e.showTwelveHourFormat=i.DATETIME_FORMATS.shortTime.indexOf(" a")>0,o(),e.$watch("minDate",function(t,n){t&&"undefined"!=typeof t&&(e.min=t,"undefined"!=typeof e.date&&null!=e.date&&("string"==typeof e.date&&(e.date=new Date(e.date)),"string"==typeof e.min&&(e.min=new Date(e.min)),e.date.getTime()<e.min.getTime()&&(e.date=t)))},!0),e.$watch("date",function(t,n){e.updateFn&&e.updateFn(t,n)},!0),e.options={"show-weeks":!1,formatYear:"yy",startingDay:1},e.opened=!1,e.open=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!0},e.disabled=function(t,n){return"true"===e.disableWeekends?"day"===n&&(0===t.getDay()||6===t.getDay()):!1}}angular.module("Wizdom365").directive("wizdom365DatetimePicker",e),t.$inject=["$scope","$filter","contextInfo","$locale"]}(),function(){function e(){return{link:function(e,t,n){window.Wizdom365AppUrl&&window.Wizdom365AppUrl.indexOf("localhost")>0||t.remove()}}}angular.module("Wizdom365").directive("wizdom365Debug",e)}(),function(){function e(e){function n(e,t,n){}return{scope:{selecteddepartment:"="},template:'<select ng-options="o as o for o in departments" ng-model="selected" ng-change="onChange()" class="form-control"><option value>{{"All" | translate}}</option></select>',link:n,controller:t}}function t(e,t,n,i){function o(){i.terms.getAllTermsById("8ed8c9ea-7052-4c1d-a4d7-b9c10bffea6f").then(function(t){e.departments=t,e.selected=e.selecteddepartment})}e.departments=[],e.onChange=function(){e.selected?e.selecteddepartment=e.selected:e.selecteddepartment=""},o()}angular.module("Wizdom365").directive("wizdom365DepartmentsDropdown",e),e.$inject=[],t.$inject=["$scope","$http","contextInfo","webApiProxy"]}(),function(){function e(e,t){return{compile:function(t,n){var i=e(n.wizdom365Dragover);return function(e,t){t.droppable({over:function(t,n){var o=function(){i(e,{$event:t})};e.$apply(o)}})}}}}angular.module("Wizdom365").directive("wizdom365Dragover",e),e.$inject=["$parse","$rootScope"]}(),function(){function e(){return{scope:{allowedExtensions:"=?",module:"@",moduleContext:"=?",allowMultiple:"=?",onFileUploadStarted:"=",onFileUploadCompleted:"="},template:'<iframe class="attachment-iframe" style="width:100%;height:41px;" frameborder="0" ng-src="{{vm.iframeSrc}}"></iframe>',controllerAs:"vm",controller:t}}function t(e,t,n,i,o){function r(t){try{var n=JSON.parse(t.data);if(!n.command||n.contextId!=a)return;e.$applyAsync(function(){"FileUploadStarted"===n.command&&e.onFileUploadStarted&&e.onFileUploadStarted({files:n.files}),"FileUploadCompleted"===n.command&&e.onFileUploadCompleted&&e.onFileUploadCompleted({files:n.files}),"ErrorSelectedFilesToBig"===n.command&&o.showErrorMessage("The selected files are too large",!0,!0),"ErrorInvalidFileExtension"===n.command&&o.showErrorMessage("Invalid file type selected",!0,!0)})}catch(i){}}var a=i.newGuid();if(angular.isDefined(e.allowedExtensions)||(e.allowedExtensions=[]),!angular.isDefined(e.module))return void(window.console&&console.log("module attribute not defined for fileUploader"));angular.isDefined(e.allowMultiple)||(e.allowMultiple=!1);var l=this;l.iframeSrc=n.trustAsResourceUrl(t.appUrl+"/base/uploader.aspx?contextId="+a+"&module="+e.module+"&moduleContext="+e.moduleContext+"&allowMultiple="+e.allowMultiple+"&allowedExtensions="+e.allowedExtensions),"undefined"!=typeof window.addEventListener?window.addEventListener("message",r,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmessage",r)}angular.module("Wizdom365").directive("fileUploader",e),e.$inject=[],t.$inject=["$scope","contextInfo","$sce","guidGenerator","notificationService"]}(),function(){function e(e){return{require:"?ngModel",link:function(t,n,i,o){o&&(o.$formatters.unshift(function(t){return e(i.format)(o.$modelValue)}),o.$parsers.unshift(function(t){var o=t.replace(/[^\d|\-+|\.+]/g,"");return n.val(e(i.format)(o)),o}))}}}angular.module("Wizdom365").directive("format",e),e.$inject=["$filter"]}(),function(){function e(){function e(e,t,n){function i(t){null==t&&(t="bootstrap");var n,i,o;o=t.split(" ");for(i in e.iconGroupsMap)n=e.iconGroupsMap[i],null==e.iconMap[i]&&("all"===t||-1!==o.indexOf(i))&&(e.iconMap[i]=n)}function o(){var t,n,i,o,r,a,l;e.classes=[],a=e.iconMap;for(i in a)for(t=a[i],l=t.classes,o=0,r=l.length;r>o;o++)n=l[o],e.classes.push(t.prefix+n)}function r(){var t=e.model.split(",");return e.iconClass=t.length>0?t[0]:void 0,e.iconBackColor=t.length>1?t[1]:"inherit",e.iconForeColor=t.length>2?t[2]:"inherit",e.iconStyle={"background-color":e.iconBackColor,color:e.iconForeColor},t}function a(){e.iconMap={},i(n.groups),o();var t;e.iconClass=null!=(t=n.value)?t:e.classes[0],n.ngModel&&(e.model=e[n.ngModel],!e.model&&e.initFirstValue&&(e.model=e.iconGroupsMap[0].prefix+" "+e.iconGroupsMap[0].classes[1]),e.$watch("iconClass",function(){return e.hideColorSelector?e.model=e.iconClass||"":e.model=(e.iconClass||"")+","+(e.iconBackColor||"inherit")+","+(e.iconForeColor||"inherit")}),e.$watch("model",function(){return r()}),e.$watch("iconBackColor",function(){return e.hideColorSelector?e.model=e.iconClass||"":(e.model=(e.iconClass||"")+","+(e.iconBackColor||"inherit")+","+(e.iconForeColor||"inherit"),r())}),e.$watch("iconForeColor",function(){return e.hideColorSelector?e.model=e.iconClass||"":(e.model=(e.iconClass||"")+","+(e.iconBackColor||"inherit")+","+(e.iconForeColor||"inherit"),r())}))}return e.iconGroupsMap={bootstrap:{prefix:"glyphicon glyphicon-",classes:["asterisk","plus","euro","minus","cloud","envelope","pencil","glass","music","search","heart","star","star-empty","user","film","th-large","th","th-list","ok","remove","zoom-in","zoom-out","off","signal","cog","trash","home","file","time","road","download-alt","download","upload","inbox","play-circle","repeat","refresh","list-alt","lock","flag","headphones","volume-off","volume-down","volume-up","qrcode","barcode","tag","tags","book","bookmark","print","camera","font","bold","italic","text-height","text-width","align-left","align-center","align-right","align-justify","list","indent-left","indent-right","facetime-video","picture","map-marker","adjust","tint","edit","share","check","move","step-backward","fast-backward","backward","play","pause","stop","forward","fast-forward","step-forward","eject","chevron-left","chevron-right","plus-sign","minus-sign","remove-sign","ok-sign","question-sign","info-sign","screenshot","remove-circle","ok-circle","ban-circle","arrow-left","arrow-right","arrow-up","arrow-down","share-alt","resize-full","resize-small","exclamation-sign","gift","leaf","fire","eye-open","eye-close","warning-sign","plane","calendar","random","comment","magnet","chevron-up","chevron-down","retweet","shopping-cart","folder-close","folder-open","resize-vertical","resize-horizontal","hdd","bullhorn","bell","certificate","thumbs-up","thumbs-down","hand-right","hand-left","hand-up","hand-down","circle-arrow-right","circle-arrow-left","circle-arrow-up","circle-arrow-down","globe","wrench","tasks","filter","briefcase","fullscreen","dashboard","paperclip","heart-empty","link","phone","pushpin","usd","gbp","sort","sort-by-alphabet","sort-by-alphabet-alt","sort-by-order","sort-by-order-alt","sort-by-attributes","sort-by-attributes-alt","unchecked","expand","collapse-down","collapse-up","log-in","flash","log-out","new-window","record","save","open","saved","import","export","send","floppy-disk","floppy-saved","floppy-remove","floppy-save","floppy-open","credit-card","transfer","cutlery","header","compressed","earphone","phone-alt","tower","stats","sd-video","hd-video","subtitles","sound-stereo","sound-dolby","sound-5-1","sound-6-1","sound-7-1","copyright-mark","registration-mark","cloud-download","cloud-upload","tree-conifer","tree-deciduous","none"]},"font-awesome":{prefix:"fa fa-lg fa-",classes:["glass","music","search","envelope-o","heart","star","star-o","user","film","th-large","th","th-list","check","times","search-plus","search-minus","power-off","signal","gear","cog","trash-o","home","file-o","clock-o","road","download","arrow-circle-o-down","arrow-circle-o-up","inbox","play-circle-o","rotate-right","repeat","refresh","list-alt","lock","flag","headphones","volume-off","volume-down","volume-up","qrcode","barcode","tag","tags","book","bookmark","print","camera","font","bold","italic","text-height","text-width","align-left","align-center","align-right","align-justify","list","dedent","outdent","indent","video-camera","picture-o","pencil","map-marker","adjust","tint","edit","pencil-square-o","share-square-o","check-square-o","arrows","step-backward","fast-backward","backward","play","pause","stop","forward","fast-forward","step-forward","eject","chevron-left","chevron-right","plus-circle","minus-circle","times-circle","check-circle","question-circle","info-circle","crosshairs","times-circle-o","check-circle-o","ban","arrow-left","arrow-right","arrow-up","arrow-down","mail-forward","share","expand","compress","plus","minus","asterisk","exclamation-circle","gift","leaf","fire","eye","eye-slash","warning","exclamation-triangle","plane","calendar","random","comment","magnet","chevron-up","chevron-down","retweet","shopping-cart","folder","folder-open","arrows-v","arrows-h","bar-chart-o","twitter-square","facebook-square","camera-retro","key","gears","cogs","comments","thumbs-o-up","thumbs-o-down","star-half","heart-o","sign-out","linkedin-square","thumb-tack","external-link","sign-in","trophy","github-square","upload","lemon-o","phone","square-o","bookmark-o","phone-square","twitter","facebook","github","unlock","credit-card","rss","hdd-o","bullhorn","bell","certificate","hand-o-right","hand-o-left","hand-o-up","hand-o-down","arrow-circle-left","arrow-circle-right","arrow-circle-up","arrow-circle-down","globe","wrench","tasks","filter","briefcase","arrows-alt","group","users","chain","link","cloud","flask","cut","scissors","copy","files-o","paperclip","save","floppy-o","square","bars","list-ul","list-ol","strikethrough","underline","table","magic","truck","pinterest","pinterest-square","google-plus-square","google-plus","money","caret-down","caret-up","caret-left","caret-right","columns","unsorted","sort","sort-down","sort-asc","sort-up","sort-desc","envelope","linkedin","rotate-left","undo","legal","gavel","dashboard","tachometer","comment-o","comments-o","flash","bolt","sitemap","umbrella","paste","clipboard","lightbulb-o","exchange","cloud-download","cloud-upload","user-md","stethoscope","suitcase","bell-o","coffee","cutlery","file-text-o","building-o","hospital-o","ambulance","medkit","fighter-jet","beer","h-square","plus-square","angle-double-left","angle-double-right","angle-double-up","angle-double-down","angle-left","angle-right","angle-up","angle-down","desktop","laptop","tablet","mobile-phone","mobile","circle-o","quote-left","quote-right","spinner","circle","mail-reply","reply","github-alt","folder-o","folder-open-o","smile-o","frown-o","meh-o","gamepad","keyboard-o","flag-o","flag-checkered","terminal","code","reply-all","mail-reply-all","star-half-empty","star-half-full","star-half-o","location-arrow","crop","code-fork","unlink","chain-broken","question","info","exclamation","superscript","subscript","eraser","puzzle-piece","microphone","microphone-slash","shield","calendar-o","fire-extinguisher","rocket","maxcdn","chevron-circle-left","chevron-circle-right","chevron-circle-up","chevron-circle-down","html5","css3","anchor","unlock-alt","bullseye","ellipsis-h","ellipsis-v","rss-square","play-circle","ticket","minus-square","minus-square-o","level-up","level-down","check-square","pencil-square","external-link-square","share-square","compass","toggle-down","caret-square-o-down","toggle-up","caret-square-o-up","toggle-right","caret-square-o-right","euro","eur","gbp","dollar","usd","rupee","inr","cny","rmb","yen","jpy","ruble","rouble","rub","won","krw","bitcoin","btc","file","file-text","sort-alpha-asc","sort-alpha-desc","sort-amount-asc","sort-amount-desc","sort-numeric-asc","sort-numeric-desc","thumbs-up","thumbs-down","youtube-square","youtube","xing","xing-square","youtube-play","dropbox","stack-overflow","instagram","flickr","adn","bitbucket","bitbucket-square","tumblr","tumblr-square","long-arrow-down","long-arrow-up","long-arrow-left","long-arrow-right","apple","windows","android","linux","dribbble","skype","foursquare","trello","female","male","gittip","sun-o","moon-o","archive","bug","vk","weibo","renren","pagelines","stack-exchange","arrow-circle-o-right","arrow-circle-o-left","toggle-left","caret-square-o-left","dot-circle-o","wheelchair","vimeo-square","turkish-lira","try","plus-square-o","fw"]}},a(),e.$dropdownButton=t.find("button").eq(0),e.disabled=null!=n.disabled}return{replace:!0,restrict:"E",scope:{name:"@",model:"=?ngModel",hideColorSelector:"@?",initFirstValue:"=?"},template:'<div class="wizdom-icon-picker"><div class="dropdown ui-iconpicker" ng-class="{ disabled : disabled }" dropdown style="display:inline"><div class="btn-group" role="group" aria-label="..."><a class="btn btn-default dropdown-toggle" dropdown-toggle href ng-style="iconStyle"><i ng-show="iconClass" class="{{ iconClass }}" ng-style="iconStyle"></i> <span ng-hide="iconClass">{{\'Select icon\' | translate}}</span></a> <a class="btn btn-default" title="{{\'Background color\' | translate }}" ng-model="iconBackColor" colorpicker ng-hide="hideColorSelector"><i class="glyphicon glyphicon-text-background"></i></a> <a class="btn btn-default" title="{{\'Foreground color\' | translate }}" ng-model="iconForeColor" colorpicker ng-hide="hideColorSelector"><i class="glyphicon glyphicon-text-color"></i></a></div><ul class="dropdown-menu" role="menu"><li ng-repeat="class in classes"><button class="btn btn-default" type="button" ng-click="$parent.iconClass = class"><span class="{{ class }}"></span></button></li></ul></div></div>',link:e,controller:t}}function t(e){}angular.module("Wizdom365").directive("wizdom365IconPicker",e),t.$inject=["$scope"]}(),function(){function e(e){function i(i,o,r,a){function l(t){try{if(0==t.data.indexOf("imageUploaded_"+c)){var n=i.resultAsObject&&i.resultAsObject.length>0?JSON.parse(t.data.substr(51)):t.data.substr(51);if(i.multiple){var o=a.$viewValue||[];_.forEach(n,function(e){var t=!0;_.forEach(o,function(n){return n.Url.toLowerCase()==e.Url.toLowerCase()?t=!1:void 0}),t&&o.push(e)}),n=o}a.$setViewValue(n)}else 0==t.data.indexOf("imageUploadFailed_"+c)&&t.data.indexOf("maxRequestLength")>0&&e.showErrorMessage("File size exceeds the limit allowed")}catch(r){}}function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}var c=s(),d=(window.Wizdom365AppUrl?window.Wizdom365AppUrl:"/")+"Base/Scripts/Tinymce/plugins/wizdomImagePicker/uploader.aspx?sessionId="+c;i.imageclass&&i.imageclass.length>0&&(d+="&imageClass="+i.imageclass),i.imagecolor&&i.imagecolor.length>0&&(d+="&imageColor="+encodeURIComponent(i.imagecolor)),i.wizdommodule&&i.wizdommodule.length>0&&(d+="&wizdommodule="+i.wizdommodule),i.subfolder&&(d+="&subfolder="+i.subfolder),void 0!=i.multiple&&(d+="&multiple="+i.multiple),void 0!=i.validateFormat&&(d+="&validate="+i.validateFormat),i.resultAsObject&&i.resultAsObject.length>0&&(d+="&resultAsObject="+i.resultAsObject),o.attr("src",d),a.$render=function(){o.html(a.$viewValue||"")};try{t(l)}catch(u){}n(l)}return{restrict:"E",require:"?ngModel",scope:{imageclass:"@",imagecolor:"@",wizdommodule:"@",subfolder:"=",multiple:"=",validateFormat:"=",resultAsObject:"@?"},replace:!0,transclude:!0,template:'<iframe scrolling="no" class="attachment-iframe" frameborder="0" ></iframe>',link:i}}function t(e){"undefined"!=typeof window.removeEventListener?window.removeEventListener("message",e,!1):"undefined"!=typeof window.detachEvent&&window.detachEvent("onmessage",e)}function n(e){"undefined"!=typeof window.addEventListener?window.addEventListener("message",e,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmessage",e)}angular.module("Wizdom365").directive("wizdom365ImagePicker",e),e.$inject=["notificationService"]}(),function(){function e(){return{replace:!0,scope:{imageclass:"@",wizdommodule:"@",subfolder:"=",validateFormat:"=",result:"=",placeholder:"@?"},template:'<iframe scrolling="no" class="attachment-iframe" frameborder="0" ng-src="{{iframeUrl}}"></iframe>',controller:t}}function t(e,t,n,i){function o(t){try{if(0==t.data.indexOf("imageUploaded_"+r)){var i=t.data.substr(("imageUploaded_"+r).length+1);e.$apply(function(){e.result=i})}else 0==t.data.indexOf("imageUploadFailed_"+r)&&t.data.indexOf("maxRequestLength")>0&&n.showErrorMessage("File size exceeds the limit allowed")}catch(o){}}var r=i.newGuid(),a="";e.imageclass&&e.imageclass.length>0&&(a+="&imageClass="+e.imageclass),e.wizdommodule&&e.wizdommodule.length>0&&(a+="&wizdommodule="+e.wizdommodule),e.subfolder&&(a+="&subfolder="+e.subfolder),void 0!=e.validateFormat&&(a+="&validate="+e.validateFormat),e.iframeUrl=t.trustAsResourceUrl((window.Wizdom365AppUrl?window.Wizdom365AppUrl:"/")+"Base/Scripts/Tinymce/plugins/wizdomImagePicker/uploader.aspx?padding=0&sessionId="+r+a),"undefined"!=typeof window.addEventListener?window.addEventListener("message",o,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmessage",o)}angular.module("Wizdom365").directive("wizdom365ImagePickerInput",e),t.$inject=["$scope","$sce","notificationService","guidGenerator"]}(),function(){function e(){var e=this;return this.onShowComments=function(t){e.onShowComments.callbacks=e.onShowComments.callbacks||[],e.onShowComments.callbacks.push(t)},this.showComments=function(t,n){angular.forEach(e.onShowComments.callbacks,function(e){e(t,n)})},this.onHideComments=function(t){e.onHideComments.callbacks=e.onHideComments.callbacks||[],e.onHideComments.callbacks.push(t)},this.hideComments=function(t,n){angular.forEach(e.onHideComments.callbacks,function(e){e(t,n)})},this.onItemCommentAdded=function(t){e.onItemCommentAdded.callbacks=e.onItemCommentAdded.callbacks||[],e.onItemCommentAdded.callbacks.push(t)},this.itemCommentAdded=function(t,n){angular.forEach(e.onItemCommentAdded.callbacks,function(e){e(t,n)})},this}angular.module("Wizdom365.Noticeboard").factory("commentsPanelCommunication",e)}(),function(){function e(){return{scope:{item:"=?",itemid:"=",itemtype:"@",tooltipposition:"@",templateUrl:"=?"},template:'<div wizdom-include="::templateUrl"></div>',controller:t}}function t(e,t,n,i,o,r){function a(){var t=e.itemtype?e.itemtype.toLowerCase():"";"corporatenews"==t?(e.templateUrl=r.CorporateNews.SocialFeature.SocialSummaryTemplate,e.initshowcomments=!0):"manualpage"==t||"manual"==t?(e.templateUrl=r.Manual.SocialFeature.SocialSummaryTemplate,e.initshowcomments=!0):"contentpage"==t&&(e.templateUrl=r.ContentPage.SocialFeature.SocialSummaryTemplate,e.initshowcomments=!0),e.initshowcomments&&e.showComments(e.item,!0),(!e.templateUrl||e.templateUrl.indexOf("/SocialPreview/")<0)&&(e.templateUrl="Wizdom365/Templates/ViewTemplates/Social/SocialPreview/itemSocialPreview.html"),e.liked=!1,"undefined"!=typeof e.item&&null!=e.item&&(_.find(e.item.likes,function(e){try{return e.principal.loginName.toLowerCase()===i.userLoginName.toLowerCase()}catch(t){return!1}})&&(e.liked=!0),e.updateTooltipText())}function l(){var t={principal:{loginName:i.userLoginName,displayName:i.userDisplayName},targetID:e.itemid.toString(),targetType:d()};n.social.likeItem(t).then(function(n){n&&(e.liked=!e.liked,e.liked?e.item.likes.push(t):_.remove(e.item.likes,function(e){return e.principal.loginName.toLowerCase()==i.userLoginName.toLowerCase()}),e.updateTooltipText())})}function s(){e.item.likes&&0!=e.item.likes.length?1==e.item.likes.length?e.item.likes[0].principal.loginName==i.userLoginName?e.toolTipText=t("translate")("You like this."):e.toolTipText=t("translate")("{0} likes this.",e.item.likes[0].principal.displayName):e.liked&&e.item.likes.length-1==1?e.toolTipText=t("translate")("You and {0} like this.",_.find(e.item.likes,function(e){return e.principal.loginName.toLowerCase()!=i.userLoginName.toLowerCase()}).principal.displayName):(e.liked?e.toolTipText=t("translate")("You and {0} others like this: <br/>",e.item.likes.length-1):e.toolTipText=t("translate")("{0} people like this: <br/>",e.item.likes.length),_.forEach(e.item.likes,function(t){t.principal.loginName.toLowerCase()!=i.userLoginName.toLowerCase()&&(e.toolTipText+=t.principal.displayName+"<br/>")})):e.toolTipText=t("translate")("No likes yet...")}function c(){e.$parent.ShowItem(e.itemid)}function d(){var t=e.itemtype?e.itemtype.toLowerCase():"";return"item"==t||"nbitem"==t?1:"comment"==t?2:"corporatenews"==t?3:"manualpage"==t?4:"contentpage"==t?5:"kanban"==t?6:0}e.socialOverviewComments=r.Noticeboard?$.parseJSON(r.Noticeboard.SocialFeature.OverviewComments):!1,e.initshowcomments=e.$parent.INIT_SHOW_COMMENTS||!1,e.showComments=function(t,n){t&&(e.displayingComments=!0,t.scopeName=e.$parent?e.$parent.scopeName:"",t.scopeName||(t.scopeName=""),o.showComments(t,n),$(".txtComment_0_manualfocus").each(function(){$(this).focus();var e=$(this)[0];e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}))},e.hideComments=function(t,n){t&&(e.displayingComments=!1,t.scopeName=e.$parent?e.$parent.scopeName:"",t.scopeName||(t.scopeName=""),o.hideComments(t,n))},o.onItemCommentAdded(function(t,n){if(e.itemid==t){var i=_.find(e.item.comments,function(e){return e.commentID==n.commentID});i||e.item.comments.push(n)}}),e.liked=!1,e.toolTipText="...",e.displayingComments=!1,e.likeItem=l,e.initialize=a,e.updateTooltipText=s,e.showItem=c,e.$watch("item",function(e,t){void 0===t&&a()},!0),e.$watch("itemid",function(e,t){e!==t&&a()},!0),a()}angular.module("Wizdom365").directive("wizdom365ItemSocialContainer",e),t.$inject=["$scope","$filter","webApiProxy","contextInfo","commentsPanelCommunication","configuration"]}(),function(){function e(e){return{scope:{defaultValue:"=",daDkValue:"=",enUsValue:"=",nbNoValue:"=",svSeValue:"="},restrict:"E",replace:!0,template:'<div class="languageTextbox" ng-mouseout="mouseLeave();" ng-mouseover="mouseOver();"><div class="input-group input-group-sm"><input ng-model="defaultValue" class="form-control" ng-focus="defaultValueFocus()" ng-blur="defaultValueBlur();"> <span class="input-group-addon" ng-click="open();"><span class="flag" ng-class="languageValuesEnabled()?\'flag-allEnabled\':\'flag-allDisabled\'">&nbsp;</span></span></div><div ng-show="showLanguageTextboxes"><div class="input-group input-group-sm"><input ng-model="daDkValue" placeholder="{{defaultValue}}" ng-focus="valueFocus();" ng-blur="valueBlur();" class="form-control" style="border-top:none;"> <span class="input-group-addon"><span class="flag flag-da-dk">&nbsp;</span></span></div><div class="input-group input-group-sm"><input ng-model="enUsValue" placeholder="{{defaultValue}}" ng-focus="valueFocus();" ng-blur="valueBlur();" class="form-control" style="border-top:none;"> <span class="input-group-addon"><span class="flag flag-en-us">&nbsp;</span></span></div><div class="input-group input-group-sm"><input ng-model="nbNoValue" placeholder="{{defaultValue}}" ng-focus="valueFocus();" ng-blur="valueBlur();" class="form-control" style="border-top:none;"> <span class="input-group-addon"><span class="flag flag-nb-no">&nbsp;</span></span></div><div class="input-group input-group-sm"><input ng-model="svSeValue" placeholder="{{defaultValue}}" ng-focus="valueFocus();" ng-blur="valueBlur();" class="form-control" style="border-top:none;"> <span class="input-group-addon"><span class="flag flag-sv-se">&nbsp;</span></span></div></div></div>',controller:t}}function t(e,t,n,i){function o(){null!=c&&(t.cancel(c),c=null),c=t(function(){s&&l?e.showLanguageTextboxes=!0:(r||l)&&e.languageValuesEnabled()?e.showLanguageTextboxes=!0:a?e.showLanguageTextboxes=!0:(e.showLanguageTextboxes=!1,s=!1)})}e.showLanguageTextboxes=!1,e.languageValuesEnabled=function(){return e.daDkValue||e.enUsValue||e.nbNoValue||e.svSeValue};var r=!1,a=!1,l=!1,s=!1,c=null;e.defaultValueFocus=function(){r=!1,o()},e.defaultValueBlur=function(){r=!1,o()},e.valueFocus=function(){a=!0,o()},e.valueBlur=function(){a=!1,o()},e.mouseOver=function(){l=!0,o()},e.mouseLeave=function(){l=!1,o()},e.open=function(){s=!0,o()}}angular.module("Wizdom365").directive("wizdom365LanguageTextbox",e),e.$inject=["$parse"],t.$inject=["$scope","$timeout","$parse","$attrs"]}(),function(){function e(e,t,n,i,o){return{scope:{errorHandler:"=",uploadTo:"="},link:function(n,r,a){r.bind("change",function(a){n.$apply(function(){for(var a=new FormData,l=0;l<r.context.files.length;l++)a.append("uploadedFiles",r.context.files[l],r.context.files[l].name);n.xhr=new XMLHttpRequest,n.xhr.open("POST",e.buildUrl(n.uploadTo),!0),n.xhr.onload=function(){200!=n.xhr.status?(n.uploading=!1,n.errorHandler?n.errorHandler(n.xhr.response):t.showErrorMessage("File upload failed!",!0)):(n.uploading=!1,t.showSuccessMessage("File uploaded successfully!",!0),o(function(){i.location.reload()},1e3))},n.xhr.send(a)})})}}}angular.module("Wizdom365").directive("wizdom365LicenseFileUploader",e),e.$inject=["webapiService","notificationService","webApiProxy","$window","$timeout"]}(),function(){function e(){return{scope:{linkMetadata:"=linkMetadata"},template:'<div class="previewPosted"><span class="fr-view" ng-bind-html="htmlContent" ng-show="showVideo" style="margin-bottom: 5px;" id="{{linkMetadata.description.length}}"></span><div class="previewImagesPosted" ng-click="startVideo();" ng-show="!showVideo"><div class="previewImagePosted"><a class="image-viewer"><img ng-src="{{linkMetadata.thumbnailurl}}" style="max-width:130px; float: left;"></a> <span class="videoPostPlay" id="videoPostPlayF" ng-show="linkMetadata.type == 3"></span></div></div><div class="previewContentPosted"><div class="previewTitlePosted"><a ng-href="{{linkMetadata.url}}" target="_blank"><span id="previewSpanTitle" style="background-color: transparent; display: inline;">{{linkMetadata.title}}</span></a></div><div class="previewUrlPosted"><a ng-href="{{linkMetadata.providerurl}}" target="_blank"><span id="previewSpanTitle" style="background-color: transparent; display: inline;">{{linkMetadata.provider}}</span></a> <a ng-href="{{linkMetadata.authorurl}}" target="_blank" ng-show="linkMetadata.author">| <span id="previewSpanTitle" style="background-color: transparent; display: inline;">{{linkMetadata.author}}</span></a></div><div class="previewDescriptionPosted"><span>{{(linkMetadata.description.length > 145) ? (linkMetadata.description.substring(0, 145) + \'...\') : linkMetadata.description}}</span></div></div><div style="clear: both"></div></div>',controller:t}}function t(e,t,n){function i(){"undefined"!=typeof e.linkMetadata&&null!=e.linkMetadata&&(e.htmlContent=n(e.linkMetadata.embedcontent))}function o(){3==e.linkMetadata.type&&(e.showVideo=!0)}e.htmlContent="",e.showVideo=!1,e.initialize=i,e.startVideo=o,e.$watch("linkMetadata",function(e,t){e!==t&&i()},!0),i()}angular.module("Wizdom365").directive("wizdom365LinkPreview",e),t.$inject=["$scope","$filter","wizdomSanitizeAndTrust"]}(),function(){function e(e){function n(e,t,n){}return{scope:{selectedlocation:"="},template:'<select ng-options="o as o for o in locations" ng-model="selected" ng-change="onChange()" class="form-control">\n                        <option value="">{{"All" | translate}}</option>\n                      </select>',link:n,controller:t}}function t(e,t,n,i){function o(){i.terms.getAllTermsById("b49f64b3-4722-4336-9a5c-56c326b344d4").then(function(t){e.locations=t,e.selected=e.selectedlocation})}e.locations=[],e.onChange=function(){e.selected?e.selectedlocation=e.selected:e.selectedlocation=""},o()}angular.module("Wizdom365").directive("wizdom365LocationsDropdown",e),e.$inject=[],t.$inject=["$scope","$http","contextInfo","webApiProxy"]}(),function(){function e(e,t){return{scope:!1,replace:!0,template:"<div class='wizdom365Picker'><input class='textbox form-control' /><div class='foldout' /></div>",transclude:"true",require:"ngModel",compile:function(e,n,i){return function(e,o,r,a){function l(o,r){t.when(e[n.searchFunction](o)).then(function(t){var o=[];_.chain(s.children()).forEach(function(e){e.remove()}),_.chain(o).forEach(function(e){e.$destroy()}),o=[],_.chain(t).forEach(function(t){var r=e.$new(!1,e.$parent);r[n.wizdom365Picker]=t,i(r,function(e){o.push(r),s.append(e)})}),s.toggle(t.length>0)})}var s=$(o).find(".foldout");$(o).find("input.textbox").on("input",function(){a.$setViewValue($(this).val()),l($(this).val(),!0)});a.$render=function(){$(o).find("input.textbox").val(a.$viewValue),l(a.$viewValue,!1)}}}}}angular.module("Wizdom365").directive("wizdom365Picker",e),e.$inject=["$parse","$q"]}(),function(){function e(e,t){function n(n,i,o){function r(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}n.init=function(){window.EnsureScriptFunc("clienttemplates.js","RenderUserFieldWorker",function(){switch(n.pixels=48,"EXTRASMALL"==n.size?n.pixels=16:"SMALL"==n.size?n.pixels=36:"LARGE"==n.size&&(n.pixels=72),n.type){case"defaultrender":n.fieldSchemaData={DefaultRender:"1"};break;case"presenceonly":n.fieldSchemaData={PresenceOnly:"1"};break;case"withpicturedetailview":n.fieldSchemaData={WithPictureDetailView:"1"};break;case"withpicture":n.fieldSchemaData={WithPicture:"1"};break;case"pictureonly":default:n.fieldSchemaData={PictureOnly:"1"},"AVATAR"!=n.size&&angular.extend(n.fieldSchemaData,{PictureSize:"Size_"+n.pixels+"px"})}var o="";n.linkTarget&&(o=' target="'+n.linkTarget+'" ');var a=new window.ContextInfo;a.Templates={},a.Templates.Fields={};var l,s={EffectivePresenceEnabled:"1",PresenceAlt:"User Presence"},c={title:n.name,email:n.email,picture:n.image,sip:n.email,accountname:n.accountname},d=window.RenderUserFieldWorker(a,n.fieldSchemaData,c,s),u=$(d);e.getProfileUrl.then(function(a){c.accountname&&!r(c.accountname)?l=a+"?accountname="+encodeURIComponent(c.accountname).replace(/\./g,"%2E"):c.email?l=a+"?user="+encodeURIComponent(c.email).replace(/\./g,"%2E"):c.accountname&&r(c.accountname)&&(l=a+"?user="+encodeURIComponent(c.accountname).replace(/\./g,"%2E")),(n.doNotLinkToProfile||!a)&&(l=!1);var s=u.find(".ms-peopleux-imgUserLink img");if(s&&s[0]){var m=s.attr("src");m=t.getPictureUrl(c.accountname);var p=new Date,g=(m.indexOf("?")>0?"&":"?")+"date="+p.getDate()+p.getMonth()+p.getFullYear();m+=g,m.indexOf("undefined")>-1&&(m=m.replace("undefined","")),s.attr("src",m),u.find(".ms-peopleux-userImgWrapper").html(s[0].outerHTML)}if($(i).empty(),"AVATAR"==n.size){var f=m||u.find(".ms-peopleux-imgUserLink img").attr("src")||e.spHostUrl+"/_layouts/15/userphoto.aspx?size=M&accountname=",h='<div class="avatar-frame"><img src="'+f+'" alt="'+n.email+'" /></div>';l&&(h='<div class="avatar-frame"><a '+o+' href="'+l+'"><img src="'+f+'" alt="'+n.email+'" /></a></div>'),u=$("<div />",{html:d}),u.find(".ms-tableCell").first().remove(),u.find(".ms-peopleux-imgUserLink").html(h),$(i).append(u),window.ProcessImn()}else if("SMALLROUNDED"==n.size||"ROUNDED"==n.size){var f=m||u.find(".ms-peopleux-imgUserLink img").attr("src")||e.spHostUrl+"/_layouts/15/userphoto.aspx?size=M&accountname=",h='<div><img style="width:30px;height:30px;border-radius: 30px;" src="'+f+'" alt="'+n.email+'" /></div>';l&&"<div><a "+o+'href="'+l+'"><img style="width:30px;height:30px;border-radius: 30px;" src="'+f+'" alt="'+n.email+'" /></a></div>',"ROUNDED"==n.size&&(h='<div><img style="border-radius: 30px;" src="'+f+'" alt="'+n.email+'" /></div>',l&&(h="<div><a "+o+'href="'+l+'"><img style="border-radius: 30px;" src="'+f+'" alt="'+n.email+'" /></a></div>')),u=$("<div />",{html:d}),u.find(".ms-tableCell").first().remove(),u.find(".ms-peopleux-imgUserLink").html(h),$(i).append(u),window.ProcessImn()}else $(i).append(u),window.ProcessImn()})})},n.$watchGroup(["email","accountname"],function(e,t){e!=t&&n.init()},!0),n.init()}return{scope:{size:"@?",email:"=?",accountname:"=?",name:"=?",url:"=?",image:"=?",type:"@?",linkTarget:"@?",doNotLinkToProfile:"@?"},link:n}}angular.module("Wizdom365").directive("wizdom365PresencePicture",e),e.$inject=["contextInfo","profileService"]}(),function(){function e(){return{scope:{principals:"=",useUserImg:"@?",mode:"@?",domain:"@?",placeholder:"@?",addFn:"&?",removeFn:"&?",allowmultiple:"@?",alloweveryone:"@?",allowExternalAndInternal:"@?",ngRequired:"=ngRequired",allowwizdomgroups:"@?"},template:'<div class="form-group principal-picker"><input type="text" ng-class="{\'ng-invalid\':(required && (principals==null || principals==undefined || principals.length==0))}" ng-model="asyncSelected" placeholder="{{placeholder}}" typeahead-on-select="addPrincipal($item, $model, $label);" typeahead="principal as (principal.category?\'(\'+principal.category+\') \':\'\')+ principal.displayName + (principal.loginName? \' - \' + principal.loginName : \'\') for principal in searchForPrincipal($viewValue)" typeahead-loading="loadingLocations" typeahead-template-url="customTemplate.html" class="form-control" typeahead-min-length="2" autocomplete="off" ng-model-options="{ updateOn: \'default blur\', debounce: { \'default\': 500, \'blur\': 0 } }"> <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i><ul class="list-group principal-picker-selected-list"><li class="list-group-item" ng-class="{\'alert alert-danger\':principal.error}" ng-repeat="principal in principals"><span ng-if="principal.loginName == \'Everybody\'">{{principal.displayName | translate}}</span> <span ng-if="principal.loginName != \'Everybody\'">{{principal.category?"("+principal.category+") ":""}}{{principal.displayName}}</span> <span ng-show="principal.loginName && (principal.groupId == null || principal.groupId.length == 0)">&lt;{{principal.loginName}}&gt;</span> <button type="button" class="close" ng-click="removePrincipal(principal)"><span aria-hidden="true">&times;</span></button></li></ul><script type="text/ng-template" id="customTemplate.html"><div class="typeahead-group-header" style="padding-left:20px" ng-if=\'match.model.resultSetLimitedTo\'>{{\'Top\' | translate}} {{match.model.resultSetLimitedTo}} {{\'results\' | translate}}:</div> <a> <span bind-html-unsafe="match.label | typeaheadHighlight:query"></span> </a></script></div>',controller:t}}function t(e,t,n){function i(){if((null==t.mode||""==t.mode)&&(t.mode="all"),(null==t.domain||""==t.domain)&&(t.domain="all"),null==t.useUserImg&&(t.useUserImg=!0),null==t.allowmultiple||""==t.allowmultiple?t.allowmultiple=!0:t.allowmultiple=JSON.parse(t.allowmultiple),null==t.principals&&(t.principals=[]),null==t.placeholder){var n="Select ";"groups"!==t.mode&&("internals"===t.domain?n+="internal ":"externals"===t.domain&&(n+="external ")),"all"==t.mode?n+=t.allowmultiple?"users or groups":"user or group":("users"==t.mode&&(n+="user"),"groups"==t.mode&&(n+="group"),t.allowmultiple&&(n+="s")),t.placeholder=e("translate")(n)}null==t.ngRequired||void 0==t.ngRequired?t.required=!1:t.required=t.ngRequired}function o(e,t){return e.id&&e.id==t.id||e.principalID&&e.principalID==t.principalID||e.loginName&&e.loginName==t.loginName||e.groupId&&e.groupId==t.groupId}function r(e,t){return _.any(e,function(e){return o(e,t)})}t.searchForPrincipal=function(i){function o(n,i){if(t.alloweveryone?JSON.parse(t.alloweveryone):!1){var o={id:"WizdomEverybody",displayName:e("translate")("Everybody"),loginName:"Everybody"};o.displayName.toLowerCase().indexOf(n.toLowerCase())>-1||o.loginName.toLowerCase().indexOf(n.toLowerCase())>-1?i.push(o):"Everyone".toLowerCase().indexOf(n.toLowerCase())>-1&&i.push(o)}if((t.allowExternalAndInternal?JSON.parse(t.allowExternalAndInternal):!1)&&("all"===t.domain||"externals"===t.domain)){var r={id:"WizdomExternals",displayName:e("translate")("Externals"),loginName:"Externals"};(r.displayName.toLowerCase().indexOf(n.toLowerCase())>-1||r.loginName.toLowerCase().indexOf(n.toLowerCase())>-1)&&i.push(r)}if((t.allowExternalAndInternal?JSON.parse(t.allowExternalAndInternal):!1)&&("all"===t.domain||"internals"===t.domain)){var a={id:"WizdomInternals",displayName:e("translate")("Internals"),loginName:"Internals"};(a.displayName.toLowerCase().indexOf(n.toLowerCase())>-1||a.loginName.toLowerCase().indexOf(n.toLowerCase())>-1)&&i.push(a)}}function r(e,n){return t.showingMax=!1,e.length>n&&(e=e.slice(0,n),t.showingMax=!0,e[0].resultSetLimitedTo=n),e}if(!i||i.length<2)return[];var a=(t.allowwizdomgroups?JSON.parse(t.allowwizdomgroups):!1)||!1,l="all"===t.domain||"externals"===t.domain,s="all"===t.domain||"internals"===t.domain;return"all"==t.mode?n.principals.searchUsersAndGroups(i,a,l,s).then(function(e){return o(i,e),r(e,5)}):"users"==t.mode?n.principals.searchUsers(i,l,s).then(function(e){return o(i,e),r(e,5)}):"groups"==t.mode?n.principals.searchGroups(i,a).then(function(e){return o(i,e),r(e,5)}):void 0},t.addPrincipal=function(e){var i=t.allowmultiple?JSON.parse(t.allowmultiple):!0;i||_.forEach(t.principals,function(e){t.removePrincipal(e)}),r(t.principals,e)||n.principals.ensure(e).then(function(n){e.principalID=n.principal.principalID,t.principals.push(e),t.principals.sort(function(e,t){return e.displayName<t.displayName?-1:1}),t.asyncSelected="",null!=t.addFn&&t.addFn({principal:e})})},t.removePrincipal=function(e){if(r(t.principals,e)){var n=-1;_.remove(t.principals,function(i){return o(i,e)?(n=_.indexOf(t.principals,e),!0):!1}),null!=t.removeFn&&t.removeFn({principal:e,position:n})}},i()}angular.module("Wizdom365").directive("wizdom365Principalpicker",e),t.$inject=["$filter","$scope","webApiProxy"]}(),function(){function e(e,t){return{link:function(t,n,i){t.$watch(i.wizdom365SetFocus,function(t){t===!0&&(n.is("input, textarea")||(n=n.find("input, textarea").first().focus()),e(function(){n[0].focus(),n[0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},0,!1))})}}}angular.module("Wizdom365").directive("wizdom365SetFocus",e),e.$inject=["$timeout","log"]}(),angular.module("Wizdom365").directive("setPopoverPosition",["$window",function(e){function t(e,t,n){e.getPopovers=function(){return $(".popover").length},e.$watch(e.getPopovers,function(e,t){if(0==t&&1==e){var n={width:window.innerWidth||document.body.clientWidth,height:window.innerHeight||document.body.clientHeight};setTimeout(function(){var e,t,i,o=$(".popover"),r=o.position(),a={width:o.outerWidth(),height:o.outerHeight()},l=angular.extend({},r,a);if(o.hasClass("auto")&&(o.hasClass("top")&&l.top<0?o.removeClass("top").addClass("bottom"):o.hasClass("right")&&l.left+l.width>n.width?o.removeClass("right").addClass("left"):o.hasClass("bottom")&&l.top+l.height>n.height?o.removeClass("bottom").addClass("top"):o.hasClass("left")&&l.left<0&&o.removeClass("left").addClass("right")),o.hasClass("right")||o.hasClass("left"))if(l.top+l.height>n.height){var s=l.top+l.height-n.height;i=l.top-s,t=s/l.height*100,o.css("top",i+"px"),o.find(".arrow").css("top",50+t+"%")}else l.top<0&&(t=l.top/l.height*100,o.css("top","0px"),o.find(".arrow").css("top",50+t+"%"));else if(o.hasClass("bottom")||o.hasClass("top"))if(l.left+l.width>n.width){var s=l.left+l.width-n.width;e=l.left-s,t=s/l.width*100,o.css("left",e+"px"),o.find(".arrow").css("left",50+t+"%")}else l.left<0&&(t=l.left/l.width*100,o.css("left","0px"),o.find(".arrow").css("left",50+t+"%"))},500)}},!0)}return{link:t}}]),function(){function e(){return{template:'<div style="position:relative;"><div class="wizdom365Loading" ng-if="loading"><div class="bullet"></div><div class="bullet"></div><div class="bullet"></div><div class="bullet"></div></div></div>',scope:{loading:"="}}}angular.module("Wizdom365").directive("wizdom365Spinner",e)}(),function(){function e(){function e(e,i,o,r){function a(e){try{}catch(t){}}function l(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}var s=l(),c=window._spPageContextInfo.siteAbsoluteUrl+"/_layouts/15/PickerTreeView.aspx?sessionId="+s;i.attr("src",c),r.$render=function(){i.html(r.$viewValue||"")};try{t(a)}catch(d){}n(a)}return{restrict:"E",require:"?ngModel",scope:{},replace:!0,transclude:!0,template:'<iframe height="600px" width="100px" frameborder="0" id="wzSpsitePicker"></iframe>',link:e}}function t(e){"undefined"!=typeof window.removeEventListener?window.removeEventListener("message",e,!1):"undefined"!=typeof window.detachEvent&&window.detachEvent("onmessage",e)}function n(e){"undefined"!=typeof window.addEventListener?window.addEventListener("message",e,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmessage",e)}angular.module("Wizdom365").directive("wizdom365SpsitePicker",e)}(),function(){function e(){return{scope:{selectedTerms:"=",termSetId:"@?",fieldName:"@?",allowOnlyOneTerm:"@?",ngRequired:"=ngRequired",placeholder:"@?"},template:'<div class="peopleInput input-group filter-group" ng-show="selectedTerms.length > 0"><a class="filter btn btn-default" ng-repeat="term in selectedTerms" ng-click="removeFilter(term)">{{term.label}} <span class="glyphicon glyphicon-remove"></span></a></div><input id="hiddenInputForValidation" type="text" style="display:none" ng-required="required" ng-model="selectedTerms[0]"><div class="taxonomyFieldInput" style="width: 100%; padding: 0; display: inline-table;" ng-class="{\'ng-invalid form-control\':(required && (selectedTerms==null || selectedTerms==undefined || selectedTerms.length==0))}"><div class="input-group" ng-if="(termSetId != null && termSetId.length > 1)||(fieldName != null && fieldName.length > 1)"><input type="text" class="form-control" autocomplete="off" typeahead-on-select="filterSelected($item, $model, $label); selectedTerm = \'\';" ng-model="selectedTerm" typeahead="term as term.name for term in termSetList | filter:$viewValue | limitTo:8" ng-disabled="(allowOnlyOneTerm == \'true\' && selectedTerms.length > 0)" placeholder="{{allowOnlyOneTerm == \'true\' && selectedTerms.length > 0 ? (\'No more terms can be selected\' | translate) : (placeholder && placeholder != \'\' ? placeholder : (\'Enter Term\' | translate))}}"> <span class="input-group-addon" style="cursor:pointer" ng-click="pickTermSet()"><img src="/_layouts/15/images/EMMCopyTerm.png" alt="{{\'Pick terms\' | translate}}" class="ms-taxonomy-browser-button"></span></div><div class="peopleInput" ng-if="(termSetId == null || termSetId.length == 0) && (fieldName == null || fieldName.length == 0)">{{\'TermSet is not selected for this field.\' | translate}}</div></div>',controller:t}}function t(e,t,n,i){function o(){if(null==t.ngRequired||void 0==t.ngRequired?t.required=!1:t.required=t.ngRequired,t.selectedTerms=angular.copy(t.selectedTerms||[]),t.termSetList=[],t.fieldName)n.terms.getAllTermsWithIDsByFieldName(t.fieldName).then(function(e){t.termSetList=e});else{if(null==t.termSetId||""===t.termSetId)return;n.terms.getAllTermsWithIDsById(t.termSetId).then(function(e){t.termSetList=e})}}t.filterSelected=function(e,n,i){for(var o=!1,r=0;r<t.selectedTerms.length;++r){var a=t.selectedTerms[r];if(a.label==i){o=!0;break}}o||t.selectedTerms.push({label:i,filter:e.name+"|"+e.id})},t.removeFilter=function(e){var n=t.selectedTerms.indexOf(e);t.selectedTerms.splice(n,1)},t.pickTermSet=function(){i.open({template:'<div class="modal-header"><button type="button" class="close closebtn" data-ng-click="cancel()" aria-hidden="true">&times;</button><h1 class="modal-title">{{\'Choose term\' | translate}}</h1></div><div class="modal-body"><div class="wizdom-controls"><div class="row wizdom-controls-row" ng-show="!loading && !errorState"><div class="col-xs-12 col-md-12"><div style="background-color:#f9f9f9;border:1px solid #f2f2f2;padding:10px;"><treecontrol style="width:100%;" class="tree-light" tree-model="termsTreeData" options="treeOptions" selected-nodes="selectedTerms" selected-node="selectedTerm" expanded-nodes="expandedNodes" on-selection="nodeSelected(node, selected, $parentNode)"><span><span aria-hidden="true"><img height="16" src="/_layouts/15/Images/EMMTerm.png" width="16"></span> {{node.name}}</span></treecontrol></div></div></div></div><div wizdom365-spinner loading="loading"></div><div ng-show="!loading && errorState"><p>{{"Error occured. Please contact your IT administrator." | translate}}</p></div></div><div class="modal-footer"><button class="btn btn-success" ng-click="save()">{{\'Ok\' | translate}}</button> <button class="btn btn-default" ng-click="cancel()">{{\'Cancel\' | translate}}</button></div>',controller:"Wizdom365TaxonomyPickerTreeController",windowClass:"bootstrap-wrapper",resolve:{termsetId:function(){return t.termSetId},multiSelect:function(){return!("true"===t.allowOnlyOneTerm)},preSelectedTerms:function(){return t.selectedTerms},fieldName:function(){return t.fieldName}}}).result.then(function(e){e&&(t.selectedTerms=[],angular.forEach(e,function(e){t.selectedTerms.push({label:e.name,filter:e.name+"|"+e.id})}))})},o()}angular.module("Wizdom365").directive("wizdom365Taxonomypicker",e),t.$inject=["$filter","$scope","webApiProxy","$modal"]}(),function(){function e(){return{scope:{appname:"@",selectedvalue:"=",sourceurl:"@"},restrict:"A",template:'<wizdom365-spinner loading="loading"></wizdom365-spinner><select class="form-control" ng-model="vm.termSetSelected" ng-options="termSet.termSetName group by termSet.termSetGroup for termSet in vm.termsets track by termSet.termSetId" ng-change="vm.termsetChanged()"></select>',controller:t,controllerAs:"vm"}}function t(e,t){function n(){e.loading=!0,t.terms.getAllTermSets(e.sourceurl).then(function(t){if(i.termsets=t,e.selectedvalue)for(var n=0;n<i.termsets.length;n++)i.termsets[n].termSetId==e.selectedvalue.termSetId&&(i.termSetSelected=i.termsets[n]);e.loading=!1})}var i=this;n(),i.termsetChanged=function(){e.selectedvalue=i.termSetSelected}}angular.module("Wizdom365").directive("wizdom365TaxonomyTermSetPicker",e),t.$inject=["$scope","webApiProxy"]}(),function(){function e(e){function t(t,n,i,o){e.webpartTemplates.getViewTemplates(t.directoryPath).then(function(e){t.templates=[];for(var n=0;n<e.length;n++){var i=e[n].split("/"),o=i[i.length-1].split(".")[0];t.templates.push({templatePath:e[n],templateName:o})}var r=e.indexOf(t.templateUrl);r>=0?t.selectedTemplate=e[r]:t.selectedTemplate=e[0]}),t.$watch("selectedTemplate",function(e,n){e!==n&&(t.templateUrl=t.selectedTemplate)}),t.$watch("templateUrl",function(e,n){e!==n&&(t.templateUrl=e,t.selectedTemplate=e)})}return{scope:{templateUrl:"=",directoryPath:"@"},template:"<select class='form-control' ng-model='selectedTemplate'ng-options='template.templatePath as template.templateName for template in templates'></select>",link:t}}angular.module("Wizdom365").directive("wizdom365TemplatePicker",e),e.$inject=["webApiProxy"]}(),function(){function e(){return{replace:!0,restrict:"E",scope:{name:"@",model:"=ngModel",hideColorSelector:"@?",initFirstValue:"=?"},template:'<div class="wizdom-icon-picker"><div class="dropdown ui-iconpicker" ng-class="{ disabled : disabled }" dropdown style="display:inline"><div class="btn-group" role="group" aria-label="..."><a class="btn btn-default dropdown-toggle" ng-click="vm.hasClick = true" ng-style="{\'color\': vm.returnObj.color, \'background-color\': vm.returnObj.backgroundColor}" dropdown-toggle href><i ng-show="vm.returnObj.icon" class="{{ vm.returnObj.icon }}"></i> <span ng-hide="vm.returnObj.icon">{{\'Select icon\' | translate}}</span></a> <a class="btn btn-default" title="{{\'Background color\' | translate }}" ng-model="vm.returnObj.backgroundColor" colorpicker ng-hide="hideColorSelector"><i class="glyphicon glyphicon-text-background"></i></a> <a class="btn btn-default" title="{{\'Foreground color\' | translate }}" ng-model="vm.returnObj.color" colorpicker ng-hide="hideColorSelector"><i class="glyphicon glyphicon-text-color"></i></a></div><ul class="dropdown-menu" role="menu"><li ng-if="vm.hasClick" ng-repeat="class in vm.classes"><button class="btn btn-default" type="button" ng-click="vm.returnObj.icon = vm.classPrefix + class"><span ng-class="vm.classPrefix + class"></span></button></li></ul></div></div>',controller:t,controllerAs:"vm"}}function t(e){var t=this;t.returnObj=e.model=e.model||{icon:"",color:"",backgroundColor:""},t.classPrefix="ms-Icon ms-Icon--",t.classes=["12PointStar","6PointStar","AADLogo","Accept","AccessibiltyChecker","AccessLogo","AccessLogoFill","AccountActivity","AccountBrowser","AccountManagement","Accounts","ActionCenter","ActivateOrders","ActivityFeed","Add","AddBookmark","AddEvent","AddFavorite","AddFavoriteFill","AddFriend","AddGroup","AddHome","AddIn","AddLink","AddNotes","AddOnlineMeeting","AddPhone","AddReaction","AddTo","AddToShoppingList","AddWork","Admin","AdminALogo32","AdminALogoFill32","AdminALogoInverse32","AdminCLogoInverse32","AdminDLogoInverse32","AdminELogoInverse32","AdminLLogoInverse32","AdminMLogoInverse32","AdminOLogoInverse32","AdminPLogoInverse32","AdminSLogoInverse32","AdminYLogoInverse32","Airplane","AirplaneSolid","AirTickets","AlarmClock","Album","AlbumRemove","AlertSettings","AlertSolid","AlignCenter","AlignHorizontalCenter","AlignHorizontalLeft","AlignHorizontalRight","AlignJustify","AlignLeft","AlignRight","AlignVerticalBottom","AlignVerticalCenter","AlignVerticalTop","AllApps","AllAppsMirrored","AllCurrency","AnalyticsLogo","AnalyticsQuery","AnalyticsReport","AnalyticsView","AnchorLock","Annotation","AppIconDefault","AppIconDefaultAdd","AppIconDefaultList","Archive","AreaChart","ArrangeBringForward","ArrangeBringToFront","ArrangeByFrom","ArrangeSendBackward","ArrangeSendToBack","Arrivals","ArrowDownRight8","ArrowDownRightMirrored8","ArrowTallDownLeft","ArrowTallDownRight","ArrowTallUpLeft","ArrowTallUpRight","ArrowUpRight","ArrowUpRight8","ArrowUpRightMirrored8","Articles","Ascending","AspectRatio","AssessmentGroup","AssessmentGroupTemplate","AssetLibrary","Assign","Asterisk","AsteriskSolid","ATPLogo","Attach","AustralianRules","AuthenticatorApp","AutoEnhanceOff","AutoEnhanceOn","AutoFillTemplate","AutoHeight","AutoRacing","AwayStatus","AzureAPIManagement","AzureKeyVault","AzureLogo","AzureServiceEndpoint","Back","BackgroundColor","Backlog","BacklogBoard","BacklogList","BackToWindow","Badge","Balloons","Bank","BankSolid","BarChart4","BarChartHorizontal","BarChartVertical","BarChartVerticalEdit","BarChartVerticalFill","BarChartVerticalFilter","BarChartVerticalFilterSolid","Baseball","BeerMug","BIDashboard","BidiLtr","BidiRtl","BingLogo","BirthdayCake","BlockContact","Blocked","Blocked12","Blocked2","Blocked2Solid","BlockedSite","BlockedSiteSolid12","BlockedSolid","Blog","BlowingSnow","Blur","Boards","Bold","BookAnswers","BookingsLogo","BookmarkReport","Bookmarks","BookmarksMirrored","BorderDash","BorderDot","BoxAdditionSolid","BoxCheckmarkSolid","BoxMultiplySolid","BoxPlaySolid","BoxSubtractSolid","BranchCommit","BranchCompare","BranchFork","BranchFork2","BranchLocked","BranchMerge","BranchPullRequest","BranchSearch","BranchShelveset","Breadcrumb","Breakfast","Brightness","Broom","BrowserScreenShot","BrowserTab","BrowserTabScreenshot","Brunch","Brush","BucketColor","BucketColorFill","BufferTimeAfter","BufferTimeBefore","BufferTimeBoth","Bug","BugSolid","Build","BuildDefinition","BuildIssue","BuildQueue","BuildQueueNew","BulkUpload","BulletedList","BulletedList2","BulletedList2Mirrored","BulletedListBullet","BulletedListBulletMirrored","BulletedListMirrored","BulletedListText","BulletedListTextMirrored","BulletedTreeList","Bullseye","BullseyeTarget","BullseyeTargetEdit","Bus","BusinessCenterLogo","BusinessHoursSign","BusSolid","ButtonControl","Cafe","Cake","Calculator","CalculatorAddition","CalculatorEqualTo","CalculatorMultiply","CalculatorNotEqualTo","CalculatorPercentage","CalculatorSubtract","Calendar","CalendarAgenda","CalendarDay","CalendarMirrored","CalendarReply","CalendarSettings","CalendarSettingsMirrored","CalendarWeek","CalendarWorkWeek","CalendarYear","Calories","CaloriesAdd","Camera","CampaignTemplate","Cancel","CannedChat","Car","CaretBottomLeftCenter8","CaretBottomLeftSolid8","CaretBottomRightCenter8","CaretBottomRightSolid8","CaretDown8","CaretDownSolid8","CaretHollow","CaretHollowMirrored","CaretLeft8","CaretLeftSolid8","CaretRight","CaretRight8","CaretRightSolid8","CaretSolid","CaretSolid16","CaretSolidDown","CaretSolidLeft","CaretSolidMirrored","CaretSolidRight","CaretSolidUp","CaretTopLeftCenter8","CaretTopLeftSolid8","CaretTopRightCenter8","CaretTopRightSolid8","CaretUp8","CaretUpSolid8","Cat","CellPhone","Certificate","CertifiedDatabase","ChangeEntitlements","Chart","ChartSeries","ChartTemplate","ChartXAngle","ChartYAngle","Chat","ChatBot","ChatInviteFriend","ChatSolid","Checkbox","CheckboxComposite","CheckboxCompositeReversed","CheckboxFill","CheckboxIndeterminate","CheckedOutByOther12","CheckedOutByYou12","CheckList","CheckListCheck","CheckListCheckMirrored","CheckListText","CheckListTextMirrored","CheckMark","ChevronDown","ChevronDownEnd6","ChevronDownMed","ChevronDownSmall","ChevronFold10","ChevronLeft","ChevronLeftEnd6","ChevronLeftMed","ChevronLeftSmall","ChevronRight","ChevronRightEnd6","ChevronRightMed","ChevronRightSmall","ChevronUnfold10","ChevronUp","ChevronUpEnd6","ChevronUpMed","ChevronUpSmall","Childof","Chopsticks","ChromeBack","ChromeBackMirrored","ChromeClose","ChromeFullScreen","ChromeMinimize","ChromeRestore","CircleAddition","CircleAdditionSolid","CircleFill","CircleHalfFull","CirclePause","CirclePauseSolid","CirclePlus","CircleRing","CircleShapeSolid","CircleStop","CircleStopSolid","CityNext","CityNext2","ClassNotebookLogo16","ClassNotebookLogo32","ClassNotebookLogoFill16","ClassNotebookLogoFill32","ClassNotebookLogoInverse","ClassNotebookLogoInverse16","ClassNotebookLogoInverse32","ClassroomLogo","Clear","ClearFilter","ClearFormatting","ClearFormattingA","ClearFormattingEraser","ClearNight","ClearSelection","ClearSelectionMirrored","ClipboardList","ClipboardListMirrored","ClipboardSolid","Clock","CloneToDesktop","ClosedCaption","ClosePane","ClosePaneMirrored","Cloud","CloudAdd","CloudDownload","CloudImportExport","CloudUpload","CloudWeather","Cloudy","Cocktails","Code","CodeEdit","Coffee","CoffeeScript","CollapseContent","CollapseContentSingle","CollapseMenu","CollegeFootball","CollegeHoops","Color","ColorSolid","ColumnLeftTwoThirds","ColumnLeftTwoThirdsEdit","ColumnOptions","ColumnRightTwoThirds","ColumnRightTwoThirdsEdit","ColumnVerticalSection","ColumnVerticalSectionEdit","Combine","Combobox","CommandPrompt","Comment","CommentActive","CommentAdd","CommentNext","CommentPrevious","CommentSolid","CommentUrgent","Commitments","Communications","CompanyDirectory","CompanyDirectoryMirrored","Compare","CompassNW","Completed","CompletedSolid","ComplianceAudit","ConfigurationSolid","ConnectContacts","ConnectVirtualMachine","ConstructionCone","ConstructionConeSolid","Contact","ContactCard","ContactCardSettings","ContactCardSettingsMirrored","ContactHeart","ContactInfo","ContactLink","ContactList","ContextMenu","Contrast","Copy","Cotton","Coupon","CPlusPlus","CPlusPlusLanguage","CreateMailRule","Cricket","CRMCustomerInsightsApp","CRMProcesses","CRMReport","CRMServices","Crop","Crown","CrownSolid","CSharp","CSharpLanguage","CSS","CubeShape","CustomizeToolbar","CustomList","CustomListMirrored","Cut","Cycling","D365TalentHRCore","D365TalentInsight","D365TalentLearn","DashboardAdd","Database","DatabaseSync","DataConnectionLibrary","Dataflows","DataflowsLink","DataManagementSettings","DateTime","DateTime2","DateTimeMirrored","DeactivateOrders","Decimals","DecisionSolid","DeclineCall","DecreaseIndentArrow","DecreaseIndentArrowMirrored","DecreaseIndentLegacy","DecreaseIndentText","DecreaseIndentTextMirrored","DefaultRatio","DefectSolid","DefenderTVM","Delete","DeleteColumns","DeleteRows","DeleteRowsMirrored","DeleteTable","DeliveryTruck","DelveAnalytics","DelveAnalyticsLogo","DelveLogo","DelveLogoFill","DelveLogoInverse","DependencyAdd","DependencyRemove","Deploy","Descending","Design","DesktopScreenshot","DeveloperTools","Devices2","Devices3","Devices4","Diagnostic","DiagnosticDataBarTooltip","Dialpad","Diamond","DiamondSolid","Dictionary","DictionaryRemove","DietPlanNotebook","DiffInline","DiffSideBySide","DisableUpdates","DisconnectVirtualMachine","Dislike","DislikeSolid","DistributeDown","DockLeft","DockLeftMirrored","DockRight","DocLibrary","DocsLogoInverse","Document","DocumentApproval","Documentation","DocumentManagement","DocumentReply","DocumentSearch","DocumentSet","DOM","DonutChart","Door","DoubleBookmark","DoubleChevronDown","DoubleChevronDown12","DoubleChevronDown8","DoubleChevronLeft","DoubleChevronLeft12","DoubleChevronLeft8","DoubleChevronLeftMed","DoubleChevronLeftMedMirrored","DoubleChevronRight","DoubleChevronRight12","DoubleChevronRight8","DoubleChevronUp","DoubleChevronUp12","DoubleChevronUp8","DoubleColumn","DoubleColumnEdit","DoubleDownArrow","Down","Download","DownloadDocument","DragObject","DrillDown","DrillDownSolid","DrillExpand","DrillShow","DrillThrough","DRM","Drop","Dropdown","DropShapeSolid","DuplicateRow","Duststorm","Dynamics365Logo","DynamicSMBLogo","EaseOfAccess","EatDrink","EdgeLogo","eDiscovery","Edit","EditContact","EditCreate","EditMail","EditMirrored","EditNote","EditPhoto","EditSolid12","EditSolidMirrored12","EditStyle","Education","Ellipse","Embed","EMI","Emoji","Emoji2","EmojiDisappointed","EmojiNeutral","EmojiTabSymbols","EmptyRecycleBin","Encryption","EngineeringGroup","EntitlementPolicy","EntitlementRedemption","EntryDecline","EntryView","Equalizer","EraseTool","Error","ErrorBadge","Event","Event12","EventAccepted","EventDate","EventDateMissed12","EventDeclined","EventInfo","EventTentative","EventTentativeMirrored","EventToDoLogo","ExcelDocument","ExcelLogo","ExcelLogo16","ExcelLogoFill","ExcelLogoFill16","ExcelLogoInverse","ExcelLogoInverse16","ExchangeLogo","ExchangeLogoFill","ExchangeLogoInverse","ExerciseTracker","ExpandMenu","ExploreContent","ExploreContentSingle","ExploreData","Export","ExportMirrored","ExternalBuild","ExternalTFVC","ExternalXAML","Eyedropper","EyeShadow","F12DevTools","FabricAssetLibrary","FabricDataConnectionLibrary","FabricDocLibrary","FabricFolder","FabricFolderConfirm","FabricFolderFill","FabricFolderSearch","FabricFormLibrary","FabricFormLibraryMirrored","FabricMovetoFolder","FabricNetworkFolder","FabricNewFolder","FabricOpenFolderHorizontal","FabricPictureLibrary","FabricPublicFolder","FabricReportLibrary","FabricReportLibraryMirrored","FabricSyncFolder","FabricTextHighlight","FabricTextHighlightComposite","FabricUnsyncFolder","FabricUserFolder","Family","FangBody","FastForward","FastMode","Favicon","FavoriteList","FavoriteStar","FavoriteStarFill","Fax","Feedback","FeedbackRequestMirroredSolid","FeedbackRequestSolid","FeedbackResponseSolid","Ferry","FerrySolid","FieldChanged","FieldEmpty","FieldFilled","FieldNotChanged","FieldReadOnly","FieldRequired","FileASPX","FileBug","FileCode","FileComment","FileCSS","FileHTML","FileImage","FileJAVA","FileLess","FilePDB","FileRequest","FileSass","FileSQL","FileSymlink","FileTemplate","FileTypeSolution","FileYML","Filter","Filters","FilterSettings","FilterSolid","FiltersSolid","Financial","FinancialMirroredSolid","FinancialSolid","Fingerprint","FitPage","FitWidth","FiveTileGrid","Flag","FlameSolid","Flashlight","FlickDown","FlickLeft","FlickRight","FlickUp","Flow","FlowChart","Flower","FocalPoint","Focus","Fog","Folder","FolderFill","FolderHorizontal","FolderList","FolderListMirrored","FolderOpen","FolderQuery","FolderSearch","FollowUser","Font","FontColor","FontColorA","FontColorSwatch","FontDecrease","FontIncrease","FontSize","Footer","FormLibrary","FormLibraryMirrored","Forum","Forward","ForwardEvent","Freezing","Frigid","FrontCamera","FSharp","FSharpLanguage","FullCircleMask","FullHistory","FullScreen","FullWidth","FullWidthEdit","FunctionalManagerDashboard","FunnelChart","GallatinLogo","Game","Generate","GenericScan","GenericScanFilled","GIF","Giftbox","GiftboxOpen","GiftBoxSolid","GiftCard","GitGraph","Glasses","Glimmer","GlobalNavButton","GlobalNavButtonActive","Globe","Globe2","GlobeFavorite","Go","Golf","GoMirrored","GoToDashboard","GotoToday","GreetingCard","GridViewLarge","GridViewMedium","GridViewSmall","GripperBarHorizontal","GripperBarVertical","GripperDotsVertical","GripperTool","Group","GroupedAscending","GroupedDescending","GroupedList","GroupList","GroupObject","GUID","Guitar","HailDay","HailNight","HalfAlpha","HalfCircle","HandsFree","Handwriting","HardDrive","HardDriveGroup","HardDriveLock","HardDriveUnlock","Header","Header1","Header2","Header3","Header4","Headset","HeadsetSolid","Health","HealthSolid","Heart","HeartBroken","HeartFill","Help","HelpMirrored","Hexagon","Hide","Hide2","Hide3","Highlight","HighlightMappedShapes","HintText","HistoricalWeather","History","Home","HomeGroup","HomeSolid","HomeVerify","HorizontalDistributeCenter","HorizontalTabKey","Hospital","Hotel","HourGlass","IconSetsFlag","IDBadge","IgnoreConversation","ImageCrosshair","ImageDiff","ImagePixel","ImageSearch","Import","ImportAllMirrored","Important","ImportMirrored","Inbox","InboxCheck","IncidentTriangle","IncomingCall","IncreaseIndentArrow","IncreaseIndentArrowMirrored","IncreaseIndentLegacy","IncreaseIndentText","IncreaseIndentTextMirrored","Info","Info2","InformationBarriers","InfoSolid","InkingTool","Insert","InsertColumnsLeft","InsertColumnsRight","InsertRowsAbove","InsertRowsBelow","InsertSignatureLine","InsertTextBox","Installation","InstallToDrive","InternalInvestigation","InternetSharing","IRMForward","IRMForwardMirrored","IRMReply","IRMReplyMirrored","IssueSolid","IssueTracking","IssueTrackingMirrored","Italic","JavaScriptLanguage","JoinOnlineMeeting","JS","KaizalaLogo","KeyboardClassic","KnowledgeArticle","Label","LadybugSolid","Lamp","LandscapeOrientation","LaptopSecure","LaptopSelected","LargeGrid","Leave","Library","Lifesaver","LifesaverLock","Light","Lightbulb","LightningBolt","LightWeight","Like","LikeSolid","Line","LineChart","LineSpacing","LineStyle","LineThickness","Link","Link12","LinkedDatabase","LinkedInLogo","List","ListMirrored","LocaleLanguage","Location","LocationCircle","LocationDot","LocationFill","LocationOutline","Lock","Lock12","LockSolid","LogRemove","LookupEntities","LowerBrightness","LyncLogo","M365InvoicingLogo","Mail","MailAlert","MailAttached","MailCheck","MailFill","MailForward","MailForwardMirrored","MailLowImportance","MailOptions","MailPause","MailReminder","MailRepeat","MailReply","MailReplyAll","MailReplyAllMirrored","MailReplyMirrored","MailSchedule","MailSolid","MailTentative","MailTentativeMirrored","MailUndelivered","ManagerSelfService","Manufacturing","MapDirections","MapLayers","MapPin","MapPinSolid","MarkAsProtected","MarkDownLanguage","Market","MarketDown","MasterDatabase","MaximumValue","Medal","MedalSolid","Media","MediaAdd","Medical","Megaphone","MegaphoneSolid","Memo","Merge","MergeDuplicate","Message","MessageFill","MicOff","MicOff2","Microphone","MicrosoftFlowLogo","MicrosoftStaffhubLogo","MicrosoftTranslatorLogo","MicrosoftTranslatorLogoBlue","MicrosoftTranslatorLogoGreen","MiniContract","MiniContractMirrored","MiniExpand","MiniExpandMirrored","MiniLink","MinimumValue","MobileReport","MobileSelected","ModelingView","Money","More","MoreSports","MoreVertical","MountainClimbing","Move","Movers","MoveToFolder","MSNLogo","MSNVideos","MSNVideosSolid","MultiSelect","MultiSelectMirrored","MusicInCollection","MusicInCollectionFill","MusicNote","MuteChat","MyMoviesTV","Nav2DMapView","NavigateBack","NavigateBackMirrored","NavigateExternalInline","NavigateForward","NavigateForwardMirrored","NavigationFlipper","NetworkTower","NewAnalyticsQuery","NewFolder","NewMail","News","NewsSearch","NewTeamProject","Next","NormalWeight","NoteForward","NotePinned","NoteReply","NotExecuted","NotImpactedSolid","NugetLogo","NumberedList","NumberedListNumber","NumberedListNumberMirrored","NumberedListText","NumberedListTextMirrored","NumberField","NumberSequence","NumberSymbol","Octagon","OEM","OfficeAddinsLogo","OfficeAssistantLogo","OfficeChat","OfficeChatSolid","OfficeFormsLogo","OfficeFormsLogo16","OfficeFormsLogo24","OfficeFormsLogoFill","OfficeFormsLogoFill16","OfficeFormsLogoFill24","OfficeFormsLogoInverse","OfficeFormsLogoInverse16","OfficeFormsLogoInverse24","OfficeLogo","OfficeStoreLogo","OfficeVideoLogo","OfficeVideoLogoFill","OfficeVideoLogoInverse","OfflineOneDriveParachute","OfflineOneDriveParachuteDisabled","OfflineStorage","OfflineStorageSolid","Onboarding","OneDriveAdd","OneDriveFolder16","OneDriveLogo","OneNoteEduLogoInverse","OneNoteLogo","OneNoteLogo16","OneNoteLogoFill","OneNoteLogoFill16","OneNoteLogoInverse","OneNoteLogoInverse16","OpenEnrollment","OpenFile","OpenFolderHorizontal","OpenInNewTab","OpenInNewWindow","OpenPane","OpenPaneMirrored","OpenSource","OpenWith","OpenWithMirrored","Org","Orientation","Orientation2","OutlookLogo","OutlookLogo16","OutlookLogoFill","OutlookLogoFill16","OutlookLogoInverse","OutlookLogoInverse16","OutOfOffice","Package","Packages","Padding","PaddingBottom","PaddingLeft","PaddingRight","PaddingTop","Page","PageAdd","PageArrowRight","PageCheckedin","PageCheckedOut","PageData","PageEdit","PageHeader","PageHeaderEdit","PageLeft","PageLink","PageList","PageListFilter","PageListMirroredSolid","PageListSolid","PageLock","PageRemove","PageRight","PageShared","PageSolid","PanoIndicator","Parachute","ParachuteSolid","Parameter","ParkingLocation","ParkingLocationMirrored","ParkingMirroredSolid","ParkingSolid","PartlyCloudyDay","PartlyCloudyNight","PartyLeader","PassiveAuthentication","PasswordField","Paste","PasteAsCode","PasteAsText","Pause","PaymentCard","PC1","PDF","PencilReply","Pentagon","PenWorkspace","People","PeopleAdd","PeopleAlert","PeopleBlock","PeoplePause","PeopleRepeat","Permissions","PermissionsSolid","Personalize","Phishing","Phone","Photo","Photo2","Photo2Add","Photo2Fill","Photo2Remove","PhotoCollection","PhotoVideoMedia","Picture","PictureCenter","PictureFill","PictureLibrary","PicturePosition","PictureStretch","PictureTile","PieDouble","PieSingle","PieSingleSolid","Pill","Pin","Pinned","PinnedFill","PinnedSolid","PinSolid12","PinSolidOff12","PivotChart","PlainText","PlannerLogo","PlanView","Play","PlaybackRate1x","PlayerSettings","PlayResume","PlayReverse","PlayReverseResume","Plug","PlugConnected","PlugDisconnected","PlugSolid","POI","POISolid","PollResults","PostUpdate","PowerApps","PowerApps2Logo","PowerAppsCDS","PowerAppsLogo","PowerBILogo","PowerBILogo16","PowerBILogoBackplate16","PowerButton","PowerPointDocument","PowerPointLogo","PowerPointLogo16","PowerPointLogoFill","PowerPointLogoFill16","PowerPointLogoInverse","PowerPointLogoInverse16","PowerShell","PowerShell2","Precipitation","PresenceChickletVideo","Presentation","Presentation12","Preview","PreviewLink","Previous","PrimaryCalendar","Print","PrintfaxPrinterFile","Processing","ProcessMetaTask","Product","ProductCatalog","ProductionFloorManagement","ProductList","ProductRelease","ProductVariant","ProfileSearch","ProFootball","ProgressLoopInner","ProgressLoopOuter","ProgressRingDots","ProHockey","ProjectCollection","ProjectDocument","ProjectLogo16","ProjectLogo32","ProjectLogoFill16","ProjectLogoFill32","ProjectLogoInverse","PromotedDatabase","ProtectedDocument","ProtectionCenterLogo32","ProtectRestrict","PublicCalendar","PublicContactCard","PublicContactCardMirrored","PublicEmail","PublicFolder","PublishContent","PublishCourse","PublisherLogo","PublisherLogo16","PublisherLogoFill","PublisherLogoFill16","PublisherLogoInverse16","Puzzle","PY","PythonLanguage","QandA","QandAMirror","QRCode","QuadColumn","Quantity","QuarterCircle","QueryList","Questionnaire","QuestionnaireMirrored","QuickNote","QuickNoteSolid","R","RadioBtnOff","RadioBtnOn","RadioBullet","Rain","RainShowersDay","RainShowersNight","RainSnow","RawSource","Read","ReadingMode","ReadingModeSolid","ReadOutLoud","RealEstate","ReceiptCheck","ReceiptForward","ReceiptReply","ReceiptTentative","ReceiptTentativeMirrored","ReceiptUndelivered","Recent","Record2","RecruitmentManagement","RectangleShape","RectangleShapeSolid","RectangularClipping","RecurringEvent","RecurringTask","RecycleBin","Redeploy","RedEye","Redo","Refresh","Relationship","ReleaseDefinition","ReleaseGate","ReleaseGateCheck","ReleaseGateError","ReminderGroup","ReminderPerson","ReminderTime","Remote","Remove","RemoveEvent","RemoveFilter","RemoveFromShoppingList","RemoveFromTrash","RemoveLink","RemoveLinkChain","RemoveLinkX","RemoveOccurrence","Rename","RenewalCurrent","RenewalFuture","ReopenPages","Repair","RepeatAll","RepeatOne","Reply","ReplyAll","ReplyAllAlt","ReplyAllMirrored","ReplyAlt","ReplyMirrored","Repo","ReportAdd","ReportDocument","ReportHacked","ReportLibrary","ReportLibraryMirrored","ReportLock","ReportWarning","RepoSolid","Rerun","ReservationOrders","ResetDevice","ResponsesMenu","ReturnKey","ReturnToSession","ReviewRequestMirroredSolid","ReviewRequestSolid","ReviewResponseSolid","ReviewSolid","RevToggleKey","Rewind","Ribbon","RibbonSolid","RightDoubleQuote","RightTriangle","Ringer","RingerOff","RingerRemove","RingerSolid","Robot","Rocket","Room","Rotate","Rotate90Clockwise","Rotate90CounterClockwise","RowsChild","RowsGroup","Rugby","Running","Sad","SadSolid","Save","SaveAll","SaveAndClose","SaveAs","SaveTemplate","SaveToMobile","Savings","ScaleUp","ScaleVolume","ScatterChart","ScheduleEventAction","SchoolDataSyncLogo","ScopeTemplate","ScreenCast","Script","ScrollUpDown","Search","SearchAndApps","SearchBookmark","SearchCalendar","SearchData","SearchIssue","SearchIssueMirrored","SearchNearby","SecondaryNav","Section","Sections","SecurityGroup","SeeDo","SelectAll","Sell","SemiboldWeight","Send","SendMirrored","Separator","Server","ServerEnviroment","ServerProcesses","SetAction","Settings","ShakeDevice","Shapes","Share","ShareiOS","SharepointAppIcon16","SharepointLogo","SharepointLogoFill","SharepointLogoInverse","Shield","ShieldAlert","ShieldSolid","Shirt","Shop","ShoppingCart","ShoppingCartSolid","ShopServer","ShowGrid","ShowResults","ShowResultsMirrored","ShowTimeAs","SidePanel","SidePanelMirrored","Signin","SignOut","SingleBookmark","SingleBookmarkSolid","SingleColumn","SingleColumnEdit","SIPMove","SiteScan","SizeLegacy","SkiResorts","SkypeArrow","SkypeCheck","SkypeCircleArrow","SkypeCircleCheck","SkypeCircleClock","SkypeCircleMinus","SkypeCircleSlash","SkypeClock","SkypeForBusinessLogo","SkypeForBusinessLogo16","SkypeForBusinessLogoFill","SkypeForBusinessLogoFill16","SkypeLogo","SkypeLogo16","SkypeMessage","SkypeMinus","SkypeSlash","Slider","SliderHandleSize","SliderThumb","Slideshow","SmartGlassRemote","SnapToGrid","Snooze","Snow","Snowflake","SnowShowerDay","SnowShowerNight","Soccer","SocialListeningLogo","Sort","SortDown","SortLines","SortUp","Source","Spacer","Speakers","SpecialEvent","SpeedHigh","Split","SplitObject","Sprint","Squalls","SquareShapeSolid","Stack","StackColumnChart","StackedBarChart","StackedColumnChart2","StackedColumnChart2Fill","StackedLineChart","StackIndicator","StaffNotebookLogo16","StaffNotebookLogo32","StaffNotebookLogoFill16","StaffNotebookLogoFill32","StaffNotebookLogoInverted16","StaffNotebookLogoInverted32","Starburst","StarburstSolid","StatusCircleBlock","StatusCircleBlock2","StatusCircleCheckmark","StatusCircleErrorX","StatusCircleExclamation","StatusCircleInfo","StatusCircleInner","StatusCircleOuter","StatusCircleQuestionMark","StatusCircleRing","StatusCircleSync","StatusErrorFull","StatusTriangle","StatusTriangleExclamation","StatusTriangleInner","StatusTriangleOuter","Step","StepInsert","StepShared","StepSharedAdd","StepSharedInsert","StickyNotesOutlineAppIcon","StickyNotesSolidAppIcon","StockDown","StockUp","Stop","StopSolid","Stopwatch","StorageOptical","StoreLogo16","StoreLogoMed20","Storyboard","Streaming","StreamingOff","StreamLogo","Street","StreetsideSplitMinimize","Strikethrough","Subscribe","Subscript","SubstitutionsIn","Suitcase","SunAdd","Sunny","SunQuestionMark","Superscript","SurveyQuestions","SwayLogo16","SwayLogo32","SwayLogoFill16","SwayLogoFill32","SwayLogoInverse","Switch","SwitcherStartEnd","Sync","SyncFolder","SyncOccurence","SyncStatus","SyncStatusSolid","SyncToPC","System","Tab","TabCenter","Table","TableComputed","TableGroup","TableLink","Tablet","TabletMode","TabletSelected","TabOneColumn","TabThreeColumn","TabTwoColumn","Tag","TagSolid","TagUnknown","TagUnknown12","TagUnknown12Mirror","TagUnknownMirror","Taskboard","TaskGroup","TaskGroupMirrored","TaskLogo","TaskManager","TaskManagerMirrored","TaskSolid","Taxi","TeamFavorite","TeamsLogo","TeamsLogo16","TeamsLogoFill","TeamsLogoFill16","TeamsLogoInverse","Teamwork","Teeth","Telemarketer","TemporaryUser","Tennis","TestAutoSolid","TestBeaker","TestBeakerSolid","TestCase","TestExploreSolid","TestImpactSolid","TestParameter","TestPlan","TestStep","TestSuite","TestUserSolid","TextBox","TextCallout","TextDocument","TextDocumentShared","TextField","TextOverflow","TFVCLogo","ThisPC","ThreeQuarterCircle","ThumbnailView","ThumbnailViewMirrored","Thunderstorms","Ticket","Tiles","Tiles2","TimeEntry","Timeline","TimelineDelivery","TimelineMatrixView","TimelineProgress","TimePicker","Timer","TimeSheet","ToDoLogoBottom","ToDoLogoInverse","ToDoLogoOutline","ToDoLogoTop","ToggleBorder","ToggleFilled","ToggleLeft","ToggleRight","ToggleThumb","Toll","Toolbox","Touch","TouchPointer","Trackers","TrackersMirrored","Train","TrainSolid","TransferCall","Transition","TransitionEffect","TransitionPop","TransitionPush","Translate","Trending12","TriangleDown12","TriangleLeft12","TriangleRight12","TriangleShape","TriangleShapeSolid","TriangleSolid","TriangleSolidDown12","TriangleSolidLeft12","TriangleSolidRight12","TriangleSolidUp12","TriangleUp12","TriggerApproval","TriggerAuto","TriggerUser","Trim","TrimEnd","TrimStart","TripleColumn","TripleColumnEdit","TripleColumnWide","Trophy","Trophy2","Trophy2Solid","TurnRight","TVMonitor","TVMonitorSelected","TypeScriptLanguage","Umbrella","Underline","Undo","Uneditable","Uneditable2","Uneditable2Mirrored","UneditableMirrored","UneditableSolid12","UneditableSolidMirrored12","Unfavorite","UngroupObject","Unknown","UnknownCall","UnknownMirrored","UnknownMirroredSolid","UnknownSolid","Unlock","UnlockSolid","Unpin","UnpublishContent","UnSetColor","UnstackSelected","Unsubscribe","UnsyncFolder","UnsyncOccurence","Untag","Up","UpgradeAnalysis","Upload","USB","UserEvent","UserFollowed","UserGauge","UserOptional","UserPause","UserRemove","UserSync","UserWarning","Vacation","Variable","Variable2","VariableGroup","VB","VennDiagram","VerifiedBrand","VerifiedBrandSolid","VersionControlPush","VerticalDistributeCenter","Video","Video360Generic","VideoLightOff","VideoOff","VideoSearch","VideoSolid","View","ViewAll","ViewAll2","ViewDashboard","ViewList","ViewListGroup","ViewListTree","ViewOriginal","VisioDiagram","VisioDiagramSync","VisioDocument","VisioLogo","VisioLogo16","VisioLogoFill","VisioLogoFill16","VisioLogoInverse","VisioLogoInverse16","VisualBasicLanguage","VisuallyImpaired","VisualsFolder","VisualsStore","VisualStudioIDELogo32","VisualStudioLogo","VoicemailForward","VoicemailIRM","VoicemailReply","Volume0","Volume1","Volume2","Volume3","VolumeDisabled","VSTSAltLogo1","VSTSAltLogo2","VSTSLogo","Waffle","WaffleOffice365","WaitlistConfirm","WaitlistConfirmMirrored","Warning","Warning12","WarningSolid","WavingHand","WebAppBuilderFragment","WebAppBuilderFragmentCreate","WebAppBuilderModule","WebAppBuilderSlot","Webcam2","Webcam2Off","WebComponents","WebPublish","Website","WebTemplate","Weights","Wheelchair","WhiteBoardApp16","WhiteBoardApp32","WifiEthernet","WifiWarning4","WindDirection","WindowEdit","WindowsLogo","Wines","WipePhone","WordDocument","WordLogo","WordLogo16","WordLogoFill","WordLogoFill16","WordLogoInverse","WordLogoInverse16","Work","WorkFlow","WorkforceManagement","WorkItem","WorkItemAlert","WorkItemBar","WorkItemBarSolid","WorkItemBug","World","WorldClock","YammerLogo","ZipFolder","Zoom","ZoomIn","ZoomOut","ZoomToFit"];}angular.module("Wizdom365").directive("wizdom365UiFabricIconPicker",e),t.$inject=["$scope"]}(),function(){function e(e,t){function n(e,t,n){window.amp?i(e,t,n):($.getScript(window.wizdomResources.js.Azuremediaplayer).done(function(o,r){console.info("AzureMediaplayer js loaded"),e.$applyAsync(function(){i(e,t,n)})}).fail(function(e,t,n){console.error("AzureMediaplayer js load failed")}),$("<link/>",{rel:"stylesheet",type:"text/css",href:window.wizdomResources.css.AzuremediaplayerCss}).appendTo("head")),e.$watch("videolink",function(o,r){o!==r&&i(e,t,n)},!0)}function i(n,i,o){"undefined"!=typeof n.videolink&&(n.videoType=t.getVideoType(n.videolink),"unknown"!=n.videoType&&(n.videourl=t.getVideoEmbedUrl(n.videolink,n.videoType),n.videoTemplate=t.getVideoTemplate(n),i.html(n.videoTemplate).show(),e(i.contents())(n)))}return{restrict:"EA",link:n,scope:{videolink:"=",thumbnail:"="}}}angular.module("Wizdom365").directive("wizdom365VideoPlayer",e),e.$inject=["$compile","videoUtility"]}(),function(){function e(){return function(e,t,n){t.bind("keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.wizdom365Enter)}),t.preventDefault())})}}angular.module("Wizdom365").directive("wizdom365Enter",e)}(),function(){function e(){function e(e,t,n){function i(){if(e.icon){var t=e.icon.split(",");e.iconClass=t.length>0?t[0]:void 0;var n=t.length>1?t[1]:"inherit",i=t.length>2?t[2]:"inherit";return e.iconStyle={"background-color":n,color:i},t}}function o(){i(),n.icon&&e.$watch("icon",function(){return i()})}return o(),e.disabled=null!=n.disabled}return{replace:!0,restrict:"E",scope:{icon:"="},template:"<i ng-show='iconClass' class='{{ iconClass }}' ng-style='iconStyle'></i>",link:e,controller:t}}function t(e){}angular.module("Wizdom365").directive("wizdom365Icon",e),t.$inject=["$scope"]}(),function(){function e(e,t,n){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(i,o){var r=o.wizdomInclude||o.src,a=o.onload||"",l=o.preserveScope||!1;o.autoscroll;return function(i,o,s,c,d){var u,m,p,g=0,f=function(){m&&(m.remove(),m=null),u&&(u.$destroy(),u=null),p&&(t.leave(p).then(function(){m=null}),m=p,p=null)};i.$watch(n.parseAsResourceUrl(r),function(n){var r=function(){},s=++g;n?(e(n,!0).then(function(e){if(s===g){var m=i.$parent;l||(m=i.$new()),c.template=e;var h=d(m,function(e){f(),t.enter(e,null,o).then(r)});u=m,p=h,u.$emit("$insertContentLoaded",n),i.$eval(a)}},function(){s===g&&(f(),i.$emit("$insertContentError",n))}),i.$emit("$insertContentRequested",n)):(f(),c.template=null)})}}}}function t(e){return{restrict:"ECA",priority:-400,require:"wizdomInclude",link:function(t,n,i,o){n.html(o.template),e(n.contents())(t)}}}function n(e,t,n){return n.appUrl.toLowerCase().indexOf("localhost")>0&&e.showErrorMessage("ngInclude is not supported by wizdom, please use wizdomInclude instead"),{link:function(e,t,n,i){}}}angular.module("Wizdom365").directive("wizdomInclude",e).directive("wizdomInclude",t).directive("ngInclude",n),e.$inject=["$templateRequest","$animate","$sce"],t.$inject=["$compile"],n.$inject=["notificationService","log","contextInfo"]}(),function(){function e(e,n){return{session:t(window.sessionStorage,"session"),local:t(window.localStorage,"local")}}function t(e,t){return{storageType:t,setItem:function(t,n,i){a(e,t,n,i)},removeItem:function(t){d(e,t)},getItem:function(t){var n=u(t);return l(e,n)},clear:function(t){return s(e,t)},isExpired:function(t){return r(e,t)},getExpireTime:function(t){return n(e,t)},expiresIn:function(t){return i(e,t)},hasStorage:function(t){return c(e,t)},expiresInToMinutes:function(e){return e/6e4},addMinutesToNow:function(e){return new Date((new Date).getTime()+6e4*e)}}}function n(e,t){var n=0,i=u(t)+"_At",o=e.getItem(i);return null!=o&&(n=o),n}function i(e,t){var i=n(e,t);return o(i)}function o(e){if(0==e)return e;var t=(new Date).getTime();return e-t}function r(e,t){return i(e,t)<0}function a(e,t,n,i){angular.isUndefined(n)&&(n=null),angular.isUndefined(i)&&(i=0);var o=u(t);e.setItem(o,n),i>0&&e.setItem(o+"_At",i)}function l(e,t){var n=u(t);return r(e,t)?(d(e,t),null):e.getItem(n)}function s(e,t){angular.isUndefined(t)&&(t="");var n=u(t),i=0;for(var o in e)e.hasOwnProperty(o)&&0==o.indexOf(n)&&(e.removeItem(o),i++);return i}function c(e,t){angular.isUndefined(t)&&(t="");var n=u(t),i=!1;for(var o in e)if(e.hasOwnProperty(o)&&0==o.indexOf(n)){i=!0;break}return i}function d(e,t){var n=u(t);e.removeItem(n),e.removeItem(n+"_At")}function u(e){return e.indexOf("wiz_")<0?"wiz_"+e:e}angular.module("Wizdom365").factory("clientStorageService",e),e.$inject=["$window","$document"]}(),function(){angular.module("Wizdom365").value("configuration",window.Wizdom365Config)}(),function(){function e(e){function t(){var t=e.defer();if(window._spPageContextInfo&&window._spPageContextInfo.ProfileUrl)t.resolve(window._spPageContextInfo.ProfileUrl);else{var n=window.SP;if(n){var i=null;n.SOD.executeFunc("SP.js","SP.ClientContext",function(){n.SOD.executeFunc("userprofile","SP.UserProfiles.PeopleManager",function(){var e=new n.ClientContext.get_current,o=new n.UserProfiles.PeopleManager(e);i=o.getMyProperties(),e.load(i,"UserUrl"),e.executeQueryAsync(function(){var e=i.get_userUrl(),n=C(e),o=n.href.replace(n.search,"");t.resolve(o)},function(){})})})}}return t.promise}var n=[],i=e.defer(),o=!1;if(window.ctx){for(var r=window.ctx.ctxId;window["ctx"+r];)n.push({title:window["ctx"+r].ListTitle,dirUrl:window["ctx"+r].listUrlDir}),r++;for(r=window.ctx.ctxId-1;window["ctx"+r];)n.push({title:window["ctx"+r].ListTitle,dirUrl:window["ctx"+r].listUrlDir}),r--;1==n.length&&(n=n[0])}var a="",l="",s="";try{if(!window._spFriendlyUrlPageContextInfo)for(var c=angular.element(document.querySelector("#aspnetForm")),d=c.context.action,u=d.indexOf("?"),m=d.substring(u+1),p=m.split("&"),g=0;g<p.length;g++){var f=p[g].split("=");"TermId"==f[0]&&(a=f[1]),"TermSetId"==f[0]&&(l=f[1]),"TermStoreId"==f[0]&&(s=f[1])}}catch(h){}var w=($.getQueryParameters().SPLanguage?decodeURIComponent($.getQueryParameters().SPLanguage):window._spPageContextInfo?window._spPageContextInfo.currentUICultureName:"en-us").toLowerCase(),v=window.g_PageFileVersionForDisplay?window.g_PageFileVersionForDisplay:null;null==v&&window.wizdomPageColumns&&(v=window.encodeURIComponent(""+window.wizdomPageColumns.pageModified).replace(/\%/g,""));var b={pageIsInEditMode:window.wizdomIsPageInEditMode(),userId:window._spPageContextInfo?window._spPageContextInfo.userId:null,userLoginName:window._spPageContextInfo&&window._spPageContextInfo.userLoginName?window._spPageContextInfo.userLoginName:window.loginName,userDisplayName:window._spPageContextInfo&&window._spPageContextInfo.userDisplayName?window._spPageContextInfo.userDisplayName:window.displayName,currentPage:window._spPageContextInfo?window._spPageContextInfo.serverRequestPath:null,pageListId:window._spPageContextInfo?window._spPageContextInfo.pageListId:null,pageItemId:window._spPageContextInfo?window._spPageContextInfo.pageItemId:null,webTitle:window._spPageContextInfo?window._spPageContextInfo.webTitle:null,sitePagesEnabled:window._spPageContextInfo?window._spPageContextInfo.sitePagesEnabled:null,publishingFeatureOn:window._spPageContextInfo?window._spPageContextInfo.PublishingFeatureOn:null,listContext:window.ctx?n:null,webServerRelativeUrl:window._spPageContextInfo?window._spPageContextInfo.webServerRelativeUrl:null,siteServerRelativeUrl:window._spPageContextInfo?window._spPageContextInfo.siteServerRelativeUrl:null,siteAbsoluteUrl:window._spPageContextInfo?window._spPageContextInfo.siteAbsoluteUrl:null,spHostUrl:window._spPageContextInfo?window._spPageContextInfo.siteAbsoluteUrl:window.decodeURIComponent($.getQueryParameters().SPHostUrl),spWebUrl:window._spPageContextInfo?window._spPageContextInfo.webAbsoluteUrl:window.decodeURIComponent($.getQueryParameters().SPWebUrl||$.getQueryParameters().SPHostUrl),appUrl:window.Wizdom365AppUrl,blobUrl:window.Wizdom365BlobUrl,resourcesUrl:window.Wizdom365ResourcesUrl,clientId:window.Wizdom365ClientID,wizdomVersion:window.wizdomVersion,language:w,locale:($.getQueryParameters().SPLocale?decodeURIComponent($.getQueryParameters().SPLocale):window._spPageContextInfo?window._spPageContextInfo.currentCultureName:w).toLowerCase(),productNumber:window._spPageContextInfo?window._spPageContextInfo.siteClientTag.split("$")[2]:$.getQueryParameters().SPProductNumber,requestPath:window._spPageContextInfo?window._spPageContextInfo.serverRequestPath:null,isSettingsPage:location.href?location.href.indexOf("_layouts/15/")>-1&&location.href.indexOf("#")<location.href.lastIndexOf("_layouts/15/"):!1,isDialogPage:location.href?location.href.indexOf("IsDlg=1")>-1:!1,friendUrlTermId:window._spFriendlyUrlPageContextInfo?window._spFriendlyUrlPageContextInfo.termId:a,friendUrlTermSetId:window._spFriendlyUrlPageContextInfo?window._spFriendlyUrlPageContextInfo.termSetId:l,friendUrlTermStoreId:window._spFriendlyUrlPageContextInfo?window._spFriendlyUrlPageContextInfo.termStoreId:s,pageFileVersionForDisplay:v,friendlyUrlPageconextInfo:window._spFriendlyUrlPageContextInfo?window._spFriendlyUrlPageContextInfo:null,pageColumns:window.wizdomPageColumns,wizdomEnvironmentIsOnPrem:!!window.WizdomEnvironmentIsOnPrem,wizdomEnvironment:window.isSaaS?"SAAS":window.WizdomEnvironmentIsOnPrem?"ONPREM":"AZURE",isConfigurationContext:window.configurationContext?!0:!1,getProfileUrl:t(),pageIsCheckedOutTocurrentUser:"undefined"!=typeof window.PageState&&"1"===window.PageState.ItemIsCheckedOutToCurrentUser,upgradeInProgress:function(t){return void 0!==t&&(o&&(i=e.defer()),i.resolve(t),o=!0),i.promise}},C=function(e){var t=document.createElement("a");return t.href=e,t};return window.Wizdom365ContextInfo=b,b}angular.module("Wizdom365").factory("contextInfo",e),e.$inject=["$q"]}(),function(){function e(){function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}var t={newGuid:e};return t}angular.module("Wizdom365").factory("guidGenerator",e)}(),function(){function e(e,n){return{setItem:function(e,n){angular.isUndefined(n)&&(n=null),window.localStorage.setItem(t(e),n)},removeItem:function(e){window.localStorage.removeItem(t(e))},getItem:function(e){return window.localStorage.getItem(t(e))}}}function t(e){return e.indexOf("wiz")<0?"wiz"+e:e}angular.module("Wizdom365").factory("localStorageService",e),e.$inject=["$window","$document"]}(),function(){function e(e){var t=document.location.href.toLowerCase(),n=e.appUrl.toLowerCase().indexOf("localhost")>0||t.indexOf("?")<t.indexOf("debug");return function(e,t){try{n&&console&&console.log&&(t?window.console&&window.console.log(e,t):window.console&&window.console.log(e))}catch(i){}}}angular.module("Wizdom365").factory("log",e),e.$inject=["contextInfo"]}(),function(){function e(e,t,n){function i(n){var i=e.spWebUrl+"/_api/search/query?querytext='*'&sortlist='"+n+":ascending'&RowLimit=1";return t({method:"GET",url:i,headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})}var o={isSortable:function(e){return i(e)}};return o}angular.module("Wizdom365").factory("managedProperty",e),e.$inject=["contextInfo","$http","$q"]}(),function(){function e(e,t){function n(n,i,o){if(void 0===o&&(o=!0),!l()&&!s()){angular.isUndefined(i)&&(i=!0);var r=noty({text:t("translate")(n),layout:"topCenter",type:"error",animation:{open:"animated flipInX",close:"animated flipOutX"},closeWith:o?["click"]:[]});return i&&e(function(){$.noty.close(r.options.id)},6e3),r}}function i(n,i,o){if(void 0===o&&(o=!0),!l()&&!c()){angular.isUndefined(i)&&(i=!0);var r=noty({text:t("translate")(n),layout:"topCenter",type:"warning",animation:{open:"animated flipInX",close:"animated flipOutX"},closeWith:o?["click"]:[]});return i&&e(function(){$.noty.close(r.options.id)},6e3),r}}function o(n,i,o){if(void 0===o&&(o=!0),!l()&&!d()){angular.isUndefined(i)&&(i=!0);var r=noty({text:t("translate")(n),layout:"topCenter",type:"success",animation:{open:"animated flipInX",close:"animated flipOutX"},closeWith:o?["click"]:[]});return i&&e(function(){$.noty.close(r.options.id)},6e3),r}}function r(e){$.noty.close(e.options.id)}function a(e){var n=e.okButtonText?t("translate")(e.okButtonText):t("translate")("Yes"),i=e.cancelButtonText?t("translate")(e.cancelButtonText):t("translate")("No"),o=noty({text:t("translate")(e.text),type:e.type,dismissQueue:!0,layout:e.layout,theme:"defaultTheme",modal:e.modal||!0,buttons:[{addClass:"btn btn-primary",text:n,onClick:function(t){t.close(),e.successCalback&&e.successCalback()}},{addClass:"btn btn-default",text:i,onClick:function(t){t.close(),e.cancelCalback&&e.cancelCalback()}}]});return o}function l(){return window.location.href.toLowerCase().indexOf("suppress-notifications=true")>-1}function s(){return window.location.href.toLowerCase().indexOf("suppress-notifications-error=true")>-1}function c(){return window.location.href.toLowerCase().indexOf("suppress-notifications-warning=true")>-1}function d(){return window.location.href.toLowerCase().indexOf("suppress-notifications-success=true")>-1}var u={showErrorMessage:n,showWarningMessage:i,showSuccessMessage:o,showConfirmationDialog:a,close:r};return u}angular.module("Wizdom365").factory("notificationService",e),e.$inject=["$timeout","$filter"]}(),function(){function e(e){return{getPictureUrl:function(t){if(!t)return(e.blobUrl||e.appUrl)+"Base/Images/1x1.png";if("group"==t)return(e.blobUrl||e.appUrl)+"Base/Images/Group.png";var n="userphoto";switch(window.wizdomClientSideFeatureToggles&&window.wizdomClientSideFeatureToggles.profilePictureService&&(n=window.wizdomClientSideFeatureToggles.profilePictureService),n){case"userphoto":return t.indexOf("|")>0&&(t=t.substr(t.lastIndexOf("|")+1)),e.spHostUrl+(e.wizdomEnvironmentIsOnPrem?"/_layouts/15/userphoto.aspx?size=M&accountname=":"/_layouts/15/userphoto.aspx?size=M&username=")+t;case"wizdom":default:return e.appUrl+"api/wizdom/365/profileimage?accountname="+t.replace(/#/g,"%23")+"&SPHostUrl="+e.spHostUrl}}}}angular.module("Wizdom365").factory("profileService",e),e.$inject=["contextInfo"]}(),function(){angular.module("Wizdom365").value("queryString",$.getQueryParameters())}(),function(){function e(e,t,n,i){var o=this,r=n.sizes;r=_.sortBy(r,"minWidth").reverse();var a=angular.element(e);return a.bind("resize",function(){o.responsiveChange()}),this.getClassName=function(e){for(var t=0;t<r.length;t++)if(parseInt(e)>=parseInt(r[t].minWidth))return r[t].name},this.getOrientation=function(e){return e.h>e.w?"wt-portrait":"wt-landscape"},this.getElementDimensions=function(e){return{h:e.height(),w:e.width()}},this.onResponsizeChange=function(e,t){o.onResponsizeChange.callbacks=this.onResponsizeChange.callbacks||[],o.onResponsizeChange.callbacks.push({element:e,callback:t}),i(function(){o.responsiveChangeSingle({element:e,callback:t})},100)},this.responsiveChangeSingle=function(e){var t=o.getElementDimensions(e.element),n=o.getClassName(t.w),i=o.getOrientation(t);e.callback(n+" "+i)},this.responsiveChange=function(){angular.forEach(o.onResponsizeChange.callbacks,function(e){var t=o.getElementDimensions(e.element),n=o.getClassName(t.w),i=o.getOrientation(t);e.callback(n+" "+i)})},this}angular.module("Wizdom365").value("responsiveConfig",{sizes:[{name:"wt-tiny",minWidth:0},{name:"wt-small",minWidth:250},{name:"wt-medium",minWidth:500},{name:"wt-large",minWidth:750}]}).factory("responsive",e),e.$inject=["$window","$document","responsiveConfig","$timeout"]}(),function(){function e(e,n){return{setItem:function(e,n){angular.isUndefined(n)&&(n=null),window.sessionStorage.setItem(t(e),n)},removeItem:function(e){window.sessionStorage.removeItem(t(e))},getItem:function(e){return window.sessionStorage.getItem(t(e))}}}function t(e){return e.indexOf("wiz")<0?"wiz"+e:e}angular.module("Wizdom365").factory("sessionStorageService",e),e.$inject=["$window","$document"]}(),function(){function e(){function e(e){var t=[],n=d(e);return angular.forEach(n,function(e){e&&e["@configFilter"]&&t.push(e["@configFilter"])}),t}function t(e){var t=window.location.href,n=t.match("selectedConfiguration=[^&|^?]*");n&&n.length>0&&(t=t.replace(n[0],"")),window.location.href=t+"&selectedConfiguration="+encodeURIComponent(e),window.location.reload()}function n(){var e=window.location.href.match("selectedConfiguration=[^&|^?]*");return e&&e.length>0?decodeURIComponent(e[0].substr("selectedConfiguration=".length)):""}function i(e,t){var n=d(e),i=angular.copy(n[0]||n);i&&(i["@configFilter"]=t.toLowerCase(),u[e]&&u[e](i),n.length?n.push(i):window.Wizdom365Config[e]=[n,i])}function o(e,t){for(var n=d(e),i=0;i<n.length;i++)if(n[i]["@configFilter"]&&n[i]["@configFilter"].toLowerCase()==t.OldName.toLowerCase()){n[i]["@configFilter"]=t.Name;break}p[e]&&p[e](t)}function r(e,t){u[e]=t}function a(e,t){m[e]=t}function l(e,t){p[e]=t}function s(e,t){var n=d(e);angular.forEach(n,function(i){if(i["@configFilter"]==t){m[e]&&m[e](i);var o=n.indexOf(i);return void n.splice(o,1)}})}function c(e){var t=window.location.href,n=d(e);Array.isArray(n)||(n=[n]);var i="",o="";return angular.forEach(n,function(e){o||e["@configFilter"]?e["@configFilter"]&&t.match(new RegExp(e["@configFilter"],"i"))&&e["@configFilter"].length>o.length&&(i=e,o=e["@configFilter"]):i=e}),i}function d(e){var t=e.split("/"),n=window.Wizdom365Config,i=n;return angular.forEach(t,function(e){i=i[e]}),i}var u={},m={},p={};return{getModuleUrlFilters:e,selectConfigurationFilter:t,getSelectedConfigurationFilter:n,getApplyingConfiguration:c,addConfigurationFilter:i,updateConfigurationFilter:o,addCallbackForNewConfigurationFilter:r,addCallbackForDeleteConfigurationFilter:a,addCallbackForChangeConfigurationFilter:l,removeConfigurationFilter:s}}angular.module("Wizdom365").factory("SpecificConfigurationService",e),e.$inject=[]}(),function(){function e(e,t){var n,i,o,r={allWizdomRoles:function(){if(!n)if(window.isSaaS)n=e.permissions.allWizdomRoles();else{var i=t.defer();window.Wizdom365Roles?i.resolve(window.Wizdom365Roles):window.addEventListener("wizdomProxyReady",function(){i.resolve(window.Wizdom365Roles)}),n=i.promise}return n},rolesForCurrentUser:function(n){if(!i)if(window.isSaaS)i=e.principals.currentUserRoles();else{var o=t.defer();window.Wizdom365RolesForCurrentUser?o.resolve(window.Wizdom365RolesForCurrentUser):window.addEventListener("wizdomProxyReady",function(){o.resolve(window.Wizdom365RolesForCurrentUser)}),i=o.promise}return i},currentUser:function(){return o||(o=e.principals.current()),o}};return window.Wizdom365UserContextInfo=r,r}angular.module("Wizdom365").factory("userContextInfo",e),e.$inject=["webApiProxy","$q"]}(),function(){var e={noticboard:{channelMax:25}};angular.module("Wizdom365").value("valueService",e)}(),function(){function e(e,t){var n={getVideoType:function(e){return-1!=e.indexOf(".mp4")?"video/mp4":-1!=e.indexOf(".mov")?"video/mov":-1!=e.indexOf(".webm")?"video/webm":-1!=e.indexOf(".ogg")?"video/ogg":-1!=e.indexOf("youtube.com")||-1!=e.indexOf("youtu.be")?"video/youtube":-1!=e.indexOf("vimeo.com")?"video/vimeo":-1!=e.indexOf("wistia.com")?"video/wistia":-1!=e.indexOf("microsoftstream.com")?"video/microsoftstream":"unknown"},getVideoEmbedUrl:function(t,n){var i=t;return"video/youtube"==n&&(i="https://www.youtube.com/embed/"+this.getYoutubeVideoId(t)),"video/vimeo"==n&&(i="https://player.vimeo.com/video/"+this.getVimeoVideoId(t)),"video/wistia"==n&&(i="https://fast.wistia.net/embed/iframe/"+this.getWistiaVideoId(t)),"video/microsoftstream"==n&&(i="https://web.microsoftstream.com/embed/video/"+this.getMicrosoftStreamVideoId(t)),e.trustAsResourceUrl(i)},getYoutubeVideoId:function(e){var t=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,n=e.match(t);return n&&11==n[7].length?n[7]:null},getVimeoVideoId:function(e){var t=/^\/*(player\.vimeo\.com\/video\/)|(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/)|(video\/))?(\d+)/,n=e.match(t);return n?n[7]:null},getWistiaVideoId:function(e){var t=/https?:\/\/(.+)?(wistia\.com|wi\.st)\/(medias|embed)\/([^#\&\?]*).*/,n=e.match(t);return n?n[4]:null},getMicrosoftStreamVideoId:function(e){var t=/https?:\/\/(.+)?(microsoftstream\.com)\/(video|embed\/video|channel)\/([^#\&\?]*).*/,n=e.match(t);return n?n[4]:null},getVideoTemplate:function(e){var n="12345".split("").map(function(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()))}).join(""),i=null!=e.thumbnail&&""!=e.thumbnail,o='<div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" src="'+e.videourl+'"  allowscriptaccess="always" allowfullscreen="true"></iframe></div>';switch(i&&(o='<span id="'+n+'" style="display:none;">'+o+"</span><div onclick=\"$('#"+n+" div iframe').attr('src', $('#"+n+" div iframe').attr('src') + '?autoplay=1'); var thevid = document.getElementById('"+n+"'); thevid.style.display='block'; this.style.display='none';\"><img src=\""+e.thumbnail+'" style="cursor:pointer; max-width: 400px;" class="img-thumbnail img-responsive" alt="play video" /></div>'),e.videoType){case"video/mp4":case"video/mov":case"video/webm":case"video/ogg":var r=i?'poster="'+e.thumbnail+'"':"";if(window.LoadWizdomModule){var a=t.get("wizdomLoader");o='<div><style>.videocontent {width:80%; max-width: 640px; margin: 0 auto;} .video-js {padding-top: 56.25%} .vjs-fullscreen {padding-top: 0px}</style><script></script><video width="auto" id="'+n+'" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="metadata" width="auto" height="auto" '+r+' data-setup="{}"><source src="'+e.videourl+'" type="'+e.videoType+'" /></video></div>',a.LoadModule("Video").then(function(){})}else o='<div><style>.videocontent {width:80%; max-width: 640px; margin: 0 auto;} .video-js {padding-top: 56.25%} .vjs-fullscreen {padding-top: 0px}</style><script></script><video width="auto" id="'+n+'" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="metadata" width="auto" height="auto" '+r+' data-setup="{}"><source src="'+e.videourl+'" type="'+e.videoType+'" /></video></div> <script>videojs(document.getElementById("'+n+'"), {}, function(){});</script>'}return o}};return n}angular.module("Wizdom365").factory("videoUtility",e),e.$inject=["$sce","$injector"]}(),function(){function e(e,t,n,i){var o={cache:{baseUrl:"api/wizdom/365/cache/",getCacheCount:function(){return t.get(this.baseUrl+"count")},clearCache:function(){return t.get(this.baseUrl+"clear").then(function(e){return window.Wizdom365Config["@timestamp"]=e})},clearModuleCache:function(e){return t.get(this.baseUrl+"clear/"+e)},clearBrowserCache:function(){return t.get(this.baseUrl+"clearBrowserCache")}},configuration:{baseUrl:"api/wizdom/365/configuration",loadConfig:function(){return t.get(this.baseUrl).then(function(t){var n=e.defer();return window.Wizdom365Config?angular.copy(t,window.Wizdom365Config):window.Wizdom365Config=t,n.resolve(t),n.promise})},saveConfigAsync:function(n){return t.post(this.baseUrl,n).then(function(t){var n=e.defer();return window.Wizdom365Config["@timestamp"]=t,n.resolve(t),n.promise})},saveConfig:function(e){return t.post(this.baseUrl,e).then(function(e){return window.Wizdom365Config["@timestamp"]=e})},addOrUpdate:function(e,n){return t.post(this.baseUrl+"/addorupdate",{configurationTimestamp:window.Wizdom365Config["@timestamp"],path:e,node:n}).then(function(e){return window.Wizdom365Config["@timestamp"]=e})},remove:function(e){return t["delete"](this.baseUrl+"/remove?path="+e+"&timestamp="+window.Wizdom365Config["@timestamp"]).then(function(e){return window.Wizdom365Config["@timestamp"]=e})}},context:{baseUrl:"api/wizdom/365/context",get:function(){return t.get(this.baseUrl)}},wizdomApp:{baseUrl:"api/wizdom/365/app",getAppInstanceId:function(){return t.get(this.baseUrl+"/instanceid")}},documentation:{baseUrl:"api/wizdom/documentation/",authorizationCheck:function(t){return t&&t.error?(-1===i.appUrl.indexOf("://localhost")&&n.showErrorMessage(t.error,!1,!0),e.reject(t)):t},getForModule:function(e,n){return t.get(this.baseUrl+"modules/"+e+"/"+n).then(this.authorizationCheck)},getPages:function(){return t.get(this.baseUrl+"pages/").then(this.authorizationCheck)},getPagesByType:function(e){return t.getAppCached(this.baseUrl+"pagesbytype/"+e).then(this.authorizationCheck)},getPageContent:function(e){return t.get(this.baseUrl+"pagecontent/"+e).then(this.authorizationCheck)},search:function(e){return t.get(this.baseUrl+"search/"+e).then(this.authorizationCheck)},searchDocumentations:function(e,n){switch(e){case 0:return t.getAppCached(this.baseUrl+"search/articles/"+n).then(this.authorizationCheck);case 1:return t.getAppCached(this.baseUrl+"search/videos/"+n).then(this.authorizationCheck);case 2:return t.getAppCached(this.baseUrl+"search/releasenotes/"+n).then(this.authorizationCheck)}},getReleaseNotes:function(){return t.get(this.baseUrl+"releaseNotes/").then(this.authorizationCheck)},getReleaseNotesOptimized:function(){return t.get(this.baseUrl+"optReleaseNotes/").then(this.authorizationCheck)},getAvailableTags:function(){return t.get(this.baseUrl+"search/tags").then(this.authorizationCheck)}},ioc:{baseUrl:"api/wizdom/365/ioc",getRegistrations:function(){return t.get(this.baseUrl)}},classicModernDeploy:{baseUrl:"api/wizdom/365/ClassicModernDeploy",deployModernPackages:function(){return t.post(this.baseUrl+"/DeployModernPackages")},associateModernToWizdom:function(){return t.post(this.baseUrl+"/AssociateModernToWizdom")}},sitecollections:{baseUrl:"api/wizdom/365/sitecollections",getSitecollections:function(){return t.get(this.baseUrl)},getSingleSitecollection:function(){return t.get(this.baseUrl)}},modernSitecollections:{baseUrl:"api/wizdom/365/modernsitecollections",getAll:function(e,n,i,o,r){void 0===i&&(i=""),void 0===o&&(o=""),void 0===r&&(r=!0);var a=this.baseUrl+"?skip="+e+"&take="+n;return i&&(a+="&searchQuery="+encodeURIComponent(i)),o&&(a+="&orderBy="+o+"&ascending="+r),t.get(a)},remove:function(e){var n=this.baseUrl+"/"+e;return t["delete"](n)}},sitecollectionTasks:{baseUrl:"api/wizdom/365/SitecollectionTasks",remove:function(e){return t["delete"](this.baseUrl+"/Remove?url="+encodeURIComponent(e))},disable:function(e){return t.post(this.baseUrl+"/Disable?url="+encodeURIComponent(e))},enable:function(e){return t.post(this.baseUrl+"/Enable?url="+encodeURIComponent(e))},updateClientSideFeatureToggles:function(){return t.post(this.baseUrl+"/UpdateClientSideFeatureToggles")},taskStatus:function(e){return t.get(this.baseUrl+"/TaskStatus?sitecollectionUrl="+encodeURIComponent(e))},allTaskStatus:function(){return t.get(this.baseUrl+"/AllTaskStatus")},hasPendingTasks:function(e){return t.get(this.baseUrl+"/HasPendingTasks?sitecollectionUrl="+encodeURIComponent(e))},allTaskStatusPaging:function(e,n,i,o,r){void 0===i&&(i=""),void 0===o&&(o=""),void 0===r&&(r=!0);var a=this.baseUrl+"/AllTaskStatusPaging?skip="+e+"&take="+n;return i&&(a+="&searchQuery="+i),o&&(a+="&orderBy="+o+"&ascending="+r),t.get(a)},installWizdomOnSitecollection:function(e,n){return void 0===n&&(n=!1),t.post(this.baseUrl+"/InstallWizdomOnSitecollection?sitecollectionUrl="+encodeURIComponent(e)+"&scriptLoaderOnly="+encodeURIComponent(n+""))},installWizdomOnAllSitecollections:function(e){return void 0===e&&(e=!1),t.post(this.baseUrl+"/InstallWizdomOnAllSitecollections?scriptLoaderOnly="+encodeURIComponent(e+""))},CancelTask:function(e){return t["delete"](this.baseUrl+"/CancelTask?taskID="+e)},setTaskPriority:function(e,n){return t.post(this.baseUrl+"/TaskPriority?sitecollectionUrl="+encodeURIComponent(e),n)},createSiteCollectionForWizdom:function(e){return t.post(this.baseUrl+"/createSiteCollectionForWizdom",e)}},datastore:{baseUrl:"api/wizdom/365/datastore",create:function(e,n){return t.post(this.baseUrl+"/create?url="+encodeURIComponent(e)+"&ownerLogin="+encodeURIComponent(n))}},license:{baseUrl:"api/wizdom/365/license",isValidLicense:function(e){return t.get(this.baseUrl+"/module/"+e)},getLicense:function(){return t.get(this.baseUrl)},getActiveUserCount:function(){return t.get(this.baseUrl+"/activeusers/count")},uploadLicense:function(e){return t.post(this.baseUrl+"",e)}},logger:{baseUrl:"api/wizdom/365/log",getLogs:function(e){return t.get(this.baseUrl+"?module="+e)},getLogFileNames:function(){return t.get(this.baseUrl+"/lognames")},getLogFile:function(e){return t.get(this.baseUrl+"/logs?logfile="+e)}},modules:{baseUrl:"api/wizdom/365/modules",getInfo:function(){return t.get(this.baseUrl)},getPartnerModules:function(){return t.get(this.baseUrl+"/partner")},updatePartnerModule:function(e){return t.put(this.baseUrl+"/partner",e)},addPartnerModule:function(e){return t.post(this.baseUrl+"/partner",e)},deletePartnerModule:function(e){return t.post(this.baseUrl+"/partner/delete",e)}},cssGenerator:{baseUrl:"api/wizdom/365/cssgenerator",addConfiguration:function(e){return t.post(this.baseUrl+"/addconfiguration",{configFilter:e})},removeConfiguration:function(e){return t.post(this.baseUrl+"/removeconfiguration",{configFilter:e})},changeConfigFilter:function(e,n){return t.post(this.baseUrl+"/changeconfigfilter",{oldConfigFilter:e,newConfigFilter:n})}},administration:{baseUrl:"api/wizdom/365/administration",getPages:function(){return t.get(this.baseUrl+"/pages")},getAdminPages:function(){return t.get(this.baseUrl+"/adminpages")},getPublishingFeatureStatus:function(){return t.get(this.baseUrl+"/publishingfeature")}},searchPerson:{baseUrl:"api/wizdom/searchPerson/search",search:function(e,n,i,o,r,a,l){var s=this.baseUrl+"?queryText="+encodeURIComponent(e)+"&index="+n;return i&&(s+="&numberOfUsersPerPage="+i),o&&angular.forEach(o,function(e){s+="&selectProperties="+e}),l&&angular.forEach(l,function(e){s+="&orderProperties="+e.property+"|"+e.orderDirection}),r&&(s+="&resultSource="+r),a&&(s+="&pageindex="+a),t.get(s)}},terms:{baseUrl:"api/wizdom/365/terms",batchGroup:"terms",getAllTermsById:function(e){return t.getAppCached(this.baseUrl+"?termId="+e)},getAllTermsWithIDsById:function(e){return t.getAppCached(this.baseUrl+"/withids?termId="+e)},getAllTermsWithIDsByFieldName:function(e){return t.getAppCached(this.baseUrl+"/withFieldName?fieldName="+e)},getAllTermsWithChildrenById:function(e){return t.getAppCached(this.baseUrl+"/nested?termId="+e)},getAllTermsWithChildrenByFieldName:function(e){return t.getAppCached(this.baseUrl+"/nested?fieldName="+e)},getAllTermSets:function(e){return t.getAppCached(this.baseUrl+"/AllTermSets"+(angular.isDefined(e)?"?sourceurl="+e:""))},getAllTermsWithPagingById:function(e,n,i){return t.getAppCached(this.baseUrl+"/withpaging?termId="+e+"&pageSize="+n+"&pageNo="+i)},searchTerms:function(e,n){return t.getAppCached(this.baseUrl+"/search?termId="+e+"&searchText="+n)},getTermsCount:function(e){return t.getAppCached(this.baseUrl+"/count?termId="+e)}},languages:{baseUrl:"api/wizdom/365/languages",getAll:function(){return t.getAppCached(this.baseUrl)},activate:function(e){return t.put(this.baseUrl+"/"+e+"/activate")},deactivate:function(e){return t.put(this.baseUrl+"/"+e+"/deactivate")}},translations:{baseUrl:"api/wizdom/365/translations",get:function(){return t.get(this.baseUrl)},setTranslationValue:function(e,n,i){var o={key:n,value:i};return t.put(this.baseUrl+"/"+e,o)},uploadTranslationFile:function(e,n){return t.post(this.baseUrl+"/"+e+"/file",n)},getTranslation:function(e){return t.get(this.baseUrl+"/translate/"+e)},getMyLocale:function(){return t.get(this.baseUrl+"/getmylocale")}},webpartTemplates:{baseUrl:"api/wizdom/365/htmlTemplates/",getTemplates:function(){return t.get(this.baseUrl)},getViewTemplates:function(e){return t.get(this.baseUrl+"viewtemplates/?directoryPath="+e)},getModuleTemplates:function(e){return t.get(this.baseUrl+"moduletemplates/?directoryPath="+e)},getPartnerModuleTemplates:function(e){return t.get(this.baseUrl+"partnermoduletemplates/?directoryPath="+e)},addTemplate:function(e){return t.post(this.baseUrl,e)},updateTemplate:function(e){return t.put(this.baseUrl,e)},deleteTemplate:function(e){return t["delete"](this.baseUrl+"?htmlTemplatePath="+e)},uncustomizeTemplate:function(e){return t.put(this.baseUrl+"uncustomize",e)}},scriptTemplates:{baseUrl:"api/wizdom/365/scripttemplates",getCustomScriptTemplates:function(){return t.get(this.baseUrl)},updateTemplate:function(e){return t.put(this.baseUrl,e)},deleteTemplate:function(e){return t["delete"](this.baseUrl+"?scriptTemplatePath="+e)},bundleAllTemplates:function(){return t.post(this.baseUrl+"/bundleAll")},addConfiguration:function(e){return t.post(this.baseUrl+"/addconfiguration",{configFilter:e})},removeConfiguration:function(e){return t.post(this.baseUrl+"/removeconfiguration",{configFilter:e})}},styleTemplates:{baseUrl:"api/wizdom/365/styletemplates",getCustomStyleTemplates:function(){return t.get(this.baseUrl)},updateTemplate:function(e){return t.put(this.baseUrl,e)},deleteTemplate:function(e){return t["delete"](this.baseUrl+"?styleTemplatePath="+e)},bundleAllTemplates:function(){return t.post(this.baseUrl+"/bundleAll")},addConfiguration:function(e){return t.post(this.baseUrl+"/addconfiguration",{configFilter:e})},removeConfiguration:function(e){return t.post(this.baseUrl+"/removeconfiguration",{configFilter:e})}},modernScriptTemplates:{baseUrl:"api/wizdom/365/modernscripttemplates",getCustomScriptTemplates:function(){return t.get(this.baseUrl)},updateTemplate:function(e){return t.put(this.baseUrl,e)},deleteTemplate:function(e){return t["delete"](this.baseUrl+"?scriptTemplatePath="+e)},bundleAllTemplates:function(){return t.post(this.baseUrl+"/bundleAll")},addConfiguration:function(e){return t.post(this.baseUrl+"/addconfiguration",{configFilter:e})},removeConfiguration:function(e){return t.post(this.baseUrl+"/removeconfiguration",{configFilter:e})}},modernStyleTemplates:{baseUrl:"api/wizdom/365/modernstyletemplates",getCustomStyleTemplates:function(){return t.get(this.baseUrl)},updateTemplate:function(e){return t.put(this.baseUrl,e)},deleteTemplate:function(e){return t["delete"](this.baseUrl+"?styleTemplatePath="+e)},bundleAllTemplates:function(){return t.post(this.baseUrl+"/bundleAll")},addConfiguration:function(e){return t.post(this.baseUrl+"/addconfiguration",{configFilter:e})},removeConfiguration:function(e){return t.post(this.baseUrl+"/removeconfiguration",{configFilter:e})}},principals:{baseUrl:"api/wizdom/365/principals",ensure:function(e){return t.post(this.baseUrl+"/ensure",e)},searchGroups:function(e,n){return n=n||!1,t.get(this.baseUrl+"/searchGroups?searchTerm="+encodeURIComponent(e)+"&includeWizdomGroups="+n)},searchUsers:function(e,n,i){return void 0===n&&(n=!0),void 0===i&&(i=!0),t.get(this.baseUrl+"/searchUsers?searchTerm="+encodeURIComponent(e)+"&includeExternals="+n+"&includeInternals="+i)},searchUsersAndGroups:function(e,n,i,o){return void 0===i&&(i=!0),void 0===o&&(o=!0),n=n||!1,t.get(this.baseUrl+"/searchUsersAndGroups?searchTerm="+encodeURIComponent(e)+"&includeDbPrincipals="+n+"&includeExternals="+i+"&includeInternals="+o)},current:function(){return t.get(this.baseUrl+"/me")},currentUserToken:function(){return t.get(this.baseUrl+"/me/token")},currentUserRoles:function(){return t.get(this.baseUrl+"/me/permissions")},currentUserGroups:function(){return t.get(this.baseUrl+"/me/groups")},updateCurrentUserLanguage:function(e){return t.put(this.baseUrl+"/me/language",e)},forgetUser:function(e){return t.post(this.baseUrl+"/forgetUser",e)},forgetUsers:function(e){return t.post(this.baseUrl+"/forgetUsers",e)}},permissions:{baseUrl:"api/wizdom/365/permissions",clearCache:function(){return t.post(this.baseUrl+"/clearCache")},allWizdomRoles:function(){return t.get(this.baseUrl+"/allwizdomroles")}},social:{baseUrl:"api/wizdom/365/social/",addMentio:function(e){return t.post(this.baseUrl+"mentio",e)},getFullComments:function(e){return t.get(this.baseUrl+"comments/"+e)},deleteComment:function(e){return t["delete"](this.baseUrl+"comments/"+e)},likeItem:function(e){return t.post(this.baseUrl+"like",e)},saveComment:function(e){return t.post(this.baseUrl+"comments",e)},getSocialOverview:function(e,n){return t.get(this.baseUrl+"overview/"+e+"/"+n)},getCommentsTree:function(e,n,i,o,r){return t.get(this.baseUrl+"commentstree?itemId="+e+"&targetId="+n+"&type="+i+"&lastId="+o+"&allowedlevel="+r)}},timerjobs:{baseUrl:"api/wizdom/365/timerjob/",getAll:function(){return t.get(this.baseUrl+"all")},getJobByName:function(e){return t.get(this.baseUrl+e)},runJob:function(e){return t.get(e.invokeJobLink)},updateJobByName:function(e,n){return t.put(this.baseUrl+e,n)}},wonkr:{baseUrl:"api/wizdom/365/Wonkr/",getFiles:function(e){return t.get(this.baseUrl+"files/"+e)},addFile:function(e,n){return t.post(this.baseUrl+"files/"+e,n)},updateFile:function(e,n){return t.put(this.baseUrl+"files/"+e,n)},deleteFile:function(e){return t["delete"](this.baseUrl+"files/templates?filePath="+e)},getSnippets:function(e){return t.get("api/wizdom/templateManager/ActionSnippets")}},webhooks:{baseUrl:"api/wizdom/365/webhooks/1/",getRegistrations:function(){return t.get(this.baseUrl+"registrations")},addRegistration:function(e){return t.post(this.baseUrl+"registrations",e)},updateRegistration:function(e){return t.put(this.baseUrl+"registrations/"+e.id,e)},deleteRegistration:function(e){return t["delete"](this.baseUrl+"registrations/"+e)},getEvents:function(){return t.get(this.baseUrl+"events")},getEventInfo:function(e){return t.get(this.baseUrl+"events/"+e)}},wzupdate:{baseUrl:"api/wizdom/update",update:function(e){return t.post(this.baseUrl,e)}},verifyinstallation:{baseUrl:"api/wizdom/365/verifyinstallation",getResults:function(){return t.get(this.baseUrl)},getResult:function(e){return t.get(this.baseUrl+"?className="+e)},fixIssue:function(e){return t.get(this.baseUrl+"/fixIssue?className="+e)}},flags:{baseUrl:"api/wizdom/flags",get:function(e){return t.post(this.baseUrl,e)}},push:{baseUrl:"api/wizdom/push",unregisterPrincipal:function(e){return t.post(this.baseUrl+"/UnregisterPrincipal",e)}}};return o}angular.module("Wizdom365").factory("webApiProxy",e),e.$inject=["$q","webapiService","notificationService","contextInfo"]}(),function(){function e(e,n,i,o,r,a,l,s,c){function d(){return c.getItem(D)}function u(t){function r(){try{z.contents().find("#ms-error-content").length>0&&(o("proxy communication initialization failed: "+z.contents().find("#ctl00_PlaceHolderMain_LabelMessage").text()),a.cancel(w),e.showErrorMessage("Wizdom initialization failed"))}catch(t){}}function l(){a.cancel(w)}if(t=!!t,o("create proxy iframe"),P=i.defer(),M&&(new Date).getTime()-M.getTime()<5e3)return o("Attempted to create multiple proxy iframes. Wait 30 sec to try again"),void setTimeout(function(){return P.resolve()},3e4);if(M=new Date,0==A&&$("iframe.wizdomProxyFrame").length>0){A++,z=$("iframe.wizdomProxyFrame");try{z[0].contentWindow.postMessage(angular.toJson({method:"PING"}),"*")}catch(d){o("use of intial iframe failed."),u()}}else{var m=window.wizdomClientSideFeatureToggles&&"true"==window.wizdomClientSideFeatureToggles.useDynamicSessions,p=window.sessionId;m&&(p=c.getItem(D),(!p||A>0)&&(p=s.newGuid(),c.setItem(D,p)));var g=c.getItem("wizMsLeftOnToken."+n.spWebUrl);L&&(g=c.getItem("wizMsLeftOnToken."+n.spHostUrl));var f=g>0&&g<Date.now()-12e4;t&&(f=!1);var h=!n.clientId||f?n.appUrl+"/Base/WizdomCorsProxy.aspx?SPHostUrl="+window.encodeURIComponent(n.spWebUrl)+"&SPLanguage="+n.language+"&userLoginName="+encodeURIComponent(n.userLoginName)+(m?"%26sessionId="+p:""):decodeURIComponent(n.spWebUrl)+"/_layouts/15/appredirect.aspx?client_id="+n.clientId+"&redirect_uri="+n.appUrl+"/Base/WizdomCorsProxy.aspx?{StandardTokens}%26userLoginName="+encodeURIComponent(n.userLoginName)+(m?"%26sessionId="+p:"");L&&(h=!n.clientId||f?n.appUrl+"/Base/WizdomCorsProxy.aspx?SPHostUrl="+window.encodeURIComponent(n.spHostUrl)+"&SPLanguage="+n.language+"&userLoginName="+encodeURIComponent(n.userLoginName)+(m?"%26sessionId="+p:""):decodeURIComponent(n.spWebUrl||n.spHostUrl)+"/_layouts/15/appredirect.aspx?client_id="+n.clientId+"&redirect_uri="+n.appUrl+"/Base/WizdomCorsProxy.aspx?{StandardTokens}%26userLoginName="+encodeURIComponent(n.userLoginName)+(m?"%26sessionId="+p:"")),z=$('<iframe class="wizdomProxyFrame" src="'+h+'" ></iframe>').css("display","none").attr("index",A++).appendTo("body")}var w=a(r,100);P.promise.then(l,l);var v=$(".wizdomProxyFrame");v.length>2&&v.slice(0,v.length-2).remove()}function m(){"undefined"!=typeof window.addEventListener?window.addEventListener("message",k,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmessage",k),window.SP&&window.SP.SOD&&window.SP.SOD.notifyEventAndExecuteWaitingJobs("Wizdom365CreatingProxyIframe"),P.promise.then(function(){o("wizdom proxy communication ready"),window.SP&&window.SP.SOD&&window.SP.SOD.notifyEventAndExecuteWaitingJobs("Wizdom365ProxyIframeCreated")},function(){o("proxy communication initialization failed"),e.showErrorMessage("Wizdom initialization failed")})}function p(e,t){o("resending request",e),P.promise.then(function(){o("iframe is ready, send it",e),z[0].contentWindow.postMessage(e,"*")})}function g(e,t,n,o,r,a){var l=i.defer(),s=T++,c=angular.toJson({method:e,url:t,requestIndex:s,data:n,allowBatching:o,batchGroup:r,isExternalRequest:a});return U[s]={defered:l,message:c},P.promise.then(function(){z[0].queuedRequests=s+1,z[0].contentWindow.postMessage(c,"*")}),l.promise}function f(e,i,o){return g("GETURL",t(e,n,l),null,i,o,!1)}function h(e,i,o){return F[e]&&(F[e]=null),g("GET",t(e,n,l),null,i,o,!1)}function w(e,t,n){return null==F[e]&&(F[e]=h(e,t,n)),F[e]}function v(e,t,n){return F[e]=h(e,t,n),F[e]}function b(e,i,o,r){return g("POST",t(e,n,l),i,o,r,!1)}function C(e,i,o,r){return g("DELETE",t(e,n,l),i,o,r,!1)}function y(e,i,o,r){return g("PUT",t(e,n,l),i,o,r,!1)}function I(t){angular.isUndefined(t)&&(t={status:0,statusText:"undefined error!",responseText:""}),o("request failed",t);var r="<span>Extended log for Localhost: Error code "+t.status+": "+t.statusText+"</span>",a=t.responseText;if(a&&a.length&&a.length>0){var l=a.split(/\r\n|\r|\n/g);l.length>0&&(a=l[0])}var s="";switch(t.status){case 0:return;case 400:s="Client error.";break;case 401:s="The request requires user authentication.";break;case 403:return;case 404:s="The requested resource could not be found but may be available again in the future. Subsequent requests by the client are permissible.";break;case 500:s="Server error."}var c=r;s&&(s="<div>"+a+"</div>"+s,c+="<div class='noty-error-description'>"+s+"</div>");var d=!1;try{d=d||n.appUrl.toLowerCase().indexOf("localhost")>0}catch(u){}return 400===t.status?e.showErrorMessage("Bad request"):d?e.showErrorMessage(c):401===t.status&&e.showErrorMessage("You don't have enough permissions to perform this action",!1),i.reject(t)}function S(e){var t=e.indexOf("?")>0?"&":"?",i=[];return i.push("/"),i.push(e),i.push(t),i.push("SPHostUrl="+window.encodeURIComponent(n.spWebUrl)),i.join("")}function k(e){try{var t=JSON.parse(e.data);if(!t.command)return;if("reloadCustomModules"===t.command){var i=window.location.href,a=i.indexOf("&selectedModule="),l=i;return a>0&&(l=i.substr(0,a)),window.location.href=l,void window.location.reload()}if("WizdomCorsProxySuccess"===t.command){o("Proxy ready",t),N=t.session,window.Wizdom365Roles=t.allWizdomRoles,window.Wizdom365RolesForCurrentUser=t.rolesForCurrentUser,window.Wizdom365SiteCollectionUpgradeInProgress=t.upgradeInProgress,n.upgradeInProgress(t.upgradeInProgress),-1!=t.msLeftOnToken&&(L?c.setItem("wizMsLeftOnToken."+n.spHostUrl,Date.now()+t.msLeftOnToken):c.setItem("wizMsLeftOnToken."+n.spWebUrl,Date.now()+t.msLeftOnToken),setTimeout(function(){o("Token will expire in 2 minuttes! creating new iframe"),u(!0)},t.msLeftOnToken-12e4)),P.resolve();var s;"function"==typeof Event?s=new Event("wizdomProxyReady"):(s=document.createEvent("Event"),s.initEvent("wizdomProxyReady",!1,!1)),window.dispatchEvent(s)}else"WizdomCorsProxyFailed"===t.command?(o("Proxy failed"),P.reject()):"RequestSuccess"===t.command?(U[t.requestIndex].defered.resolve(t.result),z[0].completedRequests=z[0].completedRequests?z[0].completedRequests+1:1):"TokenExpired"===t.command?(W?o("token expired, waiting for iframe"):(W=!0,r(function(){W=!1},6e4),u(!0),P.promise["finally"](function(){W=!1})),p(U[t.requestIndex].message,U[t.requestIndex].defered)):"RequestFailed"===t.command?(U[t.requestIndex].defered.promise.then(null,I),U[t.requestIndex].defered.reject(t.result)):"ExternalRequest"===t.command&&g(t.method,t.url,t.data,!1,!1,!0).then(function(n){e.source.postMessage(JSON.stringify({command:"ExternalRequestSuccess",result:n,context:t.context}),e.origin)},function(n){e.source.postMessage(JSON.stringify({command:"ExternalRequestError",result:n,context:t.context}),e.origin)})}catch(d){}}var P=null,x={getUrl:f,get:h,getAppCached:w,getRefreshAppCached:v,post:b,"delete":C,put:y,buildUrl:S,appUrl:n.appUrl,getSessionId:d,getcorsProxySessionId:function(){return N||d()},reCreateProxyIframe:u},T=0,U=[],z=null,A=0,N=null,D=n.spWebUrl+".session",L=window.wizdomClientSideFeatureToggles&&"true"==window.wizdomClientSideFeatureToggles.useSpHostUrlForTokenCheck,M=null;u(),m();var F=[],W=!1;return x}function t(e,t,n){var i=e.indexOf("?")>0?"&":"?",o=[];return 0!=e.indexOf("http")&&o.push("/"),o.push(e),o.push(i),o.push("SPHostUrl="+window.encodeURIComponent(t.spWebUrl||t.spHostUrl)),o.push("&SPLocale="+window.encodeURIComponent(t.locale)),(t.pageIsInEditMode||t.pageIsCheckedOutTocurrentUser)&&o.push("&noBrowserCache="+(new Date).getTime()),e.indexOf("WizdomVersion")<0&&o.push("&WizdomVersion="+n["@version"]),n.Wizdom365&&n.Wizdom365.GlobalCache&&n.Wizdom365.GlobalCache.Timestamp&&o.push("&cacheTimestamp="+n.Wizdom365.GlobalCache.Timestamp),o.join("")}angular.module("Wizdom365").factory("webapiService",e),e.$inject=["notificationService","contextInfo","$q","log","$timeout","$interval","configuration","guidGenerator","sessionStorageService"]}(),function(){function e(e){function t(e){var t=$(e).parents("div[webpartid]"),n=t.attr("webpartid2")||t.attr("webpartid");return n}function n(e){var t=i(e);return t.attr("webpart-properties")?t:o(e)}function i(e){return $('div[webpart-properties*=\'"webpartInstanceId":"'+e+"\"']")}function o(e){return $("div[webpartid='"+e+"']").find("div[webpart-properties]")}function r(e){return $("div[webpartid='"+e+"']").length>0?!0:!1}function a(e,t){var n="#"+e+"scriptcontent",i=$(n).val(),o=$(i).attr("webpart-properties",angular.toJson(t));$(n).val(o.prop("outerHTML"))}return{isInEditMode:function(n){if(0==e.pageIsInEditMode)return!1;var i=t(n),o="#"+i+"scriptcontent",r=$(o);if(r.length>0)return!0;var a=$(n).parents("div[webpartid]"),l=a.attr("selectedwebpart");return"true"===l?!0:!1},hideEditCode:function(e){var t=$(e).parents("div[webpartid]").parent().parent(),n=t.find(".ms-metadata");n.toggle(!1)},getProperties:function(e){try{var i=e;if(!r(e)){var o=n(e);i=t(o)}var a="#"+i+"scriptcontent",l=$(a).val(),s=$(l).attr("webpart-properties"),c=JSON.parse(s);return c}catch(d){var o=n(e),u=o.attr("webpart-properties");return u?JSON.parse(u):{}}},setProperties:function(e,i){var o=e,l=this.getProperties(e);if(l.webpartInstanceId?i.webpartInstanceId=l.webpartInstanceId:i.webpartInstanceId=e,!r(e)){var s=n(e);o=t(s)}a(o,i)},getWebpartId:function(e){var n,i=t(e),o=e.attr("webpart-properties");return o?(n=JSON.parse(o),n.webpartInstanceId||(n.webpartInstanceId=i,a(i,n))):(n={},n.webpartInstanceId=i,a(i,n)),n.webpartInstanceId},toggleWebpart:function(t,n){e.pageIsInEditMode&&(n=!0),void 0!=n&&$(t).parents("div[webpartid]").parent().parent().toggle(n)}}}angular.module("Wizdom365").factory("webpartPropertiesService",e),e.$inject=["contextInfo"]}(),function(){function e(){function e(e){var t=[];return _.forEach(e,function(e){var n=e.toString().split("_");t.push({Section:n[0],Module:n[1],Role:n[2]})}),t}var t={roleInfo:e};return t}angular.module("Wizdom365").factory("wizdomRoleInfoService",e)}(),function(){function e(e,t){return function(n,i){return i||window.wizdomClientSideFeatureToggles&&"true"==window.wizdomClientSideFeatureToggles.DisableWizdomSanitize?e.trustAsHtml(n):e.trustAsHtml(t(n))}}angular.module("Wizdom365").factory("wizdomSanitizeAndTrust",e),e.$inject=["$sce","$sanitize"]}(),function(){function e(){return{scope:{size:"@",author:"=?author",date:"=?date",isAlternateAuthor:"=?isAlternateAuthor",alternateImage:"=?"},controller:t,template:'<div class="text-center wtsite-pagemodified-control-row1" ng-show="size==\'large\'">\n                            <div class="author-image presence media-object" wizdom365-presence-picture size="AVATAR" accountname="author.loginName" name="author.displayName" image="alternateImage"></div>\n                         <span class="wtsite-pagemodified-editedby">{{(isAlternateAuthor ? (\'on behalf of: \' | translate) : (\'by\' | translate) + \' \')}} <a ng-href="{{author.displayNameLink}}">{{author.displayName}}</a></span>\n                            <div class="news-info">\n                                <span class="icon icon-clock icon-clock-dims icon-inline"></span>\n                                <span class="wtsite-pagemodified-editeddate">{{ date | date: \'mediumDate\' }}</span>\n                                <span class="wtsite-pagemodified-spc"></span>\n                            </div>\n                        </div>\n\n                        <div ng-show="size == \'small\'">\n                            <div class="wtsite-pagemodified-control-row1">\n                                <span class="icon icon-clock icon-clock-dims icon-inline"></span>\n                          <span class="wtsite-pagemodified-editeddate">{{ date | date: \'mediumDate\' }}</span>\n                                <span class="wtsite-pagemodified-spc">|</span>\n                          <span class="wtsite-pagemodified-editedby">{{(isAlternateAuthor ? (\'on behalf of\' | translate) + \': \': (\'Modified by:\' | translate) + \' \')}} <a ng-href="{{author.displayNameLink}}">{{author.displayName}}</a></span>\n                         </div>\n                        </div>'}}function t(e,t,n){n.getProfileUrl.then(function(t){var n;e.author.loginName&&(n=t+"?user="+encodeURIComponent(e.author.loginName).replace(/\./g,"%2E")),e.author.displayNameLink=n})}angular.module("Wizdom365.Branding").directive("wizdom365NewsAuthor",e),t.$inject=["$scope","$http","contextInfo"]}(),function(){function e(){return{scope:{},template:"<div class='bootstrap-wrapper ms-webpart-chrome ms-webpartzone-cell' ng-if='::(showPageInfo && pageTerms && pageTerms.length > 0)'>\n                <div class='ms-webpart-chrome-title'>\n                    <h2 style='text-align:justify;' class='ms-webpart-titletext'>\n                        <nobr><span>{{ 'Tags' | translate }}</span></nobr>\n                    </h2>\n                </div>\n                <div class='ms-wpContentDivSpace'>\n                    <div class='ms-WPBody'>\n                        <ul class='nav nav-pills tags' role='tablist'>\n                            <li role='presentation' ng-repeat='termname in ::pageTerms'>\n                                <a href=\"\" ng-click=\"selectTerm(termname)\" title='{{ ::termname }}'>{{ ::termname }}</a>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class='ms-clear'></div>\n                </div>\n            </div>",controller:t}}function t(e,t,n,i,o,r,a){function l(){return r(function(e,t){var n=window.SP;n?n.SOD.executeFunc("SP.js","SP.ClientContext",function(){var i=new n.ClientContext.get_current,o=i.get_web(),r=i.get_site().get_rootWeb();i.load(o,"AllProperties"),i.load(r,"AllProperties"),i.executeQueryAsync(function(){var n=o.get_allProperties(),i=r.get_allProperties(),a=n.get_fieldValues().SRCH_ENH_FTR_URL_WEB;if((null==a||""==a)&&(a=i.get_fieldValues().SRCH_ENH_FTR_URL),null!=a&&""!=a){var l=n.get_fieldValues().SRCH_SB_SET_WEB;(null==l||""==l||JSON.parse(l).Inherit)&&(l=i.get_fieldValues().SRCH_SB_SET_SITE),null!=l&&""!=l?(l=JSON.parse(l),e(l.ResultsPageAddress)):t()}else t()},function(e){t()})}):t()})}if(e.showPageInfo=!0,e.spHostUrl=n.spHostUrl,e.pageInfo=null,e.searchCenterUrl=e.spHostUrl+"/_layouts/15/osssearchresults.aspx",e.selectTerm=function(t){var i="?u="+n.spHostUrl+"&k=owstaxIdW365RelatedTopic:"+encodeURIComponent(t),o=e.searchCenterUrl+i;a.open(o,"_blank")},"true"!=o.PageInfo.Enabled)return void(e.showPageInfo=!1);e.pageTerms=null;var s=angular.isUndefined(n.pageColumns.relatedTopic)?"":n.pageColumns.relatedTopic;s.length>0&&(e.pageTerms=s.split(";"),l().then(function(t){t&&(e.searchCenterUrl=t)},function(){})),e.encode=function(e){return encodeURIComponent(e)}}angular.module("Wizdom365.Branding").directive("wizdom365Pagetags",e),t.$inject=["$scope","$http","contextInfo","pageInfoApi","configuration","$q","$window"]}(),function(e){e(document).ready(function(){var t=window._spPageContextInfo;if("undefined"!=typeof t){for(var n="",i=t.webServerRelativeUrl.split("/"),o="",r="",a=0;a<i.length;a++){var l=i[a];l&&(n+=" "+o+r+l,o+=r+l,""==r&&(r="-"))}n+=" "+i[i.length-1],n.length>0&&e("html").addClass(n.toLowerCase())}})}(jQuery),function(e){e(document).ready(function(){var t=window.Wizdom365Config;t&&"undefined"!=typeof t&&null!=t.HeaderBackground.ImageUrl&&""!=t.HeaderBackground.ImageUrl&&e("html").addClass("pageHeaderBackgroundEnabled")})}(jQuery),function(e){e(document).ready(function(){})}(jQuery),function(e){e(document).ready(function(){e(".wt-news-thumb img").length>0&&e("html").addClass("wt-news-has-image");var t=setInterval(function(){void 0!=e("#O365_TopMenu").attr("style")&&clearInterval(t),e("#O365_TopMenu").length>0&&void 0==e("#O365_TopMenu").attr("style")&&e("#O365_TopMenu").css({"background-color":"transparent"})},500)})}(jQuery),jQuery(document).ready(function(e){var t=window.Wizdom365Config;e('[id$="_TopNavigationMenu"]').addClass("spTopNav"),e('[id$="_V4QuickLaunchMenu"]').addClass("spLeftNav");var n=setInterval(function(){if("undefined"!=typeof t){clearInterval(n);var i=window.getCorrectMegamenuConfig;"true"===i(t).Enabled?window.megaMenuIsReadyForBurgerLink?setupServices():e(document).on("megaMenuIsReadyForBurgerLink",function(e,t){setupServices()}):setupServices()}},50)});var globalGoMobileTestCounter=0;!function(e){e(document).ready(function(){var t=0,n=0,i=!1,o=setInterval(function(){if(0==e(".Megamenu").length&&globalGoMobileTestCounter>25)return void clearInterval(o);if(globalGoMobileTestCounter++,e(".Megamenu").length>0&&0!=e(".Megamenu").width()){if(t>100||i)return void clearInterval(o);if(t++,e("#DeltaTopNavigation li").height()>0||e(".TopItems > li").length!=n){n=e(".TopItems > li").length,e("#titleAreaBox").css("display","block"),e(".Megamenu>.TopItems").css({"white-space":"nowrap"});var r=e(".Megamenu").width()+150;e("#titleAreaBox").css("display",""),e(".Megamenu>.TopItems").css({"white-space":"normal"});var a;e(window).resize(function(){clearTimeout(a),a=setTimeout(function(){e("#titleAreaBox").css("display","block"),e(".Megamenu>.TopItems").css({"white-space":"nowrap"}),r=e(".Megamenu").width()+150,e("#titleAreaBox").css("display",""),e(".Megamenu>.TopItems").css({"white-space":"normal"}),e(window).width()<r||150===r?e("html").hasClass("goMobileNow")||e("html").addClass("goMobileNow"):e("html").removeClass("goMobileNow"),e(window).width()<=992&&e("html").removeClass("goMobileNow")},100)}),e(window).width()<r?e("html").hasClass("goMobileNow")||e("html").addClass("goMobileNow"):e("html").removeClass("goMobileNow"),e(window).width()<=992&&e("html").removeClass("goMobileNow"),i=!0}}},100)})}(jQuery),function(e){e(document).ready(function(){e.map(e(".ms-rte-embedcode > iframe, .ms-rte-embedholder > iframe"),function(t){var n=e(t).attr("width")+"px";e(t).css("width",n),e(t).parent().css("width",n)})})}(jQuery);var intSpaceBetweenColumns=20,intWebpartContentPaddingWidth=20,intControlCounter=0;$(document).ready(function(){0==window.isSaaS&&($(window).load(handleOverflows()),$(window).resize(_.debounce(handleOverflows,500)))}),function(e){e(document).ready(function(){0===e(".wt-editmode").length&&e(document).on("dragstart dragenter dragover",function(t){e(".ms-dnd-dropbox").hasClass("wiz-drop-active")||(e(".ms-dnd-dropbox").parent(".ms-webpart-chrome").css({position:"relative"}),e(".ms-dnd-dropbox").addClass("wiz-drop-active"),e(".ms-dnd-dropbox").on("dragend drop",function(t){e(".ms-dnd-dropbox").removeClass("wiz-drop-active"),e(".ms-dnd-dropbox").parent(".ms-webpart-chrome").css({position:"static"})}))})}),e(document).ready(function(){setInterval(function(){e(".ms-webpart-chrome-title").each(function(t,n){e(this).width("")}),e(".ms-WPBody").each(function(t,n){e(this).width("")})},5e3)}),e(document).ready(function(){var t=function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1};if(!t()&&e(".wt-2column").length>0){var n=e("#suiteBarDelta").height()+e("#s4-ribbonrow").height()+e("#s4-titlerow").height()-55;e("#wt-footer").length>0&&(n+=e("#wt-footer").height()),e("#wizdomPageLayout.wt-2column > .container-fluid > .row:first-child .wt-shadow").css({"min-height":e("#s4-workspace").height()-n});var i;e(window).resize(function(){clearTimeout(i),i=setTimeout(function(){var t=e("#suiteBarDelta").height()+e("#s4-ribbonrow").height()+e("#s4-titlerow").height()-55;e("#wt-footer").length>0&&(t+=e("#wt-footer").height()),e("#wizdomPageLayout.wt-2column > .container-fluid > .row:first-child .wt-shadow").css({"min-height":e("#s4-workspace").height()-t})},100)})}})}(jQuery),function(){function e(){return{scope:{},template:'<span class="wt-notificationPanel"><span ng-if="YammerNotifyEnabled"><span class="ms-promotedActionButton {{(networkList && totalNotificationCount > 0 ? \'notificationPanelMentionsAlert\' : \'\')}}" style="cursor: pointer" data-auto-close="1" data-placement="bottom" title="{{\'Yammer Notifications\' | translate}}" data-content="{{notificationItemList}}" data-template="Yammer/Templates/Notification/NotificationList.html" bs-popover><span class="ms-Icon ms-Icon--YammerLogo wt-icon"></span> <span class="notificationPanel-number">{{networkList && totalNotificationCount > 0 ? totalNotificationCount : \'\'}}</span></span></span></span>',controller:t}}function t(e,t,n,i,o,r,a,l,s,c){function d(){function e(){try{g.contents().find("#ms-error-content").length>0&&(a("proxy communication initialization failed: "+g.contents().find("#ctl00_PlaceHolderMain_LabelMessage").text()),s.cancel(o),c.showErrorMessage("Wizdom initialization failed"))}catch(e){}}function t(){s.cancel(o)}if(a("create oauth proxy iframe"),p=r.defer(),0==f&&$("iframe.wizdomOAuthProxyFrame").length>0){f++,g=$("iframe.wizdomOAuthProxyFrame");try{g[0].contentWindow.postMessage(angular.toJson({method:"PING"}),"*")}catch(n){a("use of intial oauth iframe failed."),d()}}else{var i=l.clientId?decodeURIComponent(l.spWebUrl||l.spHostUrl)+"/_layouts/15/appredirect.aspx?client_id="+l.clientId+"&redirect_uri="+l.appUrl+"/Base/WizdomCorsOAuthProxy.aspx?{StandardTokens}%26userLoginName="+l.userLoginName:l.appUrl+"/Base/WizdomCorsOAuthProxy.aspx?userLoginName="+l.userLoginName+"&SPHostUrl="+window.encodeURIComponent(l.spHostUrl);g=$('<iframe class="wizdomOAuthProxyFrame" src="'+i+'" ></iframe>').css("display","none").attr("index",f++).appendTo("body")}var o=s(e,100);p.promise.then(t,t);var u=$(".wizdomOAuthProxyFrame");u.length>2&&u.slice(0,u.length-2).remove()}function u(){"undefined"!=typeof window.addEventListener?window.addEventListener("message",m,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmessage",m),i.getNotifications().then(function(t){if(i.setNetworkData(t),t&&t.isAuthenticated){e.networkList=t.networks,e.totalNotificationCount=0;for(var n=0;n<e.networkList.length;n++)e.totalNotificationCount+=e.networkList[n].count}else t.userWithNoYammerAccess?a("user does not have yammer access"):(d(),p.promise.then(function(){a("wizdom oauth proxy communication ready"),u()},function(){a("oauth proxy communication initialization failed"),c.showErrorMessage("OAuth proxy communication initialization failed")}))})}function m(e){try{var t=JSON.parse(e.data);if(!t.command)return;"WizdomCorsOAuthProxySuccess"===t.command?(a("OAuthProxy ready"),p.resolve()):"WizdomCorsOAuthProxyFailed"===t.command&&(a("OAuthProxy failed"),p.reject())}catch(n){}}var p=null,g=null,f=0;e.YammerNotifyEnabled=n.Yammer&&angular.isDefined(n.Yammer.YammerNotifyEnability["#checkbox"])?$.parseJSON(n.Yammer.YammerNotifyEnability["#checkbox"]):!1,e.networkList=e.networkList||[],e.totalNotificationCount=e.totalNotificationCount||0,e.YammerNotifyEnabled&&t(u,1e3)}angular.module("Wizdom365.Yammer").directive("wizdom365YammerNotificationPanel",e),t.$inject=["$scope","$timeout","configuration","yammerApi","$window","$q","log","contextInfo","$interval","notificationService"]}(),function(){function e(e,t,n,i){e.YammerNotifyEnabled=n.Yammer?$.parseJSON(n.Yammer.YammerNotifyEnability["#checkbox"]):!1,e.networkList=e.networkList||[],e.loading=!0;var o=i.getNetworkData();o.isAuthenticated&&(e.networkList=o.networks),e.loading=!1}angular.module("Wizdom365.Yammer").controller("Wizdom365YammerNotificationController",e),e.$inject=["$scope","$timeout","configuration","yammerApi"]}(),function(){function e(e,t,n,i){function o(){i.getAuthUrl().then(function(t){e.authUrl=t})}"undefined"!=typeof n.Yammer.YammerNotifyEnability["#checkbox"]&&(e.YammerNotifyEnability=JSON.parse(n.Yammer.YammerNotifyEnability["#checkbox"].toString().toLowerCase())),e.saveConfig=function(){e.saving=!0,n.Yammer.YammerNotifyEnability["#checkbox"]=e.YammerNotifyEnability,t.configuration.saveConfig(n).then(function(){e.saving=!1})},e.authUrl=e.authUrl||"",o()}angular.module("Wizdom365.Yammer").controller("Wizdom365YammerSettingController",e),e.$inject=["$scope","webApiProxy","configuration","yammerApi"]}(),function(){function e(e){var t={isAuthenticated:!1,networks:[],redirectUrl:null},n={baseUrl:"api/wizdom/yammer",getNotifications:function(){return e.get(this.baseUrl+"/notifications")},getAuthUrl:function(){return e.get(this.baseUrl+"/authurl")},getNetworkData:function(){return t},setNetworkData:function(e){t=e}};return n}angular.module("Wizdom365.Yammer").factory("yammerApi",e),e.$inject=["webapiService"]}(),function(){function e(e,t,n,i,o,r){function a(){t.limitCountTo+=t.limitStep}function l(){t.limitCountTo-=t.limitStep}function s(e){c(e),r.setOpenItem({id:e})}function c(e){o.social.dismissMentio(e).then(function(){r.mentioList.remove(e)})}function d(e){o.notifications.dismissMentioSP(e).then(function(){r.mentioList.remove(e)})}function u(){o.social.dismissMentio(_.map(t.mentioItemList,function(e){return e.targetId}).join()).then(function(){r.mentioList.removeAll()})}function m(t){return 1==t.mentions.length?e("translate")("has mentioned you on"):2==t.mentions.length?e("translate")("and {0} mentioned you on",t.mentions[1].sender.displayName):t.mentions.length>2?e("translate")("and {0} others mentioned you on",t.mentions.length-1):""}t.openItem=s,t.dismiss=c,t.spdismiss=d,t.dismissAll=u,t.prepareText=m,t.loadMore=a,t.loadLess=l,t.limitStep=10,t.limitCountTo=t.limitStep,t.mentioItemList=_(_.sortBy(r.mentioList.get().value,function(e){return new Date(e.mentions[0].timestamp)})).reverse().value(),r.registerCallback(function(e,n){"removeMentions"==e?t.mentioItemList=_(_.sortBy(r.mentioList.get().value,function(e){return new Date(e.mentions[0].timestamp)})).reverse().value():"addMentions"==e&&(t.mentioItemList=_(_.sortBy(r.mentioList.get().value,function(e){return new Date(e.mentions[0].timestamp)})).reverse().value())})}angular.module("Wizdom365.Notification").controller("Wizdom365NotificationPanelMentionsController",e),e.$inject=["$filter","$scope","$timeout","configuration","notificationApi","socialNotificationService"]}(),function(){function e(e,t,n,i,o,r){function a(){t.limitCountTo+=t.limitStep}function l(){t.limitCountTo-=t.limitStep}function s(e){o.social.dismissComments(e.targetId).then(function(){r.unreadComments.remove(e)})}function c(e){o.notifications.dismissCommentsSP(e.targetId).then(function(){r.unreadComments.remove(e)})}function d(){o.social.dismissComments(_.map(t.unreadComments,function(e){return e.targetId}).join()).then(function(){r.unreadComments.removeAll()})}function u(e){s(e),r.setOpenItem({id:e.targetId})}function m(t){return 1==t.comments.length?e("translate")("commented on"):2==t.comments.length?e("translate")("and {0} commented on",t.comments[1].author.displayName):t.comments.length>2?e("translate")("and {0} others commented on",t.comments.length-1):""}t.openItem=u,t.dismiss=s,t.spdismiss=c,t.dismissAll=d,t.prepareText=m,t.loadMore=a,t.loadLess=l,t.limitStep=10,t.limitCountTo=t.limitStep,t.unreadComments=_(_.sortBy(r.unreadComments.get().value,function(e){return new Date(e.comments[0].datePosted)})).reverse().value(),r.registerCallback(function(e,n){"removeUnreadComments"==e?t.unreadComments=_(_.sortBy(r.unreadComments.get().value,function(e){return new Date(e.comments[0].datePosted)})).reverse().value():"addUnreadComments"==e&&(t.unreadComments=_(_.sortBy(r.unreadComments.get().value,function(e){return new Date(e.comments[0].datePosted)})).reverse().value())})}angular.module("Wizdom365.Notification").controller("wizdom365NotificationPanelUnreadCommentsController",e),e.$inject=["$filter","$scope","$timeout","configuration","notificationApi","socialNotificationService"]}(),function(){function e(e,t,n,i,o,r,a,l){function s(){n.limitCountTo+=n.limitStep}function c(){n.limitCountTo-=n.limitStep}function d(t){r.items.markRead(t.id).then(function(){e.$broadcast("NoticeboardNewsItemRead",t)})}function u(){r.items.markAllRead(_.map(n.unreadNews,function(e){return e.id})).then(function(){e.$broadcast("NoticeboardNewsAllRead"),n.unreadNews=[]})}function m(e){l.setOpenItem({id:e})}n.openItem=m,n.dismiss=d,n.dismissAll=u,n.unreadNews=_(_.sortBy(l.unreadNews.get().value,function(e){return new Date(e.startDate)})).reverse().value(),n.limitStep=10,n.limitCountTo=n.limitStep,n.loadMore=s,n.loadLess=c,n.$on("NoticeboardNewsAllRead",function(e,t){n.unreadNews=[]}),n.$on("NoticeboardNewsItemRead",function(e,t){_.remove(n.unreadNews,function(e){return e.id===t.id})}),n.$on("NoticeboardNewsItemUnread",function(e,t){n.unreadNews.push(t)})}angular.module("Wizdom365.Notification").controller("wizdom365NotificationPanelUnreadElementsController",e),e.$inject=["$rootScope","$filter","$scope","$timeout","configuration","noticeboardApi","notificationApi","socialNotificationService"]}(),function(){angular.module("Wizdom365.Validation",["Wizdom365.Validation.Provider","Wizdom365.Validation.Directive"])}.call(this),function(){angular.module("Wizdom365.Validation.Provider",[]).provider("$validation",function(){var e,t,n,i,o,r=this,a=function(r){e=r,t=e.get("$rootScope"),n=e.get("$http"),i=e.get("$q"),o=e.get("$parse")},l={},s={};return this.setExpression=function(e){return angular.extend(l,e),r},this.getValidationConfig=function(e){var t=o(e)(this);return t},this.getExpression=function(e){return l[e]},this.setDefaultMsg=function(e){return angular.extend(s,e),r},this.getDefaultMsg=function(e){return s[e]},this.setErrorHTML=function(e){return e.constructor===Function?(r.getErrorHTML=e,r):void 0},this.getErrorHTML=function(e){return'<span class="validation-invalid">'+e+"</span>"},this.setSuccessHTML=function(e){return e.constructor===Function?(r.getSuccessHTML=e,r):void 0},this.getSuccessHTML=function(e){return'<span class="validation-valid">'+e+"</span>"},this.showSuccessMessage=!0,this.showErrorMessage=!0,this.checkValid=function(e){return void 0===e.$valid?!1:e&&e.$valid===!0},this.validate=function(e){var n=i.defer(),o=0;if(void 0===e)return console.error("This is not a regular Form name scope"),n.reject("This is not a regular Form name scope"),n.promise;if(e.validationId)t.$broadcast(e.$name+"submit-"+e.validationId,o++);else if(e.constructor===Array)for(var a in e)t.$broadcast(e[a].$name+"submit-"+e[a].validationId,o++);else for(var l in e)"$"!==l[0]&&e[l].hasOwnProperty("$dirty")&&t.$broadcast(l+"submit-"+e[l].validationId,o++);return n.promise.success=function(e){return n.promise.then(function(t){e(t)}),n.promise},n.promise.error=function(e){return n.promise.then(null,function(t){e(t)}),n.promise},r.checkValid(e)?n.resolve("success"):n.reject("error"),n.promise},this.reset=function(e){if(void 0===e)return void console.error("This is not a regular Form name scope");if(e.validationId)t.$broadcast(e.$name+"reset-"+e.validationId);else if(e.constructor===Array)for(var n in e)t.$broadcast(e[n].$name+"reset-"+e[n].validationId);else for(var i in e)"$"!==i[0]&&e[i].hasOwnProperty("$dirty")&&t.$broadcast(i+"reset-"+e[i].validationId)},this.$get=["$injector",function(e){return a(e),{setErrorHTML:this.setErrorHTML,getErrorHTML:this.getErrorHTML,setSuccessHTML:this.setSuccessHTML,getSuccessHTML:this.getSuccessHTML,setExpression:this.setExpression,getValidationConfig:this.getValidationConfig,getExpression:this.getExpression,setDefaultMsg:this.setDefaultMsg,getDefaultMsg:this.getDefaultMsg,showSuccessMessage:this.showSuccessMessage,showErrorMessage:this.showErrorMessage,checkValid:this.checkValid,validate:this.validate,reset:this.reset}}],this})}.call(this),function(){angular.module("Wizdom365.Validation.Directive",["Wizdom365.Validation.Provider"]).directive("validate",["$injector",function(e){var t=e.get("$validation"),n=e.get("validationService"),i=e.get("$filter"),o=e.get("$parse"),r=e.get("$q"),a={},l=function(e,n,i,o,r,a,l){if(t.showSuccessMessage&&"false"!=i){var s=t.getDefaultMsg(r),c=s?s.success:"",d=t.getSuccessHTML(o||c);n.nextAll(".validation-container").html(d)}else n.nextAll(".validation-container").html("");return l.$setValidity(l.$name,!0),a&&a(e),!0},s=function(e,n,o,r,a,l,s){if(t.showErrorMessage&&"false"!=o){var c=t.getDefaultMsg(a),d=c?c.error:i("translate")("This control breaks following rule: ")+i("translate")(a),u=t.getErrorHTML(r||d);n.nextAll(".validation-container").html(u)}else n.nextAll(".validation-container").html("");return s.$setValidity(s.$name,!1),l&&l(e),!1},c=!1,d=function(e,n,i,a,c,u){var m={};if(jQuery.extend(m,c),!i.disabled){var p=Object.keys(m)[0],g=m[p],f=p+"SuccessMessage",h=p+"ErrorMessage",w="showValidationMessages",v={success:function(){var t=o(i.validCallback);return l(e,n,i[w],i[f],p,t,a),Object.keys(m).length?void d(e,n,i,a,m,u):!0},error:function(){var t=o(i.invalidCallback);return s(e,n,i[w],i[h],p,t,a)}};if(delete m[p],void 0===g||0==g){if(void 0===g&&console.error('You are using undefined validator "%s"',p),!Object.keys(m).length)return;d(e,n,i,a,m,u)}return 1==g?(g=t.getExpression(p),g.constructor===Function?r.all([g(u,e,n,i)]).then(function(e){return e&&e.length>0&&e[0]?v.success():v.error()},function(){return v.error()}):g.constructor===RegExp?u?g.test(u)?v.success():v.error():v.success():v.error()):r.all([e.$eval(g,{$value:u})]).then(function(e){return e&&e.length>0&&e[0]?v.success():v.error()},function(){return v.error()})}},u=function(e,t,n,i,o,r){return angular.isString(e)?(m(e),void(a[e]=t.$watch(e,function(e,a){e!=a&&d(t,n,i,o,r,o.$modelValue)}))):angular.isArray(e)?void angular.forEach(e,function(e){m(e),a[e]=t.$watch(e,function(e,a){e!=a&&d(t,n,i,o,r,o.$modelValue)})}):void(angular.isObject(e)&&angular.forEach(e,function(e,l){var s={};s[l]=r[l],angular.isString(e)&&(m(e),a[e]=t.$watch(e,function(e,r){e!=r&&d(t,n,i,o,s,o.$modelValue)})),angular.isArray(e)&&angular.forEach(e,function(e){m(e),a[e]=t.$watch(e,function(e,r){e!=r&&d(t,n,i,o,s,o.$modelValue)})})}))},m=function(e){a[e]&&(a[e](),delete a[e])},p=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},g=function(){return p()+p()+p()+p()};return{restrict:"A",priority:1001,require:"ngModel",link:function(e,i,o,r){var a=function(){},l=t.getValidationConfig(o.validate);e.validationService=n;var s=r.validationId=g();i.after('<span class="validation-container"></span>');var m=!0;"boolean"==typeof o.initialValidity&&(m=e.initialValidity),r.$setValidity(r.$name,m),e.$on(r.$name+"reset-"+s,function(){a(),c=!1,r.$setViewValue(""),r.$setPristine(),r.$setValidity(r.$name,void 0),r.$render(),i.next().html("")}),function(){var t=$(i[0].form);return e.$on(r.$name+"submit-"+s,function(n,s){var m=r.$viewValue,p=!1;0===s&&(c=!1),p=d(e,i,o,r,l,m),("submit"===t.attr("validation-method")||"submit"===o.validationMethod)&&(a(),a=e.$watch(o.ngModel,function(t,n){t!==n&&((void 0===t||null===t)&&(t=""),p=d(e,i,o,r,l,t))}),o.validateWatch&&u(e.$eval(o.validateWatch),e,i,o,r,l)),c||p||(c=!0,i[0].focus())}),"blur"===t.attr("validation-method")||"blur"===o.validationMethod?(i.bind("blur",function(){var t=i[0].value;e.$apply(function(){d(e,i,o,r,l,t)})}),void(o.validateWatch&&u(e.$eval(o.validateWatch),e,i,o,r,l))):void("submit"!==t.attr("validation-method")&&"submit-only"!==t.attr("validation-method")&&"submit"!==o.validationMethod&&"submit-only"!==o.validationMethod&&(e.$watch(o.ngModel,function(t){if(r.$pristine&&r.$viewValue)r.$setViewValue(r.$viewValue);else if(r.$pristine)return void i.next().html("");d(e,i,o,r,l,t)}),o.validateWatch&&u(e.$eval(o.validateWatch),e,i,o,r,l)))}(),o.$observe("noValidationMessage",function(e){var t=i.next();"true"==e||e===!0?t.css("display","none"):("false"==e||e===!1)&&t.css("display","block")})}}}]).directive("validationSubmit",["$injector",function(e){var t=e.get("$validation"),n=(e.get("$timeout"),e.get("$parse"));return{priority:1,require:"?ngClick",link:function(e,i,o){var r=n(o.validationSubmit)(e);i.off("click"),i.on("click",function(i){i.preventDefault(),t.validate(r).success(function(){n(o.ngClick)(e)})})}}}]).directive("validationReset",["$injector",function(e){var t=e.get("$validation"),n=e.get("$parse");return{link:function(e,i,o){var r=n(o.validationReset)(e);i.on("click",function(e){e.preventDefault(),t.reset(r)})}}}])}.call(this),function(){angular.module("Wizdom365.Validation.Config",["Wizdom365.Validation"]).config(["$validationProvider",function(e){e.setErrorHTML(function(e){var t='<span class="validation-message validation-error"><i class="validation-icon icon-error-sign"></i>'+e+"</span>";return t});var t={required:function(e){return!!e},smarturl:/(^(https:\/\/|http:\/\/|\/|mailto:|tel:|file:).+)/,url:/(?:https?:\/\/)?(?:[\w]+\.)([a-zA-Z\.]{2,6})([\/\w\.-]*)*\/?/,email:/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,number:/^[0-9]*$/,ip:/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,filename:/^[\w\-. ]+$/},n={required:{error:"This should be Required!!",success:""},smarturl:{error:"This should be Url or smart word",success:""},url:{error:"This should be Url",success:""},email:{error:"This should be Email",success:""},number:{error:"This should be Number",success:""},ip:{error:"This is not ip address",success:""},filename:{error:"This is invalid file name",success:""}};e.setExpression(t).setDefaultMsg(n)}])}(),function(){function e(){function e(e){return angular.isUndefined(e)||null===e||""===e.toString().trim()}function t(t,n){return e(t)||e(n)||parseFloat(t)>=parseFloat(n)}function n(t,n){return e(t)||e(n)||parseFloat(t)>parseFloat(n)}function i(t,n){return e(t)||e(n)||parseFloat(t)<=parseFloat(n)}function o(t,n){return e(t)||e(n)||parseFloat(t)==parseFloat(n)}function r(e,t){return e&&t?!!e.toString().match(t):!0}function a(e,t,n){return t&&t>e?!1:n&&e>n?!1:!0}function l(e){if(e){var t="^[0-9]*$";return!!e.toString().match(t)}return!0}function s(e){if(e){var t=/^(?:[1-9]\d*|0)(\.\d+)?$/;return!!e.toString().match(t)}return!0}var c={isEmpty:e,notLessThen:t,biggerThen:n,notBiggerThen:i,equalTo:o,isNumeric:l,isDecimal:s,validateByRegex:r,validateByMinMax:a};return c}angular.module("Wizdom365.Validation").factory("validationService",e)}(),function(){function e(e,t,n,i,o,r,a,l){function s(){t.isVideoEnabled=2==t.selectedcontenttype.id,null!=t.editItem?(t.startDate=new Date(t.editItem.startDate),t.endDate=new Date(t.editItem.endDate),t.newsTitle=t.editItem.heading,t.newsContent=t.editItem.content,null!=t.editItem.alternateAuthor&&(t.altAuthor=t.editItem.alternateAuthor),null!=t.editItem.metadata&&(t.metadata=t.editItem.metadata,null!=t.editItem.metadata.allowComments&&(t.allowComments=t.editItem.metadata.allowComments),t.isVideoEnabled?(null!=t.editItem.metadata.videoImage&&t.editItem.metadata.videoImage.length>0&&(t.videoImage=t.editItem.metadata.videoImage),null!=t.editItem.metadata.link&&t.editItem.metadata.link.length>0&&(t.videoLink=t.editItem.metadata.link)):t.selectedcontenttype.metaData.useRollupImage&&t.editItem.metadata.picture&&(t.newsImage=t.editItem.metadata.picture))):(t.endDate1=e("date")(new Date,"dd-mm-yyyy"),t.startDate=new Date,t.endDate=new Date,t.endDate.setDate(t.startDate.getDate()+t.selectedcontenttype.metaData.plusDays)),t.isVideoEnabled?null==t.videoImage&&t.selectedcontenttype.metaData.useRollupImage&&(t.videoImage=t.selectedcontenttype.metaData.rollupImage):null==t.newsImage&&t.selectedcontenttype.metaData.useRollupImage&&(t.newsImage=t.selectedcontenttype.metaData.rollupImage)}function c(){var i=t.selectedchannels.map(function(e){return{id:e}}),l={id:null!=t.editItem?t.editItem.id:0,author:null!=t.editItem?t.editItem.author:null,heading:t.newsTitle,content:t.newsContent,startDate:t.startDate,endDate:t.endDate,alternateAuthor:null!=t.altAuthor?{loginName:t.altAuthor.loginName,displayName:t.altAuthor.displayName,id:t.altAuthor.id}:null,metadata:t.metadata,contentType:t.selectedcontenttype,channels:i};t.isVideoEnabled?l.metadata=_.merge(l.metadata,{link:t.videoLink,videoImage:t.videoImage,allowComments:t.allowComments}):l.metadata=_.merge(l.metadata,{picture:t.newsImage,allowComments:t.allowComments}),n.items.createNews(l).then(function(n){if(null!=n&&0!=n){var i=t.newsContent&&t.newsContent.indexOf("atwho-inserted")>0;if(i)try{var s=$(t.newsContent).find(".atwho-inserted"),c=_.map(s,function(e){return{receiver:{loginName:$(e).attr("loginname")},targetId:n,targetType:1}});console.log("mentions",c),c&&c.length&&r.social.addMentio(c)}catch(u){a("An error occurred while adding mentions",u)}else if(0!=t.notifyPrincipals.length){var p=[];l.id=n,_.forEach(t.notifyPrincipals,function(e){if(-1!=t.newsContent.indexOf(d(e.displayName))){var n={receiver:e,targetID:l.id,targetType:1};p.push(n)}}),p.length>0&&r.social.addMentio(p)}t.$emit("closeDialog")}else{var g=e("translate")("Some error occurred while item saving.");o.showErrorMessage(g),m=!1}})["catch"](function(){m=!1})}function d(e){return"@"+e.replace(/ /g,"")}function u(e){return null==e.newsTitle||0==e.newsTitle.length?"Please add a title.":null==e.startDate||null==e.endDate?"Please fill in both start date and end date.":e.startDate>e.endDate?"The start date must be before the end date.":new Date>e.endDate?"The end date must be later than the the current time.":e.isVideoEnabled&&(null==e.isVideoEnabled||null==e.videoLink||0==e.videoLink.length||e.invalidUrl)?"Please enter a valid video link.":null}t.isVideoEnabled=t.isVideoEnabled||!1,t.newsTitle=null,t.newsContent=null,t.startDate=null,t.endDate=null,t.altAuthor=null,t.videoLink="",t.videoImage=null,t.newsImage=null,t.allowComments=i.Noticeboard?$.parseJSON(i.Noticeboard.SocialFeature.EnableSocialOnItemByDefault):!0,t.invalidUrl=!1,t.socialFeatureEnabled=i.Noticeboard?$.parseJSON(i.Noticeboard.SocialFeature.Enabled):!1,t.searchPrincipals=[],t.notifyPrincipals=[],t.metadata={},t.tinyMceOptions={init_instance_callback:function(e){t.iframeElement=e.iframeElement,e.on("SetAttrib",function(t){"style"==t.attrName&&setTimeout(function(){e.execCommand("mceRepaint")})}),$(".ie11focusfix").focus(),e.serializer.addNodeFilter("script,style",function(e,t){function n(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")}for(var i,o,r=e.length;r--;)i=e[r],o=i.firstChild?i.firstChild.value:"",o.length>0&&(i.firstChild.value=n(o))})},entity_encoding:"raw",selector:"textarea",invalid_elements:"script, iframe",cleanup:!1},t.options={"show-weeks":!1,formatYear:"yy",startingDay:1},t.opened=!1,t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.disabled=function(e,n){return 1==t.disableWeekends?"day"===n&&(0===e.getDay()||6===e.getDay()):!1},t.removeAltAuthor=function(){t.altAuthor=null},t.deleteVideoImage=function(){t.videoImage=null},t.checkUrl=function(){return"undefined"==typeof t.videoLink||null==t.videoLink||0===t.videoLink.length?void(t.invalidUrl=!1):void(t.invalidUrl="unknown"===l.getVideoType(t.videoLink))},t.addAltAuthor=function(e,n,i){t.asyncSelected="",t.altAuthor=n},t.searchForPrincipal=function(e){return!e||e.length<2?[]:n.principals.searchForPrincipalAuthors(e).then(function(e){return e})},t.deleteImage=function(){t.newsImage=null};var m=!1;t.$watch("mode",function(e,t){"secondScene"==e&&s()}),t.$on("saveNews",function(n){if(!m){var i=u(t);i?o.showErrorMessage(e("translate")(i)):(m=!0,c())}}),t.selectUser=function(e){return _.contains(t.notifyPrincipals,e)||t.notifyPrincipals.push(e),d(e.displayName)},t.searchForMention=function(e){return!e||e.length<2?void(t.searchPrincipals=[]):n.principals.searchForPrincipalAuthors(e).then(function(e){t.searchPrincipals=e})}}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardCreateEditController",e),e.$inject=["$filter","$scope","noticeboardApi","configuration","notificationService","webApiProxy","log","videoUtility"]}(),function(){function e(e,t,n,i,o,r){function a(){null!=t.editItem?(t.startDate=t.editItem.startDate,t.endDate=t.editItem.endDate,t.newsTitle=t.editItem.heading,t.newsContent=t.editItem.content,null!=t.editItem.alternateAuthor&&(t.altAuthor=t.editItem.alternateAuthor),null!=t.editItem.metadata&&(t.metadata=t.editItem.metadata,null!=t.editItem.metadata.allowComments&&(t.allowComments=t.editItem.metadata.allowComments),t.selectedcontenttype.metaData.useRollupImage&&t.editItem.metadata.picture&&(t.newsImage=t.editItem.metadata.picture))):(t.endDate1=e("date")(new Date,"dd-mm-yyyy"),t.startDate=new Date,t.endDate=new Date,t.endDate.setDate(t.startDate.getDate()+t.selectedcontenttype.metaData.plusDays)),null==t.newsImage&&t.selectedcontenttype.metaData.useRollupImage&&(t.newsImage=t.selectedcontenttype.metaData.rollupImage)}function l(){var i=t.selectedchannels.map(function(e){return{id:e}});t.metadata.picture=t.newsImage,t.metadata.allowComments=t.allowComments;var a={id:null!=t.editItem?t.editItem.id:0,author:null!=t.editItem?t.editItem.author:null,heading:t.newsTitle,content:t.newsContent,startDate:t.startDate,endDate:t.endDate,alternateAuthor:null!=t.altAuthor?{loginName:t.altAuthor.loginName,displayName:t.altAuthor.displayName,id:t.altAuthor.id}:null,metadata:t.metadata,contentType:t.selectedcontenttype,channels:i};n.items.createNews(a).then(function(n){if(null!=n&&0!=n){if(0!=t.notifyPrincipals.length){var i=[];a.id=n,_.forEach(t.notifyPrincipals,function(e){if(-1!=t.newsContent.indexOf(s(e.displayName))){var n={receiver:e,targetID:a.id,targetType:1};i.push(n)}}),i.length>0&&r.social.addMentio(i)}t.$emit("closeDialog")}else{var l=e("translate")("Some error occurred while item saving.");o.showErrorMessage(l),c=!1}})["catch"](function(){c=!1})}function s(e){return"@"+e.replace(/ /g,"")}t.metadata={},t.newsTitle=null,t.newsContent=null,t.startDate=null,t.endDate=null,t.altAuthor=null,t.newsImage=null,t.allowComments=i.Noticeboard?$.parseJSON(i.Noticeboard.SocialFeature.EnableSocialOnItemByDefault):!0,t.socialFeatureEnabled=i.Noticeboard?$.parseJSON(i.Noticeboard.SocialFeature.Enabled):!1,t.searchPrincipals=[],t.notifyPrincipals=[],t.tinyMceOptions={init_instance_callback:function(e){t.iframeElement=e.iframeElement,e.on("SetAttrib",function(t){"style"==t.attrName&&setTimeout(function(){e.execCommand("mceRepaint")})}),$(".ie11focusfix").focus()},entity_encoding:"raw"},t.options={"show-weeks":!1,formatYear:"yy",startingDay:1},t.opened=!1,t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.disabled=function(e,n){return 1==t.disableWeekends?"day"===n&&(0===e.getDay()||6===e.getDay()):!1},t.removeAltAuthor=function(){t.altAuthor=null},t.addAltAuthor=function(e,n,i){t.asyncSelected="",t.altAuthor=n},t.searchForPrincipal=function(e){return!e||e.length<2?[]:n.principals.searchForPrincipalAuthors(e).then(function(e){return e})},t.deleteImage=function(){t.newsImage=null};var c=!1,d=function(e){var t=new RegExp("((%3C*|<)[^*]?script|(%3C*|<)[^*]?iframe)").test(e);return t},u=function(){var e=t.newsContent,n=d(e);if(n)return!1;var i=new RegExp("(lt;|gt;|&amp;)").test(e);if(i){var o=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/lt;/g,"<").replace(/gt;/g,">").replace(/&amp;/g,"").replace(/amp;/g,"");return n=d(o),n?!1:!0}return!0};t.$watch("mode",function(e,t){"secondScene"==e&&a()}),t.$on("saveNews",function(n){if(!c)if(null!=t.newsTitle&&0!=t.newsTitle.length&&null!=t.startDate&&null!=t.endDate)if(u())c=!0,l();else{var i=e("translate")("Forbidden HTML-Tag detected.");o.showErrorMessage(i)}else{var i=e("translate")("Please fill out all fields.");o.showErrorMessage(i)}}),t.selectUser=function(e){return _.contains(t.notifyPrincipals,e)||t.notifyPrincipals.push(e),s(e.displayName)},t.searchForMention=function(e){return!e||e.length<2?void(t.searchPrincipals=[]):n.principals.searchForPrincipalAuthors(e).then(function(e){t.searchPrincipals=e})}}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardCreateNewsController",e),e.$inject=["$filter","$scope","noticeboardApi","configuration","notificationService","webApiProxy"]}(),function(){function e(e,t,n,i,o,r,a){function l(){null!=t.editItem?(t.startDate=new Date(t.editItem.startDate),t.endDate=new Date(t.editItem.endDate),t.newsTitle=t.editItem.heading,t.newsContent=t.editItem.content,t.videoLink=t.editItem.metadata.link.toString(),null!=t.editItem.metadata.allowComments&&(t.allowComments=t.editItem.metadata.allowComments),null!=t.editItem.metadata.videoImage&&t.editItem.metadata.videoImage.length>0&&(t.videoImage=t.editItem.metadata.videoImage),null!=t.editItem.alternateAuthor&&(t.altAuthor=t.editItem.alternateAuthor)):(t.startDate=new Date,t.endDate=new Date,t.endDate.setDate(t.startDate.getDate()+t.selectedcontenttype.metaData.plusDays)),null==t.videoImage&&t.selectedcontenttype.metaData.useRollupImage&&(t.videoImage=t.selectedcontenttype.metaData.rollupImage)}function s(){var i=t.selectedchannels.map(function(e){return{id:e}}),a={id:null!=t.editItem?t.editItem.id:0,author:null!=t.editItem?t.editItem.author:null,heading:t.newsTitle,content:t.newsContent,startDate:t.startDate,endDate:t.endDate,alternateAuthor:null!=t.altAuthor?{loginName:t.altAuthor.loginName,id:t.altAuthor.id}:null,metadata:{link:t.videoLink,videoImage:t.videoImage,allowComments:t.allowComments},contentType:t.selectedcontenttype,channels:i};n.items.createNews(a).then(function(n){if(null!=n&&0!=n){if(0!=t.notifyPrincipals.length){a.id=n;var i=[];_.forEach(t.notifyPrincipals,function(e){if(-1!=t.newsContent.indexOf(c(e.displayName))){var n={receiver:e,targetID:a.id,targetType:1};i.push(n)}}),i.length>0&&r.social.addMentio(i)}t.$emit("closeDialog")}else{var l=e("translate")("Some error occurred while item saving.");o.showErrorMessage(l)}})}function c(e){return"@"+e.replace(/ /g,"")}t.newsTitle=null,t.newsContent=null,t.startDate=null,t.endDate=null,t.altAuthor=null,t.videoLink="",t.videoImage=null,t.allowComments=i.Noticeboard?$.parseJSON(i.Noticeboard.SocialFeature.EnableSocialOnItemByDefault):!0,t.invalidUrl=!1,t.socialFeatureEnabled=i.Noticeboard?$.parseJSON(i.Noticeboard.SocialFeature.Enabled):!1,t.searchPrincipals=[],t.notifyPrincipals=[],t.tinyMceOptions={init_instance_callback:function(e){t.iframeElement=e.iframeElement,$(".ie11focusfix").focus()},entity_encoding:"raw"},t.deleteVideoImage=function(){t.videoImage=null},t.checkUrl=function(){return"undefined"==typeof t.videoLink||null==t.videoLink||0===t.videoLink.length?void(t.invalidUrl=!1):void(t.invalidUrl="unknown"===a.getVideoType(t.videoLink))},t.removeAltAuthor=function(){t.altAuthor=null},t.addAltAuthor=function(e,n,i){t.asyncSelected="",t.altAuthor=n},t.searchForPrincipal=function(e){return!e||e.length<2?[]:n.principals.searchForPrincipalAuthors(e).then(function(e){return e})};var d=function(e){var t=new RegExp("((%3C*|<)[^*]?script|(%3C*|<)[^*]?iframe)").test(e);return t},u=function(){var e=t.newsContent,n=d(e);if(n)return!1;var i=new RegExp("(lt;|gt;|&amp;)").test(e);if(i){var o=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/lt;/g,"<").replace(/gt;/g,">").replace(/&amp;/g,"").replace(/amp;/g,"");return n=d(o),n?!1:!0}return!0};t.$watch("mode",function(e,t){"secondScene"==e&&l()}),t.$on("saveNews",function(n){if(null==t.newsTitle||0==t.newsTitle.length||null==t.startDate||null==t.endDate||null==t.videoLink||0==t.videoLink.length||t.invalidUrl){var i=e("translate")("Please fill out all fields.");o.showErrorMessage(i)}else if(u())s();else{var i=e("translate")("Forbidden HTML-Tag detected.");o.showErrorMessage(i)}}),t.selectUser=function(e){return _.contains(t.notifyPrincipals,e)||t.notifyPrincipals.push(e),c(e.displayName)},t.searchForMention=function(e){return!e||e.length<2?void(t.searchPrincipals=[]):n.principals.searchForPrincipalAuthors(e).then(function(e){t.searchPrincipals=e})}}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardCreateVideoController",e),e.$inject=["$filter","$scope","noticeboardApi","configuration","notificationService","webApiProxy","videoUtility"]}(),function(){function e(e,t,n,i,o,r,a,l,s,c,d,u,m,p,g,f,h){function w(e,t,n){var i={text:e,modal:!0,type:"notification",layout:"center",successCalback:t,cancelCalback:n,okButtonText:"Yes",cancelButtonText:"No"};h.showConfirmationDialog(i)}function v(e){if(t.backId=null,t.forwardId=null,t.pageableIds)for(var n=0;n<t.pageableIds.length;n++)t.pageableIds[n]==e&&(0!=n&&(t.backId=t.pageableIds[n-1]),n!=t.pageableIds.length-1&&(t.forwardId=t.pageableIds[n+1]))}function b(){t.loadItem(t.itemId)}t.INIT_SHOW_COMMENTS=!0,t.scopeName="ShowNoticeboardItem",t.dataReady=p&&p.id===a.itemId,t.item=p,t.itemId=a.itemId,t.webpartId=r,t.webpartProperties=m.getProperties(r),t.pageableIds=g,t.mode="showNews",t.socialFeatureEnabled=l.Noticeboard?$.parseJSON(l.Noticeboard.SocialFeature.Enabled):!1,t.enableSocialOnOldItems=l.Noticeboard?$.parseJSON(l.Noticeboard.SocialFeature.EnableSocialOnItemByDefault):!1,t.enableSocialOnItemByDefault=l.Noticeboard?$.parseJSON(l.Noticeboard.SocialFeature.EnableSocialOnItemByDefault):!1,t.cancel=function(){c.close()},t.loadItem=function(e){var r=function(o){if(o.status){t.item=o.newsItem;var r=angular.copy(o.newsItem);if(delete r.content,delete r.comments,delete r.likes,delete r.mentions,t.item.contentType.metaData.navigateToSource){n.open(t.item.metadata.ItemUrl,"_blank");var l=[t.readComments()];return o.newsItem.isRead||l.push(t.readStatus()),void i.all(l).then(function(){t.cancel()})}o.newsItem.isRead||t.readStatus(),t.readComments(),"undefined"==typeof a.canEdit||a.canEdit||(t.item.canEdit=!1),t.template="Noticeboard/Templates/ViewTemplates/Webpart/ShowItem/ContentTypes/"+t.item.contentType.name+".html",t.markRead=o.newsItem.isRead,v(e),t.dataReady=!0;var s;if(s=t.webpartProperties.extendedProperties?t.webpartProperties.extendedProperties.archiveUrl||n.location.href:n.location.href,"/"===s[0]&&(s=n.location.protocol+"//"+n.location.host+s),-1===s.indexOf("?"))t.item.shareLinkUrl=s+"?k="+encodeURIComponent(t.item.heading)+"&newsId="+t.item.id;else{var c=s.split("?"),d=c[0],m=c[1],p={};if(m)for(var g=m.split("&"),f=0;f<g.length;f++){var h=g[f].split("=");p[h[0]]=h[1]}p.k=encodeURIComponent(t.item.heading),p.newsId=encodeURIComponent(t.item.id),m="?";for(var w in p)m+=w+"="+p[w]+"&";m=m.slice(0,-1),t.item.shareLinkUrl=d+m}u.trackPageView(o.newsItem.heading,t.item.shareLinkUrl,{NoticeboardItem:JSON.stringify(r)},void 0,0)}};if(p&&p.id===e&&p.contentType?r({status:!0,newsItem:p}):(t.dataReady=!1,o.views.getItem(t.webpartId,e).then(r)),t.item){var l=[],s=t.item.heading;-1!==s.indexOf(" ")?l=s.split(/(<.+?\s\/>|\s)/):l[0]=s;for(var c=0;c<l.length;c++)if(l[c].length>=22){setTimeout(function(){try{var e=$("div.modal-content").find("h1");e.addClass("wt-wordBreak")}catch(t){}},100);break}}},t.readComments=function(){return o.social.dismissComments(t.item.id).then(function(){d.unreadComments.remove(t.item),e.$broadcast("NoticeboardCommentRead",t.item)})},t.print=function(){var e;if(window.onafterprint=function(){e?$(".modal-footer .comment-item:first").removeClass("no-print"):$(".modal-footer.wd-noticeboard").removeClass("no-print"),$(".modal-header").removeClass("no-print")},t.item.comments.length>0){var n=f("translate")("Do you want to print the comments as well?");w(n,function(){e=!0,$(".modal-footer .comment-item:first").addClass("no-print"),$(".modal-header").addClass("no-print"),window.print()},function(){e=!1,$(".modal-footer.wd-noticeboard").addClass("no-print"),$(".modal-header").addClass("no-print"),window.print()})}else e=!1,$(".modal-footer.wd-noticeboard").addClass("no-print"),$(".modal-header").addClass("no-print"),window.print()},t.readStatus=function(){return o.items.markRead(t.item.id).then(function(){e.$broadcast("NoticeboardNewsItemRead",t.item),t.markRead=!0})},t.unReadStatus=function(){o.items.markUnread(t.item.id).then(function(){e.$broadcast("NoticeboardNewsItemUnread",t.item),t.markRead=!1})},t.editNewsItem=function(e){c.close(e)},t.showPicture=function(e){s.open({templateUrl:"Wizdom365/Templates/Dialogs/Image.html",controller:"Wizdom365ShowImageController",windowClass:"bootstrap-wrapper",size:"lg",resolve:{imgUrl:function(){return e}}}).result.then()},t.playVideo=function(){t.mode="showVideo"},b()}function t(e,t){return{link:function(n,i,o){var r=t(o.focusMe);n.$watch(r,function(t){t===!0&&e(function(){i[0].select()})}),i.bind("blur",function(){n.$apply(r.assign(n,!1))})}}}angular.module("Wizdom365.Noticeboard").controller("Wizdom365NoticeboardShowNewsController",e),e.$inject=["$rootScope","$scope","$window","$q","noticeboardApi","webpartId","itemInfo","configuration","$modal","$modalInstance","socialNotificationService","analyticsApi","webpartPropertiesService","item","pageableIds","$filter","notificationService"],angular.module("Wizdom365.Noticeboard").directive("focusMe",t),t.$inject=["$timeout","$parse"]}();angular.module("Wizdom365").run(["$templateCache",function($templateCache){$templateCache.put("CorporateNews/Templates/ViewTemplates/newscarousel2images.html","<div ng-show=\"dataReady && slides.length > 0\">\r\n    <div style=\"position:relative\">\r\n        <div id=\'carousel-outer\' set-container-dimensions-carousel=\"\">\r\n            <div id=\"carousel-hero\" class=\'carousel-hero-holderSearch\' ng-style=\"styleRail()\">\r\n                <div class=\'carousel-hero-railSearch\' ng-style=\"styleRail()\">\r\n                    <div class=\'carousel-hero-itemSearch slide-animation-carousel carousel-cover\'\r\n                         direction=\"{{direction}}\"\r\n                         currentIndex=\"{{currentIndex}}\"\r\n                         ng-repeat=\"slide in slides\"\r\n                         ng-hide=\"!isCurrentSlideIndex($index)\"\r\n                         ng-click=\"redirectTo(slide.path)\"\r\n                         ng-style=\"styleBackground((slide.image | stripImageSrc), 801)\"\r\n                         style=\"cursor:pointer;\">\r\n\r\n                        <div ng-style=\"style()\" ng-if=\"::(!slide.image)\" class=\"carousel-hero no-image-slide\"></div>\r\n                        <div class=\'carousel-hero-text\'>\r\n                            <div class=\'carousel-hero-text-inner\'>\r\n                                <div class=\'carousel-hero-text-title\'>\r\n                                    <a href=\'{{::slide.path}}\' ng-bind=\"slide.title\"></a>\r\n                                </div>\r\n                                <div class=\'carousel-hero-text-body\'>\r\n                                    <a href=\'{{::slide.path}}\' ng-if=\"::(!slide.summary)\">{{::slide.content | htmlToPlainText}} </a>\r\n                                    <a href=\'{{::slide.path}}\' ng-if=\"::slide.summary\">{{::slide.summary | htmlToPlainText}}</a>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div id=\'carousel-list\' class=\'carousel-list-holder\' style=\"height:294px; display:block;\">\r\n                <ul class=\'carousel-list-railSearch\'>\r\n                    <li class=\'carousel-list-item\' ng-repeat=\"slide in ::slides\" style=\"height:147px;\">\r\n                        <a href=\'{{::slide.path}}\' ng-if=\"::slide.image\"> <img ng-src=\"{{::slide.image | stripImageSrc}}?width=201\" /> </a>\r\n                        <div class=\'carousel-item-text\'>\r\n                            <div class=\'carousel-item-text-inner\'>\r\n                                <div class=\'carousel-item-text-title\'>\r\n                                    <a href=\'{{::slide.path}}\' ng-bind=\"slide.title\"></a>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </li>\r\n                    <li class=\'carousel-list-item\' ng-repeat=\"slide in ::slides\" style=\"height:147px;\">\r\n                        <a href=\'{{::slide.path}}\' ng-if=\"::slide.image\"> <img ng-src=\"{{::slide.image  | stripImageSrc}}?width=201\" /> </a>\r\n                        <div class=\'carousel-item-text\'>\r\n                            <div class=\'carousel-item-text-inner\'>\r\n\r\n                                <div class=\'carousel-item-text-title\'>\r\n\r\n                                    <a href=\'{{::slide.path}}\' ng-bind=\"slide.title\"></a>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div wizdom365-spinner=\"\" loading=\"!dataReady\"></div>");$templateCache.put("CorporateNews/Templates/ViewTemplates/newscarousel5images.html","<div ng-show=\"dataReady && slides.length > 0\">\r\n <div style=\"position:relative\">\r\n  <div id=\'carousel-outer5\' set-container-dimensions-carousel-five=\"\">\r\n   <div id=\"carousel-hero\" class=\'carousel-hero-holderSearch\' style=\"height:294px;\" ng-style=\"style()\">\r\n    <div class=\'carousel-hero-railSearch\' ng-style=\"style()\">\r\n     <div class=\'carousel-hero-itemSearch slide-animation-carousel5 carousel-cover\'\r\n       direction=\"{{direction}}\"\r\n       currentIndex=\"{{currentIndex}}\"\r\n       slides=\"{{::slides}}\"\r\n       ng-repeat=\"slide in ::slides\"\r\n       ng-hide=\"!isCurrentSlideIndex($index)\"\r\n       ng-click=\"redirectTo(slide.path)\"\r\n       ng-style=\"styleBackground((slide.image | stripImageSrc), 801)\"\r\n       style=\"cursor:pointer;\">\r\n\r\n      <div class=\'carousel-hero no-image-slide\' ng-style=\"style()\" ng-if=\"::(!slide.image)\"></div>\r\n      <div class=\'carousel-hero-text\'>\r\n       <div class=\'carousel-hero-text-inner\'>\r\n        <div class=\'carousel-hero-text-title\'>\r\n         <a href=\'{{::slide.path}}\' ng-bind=\"slide.title\"></a>\r\n        </div>\r\n        <div class=\'carousel-hero-text-body\'>\r\n         <a href=\'{{::slide.path}}\' ng-if=\"::(!slide.summary)\">{{::slide.content | htmlToPlainText}} </a>\r\n         <a href=\'{{::slide.path}}\' ng-if=\"::slide.summary\">{{::slide.summary | htmlToPlainText}}</a>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </div>\r\n   <div id=\'carousel-list\' class=\'carousel-list-holder\' style=\"height:294px;\">\r\n    <ul id=\"carousel-list-rail1\" class=\'carousel-list-railSearch\' ng-style=\"::(slides.length < 3 ? {\'margin-top\':\'0\'} : \'\')\">\r\n     <li class=\'carousel-list-item\' ng-repeat=\"slide in ::slides\" style=\"height:147px;\">\r\n      <a href=\'{{::slide.path}}\' ng-if=\"::slide.image\"> <img ng-src=\"{{::slide.image | stripImageSrc}}?width=201\" /> </a>\r\n      <div class=\'carousel-item-text\'>\r\n       <div class=\'carousel-item-text-inner\'>\r\n        <div class=\'carousel-item-text-title\'>\r\n         <a href=\'{{::slide.path}}\' ng-bind=\"slide.title\"></a>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </li>\r\n     <li class=\'carousel-list-item\' ng-repeat=\"slide in ::slides\" style=\"height:147px;\">\r\n      <a href=\'{{::slide.path}}\' ng-if=\"::slide.image\"> <img ng-src=\"{{::slide.image  | stripImageSrc}}?width=201\" /> </a>\r\n      <div class=\'carousel-item-text\'>\r\n       <div class=\'carousel-item-text-inner\'>\r\n        <div class=\'carousel-item-text-title\'>\r\n         <a href=\'{{::slide.path}}\' ng-bind=\"::slide.title\"></a>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </li>\r\n    </ul>\r\n    <ul id=\"carousel-list-rail2\" class=\'carousel-list-railSearch\' ng-style=\"::(slides.length < 3 ? {\'margin-top\':\'0\'} : \'\')\">\r\n     <li class=\'carousel-list-item\' ng-repeat=\"slide in ::slides\" style=\"height:147px;\">\r\n      <a href=\'{{::slide.path}}\' ng-if=\"::slide.image\"> <img ng-src=\"{{::slide.image | stripImageSrc}}?width=201\" /> </a>\r\n      <div class=\'carousel-item-text\'>\r\n       <div class=\'carousel-item-text-inner\'>\r\n        <div class=\'carousel-item-text-title\'>\r\n         <a href=\'{{::slide.path}}\' ng-bind=\"slide.title\"></a>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </li>\r\n     <li class=\'carousel-list-item\' ng-repeat=\"slide in ::slides\" style=\"height:147px;\">\r\n      <a href=\'{{::slide.path}}\' ng-if=\"::slide.image\"> <img ng-src=\"{{::slide.image  | stripImageSrc}}?width=201\" /> </a>\r\n      <div class=\'carousel-item-text\'>\r\n       <div class=\'carousel-item-text-inner\'>\r\n        <div class=\'carousel-item-text-title\'>\r\n         <a href=\'{{::slide.path}}\' ng-bind=\"slide.title\"></a>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </li>\r\n    </ul>\r\n   </div>\r\n  </div>\r\n </div>\r\n</div>\r\n<div wizdom365-spinner=\"\" loading=\"!dataReady\"></div>");$templateCache.put("CorporateNews/Templates/ViewTemplates/newscarouselfullwidth.html","<div ng-show=\"dataReady && slides.length > 0\">\r\n    <div style=\"position:relative\">\r\n        <div id=\'carousel-outer\' set-container-dimensions-carousel-new-design=\"\" class=\"carousel-margin\">\r\n            <div id=\"carousel-hero\" class=\'carousel-hero-holderSearch carousel-hero-holderSearch-absolute wizdom-fullview-left wizdom-fullview-right\'>\r\n                <div class=\'carousel-hero-railSearch\'>\r\n                    <div class=\'carousel-hero-itemSearch slide-animation-carousel-new-design carousel-cover\'\r\n                         direction=\"{{direction}}\"\r\n                         ng-repeat=\"slide in ::slides\"\r\n                         ng-hide=\"!isCurrentSlideIndex($index)\"\r\n                         ng-click=\"redirectTo(slide.path)\"\r\n                         ng-mouseover=\"stopAnimation()\"\r\n                         ng-mouseleave=\"startAnimation()\"\r\n                         ng-swipe-left=\"nextSlide(true)\"\r\n                         ng-swipe-right=\"prevSlide(true)\"\r\n                         ng-style=\"styleBackground((slide.image | stripImageSrc), 801)\"\r\n                         style=\"cursor:pointer;\">\r\n\r\n                        <div ng-style=\"style()\" ng-if=\"::(!slide.image)\" class=\"carousel-hero no-image-slide\"></div>\r\n                        <div class=\'carousel-hero-text-new-design\'>\r\n                            <div class=\'carousel-hero-text-inner\'>\r\n                                <div class=\'carousel-hero-text-title\'>\r\n                                    <a href=\'{{::slide.path}}\' ng-bind=\"slide.title\"></a>\r\n                                </div>\r\n                                <div class=\'carousel-hero-text-body\'>\r\n                                    <a href=\'{{::slide.path}}\' ng-if=\"::(!slide.summary)\">{{::slide.content | htmlToPlainText}} </a>\r\n                                    <a href=\'{{::slide.path}}\' ng-if=\"::slide.summary\">{{::slide.summary | htmlToPlainText}}</a>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"carousel-controls-newdesign\">\r\n                        <ul>\r\n                            <li class=\"icon-dot-white-dims\" ng-class=\"{\'icon-dot-white\':isCurrentSlideIndex($index), \'icon-dot-transparent\':!isCurrentSlideIndex($index)}\" ng-repeat=\"slide3 in ::slides\" ng-click=\"setCurrentSlideIndex($index);\"></li>\r\n                        </ul>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n            <div id=\"button-previous\" class=\"icon-arrow-left icon-arrow-left-dims\" ng-click=\"prevSlide(true)\"></div>\r\n            <div id=\"button-next\" class=\"icon-arrow-right icon-arrow-right-dims\" ng-click=\"nextSlide(true)\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div wizdom365-spinner=\"\" loading=\"!dataReady\"></div>\r\n");$templateCache.put("CorporateNews/Templates/ViewTemplates/newsgallery.html","<div ng-show=\"dataReady && slides.length > 0\">\r\n    <ul class=\"gallery-outer\" style=\"width:100%;\">\r\n        <li class=\"gallery-item\" ng-repeat=\"slide in ::slides\" style=\"{{::(slide.image ? \'\':\'width:151px;height:153px;\') }}\">\r\n            <div title=\"\" style=\"margin:0;\" class=\"newsLatest-thumb\" ng-if=\"::slide.image\" ng-click=\"redirectTo(slide.path)\" ng-style=\"::styleBackgroundList((slide.image | stripImageSrc), 151)\">\r\n            </div>\r\n            <div class=\"gallery-item-text\" style=\"{{::(slide.image ? \'\':\'width:151px;height:153px;\')}}\">\r\n                <h3>{{::slide.date | date: \'shortDate\'}}</h3>\r\n                <h3><a href=\'{{::slide.path}}\' title=\"\" ng-bind=\"slide.title\"></a></h3>\r\n            </div>\r\n        </li>\r\n    </ul>\r\n</div>\r\n<div wizdom365-spinner=\"\" loading=\"!dataReady\"></div>");$templateCache.put("CorporateNews/Templates/ViewTemplates/newslist.html","<div ng-show=\"dataReady && slides.length > 0\">\r\n    <ul class=\"newsLatest-outer\" style=\"width:100%;\">\r\n        <li class=\"newsLatest-item\" ng-repeat=\"slide in slides\">          \r\n            <div title=\"\" class=\"newsLatest-thumb\" ng-if=\"slide.image\"  ng-click=\"redirectTo(slide.path)\" ng-style=\"styleBackgroundList((slide.image | stripImageSrc), 100)\">\r\n            </div>\r\n            <a href=\'{{slide.path}}\' title=\"\" ng-bind=\"slide.title\" class=\"wt-linkText\"></a>\r\n            <div class=\"newsLatest-date\">\r\n                {{slide.date | date: \'shortDate\'}}\r\n            </div>\r\n            <div class=\"newsLatest-summary\" ng-if=\"(!slide.summary)\">\r\n                {{slide.content | htmlToPlainText}}\r\n            </div>\r\n            <div class=\"newsLatest-summary\" ng-if=\"slide.summary\">\r\n                {{slide.summary | htmlToPlainText}}\r\n            </div>\r\n        </li>\r\n    </ul>\r\n</div>\r\n<div wizdom365-spinner=\"\" loading=\"!dataReady\"></div>");$templateCache.put("CorporateNews/Templates/ViewTemplates/newsrotator.html","<div style=\"position:relative;\" ng-show=\"dataReady && slides.length > 0\">\r\n\r\n <div ng-show=\"dataReady\">\r\n  <div id=\"carousel-outer2\" set-container-dimensions-rotator=\"\">\r\n   <div class=\"carousel2-hero\" style=\"overflow: hidden;position: relative;float: left;display:inline;\">\r\n    <div ng-style=\"style()\">\r\n     <div class=\"carousel2-hero-item slide-animation-rotator carousel-cover\"\r\n       direction=\"{{direction}}\"\r\n       ng-repeat=\"slide in ::slides\"\r\n       ng-hide=\"!isCurrentSlideIndex($index)\"\r\n       ng-mouseleave=\"startAnimation()\"\r\n       ng-mouseover=\"stopAnimation()\"\r\n       ng-click=\"redirectTo(slide.path)\"\r\n       ng-style=\"styleBackground((slide.image | stripImageSrc), 801)\"\r\n       style=\"position:absolute;cursor:pointer;\">\r\n\r\n      <div ng-if=\"::(!slide.image)\" class=\"no-image-slide\"></div>\r\n      <div class=\'carousel-item-text\' ng-show=\"smallScreen\">\r\n       <div class=\'carousel-item-text-inner\'>\r\n        <div class=\'carousel-item-text-title\'>\r\n         <a href=\'{{::slide.path}}\' ng-bind=\"::slide.title\"></a>\r\n        </div>\r\n        <div class=\'carousel-hero-text-body\'>\r\n         <a href=\'{{::slide.path}}\' ng-if=\"::(!slide.summary)\">{{::slide.content | htmlToPlainText}}</a>\r\n         <a href=\'{{::slide.path}}\' ng-if=\"::slide.summary\">{{::slide.summary | htmlToPlainText}}</a>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </div>\r\n     <div class=\"carousel-controls\" ng-show=\"smallScreen\">\r\n      <ul>\r\n       <li class=\"dot\" ng-repeat=\"slide4 in ::slides\" ng-class=\"::{\'currentitem\':isCurrentSlideIndex($index)}\" ng-click=\"setCurrentSlideIndex($index);\">\r\n       </li>\r\n      </ul>\r\n     </div>\r\n    </div>\r\n   </div>\r\n   <div class=\"carousel2-list-holderAngular\" style=\"display:inline;float:right;margin-left:10px;\" ng-hide=\"smallScreen\" ng-mouseleave=\"startAnimation()\" ng-mouseover=\"stopAnimation()\">\r\n    <div class=\"carousel2-list-railAngular\">\r\n     <div class=\"carousel2-info-itemAngular\" ng-repeat=\"slide2 in ::slides\" ng-hide=\"!isCurrentSlideIndex($index)\">\r\n      <div class=\"carousel2-info-item-innerAngular\">\r\n       <div class=\"carousel2-info-text-title\"><a href=\'{{::slide2.path}}\'>{{::slide2.title}}</a></div>\r\n       <div class=\"carousel2-info-text-body\" style=\"margin-bottom: 20px;\">\r\n        <a href=\'{{::slide2.path}}\' ng-if=\"::(!slide2.summary)\">{{::slide2.content | htmlToPlainText}}</a>\r\n        <a href=\'{{::slide2.path}}\' ng-if=\"::slide2.summary\">{{::slide2.summary | htmlToPlainText}}</a>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n    <div class=\"carousel-controls\">\r\n     <ul>\r\n      <li class=\"dot\" ng-repeat=\"slide3 in ::slides\" ng-class=\"{\'currentitem\':isCurrentSlideIndex($index)}\" ng-click=\"setCurrentSlideIndex($index);\">\r\n      </li>\r\n     </ul>\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n</div>\r\n<div wizdom365-spinner=\"\" loading=\"!dataReady\"></div>");$templateCache.put("CorporateNews/Templates/ViewTemplates/newsslider.html","<div style=\"position:relative;\" ng-show=\"dataReady && slides.length > 0\">\r\n\r\n    <div id=\"slider-outer\">\r\n        <div id=\"slider-inner\" ng-style=\"styleHeight()\" ng-mouseleave=\"startAnimation()\" ng-mouseover=\"stopAnimation()\" set-container-dimensions-slider=\"\">\r\n            <div class=\"slider-item slide-animation-slider\"\r\n                 direction=\"{{direction}}\"\r\n                 ng-repeat=\"slide in ::slides\"\r\n                 ng-hide=\"!isCurrentSlideIndex($index)\"\r\n                 ng-style=\"style()\">\r\n                <a href=\'{{::slide.path}}\' ng-if=\"::slide.image\" style=\"float:left;margin-right:10px;\"><img ng-src=\"{{::slide.image | stripImageSrc}}?width=301\" /></a>\r\n                <div class=\"slider-inner-title\">\r\n                    <a href=\'{{::slide.path}}\' ng-bind=\"::slide.title\"></a>\r\n                </div>\r\n                <div class=\"slider-inner-date\" style=\"margin-top:5px;\" ng-if=\"::slide.date\">\r\n                    <span style=\"display:table-cell;vertical-align: middle;height: 20px;\">\r\n                        <img title=\"\" alt=\"\" src=\"data:image/gif;base64,R0lGODlhEAAPALMAAJubm3p6evv7+7+/v7y8vKqqqqOjo8DAwLCwsPHx8dLS0sTExLi4uIuLi////wAAACH5BAAAAAAALAAAAAAQAA8AAAR6UAVJw5pYIeZQdwXoGA5QJks6EAyDIEVszMCS3HiaHjxR76vWK1agKRyOA3KwXAoEjaODM0VSGYJEdOE6dBkKbsHbWDSTSPMooShb31WBgV3mIryIAaNoAJDVSklPBzcDdGpUBE8MNwSHCgQIYZKRkAhcDQcNm5ydnhEAOw==\" />\r\n                    </span>\r\n                    <span style=\"display: table-cell;vertical-align: top;padding-left: 3px;\">\r\n                        {{::slide.date | date: \'shortDate\'}}\r\n                    </span>\r\n                </div>\r\n                <div class=\"slider-inner-text\" ng-if=\"::(!slide.summary)\">\r\n                    <a href=\'{{::slide.path}}\'>{{::slide.content | htmlToPlainText}}</a>\r\n                </div>\r\n                <div class=\"slider-inner-text\" ng-if=\"::slide.summary\">\r\n                    <a href=\'{{::slide.path}}\'>{{::slide.summary | htmlToPlainText}}</a>\r\n                </div>\r\n            </div>\r\n            <ul class=\"slider-control-nav slider-control-paging\">\r\n                <li ng-repeat=\"slide in ::slides\">\r\n                    <a ng-bind=\"$index\" ng-click=\"goToSlide($index)\" ng-class=\"currentIndex == $index ? \'active\' : \'\'\"></a>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div wizdom365-spinner=\"\" loading=\"!dataReady\"></div>");$templateCache.put("CorporateNews/Templates/ViewTemplates/newstiles2.html","<div ng-show=\"dataReady && slides.length > 0\" class=\"corporate-news-wrapper\">\r\n    <!-- if 3 slides -->\r\n    <div class=\"container-fluid\" ng-if=\"slides.length>2\">\r\n        <div class=\"row\">\r\n            <!-- first part -->\r\n            <div class=\"col-xs-12 col-md-6\">\r\n                <div class=\"container-fluid\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-12 corp-image\" style=\"background-image:url(\'{{::slides[0].image | stripImageSrc}}?Height=400\');\">\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-12 corp-middle news-1of3-v2\" style=\"\">\r\n                            <div class=\"content\">\r\n                                <span class=\"date\" am-time-ago=\'::slides[0].date\'></span>\r\n                                <h2 class=\"title\"><a href=\'{{::slides[0].path}}\'>{{::slides[0].title}}</a></h2>\r\n                                <p class=\"content-text\">{{::slides[0].content | htmlToPlainText |limitTo: 75}}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- second part -->\r\n            <div class=\"col-xs-12 col-md-6\">\r\n                <div class=\"container-fluid\">\r\n                    <!-- second news -->\r\n                    <div class=\"row handle-margin-bottom\">\r\n                        <div class=\"col-xs-12  col-md-6 col-md-push-6 corp-image\" style=\"background-image:url(\'{{::slides[1].image | stripImageSrc}}?Height=400\');\">\r\n                        </div>\r\n                        <div class=\"col-xs-12  col-md-6 col-md-pull-6 corp-middle news-2of3-v2\" style=\"\">\r\n                            <div class=\"content\">\r\n                                <span class=\"date\" am-time-ago=\'::slides[1].date\'></span>\r\n                                <h2 class=\"title\"><a href=\'{{::slides[1].path}}\'>{{::slides[1].title}}</a></h2>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <!-- third news -->\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-6 corp-image handle-margin\" style=\"background-image:url(\'{{::slides[2].image | stripImageSrc}}?Height=400\');\">\r\n                        </div>\r\n                        <div class=\"col-xs-12 col-md-6 corp-middle handle-margin news-3of3-v2\" style=\"\">\r\n                            <div class=\"content\">\r\n                                <span class=\"date\" am-time-ago=\'::slides[2].date\'></span>\r\n                                <h2 class=\"title\"><a href=\'{{::slides[2].path}}\'>{{::slides[2].title}}</a></h2>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- if only 2 slides -->\r\n    <div class=\"container-fluid\" ng-if=\"slides.length==2\">\r\n        <div class=\"row\">\r\n            <!-- first part -->\r\n            <div class=\"col-xs-12 col-md-6\">\r\n                <div class=\"container-fluid\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-12 corp-image\" style=\"background-image:url(\'{{::slides[0].image | stripImageSrc}}?Height=400\');\">\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-12 corp-middle news-1of3-v2\">\r\n                            <div class=\"content\">\r\n                                <span class=\"date\" am-time-ago=\'::slides[0].date\'></span>\r\n                                <h2 class=\"title\"><a href=\'{{::slides[0].path}}\'>{{::slides[0].title}}</a></h2>\r\n                                <p class=\"content-text\">{{::slides[0].content | htmlToPlainText |limitTo: 75}}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n            <!-- second part -->\r\n            <div class=\"col-xs-12 col-md-6\">\r\n                <div class=\"container-fluid\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-12 corp-middle news-2of3-v2\">\r\n                            <div class=\"content\">\r\n                                <span class=\"date\" am-time-ago=\'::slides[1].date\'></span>\r\n                                <h2 class=\"title\"><a href=\'{{::slides[1].path}}\'>{{::slides[1].title}}</a></h2>\r\n                                <p class=\"content-text\">{{::slides[1].content | htmlToPlainText |limitTo: 75}}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-12 corp-image\" style=\"background-image:url(\'{{::slides[1].image | stripImageSrc}}?Height=400\');\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n\r\n <!-- if only 1 slides -->\r\n <div class=\"container-fluid\" ng-if=\"slides.length==1\">\r\n  <div class=\"row\">\r\n   <!-- first part -->\r\n   <div class=\"col-xs-12 col-md-12\">\r\n    <div class=\"container-fluid\">\r\n     <div class=\"row\">\r\n      <div class=\"col-xs-12 col-md-12 corp-full table news-1of3-v2\" style=\"\">\r\n       <div class=\"content\">\r\n        <span class=\"date\" am-time-ago=\'::slides[0].date\'></span>\r\n        <h2 class=\"title\"><a href=\'{{::slides[0].path}}\'>{{::slides[0].title}}</a></h2>\r\n        <p class=\"content-text\">{{slides[0].content | htmlToPlainText |limitTo: 150}}</p>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n\r\n</div>\r\n");$templateCache.put("CorporateNews/Templates/ViewTemplates/newstiles3.html","<div ng-show=\"dataReady && slides.length > 0\" class=\"corporate-news-wrapper\">\r\n    <div class=\"container-fluid\" ng-if=\"slides.length>1\">\r\n        <div class=\"row\">\r\n            <!-- first part -->\r\n            <div class=\"col-xs-12 col-md-6\">\r\n                <div class=\"container-fluid\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-12 corp-full table news-1of2-v3\" style=\"\">\r\n                            <div class=\"content\">\r\n                                <span class=\"date\" am-time-ago=\'::slides[0].date\'></span>\r\n                                <h2 class=\"title\"><a href=\'{{::slides[0].path}}\'>{{::slides[0].title}}</a></h2>\r\n                                <p class=\"content-text\">{{slides[0].content | htmlToPlainText |limitTo: 150}}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- second part -->\r\n            <div class=\"col-xs-12 col-md-6\">\r\n                <div class=\"container-fluid\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-12 corp-image\" style=\"background-image:url(\'{{::slides[1].image | stripImageSrc}}?Height=400\');\">\r\n                            <img ng-src=\'{{::slides[1].image | stripImageSrc}}?Height=400\' class=\"imgtiles\" />\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col-xs-12 col-md-12 corp-middle news-2of2-v3\" style=\"\">\r\n                            <div class=\"content\">\r\n                                <span class=\"date\" am-time-ago=\'::slides[1].date\'></span>\r\n                                <h2 class=\"title\"><a href=\'{{::slides[1].path}}\'>{{::slides[1].title}}</a></h2>\r\n                                <p class=\"content-text\">{{::slides[1].content | htmlToPlainText |limitTo: 75}}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n\r\n <div class=\"container-fluid\" ng-if=\"slides.length==1\">\r\n  <div class=\"row\">\r\n   <!-- first part -->\r\n   <div class=\"col-xs-12 col-md-12\">\r\n    <div class=\"container-fluid\">\r\n     <div class=\"row\">\r\n      <div class=\"col-xs-12 col-md-12 corp-full table news-1of2-v3\" style=\"\">\r\n       <div class=\"content\">\r\n        <span class=\"date\" am-time-ago=\'::slides[0].date\'></span>\r\n        <h2 class=\"title\"><a href=\'{{::slides[0].path}}\'>{{::slides[0].title}}</a></h2>\r\n        <p class=\"content-text\">{{slides[0].content | htmlToPlainText |limitTo: 150}}</p>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n\r\n</div>\r\n");$templateCache.put("Breadcrumb/Templates/ViewTemplates/BreadcrumbDefault.html","<div id=\"wt-breadcrumb\" class=\"wt-breadcrumb\">\r\n    <ul>\r\n        <li ng-repeat=\"link in ::breadCrumb\" ng-class=\"{\'wt-breadcrumb-link\':!$last, \'wt-breadcrumb-splitArr\':!$last}\">\r\n            <span ng-if=\"!$first\" ng-class=\"$last ? \'wt-breadcrumb-split-last\' : \'wt-breadcrumb-split\'\">/</span>\r\n            <a ng-href=\"{{ ::link.url }}\" ng-class=\"$last ? \'wt-breadcrumb-current\' : \'\'\">{{ ::link.name }}</a>\r\n        </li>\r\n    </ul>\r\n</div>");$templateCache.put("FAQ/Templates/ViewTemplates/webpartSimpleAccordionList.html","<div class=\"link-collection-content\">\r\n <accordion close-others=\"false\">\r\n  <accordion-group is-open=\"category.status.open\" ng-if=\"category.questions.length > 0\" ng-repeat=\"category in view.faqSet.categories\" ng-init=\"category.status = {};\">\r\n\r\n   <accordion-heading>\r\n    <div class=\"link-usercategory-content\">\r\n     <span ng-if=\"!category.isRoot\">\r\n      {{category.title}}\r\n     </span>\r\n     <span ng-if=\"category.isRoot\">\r\n      {{\'Uncategorized\' | translate}}\r\n     </span>\r\n     <i ng-if=\"category.questions.length > 0\"\r\n        class=\"pull-right glyphicon\"\r\n        ng-class=\"{\'glyphicon-chevron-down\': category.status.open,\r\n                                  \'glyphicon-chevron-right\': !category.status.open}\"></i>\r\n    </div>\r\n   </accordion-heading>\r\n\r\n   <ul class=\"list-group\">\r\n    <li class=\"list-group-item\" ng-repeat=\"question in category.questions | filter:q as results\" ng-show=\"question.isTopFAQ || category.showAll\">\r\n     <a href=\"javascript:;\" ng-hide=\"webpartProperties.useDialog\" wizdom365-faq-slide-toggle=\"#row_{{question.id}}\">\r\n      <i class=\"glyphicon glyphicon-question-sign question-heading-icon\" ng-hide=\"question.icon\"></i>\r\n      <wizdom365-icon class=\"question-heading-icon\" icon=\"question.icon\"></wizdom365-icon>\r\n      <span ng-click=\"question.showAnswer = !question.showAnswer\">{{question.question}}</span>\r\n     </a>\r\n     <a href=\"javascript:;\" ng-show=\"webpartProperties.useDialog\" ng-click=\"openDialog(question)\">\r\n      <i class=\"glyphicon glyphicon-question-sign question-heading-icon\" ng-hide=\"question.icon\"></i>\r\n      <wizdom365-icon class=\"question-heading-icon\" icon=\"question.icon\"></wizdom365-icon>\r\n      {{question.question}}\r\n     </a>\r\n     <div class=\"question-content\">\r\n      <div id=\"row_{{question.id}}\" ng-if=\"question.showAnswer\">\r\n       <div style=\"margin-left:30px\">\r\n        <p class=\"fr-view\" ng-bind-html=\"question.answer | wizdom365TrustHtml\"></p>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </li>\r\n   </ul>\r\n   <div class=\"text-center faqShowAllButton\" ng-show=\"category.showShowAllButton\" ng-click=\"category.showAll = !category.showAll\">\r\n    <a href=\"javascript:;\">\r\n     <span ng-show=\"!category.showAll\">{{\'Show all questions\' | translate}}</span>\r\n     <span ng-show=\"category.showAll\">{{\'Show only top questions\' | translate}}</span>\r\n    </a>\r\n   </div>\r\n  </accordion-group>\r\n\r\n </accordion>\r\n\r\n</div>\r\n");$templateCache.put("FAQ/Templates/ViewTemplates/webpartSimpleList.html","<!-- Uncategorised faq start -->\r\n<div ng-if=\"view.faqSet.categories.length == 1\" class=\"link-collection-content\" ng-repeat=\"category in view.faqSet.categories\">\r\n <ul class=\"list-group\">\r\n  <li class=\"list-group-item\" ng-repeat=\"question in category.questions | filter:q as results\" ng-show=\"question.isTopFAQ || category.showAll\">\r\n   <a href=\"javascript:;\" ng-hide=\"webpartProperties.useDialog\" wizdom365-faq-slide-toggle=\"#row_{{question.id}}\">\r\n    <i class=\"glyphicon glyphicon-question-sign question-heading-icon\" ng-hide=\"question.icon\"></i>\r\n    <wizdom365-icon class=\"question-heading-icon\" icon=\"question.icon\"></wizdom365-icon>\r\n    <span ng-click=\"question.showAnswer = !question.showAnswer\">{{question.question}}</span>\r\n   </a>\r\n   <a href=\"javascript:;\" ng-show=\"webpartProperties.useDialog\" ng-click=\"openDialog(question)\">\r\n    <i class=\"glyphicon glyphicon-question-sign question-heading-icon\" ng-hide=\"question.icon\"></i>\r\n    <wizdom365-icon class=\"question-heading-icon\" icon=\"question.icon\"></wizdom365-icon>\r\n    {{question.question}}\r\n   </a>\r\n   <div class=\"question-content\" ng-if=\"question.showAnswer\">\r\n    <div id=\"row_{{question.id}}\">\r\n     <div style=\"margin-left:30px\">\r\n      <p class=\"fr-view\" ng-bind-html=\"question.answer | wizdom365TrustHtml\"></p>\r\n     </div>\r\n    </div>\r\n   </div>\r\n  </li>\r\n </ul>\r\n    <div class=\"text-center faqShowAllButton\" ng-show=\"category.showShowAllButton\" ng-click=\"category.showAll = !category.showAll\">\r\n        <a href=\"javascript:;\">\r\n            <span ng-if=\"!category.showAll\">{{\'Show all questions\' | translate}}</span>\r\n            <span ng-if=\"category.showAll\">{{\'Show only top questions\' | translate}}</span>\r\n        </a>\r\n    </div>\r\n</div>\r\n<!-- Uncategorised faq end -->\r\n\r\n\r\n<div ng-if=\"view.faqSet.categories.length !== 1 && category.questions.length > 0 \" class=\"link-collection-content\" ng-repeat=\"category in view.faqSet.categories\">\r\n\r\n <div class=\"panel panel-primary\">\r\n  <div class=\"panel-heading\">\r\n   <div class=\"panel-title\">\r\n    <span ng-if=\"!category.isRoot\">{{category.title}}</span>\r\n    <span ng-if=\"category.isRoot\">{{\'Uncategorized\' | translate}}</span>\r\n   </div>\r\n  </div>\r\n  <ul class=\"list-group\">\r\n   <li class=\"list-group-item\" ng-repeat=\"question in category.questions | filter:q as results\" ng-show=\"question.isTopFAQ || category.showAll\">\r\n    <a href=\"javascript:;\" ng-hide=\"webpartProperties.useDialog\" wizdom365-faq-slide-toggle=\"#row_{{question.id}}\">\r\n     <i class=\"glyphicon glyphicon-question-sign question-heading-icon\" ng-hide=\"question.icon\"></i>\r\n     <wizdom365-icon class=\"question-heading-icon\" icon=\"question.icon\"></wizdom365-icon>\r\n     <span ng-click=\"question.showAnswer = !question.showAnswer\">{{question.question}}</span>\r\n    </a>\r\n    <a href=\"javascript:;\" ng-show=\"webpartProperties.useDialog\" ng-click=\"openDialog(question)\">\r\n     <i class=\"glyphicon glyphicon-question-sign question-heading-icon\" ng-hide=\"question.icon\"></i>\r\n     <wizdom365-icon class=\"question-heading-icon\" icon=\"question.icon\"></wizdom365-icon>\r\n     {{question.question}}\r\n    </a>\r\n    <div class=\"question-content\">\r\n     <div id=\"row_{{question.id}}\" ng-if=\"question.showAnswer\">\r\n      <div style=\"margin-left:30px\">\r\n       <p class=\"fr-view\" ng-bind-html=\"question.answer | wizdom365TrustHtml\"></p>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </li>\r\n  </ul>\r\n  <div class=\"text-center faqShowAllButton\" ng-show=\"category.showShowAllButton\" ng-click=\"category.showAll = !category.showAll\">\r\n   <a href=\"javascript:;\">\r\n    <span ng-if=\"!category.showAll\">{{\'Show all questions\' | translate}}</span>\r\n    <span ng-if=\"category.showAll\">{{\'Show only top questions\' | translate}}</span>\r\n   </a>\r\n  </div>\r\n </div>\r\n\r\n</div>\r\n\r\n");$templateCache.put("Footer/Templates/ViewTemplates/Footer.html","<div class=\"bootstrap-wrapper s4-notdlg\">\r\n    <div class=\"wt-footer clearfix\">\r\n        <div class=\"container-fluid\">\r\n            <div class=\"row\">\r\n                <div class=\"wt-footer-categories\">\r\n                    <div class=\"wt-footer-category-column col-sm-4 col-xs-6\"\r\n                         ng-repeat=\"category in vm.footer.categories\"\r\n                         ng-if=\"category.links.length > 0\">\r\n\r\n                        <div>\r\n                            <div class=\"float-wrapper\">\r\n                                <div>\r\n                                    <span class=\"wt-footer-categoryname\">\r\n                                        {{category.name}}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <ul class=\"wt-footer-linklist\">\r\n                            <li class=\"wt-footer-link\"\r\n                                ng-repeat=\"link in category.links | filter:q as results\">\r\n                                <a href=\"{{link.smarturl}}\"\r\n                                   target=\"{{link.openInNewWindow?\'_blank\':\'_self\'}}\"\r\n                                   title=\"{{link.description}}\">\r\n                                    {{link.smartname}}\r\n                                </a>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n                <div class=\"wt-footer-text col-sm-12 col-xs-12\">\r\n                    <span>{{::vm.footerText}}</span>\r\n                    <span ng-if=\"::vm.shouldShowEditLinksIcon\" style=\"float:right\">\r\n                        <a>\r\n                            <i class=\"glyphicon glyphicon-pencil\" style=\"color:lightgray;cursor:pointer\" ng-click=\"vm.editServiceMenu()\"></i>\r\n                        </a>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>");$templateCache.put("ImageSlider/Templates/ViewTemplates/default.html","<div class=\"wizdomImageSlider\" wizdom365-imageslider-set-container-dimensions=\"\" style=\"position:relative;\" ng-if=\"configured && !loading && images\" ng-mouseleave=\"startAnimation()\" ng-mouseover=\"stopAnimation()\" ng-style=\"style()\">\r\n <div>\r\n  <a ng-if=\"item.link\"\r\n     class=\"imageContainer slide-animation-imageslider\"\r\n           direction=\"{{direction}}\"\r\n     ng-repeat=\"item in images\"\r\n     ng-hide=\"!isCurrentSlideIndex($index)\"\r\n     style=\"background-size:cover;height:auto;background-image:url(\'{{item.url}}\');width:100%;\"\r\n     ng-style=\"styleBackground(item.url, $index)\"\r\n     ng-href=\"{{item.link}}\">\r\n   <img class=\"sImage{{$index}}\" ng-src=\"{{item.url}}\" style=\"width:100%;visibility:hidden\" />\r\n  </a>\r\n  <div ng-if=\"!item.link\"\r\n    class=\"imageContainer slide-animation-imageslider\"\r\n             direction=\"{{direction}}\"\r\n    ng-repeat=\"item in images\"\r\n    ng-hide=\"!isCurrentSlideIndex($index)\"\r\n    style=\"background-size:cover;height:auto;background-image:url(\'{{item.url}}\');width:100%;\"\r\n    ng-style=\"styleBackground(item.url, $index)\">\r\n   <img class=\"sImage{{$index}}\" ng-src=\"{{item.url}}\" style=\"width:100%;visibility:hidden\" />\r\n  </div>\r\n\r\n  <div ng-if=\"images.length > 1\" id=\"button-previous\" ng-click=\"prevSlide()\" style=\"{{nextPrevButtonMarginTop}}\"></div>\r\n  <div ng-if=\"images.length > 1\" id=\"button-next\" ng-click=\"nextSlide()\" style=\"{{nextPrevButtonMarginTop}}\"></div>\r\n </div>\r\n</div>\r\n<!--ng-style=\"styleBackground((item.url))\"-->");$templateCache.put("ImageSlider/Templates/ViewTemplates/default_fullwidth.html","<div class=\"wizdomImageSlider wizdom-fullview-left wizdom-fullview-right\" wizdom365-imageslider-set-container-dimensions-full=\"\" style=\"position:relative;\" ng-if=\"configured && !loading && images\" ng-mouseleave=\"startAnimation()\" ng-mouseover=\"stopAnimation()\" ng-style=\"style()\">\r\n <div>\r\n  <a ng-if=\"item.link\"\r\n     class=\"imageContainer slide-animation-imageslider\"\r\n           direction=\"{{direction}}\"\r\n     ng-repeat=\"item in images\"\r\n     ng-hide=\"!isCurrentSlideIndex($index)\"\r\n     style=\"background-size:cover;height:auto;background-image:url(\'{{item.url}}\');width:100%;\"\r\n     ng-style=\"styleBackground(item.url, $index)\"\r\n     ng-href=\"{{item.link}}\">\r\n   <img class=\"sImage{{$index}}\" ng-src=\"{{item.url}}\" style=\"width:100%;visibility:hidden\" />\r\n  </a>\r\n  <div ng-if=\"!item.link\"\r\n    class=\"imageContainer slide-animation-imageslider\"\r\n             direction=\"{{direction}}\"\r\n    ng-repeat=\"item in images\"\r\n    ng-hide=\"!isCurrentSlideIndex($index)\"\r\n    style=\"background-size:cover;height:auto;background-image:url(\'{{item.url}}\');width:100%;\"\r\n    ng-style=\"styleBackground(item.url, $index)\">\r\n   <img class=\"sImage{{$index}}\" ng-src=\"{{item.url}}\" style=\"width:100%;visibility:hidden\" />\r\n  </div>\r\n\r\n  <div ng-if=\"images.length > 1\" id=\"button-previous\" ng-click=\"prevSlide()\" style=\"{{nextPrevButtonMarginTop}}\"></div>\r\n  <div ng-if=\"images.length > 1\" id=\"button-next\" ng-click=\"nextSlide()\" style=\"{{nextPrevButtonMarginTop}}\"></div>\r\n </div>\r\n\r\n</div>");$templateCache.put("LoadingBanner/Templates/ViewTemplates/LoadingBannerDefault.html","<div class=\"upgrade\" ng-if=\"vm.upgradeTaskType && vm.upgradeTaskType.toLowerCase() !== \'scriptloaderupdate\'\">\r\n <div class=\"upgrade-in-progress\" ng-if=\"vm.upgradeInProgress\" title=\"Wizdom {{vm.upgradeTaskType}} {{\'task\' | translate}} is {{vm.upgradeStatus}}: {{vm.upgradePercentDone}}% {{vm.upgradeProgressMessage}}\">\r\n  <div><span class=\"ms-Icon ms-Icon--Robot\"></span> {{\'The corporate intranet is getting updated in the background...\'}}</div>\r\n </div>\r\n <div class=\"upgrade-in-progress\" ng-if=\"vm.upgradeStatus && vm.upgradeStatus.toLowerCase() == \'queued\'\">\r\n  <div><span class=\"ms-Icon ms-Icon--Robot\"></span> {{\'The corporate intranet is queued for update...\'}}</div>\r\n </div>\r\n <div class=\"upgrade-done\" ng-if=\"vm.installDone\">\r\n  <div><span class=\"ms-Icon ms-Icon--Emoji2\"></span> {{\'Update completed successfully...\' | translate}} <a href=\"#\" ng-click=\"vm.refreshPageAfterUpdate()\">{{\'Click here\' | translate}}</a> {{\'to refresh the page when you are ready\' | translate}}</div>\r\n </div>\r\n</div>\r\n\r\n\r\n");$templateCache.put("Megamenu/Templates/ViewTemplates/MenuTemplate.html","<div class=\"Megamenu\">\r\n <ul class=\"TopItems\" ng-mouseover=\"a()\" ng-mouseleave=\"a(true)\">\r\n  <li id=\"tab{{$index}}\" ng-repeat=\"item in vm.topItems | orderBy:\'sortOrder\' track by item.id\"\r\n            ng-class=\"::{EnableHover:vm.enableHoverOnTopLinks}\" \r\n            class=\"TopElement\"\r\n            ng-mouseover=\"vm.overTopItemV2(item, $index);\" \r\n            ng-mouseleave=\"vm.leaveTopItemV2()\"\r\n            aria-haspopup=\"true\">\r\n            <div wizdom-include=\'::item.templatePath\'></div>\r\n  </li>\r\n </ul>\r\n    <!--ng-class=\"{EnableHover:vm.enableHoverOnTopLinks, active:topItem == vm.currentTopItem}\"-->\r\n <div ng-if=\"!vm.loading\" class=\"FoldOutContainer\" ng-class=\"::{fullWidth:vm.fullWidth}\" ng-mouseover=\"vm.overFoldOutContainer();\" ng-mouseleave=\"vm.leavingFoldOutContainer();\">\r\n        <div id=\"tab{{$index}}Section\" ng-class=\"::{fullWidth:vm.fullWidth}\" class=\"navigationTree FoldOut navigationTreeV2\" ng-repeat=\"item in ::vm.topItems\">    \r\n   <h3>{{::(item.translatedTitle || item.title)}}</h3>\r\n            <ul>\r\n                <li class=\"topLink\">\r\n     <div wizdom-include=\'::item.templatePath\'></div>\r\n                </li>\r\n                <li ng-repeat=\"section in ::item.children | orderBy:\'sortOrder\'\" class=\"Column\">                    \r\n                    <ul>\r\n                        <li ng-repeat=\"item in ::section.children | orderBy:\'sortOrder\'\">                             \r\n                            <div wizdom-include=\'::item.templatePath\'></div>                            \r\n                        </li>\r\n                    </ul>\r\n                </li>\r\n            </ul>\r\n  </div>\r\n </div>\r\n</div>\r\n\r\n");$templateCache.put("Megamenu/Templates/ViewTemplates/MenuTemplateDesktop.html","<div class=\"Megamenu\">\r\n    <ul class=\"TopItems\" ng-mouseover=\"a()\" ng-mouseleave=\"a(true)\">\r\n        <li id=\"tab{{$index}}\" ng-repeat=\"topItem in vm.topItems\" ng-mouseover=\"vm.overTopItemV2(topItem, $index);\" ng-mouseleave=\"vm.leaveTopItemV2()\">\r\n            <a class=\"TopItem\" \r\n               ng-attr-target=\"{{vm.getTranslatedText(topItem, \'openInNewWindow\') ? \'_blank\' : undefined}}\" \r\n               ng-href=\"{{vm.getTranslatedText(topItem, \'href\')}}\" \r\n               ng-class=\"{EnableHover:vm.enableHoverOnTopLinks, active:topItem == vm.currentTopItem}\"\r\n               aria-haspopup=\"true\">{{vm.getTranslatedText(topItem, \"title\")}}</a>\r\n        </li>\r\n    </ul>\r\n\r\n    <div class=\"FoldOutContainer\" ng-if=\"!vm.loading\" ng-class=\"{fullWidth:vm.fullWidth}\" ng-mouseover=\"vm.overFoldOutContainer();\" ng-mouseleave=\"vm.leavingFoldOutContainer();\">\r\n\r\n        <div id=\"tab{{$index}}Section\" ng-class=\"{fullWidth:vm.fullWidth}\" class=\"navigationTree FoldOut navigationTreeV2\" ng-repeat=\"topItem in vm.topItems\">\r\n            <h3>{{vm.getTranslatedText(topItem, \"title\")}}</h3>\r\n            <ul>\r\n                <li class=\"topLink\">\r\n                    <a ng-href=\"{{vm.getTranslatedText(topItem, \'href\')}}\" ng-click=\"vm.clickTopItem(vm.getTranslatedText(topItem, \'href\'), topItem, $event);\">{{vm.getTranslatedText(topItem, \"title\")}}</a>\r\n                </li>\r\n                <li ng-repeat=\"foldoutColumn in topItem.children | orderBy:\'sortOrder\'\" class=\"Column\">\r\n\r\n                    <ul>\r\n                        <li ng-repeat=\"item in foldoutColumn.children | orderBy:\'sortOrder\'\" ng-switch=\"item.contentType\">\r\n                            <div ng-switch-when=\"Text\" class=\"Item Heading\">{{vm.getTranslatedText(item,\'title\')}}</div>\r\n                            <a ng-switch-when=\"Link\" class=\"Item Link\" ng-class=\"{EnableHover:vm.enableHoverOnLinks}\" ng-href=\"{{vm.getTranslatedText(item,\'href\')}}\" ng-attr-target=\"{{vm.getTranslatedText(item,\'openInNewWindow\') ? \'_blank\' : undefined}}\">{{vm.getTranslatedText(item,\'title\')}}</a>\r\n                            <div ng-switch-when=\"Html\" class=\"Item Html fr-view\" ng-class=\"{EnableHover:vm.enableHoverOnHtml}\" ng-bind-html=\"vm.getTranslatedText(item,\'html\') | wizdom365TrustHtml\"></div>\r\n                        </li>\r\n                    </ul>\r\n                </li>\r\n            </ul>\r\n\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n");$templateCache.put("PageContact/Templates/ViewTemplates/DefaultPageContact.html","<div class=\'bootstrap-wrapper ms-webpart-chrome\r\n     wizdom-pageInfo wizdom-right-column-container\r\n     text-center ms-webpartzone-cell\' ng-if=\"vm.showPageContact\">\r\n    <div class=\'ms-webpart-chrome-title\'>\r\n        <span>\r\n            <h2 style=\'text-align: justify;\'\r\n                class=\'ms-webpart-titletext\'>\r\n                <nobr>\r\n                    {{ \'Contact information\' | translate }}\r\n                </nobr>\r\n            </h2>\r\n        </span>\r\n    </div>\r\n    <div class=\"ms-wpContentDivSpace\">\r\n        <div class=\'ms-WPBody wizdom-pageInfo-container\'>\r\n            <div class=\"wizdom-pageInfo-row\" ng-if=\"::!vm.useDepartment\">\r\n                <div class=\"wizdom-pageInfo-imgColumn\">\r\n                    <div wizdom365-presence-picture\r\n                         size=\"AVATAR\"\r\n                         email=\"vm.pageContact.wizdomUser.email\"\r\n                         accountname=\"vm.pageContact.wizdomUser.accountName\"\r\n                         name=\"vm.pageContact.wizdomUser.name\"\r\n                         url=\"vm.pageContact.wizdomUser.publicUrl\"\r\n                         image=\"vm.pageContact.wizdomUser.pictureURL\"></div>\r\n                </div>\r\n                <div class=\"wizdom-pageInfo-textColumn\">\r\n                    <div class=\'name notranslate\'>\r\n                        <a href=\"{{::vm.pageContact.wizdomUser.publicUrl}}\" title=\"{{::vm.pageContact.wizdomUser.name}}\">{{::vm.pageContact.wizdomUser.name}}</a><span wizdom365-gf-profile-achievements email=\"{{::vm.pageContact.wizdomUser.accountName}}\" name=\"{{::vm.pageContact.wizdomUser.name }}\"></span>\r\n                    </div>\r\n                    <div class=\'email notranslate\'>\r\n                        <a ng-href=\'mailto:{{ ::vm.pageContact.wizdomUser.email }}\'>\r\n                            {{ ::vm.pageContact.wizdomUser.email }}\r\n                        </a>\r\n                    </div>\r\n                    <div ng-repeat=\"prop in ::vm.pageContact.extendedProperties | orderObjectBy:\'SortOrder\'\" ng-if=\"::vm.pageContact.extendedProperties!=null\">\r\n                        {{::prop.value}}\r\n                    </div>\r\n                </div>\r\n            </div>            \r\n            <div ng-if=\"::vm.useDepartment\" class=\"wizdom-pageInfo-row\">\r\n                <div ng-show=\"::vm.pageContact.departmentImage\" class=\"wizdom-pageInfo-imgColumn\">\r\n                    <img class=\"departmentImage\"\r\n                         ng-src=\"{{ ::vm.pageContact.departmentImage }}\" />\r\n                </div>\r\n                <div class=\"wizdom-pageInfo-textColumn\">\r\n                    <div class=\'name notranslate\'>\r\n                        <a ng-show=\"::vm.pageContact.departmentUrl\"\r\n                           ng-href=\"{{::vm.pageContact.departmentUrl}}\">\r\n                            {{ ::vm.pageContact.departmentName }}\r\n                        </a>\r\n                        <span ng-hide=\"::vm.pageContact.departmentUrl\"\r\n                              ng-href=\"{{::vm.pageContact.departmentUrl}}\">\r\n                            {{ ::vm.pageContact.departmentName }}\r\n                        </span>\r\n                    </div>\r\n                    <div class=\'email\'>\r\n                        <a ng-href=\'mailto:{{ ::vm.pageContact.departmentMail }}\'>\r\n                            {{ ::vm.pageContact.departmentMail }}\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\'ms-clear\'></div>\r\n        </div>\r\n    </div>\r\n    <style type=\"text/css\">\r\n        @media print {\r\n            a[href]:after {\r\n                content: none !important;\r\n            }\r\n            .wt-shadow {\r\n                padding-top:25px !important;\r\n            }\r\n            .translation-panel .translation-btn {\r\n                display: none !important;\r\n            }\r\n        }\r\n    </style>\r\n</div>\r\n");$templateCache.put("PageInfo/Templates/ViewTemplates/NewsInfoDefault.html","<div class=\'news-info-container\' ng-if=\"showPageInfo\">\r\n    <div class=\"author-image presence media-object\" wizdom365-presence-picture size=\"AVATAR\"\r\n         email=\"pageInfo.wizdomUser.email\" accountname=\"pageInfo.wizdomUser.accountName\" name=\"pageInfo.wizdomUser.name\"></div>\r\n    <span class=\'wtsite-pagemodified-editedby\'>\r\n        {{((\'by\' | translate) + \' \')}}\r\n        <a href=\"{{pageInfo.wizdomUser.publicUrl}}\" title=\"{{ pageInfo.wizdomUser.name }}\">\r\n            {{pageInfo.wizdomUser.name}}\r\n        </a>\r\n    </span>\r\n    <span class=\'wtsite-page-author\'  ng-if=\"pageInfo.author\">\r\n        {{((\'Author\' | translate) + \': \')}}\r\n        <a href=\"{{pageInfo.author.publicUrl}}\" title=\"{{ pageInfo.author.name }}\">\r\n            {{pageInfo.author.name}}\r\n        </a>\r\n    </span>\r\n    <div class=\"news-info\" ng-hide=\"pageInfo.newsDate == \'\'\">\r\n        <span class=\"wizdom-icon icon-icon-clock\"></span>\r\n        <span class=\'wtsite-pagemodified-editeddate\'>{{ pageInfo.newsDate | wizdom365FormatDateMoment | wizdom365DefaultDate }}</span>\r\n        <span class=\'wtsite-pagemodified-spc\'></span>\r\n    </div>\r\n</div>\r\n ");$templateCache.put("PageInfo/Templates/ViewTemplates/PageInfoDefault.html","<div class=\'wtsite-pagemodified-control\' ng-if=\"showPageInfo\">\r\n    <div class=\'wtsite-pagemodified-control-row1\'>\r\n        <div ng-if=\"pageInfo.author\">\r\n            <span>{{\'Author\' | translate}}:</span>\r\n            <span class=\'wtsite-page-author\'>\r\n                <a href=\"{{pageInfo.author.publicUrl}}\" title=\"{{ pageInfo.author.name }}\">\r\n                    {{ pageInfo.author.name }}\r\n                </a>\r\n            </span>\r\n        </div>\r\n        <span ng-hide=\"pageInfo.modifiedDate == \'\'\" class=\"wizdom-icon icon-icon-clock\"></span>\r\n        <span ng-hide=\"pageInfo.modifiedDate == \'\'\" class=\'wtsite-pagemodified-editeddate\'>{{ pageInfo.modifiedDate | wizdom365FormatDateMoment | wizdom365DefaultDate }}</span>\r\n        <span ng-hide=\"pageInfo.modifiedDate == \'\'\" class=\'wtsite-pagemodified-spc\'>|</span>\r\n        <span>{{\'Modified by:\' | translate}}</span>\r\n        <span class=\'wtsite-pagemodified-editedby\'>\r\n            <a href=\"{{pageInfo.wizdomUser.publicUrl}}\" title=\"{{ pageInfo.wizdomUser.name }}\">\r\n                {{ pageInfo.wizdomUser.name }}\r\n            </a>\r\n        </span>\r\n    </div>\r\n</div>");$templateCache.put("PageRelations/Templates/ViewTemplates/DocumentsDefault.html","<div class=\'ms-webpart-chrome relateddocuments ms-webpartzone-cell\' ng-show=\"documents.length\">\r\n    <div class=\'ms-webpart-chrome-title\'>\r\n        <span title=\"{{ \'Related documents\' | translate }}\">\r\n            <h2 style=\'text-align:justify;\' class=\'ms-webpart-titleText\'><nobr><span>{{ \'Related documents\' | translate }}</span></nobr></h2>\r\n        </span>\r\n    </div>\r\n    <div class=\'ms-wpContentDivSpace\'>\r\n        <div class=\'ms-WPBody\'>\r\n            <div ng-repeat=\"item in documents\" class=\"page-relations\">\r\n                <span ng-class=\"getDocIco(item)\"></span>\r\n                <a target=\"_blank\" ng-href=\"{{item.url}}\" ng-bind=\"item.name\"></a>\r\n            </div>\r\n        </div>\r\n        <div class=\'ms-clear\'></div>\r\n    </div>\r\n</div>");$templateCache.put("PageRelations/Templates/ViewTemplates/NewsContentPageDefault.html","<div class=\'ms-webpart-chrome related-news ms-webpartzone-cell\' ng-show=\"news.length > 0\">\r\n <div class=\'ms-webpart-chrome-title\'>\r\n  <span title=\"{{ \'Related news\' | translate }}\">\r\n   <h2 style=\'text-align:justify;\' class=\'ms-webpart-titleText\'><nobr><span>{{ \'Related news\' | translate }}</span></nobr></h2>\r\n  </span>\r\n </div>\r\n <div class=\'ms-wpContentDivSpace\'>\r\n  <div class=\'ms-WPBody\'>\r\n   <div class=\"panel page-relations\" ng-repeat=\"item in news\">\r\n    <div class=\"panel-body\">\r\n     <a target=\"_blank\" ng-href=\"{{item.url}}\" ng-bind=\"item.name\"></a>\r\n    </div>\r\n   </div>\r\n  </div>\r\n  <div class=\'ms-clear\'></div>\r\n </div>\r\n</div>\r\n");$templateCache.put("PageRelations/Templates/ViewTemplates/NewsDefault.html","\r\n<div class=\'ms-webpart-chrome ms-webpartzone-cell related-news\' ng-show=\"news.length > 0\">\r\n    <div class=\'ms-webpart-chrome-title\'>\r\n        <!--<h2 class=\'ms-webpart-titleText\'>\r\n            <span class=\"icon-inline icon-related-news icon-related-news-dims\"></span>&nbsp;\r\n            <nobr><span>{{ \'Related news\' | translate }}</span></nobr>\r\n        </h2>-->\r\n        <h2 class=\'ms-webpart-titleText\'>{{ \'Related news\' | translate }}</h2>\r\n    </div>\r\n    <div class=\'ms-wpContentDivSpace\'>\r\n        <div class=\'ms-WPBody row\'>\r\n            <div class=\"col-lg-4 col-md-6 col-sm-6 col-xs-6\" ng-repeat=\"item in news\" >\r\n                <div class=\"icon-related-news-default-background icon-related-news-default-background-dims thumbnail\" ng-style=\"getBackgroundImage(item.image)\">\r\n                    <div class=\"newsitem\">\r\n                        <a ng-href=\"{{item.url}}\">\r\n                            <h5>{{item.name}}</h5>\r\n                            <p ng-bind-html=\"item.summary | wizdom365SmartHtmlStrip:80\"></p>\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>");$templateCache.put("PageRelations/Templates/ViewTemplates/PagesDefault.html","<div class=\'ms-webpart-chrome relatedpages ms-webpartzone-cell\' ng-show=\"pages.length\">\r\n    <div class=\'ms-webpart-chrome-title\'>\r\n        <span title=\"{{ \'Related pages\' | translate }}\">\r\n            <h2 style=\'text-align:justify;\' class=\'ms-webpart-titleText\'><nobr><span>{{ \'Related pages\' | translate }}</span></nobr></h2>\r\n        </span>\r\n    </div>\r\n    <div class=\'ms-wpContentDivSpace\'>\r\n        <div class=\'ms-WPBody\'>\r\n            <div class=\"panel page-relations\" ng-repeat=\"item in pages\">\r\n                <div class=\"panel-body\">\r\n                    <a target=\"_blank\" ng-href=\"{{item.url}}\" ng-bind=\"item.name\"></a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\'ms-clear\'></div>\r\n    </div>\r\n</div>");$templateCache.put("PageRelations/Templates/ViewTemplates/PeopleDefault.html","<div class=\'wizdom-bootstrap-wrapper ms-webpart-chrome relatedpeople ms-webpartzone-cell\' ng-show=\"people.length\">\r\n    <div class=\'ms-webpart-chrome-title\'>\r\n        <span title=\"{{ \'Related people\' | translate }}\">\r\n            <h2 style=\'text-align:justify;\' class=\'ms-webpart-titleText\'><nobr><span>{{ \'Related people\' | translate }}</span></nobr></h2>\r\n        </span>\r\n    </div>\r\n    <div class=\"ms-wpContentDivSpace wizdom-pageInfo\">\r\n        \r\n        <div ng-repeat=\"item in people\" class=\"page-relations-people\">\r\n\r\n            <div class=\"ms-WPBody wizdom-pageInfo-container page-relation-peopleRow\">\r\n    <div class=\"wizdom-pageInfo-row\">\r\n     <div class=\"wizdom-pageInfo-imgColumn\">\r\n      <div wizdom365-presence-picture\r\n        size=\"AVATAR\"\r\n           email=\"item.email\"\r\n                             accountname=\"item.accountName\"\r\n        name=\"item.name\"\r\n        url=\"item.publicUrl\"\r\n        image=\"item.pictureURL\"></div>\r\n     </div>\r\n     <div class=\"wizdom-pageInfo-textColumn\">\r\n                        <div class=\'name\'><a href=\'{{ item.publicUrl }}\'>{{ item.name }}</a></div>\r\n                        <div class=\'email\'><a href=\'mailto:{{ item.email }}\'>{{ item.email }}</a></div>\r\n     </div>\r\n    </div>\r\n    <div class=\'ms-clear\'></div>\r\n   </div>\r\n\r\n        </div>\r\n        \r\n    </div>\r\n</div>");$templateCache.put("PageRevision/Templates/ViewTemplates/Email.html","<table cellpadding=\"4\" cellspacing=\"0\" border=\"0\" style=\"font-family:Sans-Serif; width:400px;\">\r\n    <tr valign=\"top\">\r\n        <td>\r\n            <img src=\"{{webUrl}}/_layouts/15/images/completeallwftasks.gif\" alt=\"\" />\r\n        </td>\r\n        <td>\r\n            {{\'You are registered as responsible for the following pages.\' | translate}}\r\n        </td>\r\n    </tr>\r\n</table>\r\n<table cellpadding=\"4\" cellspacing=\"0\" border=\"0\" style=\"font-family: Sans-Serif; width:400px;\">\r\n    <tr>\r\n        <td></td>\r\n        <td>{{\'Title\' | translate}}</td>\r\n        <td>{{\'Revision date\' | translate}}</td>\r\n        <td></td>\r\n    </tr>\r\n    <tr ng-repeat=\"page in pages\">\r\n        <td>\r\n            <a href=\"{{page.path}}\">\r\n                <img src=\"{{webUrl}}/_layouts/15/images/ichtm.gif\" alt=\"\" border=\"0\" />\r\n            </a>\r\n        </td>\r\n        <td>\r\n            <a href=\"{{page.path}}\">\r\n                {{page.title}}\r\n            </a>\r\n        </td>\r\n        <td>{{page.date}}</td>\r\n        <td ng-show=\"{{page.date}} <= now(-11)\">\r\n            <img src=\"{{webUrl}}/_layouts/15/images/attention16by16.gif\" />\r\n        </td>\r\n    </tr>\r\n</table>\r\n\r\n<!--\r\nGUIDLINES FOR THE EMAIL TEMPLATE\r\n    1. ng-repeat=\"page in pages\" element will be replaced with an element for each of the pages send to the email adress. Other ng-repeat are not supported at the moment\r\n    2. {{page.date}}, {{page.title}}, {{page.path}}, {{webUrl}} will be replaced by the actual values\r\n    3. {{\'You are registered as responsible for the following pages.\' | translate}}, {{\'Title\' | translate}} and {{\'Revision date\' | translate}} will be replaced with a localized string\r\n    4. {{\'value\' | translate}} will translate the given value according to the translation files\r\n    5. ng-show and ng-hide is supported. \r\n    6. Compare dates by using now(days)\r\n-->");$templateCache.put("PageRevision/Templates/ViewTemplates/PageRevisionNoSmiley.html","<div ng-if=\"showPageRevision\" class=\'bootstrap-wrapper revisiondate\'>\r\n    <div class=\'ms-wpContentDivSpace\' ng-show=\"pageRevision.passedRevision\">\r\n        <div class=\'ms-WPBody\'>\r\n            <div class=\'wtsite-revisiondate-outer alert alert-danger\'>\r\n                <div class=\'wtsite-revisiondate-line1\'>{{ \'The page revision date has passed!\' | translate }}</div>\r\n                <div class=\'wtsite-revisiondate-line2\'>\r\n                    {{ \'Date of revision\' | translate }}:  <span class=\'wtsite-revisiondate\'>{{ pageRevision.revisionDate | date:\'dd-MM-yyyy\' }}</span>\r\n                </div>\r\n            </div>\r\n            <div class=\'ms-clear\'></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n");$templateCache.put("PageRevision/Templates/ViewTemplates/PageRevisionSmiley.html","<div ng-if=\"showPageRevision\" class=\'bootstrap-wrapper revisiondate\'>\r\n    <div class=\'ms-wpContentDivSpace\'>\r\n        <div class=\'ms-WPBody\'>\r\n            <div class=\'wtsite-revisiondate-outer\'>\r\n                <img ng-if=\"pageRevision.greenSmiley\" ng-src=\'{{appUrl}}Modules/Branding/Content/Images/SmileyGreen.png\' />\r\n                <img ng-if=\"pageRevision.yellowSmiley\" ng-src=\'{{appUrl}}Modules/Branding/Content/Images/SmileyYellow.png\' />\r\n                <img ng-if=\"pageRevision.redSmiley\" ng-src=\'{{appUrl}}Modules/Branding/Content/Images/SmileyRed.png\' />\r\n            </div>\r\n            <div class=\'ms-clear\'></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n");$templateCache.put("PageTranslation/Templates/ViewTemplates/PageTranslationFlagsAndText.html","<div class=\"bootstrap-wrapper wizdom-translation\" style=\"\" ng-if=\"vm.ready && vm.ui\">\r\n\r\n <div class=\"translation-panel\">\r\n  <div class=\"translation-btn\" ng-click=\"vm.windowOpen = vm.windowOpen == true ? false : true\"><span class=\"glyphicons glyphicons-translate\"></span></div>\r\n  <div class=\"list-group translation-list\" translate=\"no\" ng-class=\"{\'translation-list-open\': vm.windowOpen }\">\r\n   <a ng-repeat=\"item in vm.LanguageKeys\" href=\"#\" class=\"list-group-item\" ng-class=\"{\'active\': vm.CheckActive(item)}\" ng-click=\"vm.TranslateFunc(null, item);vm.windowOpen = false;\">{{vm.LanguageMapLocallized[item]}}</a>\r\n   <a href=\"#\" class=\"list-group-item\" ng-class=\"{\'active\': vm.CheckActive(\'\')}\" ng-click=\"vm.windowOpen = false;vm.RestoreOrg();\">{{ \'Original\' | translate }}</a>\r\n  </div>\r\n </div>\r\n\r\n</div>");$templateCache.put("PageTranslation/Templates/ViewTemplates/PageTranslationTextAndFloat.html","<div class=\"bootstrap-wrapper wizdom-translation-float\" style=\"\" ng-if=\"vm.ready && vm.ui\">\r\n\r\n <div class=\"translation-panel\" ng-class=\"{\'translation-panel-open\': vm.windowOpen }\">\r\n  <div class=\"translation-btn\" ng-click=\"vm.windowOpen = vm.windowOpen == true ? false : true\"><span class=\"glyphicons glyphicons-translate\"></span></div>\r\n  <div class=\"list-group\" translate=\"no\">\r\n   <a ng-repeat=\"item in vm.LanguageKeys\" href=\"#\" class=\"list-group-item\" ng-class=\"{\'active\': vm.CheckActive(item)}\" ng-click=\"vm.TranslateFunc(null, item);vm.windowOpen = false;\">{{vm.LanguageMapLocallized[item]}}</a>\r\n   <a href=\"#\" class=\"list-group-item\" ng-class=\"{\'active\': vm.CheckActive(\'\')}\" ng-click=\"vm.windowOpen = false;vm.RestoreOrg();\">{{ \'Original\' | translate }}</a>\r\n  </div>\r\n </div>\r\n\r\n</div>");$templateCache.put("PersonalLink/Templates/ViewTemplates/accordionlist.html","<div class=\"link-collection-content\">\r\n    <accordion close-others=\"false\">\r\n\r\n        <accordion-group is-open=\"category.status.open\"\r\n                         ng-if=\"category.links.length > 0\"\r\n                         ng-repeat=\"category in vm.webpart.categories\"\r\n                         ng-init=\"category.status = {};\">\r\n\r\n            <accordion-heading>\r\n                <div class=\"link-usercategory-content\">\r\n                    <span ng-if=\"category.name == \'Uncategorized\'\">\r\n                        {{category.name | translate}}\r\n                    </span>\r\n                    <span ng-if=\"category.name != \'Uncategorized\'\">\r\n                        {{category.name}}\r\n                    </span>\r\n                    <i ng-if=\"category.links.length > 0\"\r\n                       class=\"pull-right glyphicon\"\r\n                       ng-class=\"{\'glyphicon-chevron-down\': category.status.open,\r\n                                  \'glyphicon-chevron-right\': !category.status.open}\"></i>\r\n                </div>\r\n            </accordion-heading>\r\n\r\n            <ul class=\"list-group\">\r\n                <li class=\"link-list-group-item\"\r\n                    ng-repeat=\"link in category.links | filter:q as results\">\r\n                    <a class=\"webpart-link\"\r\n                       href=\"{{link.smarturl}}\"\r\n                       target=\"{{link.openInNewWindow?\'_blank\':\'_self\'}}\"\r\n                       title=\"{{link.description}}\">\r\n                        {{link.smartname}}\r\n                    </a>\r\n                </li>\r\n            </ul>\r\n        </accordion-group>\r\n\r\n    </accordion>\r\n\r\n</div>\r\n");$templateCache.put("PersonalLink/Templates/ViewTemplates/descriptiveimagelist.html","<div ng-if=\"vm.webpart.categories.length == 1\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n\r\n    <div class=\"text-center\">\r\n        <a class=\"webpart-link imaged-link text-center\"\r\n           ng-repeat=\"link in category.links | filter:q as results\"\r\n           href=\"{{link.smarturl}}\"\r\n           title=\"{{link.description}}\"\r\n           target=\"{{link.openInNewWindow ? \'_blank\' : \'_self\'}}\">\r\n            <div ng-if=\"link.iconName.icon.length > 1 && link.imageUrl.length < 1\">\r\n                <i class=\"img-thumbnail\">\r\n                    <i class={{link.iconName.icon}}></i>\r\n                </i>\r\n                <span class=\"text-muted\" style=\"white-space: pre-line;\">\r\n                    {{link.description}}\r\n                </span>\r\n            </div>\r\n            <div ng-if=\"link.imageUrl.length > 1\">\r\n                <i class=\"img-thumbnail\">\r\n                    <img ng-src=\"{{link.imageUrl}}\" />\r\n                </i>\r\n                <span class=\"text-muted\" style=\"white-space: pre-line;\">\r\n                    {{link.description}}\r\n                </span>\r\n            </div>\r\n        </a>\r\n    </div>\r\n</div>\r\n\r\n<div ng-if=\"vm.webpart.categories.length !== 1 && category.links.length > 0\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n\r\n    <div class=\"panel panel-primary\">\r\n        <div class=\"panel-heading\">\r\n            <h3 class=\"panel-title\">\r\n                <span ng-if=\"category.name == \'Uncategorized\'\">\r\n                    {{category.name | translate}}\r\n                </span>\r\n                <span ng-if=\"category.name != \'Uncategorized\'\">\r\n                    {{category.name}}\r\n                </span>\r\n            </h3>\r\n        </div>\r\n        <div class=\"wizdom-personallink-imagelist-container\">\r\n            <a class=\"webpart-link imaged-link text-center\"\r\n               ng-repeat=\"link in category.links | filter:q as results\"\r\n               href=\"{{link.smarturl}}\"\r\n               title=\"{{link.description}}\"\r\n               target=\"{{link.openInNewWindow ? \'_blank\' : \'_self\'}}\">\r\n                <div ng-if=\"link.iconName.icon.length > 1 && link.imageUrl.length < 1\">\r\n                    <i class=\"img-thumbnail\">\r\n                        <i class={{link.iconName.icon}}></i>\r\n                    </i>\r\n                    <span class=\"text-muted\" style=\"white-space: pre-line;\">\r\n                        {{link.description}}\r\n                    </span>\r\n                </div>\r\n                <div ng-if=\"link.imageUrl.length > 1\">\r\n                    <i class=\"img-thumbnail\">\r\n                        <img ng-src=\"{{link.imageUrl}}\" />\r\n                    </i>\r\n                    <span class=\"text-muted\" style=\"white-space: pre-line;\">\r\n                        {{link.description}}\r\n                    </span>\r\n                </div>\r\n            </a>\r\n        </div>\r\n    </div>\r\n</div>");$templateCache.put("PersonalLink/Templates/ViewTemplates/detaillist.html","<div ng-if=\"vm.webpart.categories.length == 1\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n\r\n    <dl class=\"list-group-item\"\r\n        ng-repeat=\"link in category.links | filter:q as results\">\r\n        <dt>\r\n            <a class=\"webpart-link\"\r\n               href=\"{{link.smarturl}}\"\r\n               target=\"{{link.openInNewWindow?\'_blank\':\'_self\'}}\"\r\n               title=\"{{link.description}}\">\r\n                {{link.smartname}}\r\n            </a>\r\n        </dt>\r\n        <dd class=\"wizdom-personallink-detaillist-link-description\" style=\"white-space: pre-line;\">\r\n            {{link.description}}\r\n        </dd>\r\n    </dl>\r\n</div>\r\n\r\n\r\n<div ng-if=\"vm.webpart.categories.length !== 1\r\n            && category.links.length > 0\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n\r\n    <div class=\"panel panel-primary\">\r\n        <div class=\"panel-heading\">\r\n            <h3 class=\"panel-title\">\r\n                <span ng-if=\"category.name == \'Uncategorized\'\">\r\n                    {{category.name | translate}}\r\n                </span>\r\n                <span ng-if=\"category.name != \'Uncategorized\'\">\r\n                    {{category.name}}\r\n                </span>                \r\n            </h3>\r\n        </div>\r\n        <dl class=\"list-group-item\"\r\n            ng-repeat=\"link in category.links | filter:q as results\">\r\n            <dt>\r\n                <a class=\"webpart-link\"\r\n                   href=\"{{link.smarturl}}\"\r\n                   target=\"{{link.openInNewWindow?\'_blank\':\'_self\'}}\"\r\n                   title=\"{{link.description}}\">\r\n                    {{link.smartname}}\r\n                </a>\r\n            </dt>\r\n            <dd class=\"wizdom-personallink-detaillist-link-description\" style=\"white-space: pre-line;\">\r\n                {{link.description}}\r\n            </dd>\r\n        </dl>\r\n    </div>\r\n</div>");$templateCache.put("PersonalLink/Templates/ViewTemplates/dropdownlist.html","<div class=\"link-collection-dropdown\"\r\n     ng-if=\"category.links.length > 0\"\r\n     ng-repeat=\"category in vm.webpart.categories\"\r\n     ng-init=\"categoryIcon = category.id == 0 ? \'glyphicon-list-alt\'\r\n                                 : \'glyphicon-folder-close\';\r\n              categoryColor = category.id == 0 ? \'bg-success\'\r\n                                 : \'bg-info\'\">\r\n\r\n    <div dropdown class=\"btn-group\">\r\n        <button type=\"button\"\r\n                id=\"category-{{category.id}}\"\r\n                class=\"btn btn-primary dropdown-toggle\"\r\n                data-toggle=\"dropdown\" \r\n                aria-haspopup=\"true\"\r\n                aria-expanded=\"false\">\r\n            <span ng-if=\"category.name == \'Uncategorized\'\">\r\n                {{category.name | translate}}\r\n            </span>\r\n            <span ng-if=\"category.name != \'Uncategorized\'\">\r\n                {{category.name}}\r\n            </span>            \r\n            <span class=\"caret\"></span>\r\n        </button>\r\n\r\n        <ul class=\"dropdown-menu\"\r\n            role=\"menu\"\r\n            aria-labelledby=\"category-{{category.id}}\">\r\n            <li role=\"menuitem\"\r\n                ng-repeat=\"link in category.links | filter:q as results\">\r\n\r\n                <a class=\"webpart-link\"\r\n                   href=\"{{link.smarturl}}\"\r\n                   target=\"{{link.openInNewWindow?\'_blank\':\'_self\'}}\"\r\n                   title=\"{{link.description}}\">\r\n                    {{link.smartname}}\r\n                </a>\r\n\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>");$templateCache.put("PersonalLink/Templates/ViewTemplates/imaged_link_horizontal.html","<div ng-if=\"vm.webpart.categories.length == 1\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n    <div class=\"text-left\">\r\n        <a class=\"webpart-link imaged-link text-center round-64\"\r\n           ng-repeat=\"link in category.links | filter:q as results\"\r\n           href=\"{{link.smarturl}}\"\r\n           title=\"{{link.description}}\"\r\n           target=\"{{link.openInNewWindow ? \'_blank\' : \'_self\'}}\">\r\n            <div ng-if=\"link.imageUrl.length > 1\">\r\n                <img ng-src=\"{{link.imageUrl}}\" alt=\"{{link.description}}\" />\r\n            </div>\r\n            <div ng-if=\"link.iconName.icon.length > 1 && link.imageUrl.length < 1\">\r\n                <i class={{link.iconName.icon}}></i>\r\n            </div>\r\n            <span class=\"text-muted\">\r\n                {{link.name}}\r\n            </span>\r\n        </a>\r\n    </div>\r\n</div>\r\n\r\n<div ng-if=\"vm.webpart.categories.length !== 1\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n\r\n    <div ng-if=\"category.links.length > 0\" class=\"panel panel-primary\">\r\n        <div class=\"panel-heading\">\r\n            <h3 class=\"panel-title\">\r\n                <span ng-if=\"category.name == \'Uncategorized\'\">\r\n                    {{category.name | translate}}\r\n                </span>\r\n                <span ng-if=\"category.name != \'Uncategorized\'\">\r\n                    {{category.name}}\r\n                </span>\r\n            </h3>\r\n        </div>\r\n        <div class=\"wizdom-personallink-imagelist-container\">\r\n            <a class=\"webpart-link imaged-link text-center round-64\"\r\n               ng-repeat=\"link in category.links | filter:q as results\"\r\n               href=\"{{link.smarturl}}\"\r\n               title=\"{{link.description}}\"\r\n               target=\"{{link.openInNewWindow ? \'_blank\' : \'_self\'}}\">\r\n                <div ng-if=\"link.imageUrl.length > 1\">\r\n                    <img ng-src=\"{{link.imageUrl}}\" alt=\"{{link.description}}\" />\r\n                </div>\r\n                <div ng-if=\"link.iconName.icon.length > 1 && link.imageUrl.length < 1\">\r\n                    <i class={{link.iconName.icon}}></i>\r\n                </div>\r\n                <span class=\"text-muted\">{{link.name}}</span>\r\n            </a>\r\n        </div>\r\n    </div>\r\n</div>");$templateCache.put("PersonalLink/Templates/ViewTemplates/imagelist.html","<div ng-if=\"vm.webpart.categories.length == 1\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n\r\n    <div class=\"wizdom-personallink-imagelist-container\">\r\n        <a ng-repeat=\"link in category.links | filter:q as results\"\r\n           href=\"{{link.smarturl}}\"\r\n           target=\"{{link.openInNewWindow?\'_blank\':\'_self\'}}\">\r\n            <div ng-if=\"link.imageUrl.length > 1\">\r\n                <img ng-src=\"{{link.imageUrl}}\"\r\n                     alt=\"...\"\r\n                     class=\"img-thumbnail wizdom-personallink-img\">\r\n            </div>\r\n            <div ng-if=\"link.iconName.icon.length > 1 && link.imageUrl.length < 1\">\r\n                <i class=\"img-thumbnail\">\r\n                    <i class={{link.iconName.icon}}></i>\r\n                </i>\r\n            </div>\r\n        </a>\r\n    </div>\r\n</div>\r\n\r\n<div ng-if=\"vm.webpart.categories.length !== 1\r\n            && category.links.length > 0\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n\r\n    <div class=\"panel panel-primary\">\r\n        <div class=\"panel-heading\">\r\n            <h3 class=\"panel-title\">\r\n                <span ng-if=\"category.name == \'Uncategorized\'\">\r\n                    {{category.name | translate}}\r\n                </span>\r\n                <span ng-if=\"category.name != \'Uncategorized\'\">\r\n                    {{category.name}}\r\n                </span>\r\n            </h3>\r\n        </div>\r\n        <div class=\"wizdom-personallink-imagelist-container\">\r\n            <a ng-repeat=\"link in category.links | filter:q as results\"\r\n               href=\"{{link.smarturl}}\"\r\n               target=\"{{link.openInNewWindow?\'_blank\':\'_self\'}}\">\r\n                <div ng-if=\"link.imageUrl.length > 1\">\r\n                    <img ng-src=\"{{link.imageUrl}}\"\r\n                         alt=\"...\"\r\n                         class=\"img-thumbnail wizdom-personallink-img\">\r\n                </div>\r\n                <div ng-if=\"link.iconName.icon.length > 1 && link.imageUrl.length < 1\">\r\n                    <i class=\"img-thumbnail\">\r\n                        <i class={{link.iconName.icon}}></i>\r\n                    </i>\r\n                </div>\r\n            </a>\r\n        </div>\r\n    </div>\r\n</div>");$templateCache.put("PersonalLink/Templates/ViewTemplates/simplelist.html","<div ng-if=\"vm.webpart.categories.length == 1\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n    <ul class=\"list-group\">\r\n        <li class=\"list-group-item\"\r\n            ng-repeat=\"link in category.links | filter:q as results\">\r\n            <a class=\"webpart-link\"\r\n               href=\"{{link.smarturl}}\"\r\n               target=\"{{link.openInNewWindow?\'_blank\':\'_self\'}}\"\r\n               title=\"{{link.description}}\">\r\n                {{link.smartname}}\r\n            </a>\r\n        </li>\r\n    </ul>\r\n</div>\r\n\r\n<div ng-if=\"vm.webpart.categories.length !== 1\r\n            && category.links.length > 0\"\r\n     class=\"link-collection-content\"\r\n     ng-repeat=\"category in vm.webpart.categories\">\r\n\r\n\r\n    <div class=\"panel panel-primary\">\r\n        <div class=\"panel-heading\">\r\n            <h3 class=\"panel-title\">\r\n                <span ng-if=\"category.name == \'Uncategorized\'\">\r\n                    {{category.name | translate}}\r\n                </span>\r\n                <span ng-if=\"category.name != \'Uncategorized\'\">\r\n                    {{category.name}}\r\n                </span>\r\n            </h3>\r\n        </div>\r\n        <ul class=\"list-group\">\r\n            <li class=\"list-group-item\"\r\n                ng-repeat=\"link in category.links | filter:q as results\">\r\n                <a class=\"webpart-link\"\r\n                   href=\"{{link.smarturl}}\"\r\n                   target=\"{{link.openInNewWindow?\'_blank\':\'_self\'}}\"\r\n                   title=\"{{link.description}}\">\r\n                    {{link.smartname}}\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>");$templateCache.put("PersonalLink/Templates/ViewTemplates/tiles.html","<div class=\"quicklinks-tiles\">\r\n    <div class=\"category\" ng-repeat=\"category in vm.webpart.categories\" ng-if=\"category.links.length > 0\">\r\n        <h3 class=\"category__name\" ng-if=\"vm.webpart.categories.length > 1\">\r\n            {{category.name | translate}}\r\n        </h3>\r\n        <ul class=\"category__items\">\r\n            <li class=\"item\" ng-repeat=\"item in category.links\" ng-style=\"{backgroundColor:item.backgroundColor, color:item.fontColor ? item.fontColor : \'#fff\'}\">\r\n                <a\r\n                   href=\"{{item.smarturl}}\"\r\n                   target=\"{{item.openInNewWindow?\'_blank\':\'_self\'}}\"\r\n                   title=\"{{item.description}}\"\r\n                   ng-style=\"{color:item.fontColor ? item.fontColor : \'#fff\'}\">\r\n                    <div class=\"item__media\">\r\n                        <div ng-if=\"!item.useIcon\">\r\n                            <img ng-if=\"!item.isRound && item.imageUrl\" class=\"image\" ng-src=\"{{item.imageUrl}}\">\r\n                            <img ng-if=\"item.isRound && item.imageUrl\" class=\"image image--rounded\" ng-src=\"{{item.imageUrl}}\">\r\n                        </div>\r\n                        <div ng-if=\"item.useIcon\" class=\"icon-styling\" style=\"font-size: 50px\" ng-class=\"item.iconName.icon\"></div>\r\n                    </div>\r\n                    <div class=\"item__name\">\r\n                        {{item.smartname}}\r\n                    </div>\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>");$templateCache.put("Servicemenu/Templates/ViewTemplates/categorizedlist.html","<div class=\"servicemenu-classic\" ng-if=\"::(!vm.isEmpty)\">\r\n    <div ng-if=\"vm.showEditLinksIcon()\" class=\"wtsite-service-actions\" style=\"text-align: right; margin: 15px 15px 0 15px;\">\r\n        <a>\r\n            <i class=\"glyphicon glyphicon-pencil\" style=\"color:lightgray;cursor:pointer\"\r\n               ng-click=\"vm.editServiceMenu()\">\r\n            </i>\r\n        </a>\r\n    </div>\r\n    <ul ng-repeat=\"category in vm.serviceMenu.categories\" ng-init=\"outerIndex=$index\" class=\'v2 wtsite-service-list\' ng-if=\"category.links.length>0\">\r\n        <li ng-if=\"$index > 0 && category.links.length>0\">\r\n            <h1>{{::category.name}}</h1>\r\n            <ul class=\"clearfix items\">\r\n                <li ng-repeat=\"item in category.links\" class=\"wtsite-service-listitem\">\r\n                    <a style=\"cursor: pointer;\" href=\"{{item.smarturl}}\" class=\"tile-styling\" ng-style=\"vm.renderIconOrImage(item)\" title=\"{{::item.description}}\" target=\"{{::(item.openInNewWindow)?\'_blank\':\'_self\'}}\">\r\n                        <div>\r\n                            <div ng-if=\"!item.useIcon\">\r\n                                <img ng-if=\"!item.isRound\" style=\"height: 110px; width: 110px\" ng-src=\"{{item.imageUrl}}\">\r\n                                <img ng-if=\"item.isRound\" class=\"round-image\" ng-src=\"{{item.imageUrl}}\">\r\n                            </div>\r\n                            <div ng-if=\"item.useIcon\" class=\"icon-styling\" style=\"font-size: 50px\" ng-class=\"item.iconName.icon\"></div>\r\n                        </div>\r\n                        <div class=\"link-text\">\r\n                            {{item.name}}\r\n                        </div>\r\n                    </a>\r\n                </li>\r\n            </ul>\r\n        </li>\r\n\r\n        <li ng-if=\"::($index==0 && vm.serviceMenu.categories.length==1)\" style=\"margin-top:10px;\">\r\n            <h1>{{\'My Tools\' | translate}}</h1>\r\n            <ul class=\"clearfix items\">\r\n                <li ng-repeat=\"item in category.links\" class=\"wtsite-service-listitem\">\r\n                    <a style=\"cursor: pointer;\" href=\"{{item.smarturl}}\" class=\"tile-styling\" ng-style=\"vm.renderIconOrImage(item)\" title=\"{{::item.description}}\" target=\"{{::(item.openInNewWindow)?\'_blank\':\'_self\'}}\">\r\n                        <div>\r\n                            <div ng-if=\"!item.useIcon\">\r\n                                <img ng-if=\"!item.isRound\" style=\"height: 110px; width: 110px\" ng-src=\"{{item.imageUrl}}\">\r\n                                <img ng-if=\"item.isRound\" class=\"round-image\" ng-src=\"{{item.imageUrl}}\">\r\n                            </div>\r\n                            <div ng-if=\"item.useIcon\" class=\"icon-styling\" style=\"font-size: 50px\" ng-class=\"item.iconName.icon\"></div>\r\n                        </div>\r\n                        <div class=\"link-text\">\r\n                            {{item.name}}\r\n                        </div>\r\n                    </a>\r\n                </li>\r\n            </ul>\r\n        </li>\r\n    </ul>\r\n</div>\r\n");$templateCache.put("Servicemenu/Templates/ViewTemplates/servicemenubuttons.html","<div class=\"wizdom-dot-container pull-right\" ng-init=\"init()\" ng-if=\"!(toolbarMode==\'None\')\" ng-class=\"{\'v2\':toolbarMode==\'FloatingBottomRight\'}\">\r\n <div class=\"wizdom-service\">\r\n  <a ng-click=\"dotsButton()\">\r\n   <i id=\"dotIcon\" class=\"glyphicon glyphicon-option-horizontal\" style=\"display:inline-block\">\r\n                <span ng-if=\"toolbarMode==\'FloatingBottomRight\'\">{{\'My Tools\' | translate}}</span>\r\n            </i>\r\n   <i id=\"afterClickDotsIcon\" class=\"glyphicon glyphicon-remove\" hidden>\r\n                <span ng-if=\"toolbarMode==\'FloatingBottomRight\'\">{{\'My Tools\' | translate}}</span>\r\n            </i>\r\n  </a>\r\n </div>\r\n</div>\r\n<div class=\"wizdom-search-container pull-right\" ng-if=\"!(searchbarMode==\'None\')\" ng-class=\"{\'v2\':searchbarMode==\'Expanded\'}\">\r\n <div class=\"wizdom-search\">\r\n  <a ng-click=\"searchButton()\">\r\n   <i id=\"searchIcon\" class=\"glyphicon glyphicon-search\" style=\"display:inline-block\"></i>\r\n   <i id=\"afterClickSearchIcon\" class=\"glyphicon glyphicon-remove\" hidden></i>\r\n  </a>\r\n </div>\r\n</div>");$templateCache.put("Servicemenu/Templates/ViewTemplates/servicemenumobilebuttons.html","<div class=\"wizdom-dot-mobile-container  pull-right\" ng-init=\"init()\" ng-if=\"!(toolbarMode==\'None\')\" ng-class=\"{\'v2\':toolbarMode==\'FloatingBottomRight\'}\">\r\n <div class=\"wizdom-service\">\r\n  <a ng-click=\"dotsButton()\">\r\n   <i id=\"dotsMobileIcon\" class=\"glyphicon glyphicon-option-horizontal\" style=\"display:inline-block\"></i>\r\n   <i id=\"afterClickDotsMobile\" class=\"glyphicon glyphicon-remove\" hidden></i>\r\n  </a>\r\n </div>\r\n</div>\r\n<div class=\"wizdom-search-mobile-container pull-right\" ng-if=\"!(searchbarMode==\'None\')\" >\r\n <div class=\"wizdom-search\">\r\n  <a ng-click=\"searchButton()\">\r\n   <i id=\"searchMobileIcon\" class=\"glyphicon glyphicon-search\" style=\"display:inline-block\"></i>\r\n   <i id=\"afterClickSearchMobile\" class=\"glyphicon glyphicon-remove\" hidden></i>\r\n  </a>\r\n </div>\r\n</div>\r\n");$templateCache.put("Servicemenu/Templates/ViewTemplates/simplelist.html","<div ng-if=\"::(!vm.isEmpty)\">\r\n    <ul ng-if=\"category.links.length > 0 || (vm.servicemenuContainsZeroLinks && vm.personalizationAllowed && $first)\" ng-repeat=\"category in vm.serviceMenu.categories\" ng-init=\"outerIndex=$index\" class=\'wtsite-service-list\'>\r\n        <li ng-repeat=\"item in category.links\" class=\"wtsite-service-listitem\">\r\n            <a style=\"cursor: pointer;\" href=\"{{item.smarturl}}\" class=\"tile-styling\" ng-style=\"vm.renderIconOrImage(item)\" title=\"{{::item.description}}\" target=\"{{::(item.openInNewWindow)?\'_blank\':\'_self\'}}\">\r\n                <div>\r\n                    \r\n                    <div ng-if=\"!item.useIcon\">\r\n                        <img ng-if=\"!item.isRound\" style=\"height: 110px; width: 110px\" ng-src=\"{{item.imageUrl}}\">\r\n                        <img ng-if=\"item.isRound\" class=\"round-image\" ng-src=\"{{item.imageUrl}}\">\r\n                    </div>\r\n                    <div ng-if=\"item.useIcon\" class=\"icon-styling\" style=\"font-size: 50px\" ng-class=\"item.iconName.split(\',\')[0]\"></div>\r\n                </div>\r\n                <div class=\"link-text\">\r\n                    {{item.name}}\r\n                </div>\r\n            </a>\r\n        </li>\r\n        <li ng-if=\"::vm.personalizationAllowed\" class=\"personalizationPen\">\r\n            <a>\r\n                <i class=\"glyphicon glyphicon-pencil\" style=\"color:lightgray;cursor:pointer\"\r\n                   ng-click=\"vm.editServiceMenu()\">\r\n                </i>\r\n            </a>\r\n        </li>       \r\n    </ul>\r\n</div>");$templateCache.put("ServiceTickets/Templates/ViewTemplates/CardDetail.html","<div class=\"modal-header bootstrap-wrapper\">\r\n    <button type=\"button\" class=\"close closebtn\" data-ng-click=\"cancel()\" aria-hidden=\"true\">&times;</button>\r\n    <h1 class=\"modal-title\">{{\'Bug overview detail\' | translate}}</h1>\r\n</div>\r\n<div class=\"modal-body bootstrap-wrapper\">\r\n    <div class=\"container-fluid\">\r\n        <wizdom365-spinner class=\"row\" style=\"position: relative; height: 15px;\" loading=\"loading\" ng-if=\"loading\"></wizdom365-spinner>\r\n        <div class=\"row\" style=\"overflow-y: auto;\">\r\n            <div class=\"col-sm-6\" style=\"padding-left: 0;\">\r\n                <label style=\"margin-right: 10px;\">{{\'Module\' | translate}}:</label><span ng-repeat=\"label in data.labels | module\">{{  ($index>0?\', \':\'\')+label.name}}</span>\r\n            </div>\r\n            <div class=\"col-sm-6\" style=\"padding-left: 0; text-align: right;\">\r\n                <label style=\"margin-right: 10px;\">{{\'Status\' | translate}}:</label><span>{{data.statuses | cardstatus:data.idList}}</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"row\" style=\"overflow-y: auto;\">\r\n            <div class=\"col-sm-12\">\r\n                <h2>{{data.name}}</h2>\r\n            </div>\r\n            <div class=\"col-sm-12\">\r\n                {{data.desc}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"modal-footer bootstrap-wrapper\" style=\"text-align:left;\">\r\n    <label>{{\'Expected fix date\' | translate}}:</label> <span>{{ (data.due || \'not specified\' | translate) | date:\'dd-MM-yyyy\'}}</span>\r\n    <br />\r\n    <span><I>{{\'When fixed it will be included in next release/hotfix\' | translate}}</I></span>\r\n</div>");$templateCache.put("ServiceTickets/Templates/ViewTemplates/DefaultView.html","<div id=\"servicetickets\" class=\"panel panel-primary\">\r\n <div class=\"panel-heading\">\r\n  <h3 class=\"panel-title\">{{\'Issues overview\' | translate}}</h3>\r\n </div>\r\n <div class=\"panel-body\">\r\n  <div ng-model=\"searchParam\" class=\"col-sm-12 search-container\">\r\n   <div class=\"input-group col-sm-12\" style=\"margin-bottom: 15px;\">\r\n    <input type=\"text\" class=\"search-query form-control\" style=\"padding-right: 28px;\" placeholder=\"{{ \'Search...\' | translate}}\" ng-model=\"searchParam.searchText\" ng-keypress=\"doSearch($event,searchParam)\">\r\n    <span class=\"input-group-btn\" style=\"display: block;\">\r\n     <button class=\"btn glyphicon glyphicon-search\" style=\"right: 36px; background: transparent; z-index: 1000;\" type=\"button\" ng-click=\"searchCards(searchParam)\"></button>\r\n    </span>\r\n   </div>\r\n\r\n   <div class=\"col-sm-12 card-advance-search\" style=\"margin-bottom: 15px;\">\r\n    <a href=\"javascript:void()\" ng-click=\"advanceSearchCards(searchParam)\"><i class=\"glyphicon glyphicon-filter\" style=\"margin-right: 2px;\"> </i>{{\'Advanced Search\' | translate}}</a>\r\n   </div>\r\n   <div class=\"col-sm-12 card-advance-search-fields\" ng-show=\"searchParam.advanceSearch\">\r\n    <div class=\"form-group col-sm-12\">\r\n     <label for=\"cardmodule\" class=\"col-sm-12\">{{\'Module\' | translate}}</label>\r\n     <select id=\"cardmodule\" class=\"card-module col-sm-12 form-control\" ng-model=\"searchParam.moduleName\" ng-change=\"searchCards(searchParam)\">\r\n      <option value=\"\"></option>\r\n      <option ng-repeat=\"module in modules\" value=\"{{module.name}}\">{{module.name}}</option>\r\n     </select>\r\n    </div>\r\n    <div class=\"form-group  col-sm-12\">\r\n     <label for=\"cardstatus\" class=\"col-sm-12\">{{\'Impact\' | translate}}</label>\r\n     <select id=\"cardstatus\" class=\"col-sm-12 card-status form-control\" ng-model=\"searchParam.cardStatus\" ng-change=\"searchCards(searchParam)\">\r\n      <option value=\"\"></option>\r\n      <option ng-repeat=\"status in statuses\" value=\"{{status.name}}\">{{status.name | translate}}</option>\r\n     </select>\r\n    </div>\r\n    <div class=\"col-sm-12\" style=\"margin-bottom: 15px;\">\r\n     <input id=\"ShowOnlyOfMe\" type=\"checkbox\" class=\"card-only-me\" style=\"margin-top: 0; margin-right: 5px;\" ng-model=\"onlyMe\" ng-change=\"searchCards(searchParam, onlyMe)\" /><label for=\"ShowOnlyOfMe\" style=\"margin-bottom: 0;\">{{\'Only show created by me\'}}</label>\r\n    </div>\r\n\r\n   </div>\r\n  </div>\r\n  <wizdom365-spinner class=\"col-sm-12\" style=\"position: relative; height: 15px;\" loading=\"loading\" ng-if=\"loading\"></wizdom365-spinner>\r\n  <div class=\"list-group col-sm-12\" ng-if=\"cards && cards.length > 0\">\r\n   <a href=\"javascript:void()\" ng-click=\"showDetail(card)\" class=\"list-group-item\" ng-repeat=\"card in cards | orderBy:\'due\' | start: (currentPage - 1) * numPerPage | limitTo:numPerPage\">\r\n    <h4 class=\"list-group-item-heading\">{{card.name}}</h4>\r\n    <p class=\"list-group-item-text\">{{card.desc | limitTo:200}}</p>\r\n    <p class=\"list-group-item-text\"><i>{{\'Impact\' | translate}}: {{ statuses | cardstatus : card.idList | translate}}</i></p>\r\n   </a>\r\n  </div>\r\n  <div class=\"col-sm-12\" ng-if=\"cards && cards.length === 0\">{{\"Nothing matches your search\" | translate}}</div>\r\n  <div class=\"bugs-pagination\" ng-if=\"cards && cards.length > 0\">\r\n   <pagination total-items=\"cards.length\"\r\n      ng-change=\"setcurrentPage(currentPage)\"\r\n      ng-model=\"currentPage\"\r\n      items-per-page=\"numPerPage\"\r\n      max-size=\"5\"\r\n      boundary-links=\"false\"\r\n      previous-text=\"&lsaquo;\"\r\n      next-text=\"&rsaquo;\"\r\n      first-text=\"&laquo;\"\r\n      last-text=\"&raquo;\"\r\n      ng-hide=\"cards.length <= numPerPage\">\r\n\r\n   </pagination>\r\n  </div>\r\n </div>\r\n</div>\r\n\r\n<style>\r\n .col-sm-12 {\r\n  padding: 0 !important;\r\n }\r\n\r\n .pagination {\r\n  margin: 0 !important;\r\n }\r\n</style>");$templateCache.put("Weather/Templates/ViewTemplates/FiveDaysView.html","<div class=\"panel-primary bootstrap-wrapper wizdom-weather ms-webpart-chrome\" ng-show=\"Weather.data\">    \r\n    <div class=\"panel-heading todayContainer\">\r\n        <div ng-show=\"Weather.data.errorMessage==null\">\r\n            <div class=\"icon\" ng-class=\"\'icon-\' + Weather.data.list[0].weather[0].icon\">&nbsp;</div>\r\n        </div>\r\n        <div ng-show=\"Weather.data.errorMessage==null\">\r\n            <div class=\"temperature\">\r\n                {{(Weather.data.list[0].temp.day || Weather.data.list[0].temp.eve) | number:0}}&deg;{{Weather.data.tempUnit}}\r\n            </div>\r\n            <div class=\"city\">\r\n                {{Weather.data.city.name}}\r\n                <a id=\"lnkLocation_{{webpartId}}\" ng-click=\"loadFav()\" ng-if=\"webpartProperties.allowManageLocation\" class=\"glyphicon glyphicon-map-marker locationmarker\"></a>                \r\n            </div>\r\n        </div>\r\n        <div ng-show=\"Weather.data.errorMessage!=null\">\r\n            {{ \'Error\' | translate}}\r\n        </div>\r\n    </div>\r\n    <div class=\"panel-body foreCastContainer\">        \r\n        <div ng-show=\"Weather.data.errorMessage==null\">\r\n            <div class=\"icon\" ng-class=\"\'icon-\' + Weather.data.list[1].weather[0].icon\">&nbsp;</div>\r\n            <div class=\"dayText\">{{Weather.data.list[1].weekDay | translate}}</div>\r\n            <div class=\"dayText\">{{(Weather.data.list[1].temp.day || Weather.data.list[1].temp.eve) | number:0}}&deg;{{Weather.data.tempUnit}}</div>\r\n        </div>\r\n        <div ng-show=\"Weather.data.errorMessage==null\">\r\n            <div class=\"icon\" ng-class=\"\'icon-\' + Weather.data.list[2].weather[0].icon\">&nbsp;</div>\r\n            <div class=\"dayText\">{{Weather.data.list[2].weekDay | translate}}</div>\r\n            <div class=\"dayText\">{{(Weather.data.list[2].temp.day || Weather.data.list[2].temp.eve) | number:0}}&deg;{{Weather.data.tempUnit}}</div>\r\n        </div>\r\n        <div ng-show=\"Weather.data.errorMessage==null\">\r\n            <div class=\"icon\" ng-class=\"\'icon-\' + Weather.data.list[3].weather[0].icon\">&nbsp;</div>\r\n            <div class=\"dayText\">{{Weather.data.list[3].weekDay | translate}}</div>\r\n            <div class=\"dayText\">{{(Weather.data.list[3].temp.day || Weather.data.list[3].temp.eve) | number:0}}&deg;{{Weather.data.tempUnit}}</div>\r\n        </div>\r\n        <div ng-show=\"Weather.data.errorMessage==null\">\r\n            <div class=\"icon\" ng-class=\"\'icon-\' + Weather.data.list[4].weather[0].icon\">&nbsp;</div>\r\n            <div class=\"dayText\">{{Weather.data.list[4].weekDay | translate}}</div>\r\n            <div class=\"dayText\">{{(Weather.data.list[4].temp.day || Weather.data.list[4].temp.eve) | number:0}}&deg;{{Weather.data.tempUnit}}</div>\r\n        </div>\r\n        <div ng-show=\"Weather.data.errorMessage!=null\">\r\n            {{ Weather.data.errorMessage | translate}}\r\n        </div>\r\n    </div>\r\n</div> ");$templateCache.put("Weather/Templates/ViewTemplates/SingleDayView.html","<div class=\"panel-primary bootstrap-wrapper wizdom-weather ms-webpart-chrome\" ng-show=\"Weather.data\">\r\n    <div class=\"panel-heading todayContainer all-round-border\" ng-if=\"Weather.data.errorMessage==null\">   \r\n        <div ng-show=\"Weather.data.errorMessage==null\">\r\n            <div class=\"icon\" ng-class=\"\'icon-\' + Weather.data.list[0].weather[0].icon\">&nbsp;</div>\r\n        </div>\r\n        <div ng-show=\"Weather.data.errorMessage==null\">\r\n            <div class=\"temperature\">\r\n                {{(Weather.data.list[0].temp.day || Weather.data.list[0].temp.eve) | number:0}}&deg;{{Weather.data.tempUnit}}\r\n            </div>\r\n            <div class=\"city\">\r\n                {{Weather.data.city.name}}\r\n                <a id=\"lnkLocation_{{webpartId}}\" ng-click=\"loadFav()\" ng-if=\"webpartProperties.allowManageLocation\" class=\"glyphicon glyphicon-map-marker locationmarker\" ng-hide=\"loading\"></a>\r\n                <img ng-if=\"webpartProperties.allowManageLocation\" src=\"/_layouts/15/images/gears_anv4.gif\" class=\"change-location-waiting-icon\" ng-show=\"loading\" />\r\n\r\n            </div>\r\n        </div>\r\n        <div ng-show=\"Weather.data.errorMessage!=null\">\r\n            {{ \'Error\' | translate}}\r\n        </div>\r\n        <div ng-show=\"Weather.data.errorMessage!=null\">\r\n            {{ Weather.data.errorMessage | translate}}\r\n        </div>\r\n    </div>\r\n\r\n</div> ");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Heading_edit.html","<form>\r\n    <div class=\"form-group\">\r\n        <label>{{\'Text\' | translate}}</label>\r\n        <input type=\"text\" class=\"form-control\" ng-model=\"vm.bindObj.title\" placeholder=\"{{vm.title}}\">\r\n    </div>\r\n    <div class=\"form-group\">\r\n        <label>{{\'Url\' | translate}}</label>\r\n        <input type=\"text\" class=\"form-control\" ng-model=\"vm.bindObj.value.href\" placeholder=\"{{vm.value.href}}\">\r\n        <p class=\"wt-fieldInfo\">{{\'When using an absolute URL include http:// or https://\' | translate}}</p>\r\n    </div>\r\n    <div class=\"checkbox\">\r\n        <label>\r\n            <input type=\"checkbox\" ng-model=\"vm.bindObj.value.openInNewWindow\">{{\'Open in new window\' | translate}}\r\n        </label>\r\n    </div>\r\n</form>\r\n");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Heading_view.html","<a class=\"Item Heading\" \r\n   ng-attr-target=\"{{::(item.value.openInNewWindow ? \'_blank\' : undefined)}}\" \r\n   ng-href=\"{{::(item.translatedValue && item.translatedValue.href) ? item.translatedValue.href : item.value.href}}\" \r\n   ng-click=\"vm.clickTopItem((item.translatedValue && item.translatedValue.href) ? item.translatedValue.href : item.value.href, item, $event);\" \r\n   ng-class=\"::{EnableHover:vm.enableHoverOnHeadings}\">{{::(item.translatedTitle || item.title)}}</a>");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Html_edit.html","<form>\r\n    <div class=\"form-group\">\r\n        <label>{{\'Title\' | translate}}</label>\r\n        <input type=\"text\" class=\"form-control\" ng-model=\"vm.bindObj.title\" placeholder=\"{{vm.bindObj.title}}\">\r\n    </div>\r\n    <div class=\"form-group\">\r\n        <label>{{\'Html\' | translate}}</label>\r\n        <textarea ui-tinymce class=\"form-control\" placeholder=\"{{vm.bindObj.value.html}}\" toolbar-configuration=\"Megamenu\" ng-model=\"vm.bindObj.value.html\" style=\"height:200px\" />\r\n    </div>    \r\n</form>\r\n");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Html_view.html","<div class=\"Item Html fr-view\" ng-class=\"::{EnableHover:vm.enableHoverOnHtml}\" ng-bind-html=\"::(item.translatedValue.html || item.value.html | wizdom365TrustHtml)\"></div>");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Link_edit.html","<form>\r\n    <div class=\"form-group\">\r\n        <label>{{\'Text\' | translate}}</label>\r\n        <input type=\"text\" class=\"form-control\" ng-model=\"vm.bindObj.title\" placeholder=\"{{vm.title}}\">\r\n    </div>\r\n    <div class=\"form-group\">\r\n        <label>{{\'Url\' | translate}}</label>\r\n        <input type=\"text\" class=\"form-control\" ng-model=\"vm.bindObj.value.href\" placeholder=\"{{vm.value.href}}\">\r\n        <p class=\"wt-fieldInfo\">{{\'When using an absolute URL include http:// or https://\' | translate}}</p>\r\n    </div>\r\n    <div class=\"checkbox\">\r\n        <label>\r\n            <input type=\"checkbox\" ng-model=\"vm.bindObj.value.openInNewWindow\">{{\'Open in new window\' | translate}}\r\n        </label>\r\n    </div>\r\n</form>\r\n");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Link_view.html","<!--<a class=\"Item Link\" ng-attr-target=\"{{::(item.value.openInNewWindow ? \'_blank\' : undefined)}}\" ng-href=\"{{::item.value.href}}\" ng-click=\"vm.clickTopItem(item.value.href, item, $event);\">{{::(item.translatedTitle || item.title)}}</a>-->\r\n<a class=\"Item Link\" \r\n   ng-attr-target=\"{{::(item.value.openInNewWindow ? \'_blank\' : undefined)}}\" \r\n   ng-href=\"{{::(item.translatedValue.href || item.value.href)}}\" \r\n   ng-click=\"vm.clickTopItem(item.value.href, item, $event);\" \r\n   ng-class=\"{EnableHover:vm.enableHoverOnLinks, active:item == vm.currentTopItem}\">{{::(item.translatedTitle || item.title)}}</a>\r\n");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Section_edit.html","<form>    \r\n</form>\r\n");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Section_view.html","");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Text_edit.html","<form>\r\n    <div class=\"form-group\">\r\n        <label>{{\'Text\' | translate}}</label>\r\n        <input type=\"text\" class=\"form-control\" ng-model=\"vm.bindObj.title\" placeholder=\"{{vm.title}}\">\r\n    </div>   \r\n</form>\r\n");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/Text_view.html","<div class=\"Item Text\">{{::(item.translatedTitle || item.title)}}</div>");$templateCache.put("Megamenu/Templates/ViewTemplates/ElementTypes/TopItem_view.html","<a class=\"TopItem\" \r\n   ng-attr-target=\"{{::(item.value.openInNewWindow ? \'_blank\' : undefined)}}\" \r\n   ng-href=\"{{::(item.translatedValue && item.translatedValue.href) ? item.translatedValue.href : item.value.href}}\" \r\n   ng-click=\"vm.clickTopItem((item.translatedValue && item.translatedValue.href) ? item.translatedValue.href : item.value.href, item, $event);\" \r\n   ng-class=\"{ EnableHover: vm.enableHoverOnTopLinks, active:item == vm.currentTopItem}\">{{::(item.translatedTitle || item.title)}}</a>");$templateCache.put("Notifications/Templates/ViewTemplates/Notification/Mentions.html","<div class=\"no-items-container no-mentions\" ng-controller=\"Wizdom365NotificationPanelMentionsController\">\r\n    \r\n <div ng-show=\"mentioMode == \'loading\'\">\r\n  <div class=\"no-loader\">\r\n   {{\'loading...\' | translate}}\r\n            <span style=\"display:block\"><span class=\"loader\"></span></span>\r\n  </div>\r\n </div>\r\n\r\n    <div ng-show=\"mentioMode == \'loadComplete\' && mentioItemList.length == 0\">\r\n  <div class=\"no-empty\">{{\'You do not have any new mentions\' | translate}}</div>\r\n    </div>\r\n\r\n    <div class=\"form-actions\" style=\"text-align: right\">\r\n    <!--<button type=\"button\" ng-show=\"mentioItemList.length > 1\" ng-click=\"dismissAll();\" class=\"btn btn-primary\">{{\'Dismiss all\' | translate}}</button>-->\r\n        <a href=\"#\" ng-show=\"mentioItemList.length > 1\" ng-click=\"dismissAll();dismissSPAll()\">{{\'Mark all as read\' | translate}}</a>\r\n    </div>\r\n  \r\n    <div ng-show=\"mentioMode == \'loadComplete\' && mentioItemList.length > 0\">\r\n\r\n  <div class=\"no-item word-break\" ng-repeat=\"item in mentioItemList | limitTo:limitCountTo\">\r\n   <span class=\"pull-right\">\r\n    <i ng-if=\"item.url === null\" class=\"ms-Icon ms-Icon--ChromeClose ms-Icon--xxs ms-Icon--posTop no-link\" ng-click=\"dismiss(item.targetId);\" title=\"{{\'Dismiss\' | translate}}\" aria-hidden=\"true\"></i>\r\n    <i ng-if=\"item.url !== null\" class=\"ms-Icon ms-Icon--ChromeClose ms-Icon--xxs ms-Icon--posTop no-link\" ng-click=\"spdismiss(item.targetId);\" title=\"{{\'Dismiss\' | translate}}\" aria-hidden=\"true\"></i>\r\n   </span>\r\n   <div class=\"no-presence-picture\">\r\n    <div style=\"display:inline-block\" class=\"presence\" wizdom365-presence-picture=\"\" size=\"AVATAR\" accountname=\"item.mentions[0].sender.loginName\" name=\"item.mentions[0].sender.displayName\"></div>\r\n   </div>\r\n   <div class=\"no-spacerForIcon no-presence-picture-spacing\">\r\n    {{item.mentions[0].sender.displayName}} {{prepareText(item)}}\r\n    <span ng-if=\"item.url === null\" class=\"no-heading no-link\" ng-click=\"openItem(item.targetId)\" title=\"{{item.heading}}\">\r\n     {{item.heading}}\r\n    </span>\r\n    <span ng-if=\"item.url !== null\" class=\"no-heading no-link\" title=\"{{item.heading}}\">\r\n     <a href=\"{{item.url}}\">{{item.heading}}</a>\r\n    </span>\r\n    <div class=\"text-muted\" am-time-ago=\"(item.mentions[0].timestamp | wizdom365FormatDate)\"></div>\r\n   </div>\r\n  </div>\r\n       \r\n    </div>\r\n\r\n <div class=\"no-showmore no-link\" ng-show=\"mentioMode == \'loadComplete\' && (mentioItemList.length>limitCountTo)\" ng-click=\"loadMore()\">{{\"show more...\" | translate}}</div>\r\n    \r\n</div>\r\n");$templateCache.put("Notifications/Templates/ViewTemplates/Notification/NotificationPanel.html","<span class=\"pull-right no-link no-hidemenu notification-close\"><i class=\"ms-Icon ms-Icon--ChromeClose ms-Icon--s no-link\" ng-click=\"showHideMenu();\" aria-hidden=\"true\"></i></span>\r\n<h1>{{\'Notifications\' | translate}}</h1>\r\n<ul>\r\n    <li>\r\n        <h3><i class=\"ms-Icon ms-Icon--Contact\"></i>{{\'My mentions\' | translate}} ({{mentioItemList.value && mentioItemList.value.length > 0 ? (mentioItemList.value.length) : 0 }})</h3>\r\n        <ul wizdom-include=\"templateMentions\"></ul>\r\n        <div class=\"no-divider\">&nbsp;</div>\r\n    </li>\r\n\r\n    <li>\r\n        <h3><i class=\"ms-Icon ms-Icon--Message\"></i>{{\'Unread comments\' | translate}} ({{unreadComments.value && unreadComments.value.length > 0 ? (unreadComments.value.length) : 0 }})</h3>\r\n        <ul wizdom-include=\"templateUnreadComments\"></ul>\r\n        <div class=\"no-divider\">&nbsp;</div>\r\n    </li>\r\n\r\n\r\n    <li>\r\n        <h3><i class=\"ms-Icon ms-Icon--TaskManager\"></i>{{\'Unread elements\' | translate}} ({{unreadNewsCount > 0 ? unreadNewsCount : 0 }})</h3>\r\n        <ul wizdom-include=\"templateUnreadItems\"></ul>\r\n        <div class=\"no-divider-dark\">&nbsp;</div>\r\n    </li>\r\n\r\n    <li class=\"no-settings\">\r\n        <h3 class=\"no-link\" ng-click=\"chooseChannels(notificationViewId)\" title=\"{{\'Choose channels for in-app notifications\' | translate}}\"><i class=\"ms-Icon ms-Icon--Filter\"></i>{{\'Notification Settings\' | translate}}</h3>\r\n        <p>{{\'Choose channels from where you want to receive notifications in Wizdom\' | translate}}</p>\r\n    </li>\r\n\r\n    <li class=\"no-settings\" ng-if=\"emailNotificationEnabled && emailNotificationViewId && notificationViewId != emailNotificationViewId\">\r\n        <h3 class=\"no-link\" ng-click=\"chooseChannels(emailNotificationViewId)\" title=\"{{\'Choose channels for email notifications\' | translate}}\"><i class=\"ms-Icon ms-Icon--MailAlert\"></i>{{\'Email Notifications\' | translate}}</h3>\r\n        <p>{{\'Choose which channels from where you want to receive email notifications\' | translate}}</p>\r\n    </li>\r\n    <li>\r\n        <div class=\"no-scroll-fit\">&nbsp;</div>\r\n    </li>\r\n</ul>");$templateCache.put("Notifications/Templates/ViewTemplates/Notification/UnreadComments.html","<div class=\"no-items-container no-unread-comments\" ng-controller=\"wizdom365NotificationPanelUnreadCommentsController\">\r\n                    \r\n <div ng-show=\"unreadCommentsMode == \'loading\'\">\r\n  <div class=\"no-loader\">\r\n   {{\'loading...\' | translate}}\r\n   <span style=\"display:block\"><span class=\"loader\"></span></span>\r\n  </div>\r\n </div>\r\n\r\n <div ng-show=\"unreadCommentsMode == \'loadComplete\' && unreadComments.length == 0\">\r\n  <div class=\"no-empty\">{{\'No new comments.\' | translate}}</div>\r\n </div>\r\n\r\n    <div class=\"form-actions\" style=\"text-align: right\">\r\n        <!--<button type=\"button\" ng-show=\"unreadComments.value.length > 1\" ng-click=\"dismissAll();\" class=\"btn btn-primary\">{{\'Dismiss all\' | translate}}</button>-->\r\n        <a href=\"#\" ng-show=\"unreadComments.length > 1\" ng-click=\"dismissAll();\">{{\'Dismiss all\' | translate}}</a>\r\n    </div>\r\n\r\n <div ng-show=\"unreadCommentsMode == \'loadComplete\' && unreadComments.length > 0\">\r\n\r\n\r\n  <div class=\"no-item word-break\" ng-repeat=\"item in unreadComments | limitTo:limitCountTo\">\r\n   <span class=\"pull-right\">\r\n    <i ng-if=\"item.url === null\" class=\"ms-Icon ms-Icon--ChromeClose ms-Icon--xxs ms-Icon--posTop no-link\" ng-click=\"dismiss(item);\" title=\"{{\'Dismiss\' | translate}}\" aria-hidden=\"true\"></i>\r\n    <i ng-if=\"item.url !== null\" class=\"ms-Icon ms-Icon--ChromeClose ms-Icon--xxs ms-Icon--posTop no-link\" ng-click=\"spdismiss(item);\" title=\"{{\'Dismiss\' | translate}}\" aria-hidden=\"true\"></i>\r\n   </span>\r\n   <div class=\"no-spacerForIcon\">\r\n    {{item.comments[0].author.displayName}} {{prepareText(item)}}\r\n    <span ng-if=\"item.url === null\" class=\"no-heading no-link\" ng-click=\"openItem(item)\" title=\"{{item.heading}}\">\r\n     {{item.heading}}\r\n    </span>\r\n    <span ng-if=\"item.url !== null\" class=\"no-heading no-link\" title=\"{{item.heading}}\">\r\n     <a href=\"{{item.url}}\">{{item.heading}}</a>\r\n    </span>\r\n    <div class=\"text-muted\" am-time-ago=\"(item.comments[0].datePosted | wizdom365FormatDate)\"></div>\r\n   </div>\r\n  </div>\r\n \r\n </div>\r\n <div class=\"no-showmore no-link\" ng-show=\"unreadCommentsMode == \'loadComplete\' && (unreadComments.length>limitCountTo)\" ng-click=\"loadMore()\">{{\"show more...\" | translate}}</div>\r\n    \r\n</div>");$templateCache.put("Notifications/Templates/ViewTemplates/Notification/UnreadElements.html","<li class=\"no-items-container no-unread-elements\" ng-controller=\"wizdom365NotificationPanelUnreadElementsController\">\r\n    \r\n    <div ng-show=\"unreadNewsMode == \'loading\'\">\r\n  <div class=\"no-loader\">\r\n   {{\'loading...\' | translate}}\r\n            <span style=\"display:block\"><span class=\"loader\"></span></span>\r\n  </div>\r\n    </div>\r\n\r\n    <div ng-show=\"unreadNewsMode == \'loadComplete\' && unreadNewsCount == 0\">\r\n        <div class=\"no-empty\">{{\'You do not have any unread news.\' | translate}}</div>\r\n    </div>\r\n\r\n    <div class=\"form-actions\" style=\"text-align: right\">\r\n        <!-- <button type=\"button\" ng-show=\"unreadNewsCount > 0\" ng-click=\"dismissAll();\" class=\"btn btn-primary\">{{\'Mark all as read\' | translate}}</button>-->\r\n        <a href=\"#\" ng-show=\"unreadNewsCount > 1\" ng-click=\"dismissAll();\">{{\'Mark all as read\' | translate}}</a>\r\n\r\n    </div>\r\n\r\n    <div ng-show=\"unreadNewsMode == \'loadComplete\' && unreadNewsCount > 0\">\r\n\r\n  <div>\r\n\r\n   <div class=\"no-item word-break\" ng-repeat=\"item in unreadNews | filter: { isRead: false } | limitTo:limitCountTo\">\r\n    <span class=\"pull-right no-link\">\r\n     <i class=\"ms-Icon ms-Icon--ChromeClose ms-Icon--xxs ms-Icon--posTop no-link\" ng-click=\"dismiss(item);\" title=\"{{\'Mark as read\' | translate}}\" aria-hidden=\"true\"></i>\r\n    </span>\r\n    <div class=\"no-spacerForIcon\">\r\n     <span class=\"no-heading no-link\" ng-click=\"openItem(item.id)\" title=\"{{item.heading}}\">{{item.heading}} - </span>\r\n     <span ng-if=\"item.alternateAuthor\" class=\"text-muted\">{{item.alternateAuthor.displayName}}</span>\r\n     <span ng-if=\"!item.alternateAuthor\" class=\"text-muted\">{{item.author.displayName}}</span>\r\n    </div>\r\n   </div>\r\n\r\n  </div>\r\n\r\n    </div>\r\n <div class=\"no-showmore no-link\" ng-show=\"unreadNewsMode == \'loadComplete\' && (unreadNews.length>limitCountTo)\" ng-click=\"loadMore()\">{{\"show more...\" | translate}}</div>\r\n</li>");$templateCache.put("Phonebook/Templates/ViewTemplates/SearchTemplates/advancedSearch.html","<div class=\"peopleInput input-group\">\r\n <input type=\"text\" class=\"form-control inputPeopleSearchbox365\" ng-model=\"$parent.searchTerm\" ng-model-options=\"{ updateOn: \'default blur\', debounce: { \'default\': 500, \'blur\': 0 } }\" autocomplete=\"off\" placeholder=\"{{\'Find Colleague\' | translate}}\" />\r\n <span ng-click=\"$parent.searchTerm = \'\'\" ng-show=\"$parent.searchTerm\" class=\"glyphicon glyphicon-remove form-control-feedback\"></span>\r\n <span class=\"input-group-addon\">\r\n  <span class=\"w365-searchLink\">\r\n   <img src=\"/_layouts/15/images/gears_anv4.gif\" style=\"margin-top: 3px; margin-right: 1px;\" ng-show=\"searching\" />\r\n   <i class=\"glyphicon glyphicon-search\" ng-hide=\"searching\"></i>\r\n  </span>\r\n </span>\r\n</div>\r\n<div class=\"peopleInput input-group filter-group\" ng-show=\"filters.length > 0\">\r\n <a class=\"filter btn btn-default\" ng-repeat=\"filter in filters\" ng-click=\"removeFilter(filter)\">\r\n  {{::filter.label}}\r\n  <span class=\"glyphicon glyphicon-remove\"></span>\r\n </a>\r\n</div>\r\n<div class=\"advancedSearch\">\r\n\r\n <span class=\"wt-linkText\" title=\"{{\'Advanced search\' | translate}}\" ng-click=\"showAdvancedSearch()\">\r\n  <span class=\"wt-linkText glyphicon glyphicon-filter wt-icon\" style=\"\" title=\"{{\'Advanced search\' | translate}}\">\r\n   <span class=\"hidden-xs\">{{\'Advanced search\' | translate}}</span>\r\n  </span>\r\n </span>\r\n <span ng-show=\"NoOfSelectedUsers > 0\">\r\n  <a role=\"button\" style=\"padding-left:5px;\" class=\"pull-right\">\r\n   <span ng-show=\"!selectedUsersIsCollapsed\" title=\"{{\'Hide selected users\' | translate}}\" ng-click=\"collapseSelectedUsers()\" style=\"line-height:19px;\" class=\"wt-linkText glyphicons glyphicons-circle-arrow-top\"></span>\r\n   <span ng-show=\"selectedUsersIsCollapsed\" title=\"{{\'Show selected users\' | translate}}\" ng-click=\"collapseSelectedUsers()\" style=\"line-height:19px;\" class=\"wt-linkText glyphicons glyphicons-circle-arrow-down\"></span>\r\n   <span title=\"{{\'Remove all selected users\' | translate}}\" ng-click=\"removeSelectedUsers()\" style=\"line-height:19px;\" class=\"glyphicons glyphicons-remove-sign\"></span>\r\n  </a>\r\n  <a role=\"button\" style=\"padding-left:20px;\" class=\"wt-linkText pull-right\" ng-click=\"showSelectedUsers();\" title=\"{{\'Click to show selected users\' | translate}}\">\r\n   {{\'Selected users\' | translate}}&nbsp;#{{NoOfSelectedUsers}}\r\n  </a>\r\n  <a role=\"button\" class=\"wt-linkText pull-right\" title=\"{{\'Click to show selected users\' | translate}}\" ng-click=\"showLastResult();\">\r\n   {{\'Search result\' | translate}}\r\n  </a>\r\n </span>\r\n\r\n <div collapse=\"isCollapsed\">\r\n  <div class=\"peopleInput\">\r\n   <input type=\"text\" class=\"form-control\" autocomplete=\"off\" typeahead-on-select=\"filterSelected($item, $model, $label, \'Department\'); selectedDepartment = \'\';\" ng-model=\"selectedDepartment\" typeahead=\"department for department in departments | filter:$viewValue | limitTo:8\" placeholder=\"{{\'Filtering by department\' | translate}}\">\r\n  </div>\r\n  <div class=\"peopleInput\">\r\n   <input type=\"text\" class=\"form-control\" autocomplete=\"off\" typeahead-on-select=\"filterSelected($item, $model, $label, \'BaseOfficeLocation\'); selectedLocation = \'\';\" ng-model=\"selectedLocation\" typeahead=\"location for location in locations | filter:$viewValue | limitTo:8\" placeholder=\"{{\'Filtering by location\' | translate}}\">\r\n  </div>\r\n  <div class=\"peopleInput\">\r\n   <input type=\"text\" class=\"form-control\" autocomplete=\"off\" typeahead-on-select=\"filterSelected($item, $model, $label, \'JobTitle\'); selectedJobTitles = \'\';\" ng-model=\"selectedJobTitles\" typeahead=\"jobTitle for jobTitle in jobTitles | filter:$viewValue | limitTo:8\" placeholder=\"{{\'Filtering by job title\' | translate}}\">\r\n  </div>\r\n </div>\r\n</div>");$templateCache.put("Phonebook/Templates/ViewTemplates/SearchTemplates/defaultSearch.html","<div class=\"peopleInput input-group\">\r\n <input type=\"text\" class=\"form-control inputPeopleSearchbox365\" ng-model=\"$parent.searchTerm\" ng-model-options=\"{ updateOn: \'default blur\', debounce: { \'default\': 500, \'blur\': 0 } }\" autocomplete=\"off\" placeholder=\"{{\'Find Colleague\' | translate}}\" />\r\n <span ng-click=\"$parent.searchTerm = \'\'\" ng-show=\"$parent.searchTerm\" class=\"glyphicon glyphicon-remove form-control-feedback\"></span>\r\n <span class=\"input-group-addon\">\r\n  <span class=\"w365-searchLink\">\r\n   <img src=\"/_layouts/15/images/gears_anv4.gif\" style=\"margin-top: 3px; margin-right: 1px;\" ng-show=\"searching\" />\r\n   <i class=\"glyphicon glyphicon-search\" ng-hide=\"searching\"></i>\r\n  </span>\r\n </span>\r\n</div>");$templateCache.put("Phonebook/Templates/ViewTemplates/ResultTemplates/defaultResults.html","<section class=\"wizdom365SearchSection\" ng-repeat=\"user in users track by $index\">\r\n    <div class=\"wizdom365SearchLeftbody wizdom-phonebook-imgColumn\">\r\n        <div wizdom365-presence-picture=\"\" size=\"AVATAR\" accountname=\"user.AccountName\" email=\"user.WorkEmail\" name=\"user.PreferredName\" image=\"user.Path\"></div>\r\n    </div>\r\n    <div class=\"wizdom365SearchRightbody wizdom-phonebook-textColumn\">\r\n        <div class=\"name\">\r\n            <a ng-href=\"{{user.Path}}\" target=\"_blank\" ng-bind-html=\"user.PreferredName | wizdom365Highlight:searchTerm\"></a>\r\n        </div>\r\n        <section>\r\n            <div class=\"email\" ng-if=\"user.WorkEmail.length\"><a ng-href=\"mailto:{{user.WorkEmail}}\" ng-bind-html=\"user.WorkEmail | wizdom365Highlight:searchTerm\"></a></div>\r\n            <div class=\"department\" ng-if=\"user.Department.length\" ng-click=\"setSearchTerm(\'Department\', user.Department)\" ng-bind-html=\"user.Department | wizdom365Highlight:(searchTerm | wizdom365ReplaceSearchTerm)\"></div>\r\n            <div class=\"phone\" ng-if=\"user.WorkPhone.length\">\r\n                <a ng-href=\"tel:{{user.WorkPhone}}\">\r\n                    <span ng-bind-html=\"user.WorkPhone | wizdom365Highlight:(searchTerm | wizdom365ReplaceSearchTerm)\"></span>\r\n                </a>\r\n            </div>\r\n            <div class=\"sipEmail\" ng-if=\"user.SipAddress.length\">\r\n                <a ng-href=\"sip:{{user.SipAddress}}\">\r\n                    {{\'Skype Call\' | translate}}\r\n                </a>\r\n            </div>\r\n        </section>\r\n    </div>\r\n</section>");$templateCache.put("Phonebook/Templates/ViewTemplates/ResultTemplates/extendedResults.html","<section class=\"wizdom365SearchSection\" ng-repeat=\"user in users track by $index\">\r\n    <div class=\"wizdom365SearchLeftbody wizdom-phonebook-imgColumn\">\r\n        <div wizdom365-presence-picture=\"\" size=\"AVATAR\" accountname=\"user.AccountName\" email=\"user.WorkEmail\" name=\"user.PreferredName\" image=\"user.Path\"></div>\r\n    </div>\r\n    <div class=\"wizdom365SearchRightbody wizdom-phonebook-textColumn\">\r\n\r\n        <div class=\"name\">\r\n            <span wizdom365-presence-picture\r\n                  size=\"SMALL\"\r\n                  type=\"presenceonly\"\r\n                  accountname=\"user.AccountName\"\r\n                  image=\"user.Path\"\r\n                  name=\"user.PreferredName\" \r\n                  email=\"user.WorkEmail\">\r\n            </span>\r\n            <a ng-href=\"{{user.Path}}\" target=\"_blank\" ng-bind-html=\"user.PreferredName | wizdom365Highlight:searchTerm\">\r\n\r\n            </a>\r\n        </div>\r\n        <section>\r\n            <div class=\"email\" ng-show=\"user.WorkEmail.length\"><a ng-href=\"mailto:{{user.WorkEmail}}\" ng-bind-html=\"user.WorkEmail | wizdom365Highlight:searchTerm\"></a></div>\r\n            <div class=\"department\" ng-show=\"user.Department.length\" ng-click=\"setSearchTerm(\'Department\', user.Department)\" ng-bind-html=\"user.Department | wizdom365Highlight:(searchTerm | wizdom365ReplaceSearchTerm)\"></div>\r\n            <div class=\"phone\" ng-show=\"user.WorkPhone.length\">\r\n                <a ng-href=\"tel:{{user.WorkPhone}}\">\r\n                    <span ng-bind-html=\"user.WorkPhone | wizdom365Highlight:(searchTerm | wizdom365ReplaceSearchTerm)\"></span>\r\n                </a>\r\n            </div>\r\n            <div class=\"phoneAndSip\" ng-show=\"user.MobilePhone.length || user.SipAddress.length\">\r\n                <p>\r\n                    <a ng-show=\"user.MobilePhone.length\" ng-href=\"tel:{{user.MobilePhone}}\">\r\n                        <span ng-bind-html=\"user.MobilePhone | wizdom365Highlight:(searchTerm | wizdom365ReplaceSearchTerm)\"></span>\r\n                    </a>\r\n                    <a ng-if=\"user.MobilePhone.length && user.SipAddress.length\">\r\n                        |\r\n                    </a>\r\n                    <a ng-show=\"user.SipAddress.length\" ng-href=\"sip:{{user.SipAddress}}\">\r\n                        {{\'Skype Call\' | translate}}\r\n                    </a>\r\n                </p>\r\n            </div>\r\n            <div class=\"showMore\" ng-click=\"user.showExtendedInfo = !user.showExtendedInfo\">\r\n                <span ng-show=\"!user.showExtendedInfo\">{{\'Show more\' | translate}}<i class=\"glyphicon glyphicon-menu-down\" title=\"{{\'Show more\' | translate}}\"></i></span>\r\n                <span ng-show=\"user.showExtendedInfo\">{{\'Show less\' | translate}}<i class=\"glyphicon glyphicon-menu-up\" title=\"{{\'Show less\' | translate}}\"></i></span>\r\n            </div>\r\n            <div class=\"extendedInfo\" ng-show=\"user.showExtendedInfo\">\r\n                <div ng-show=\"user.JobTitle\">\r\n                    {{\'Job title\' | translate}}:\r\n                    <a class=\"jobTitle\" ng-show=\"user.JobTitle.length\" ng-click=\"setSearchTerm(\'JobTitle\', user.JobTitle)\" ng-bind-html=\"user.JobTitle | wizdom365Highlight:(searchTerm | wizdom365ReplaceSearchTerm)\"></a>\r\n                </div>\r\n                <div ng-show=\"user.BaseOfficeLocation\">\r\n                    {{\'Location\' | translate}}:\r\n                    <a class=\"location\" ng-show=\"user.BaseOfficeLocation\" ng-click=\"setSearchTerm(\'Location\', user.BaseOfficeLocation)\" ng-bind-html=\"user.BaseOfficeLocation | wizdom365Highlight:(searchTerm | wizdom365ReplaceSearchTerm)\"></a>\r\n                </div>\r\n                <div class=\"responsibilities\" ng-show=\"user.Responsibility\">\r\n                    {{\'Ask me about\' | translate}}: <a class=\"responsibility\" ng-repeat=\"resp in user.Responsibility.split(\';\')\" ng-click=\"setSearchTerm(\'Responsibility\', resp)\" ng-bind-html=\"(resp + \', \' | wizdom365Highlight:(searchTerm | wizdom365ReplaceSearchTerm))\"></a>\r\n                </div>\r\n                <div class=\"interests\" ng-show=\"user.Interests\">\r\n                    {{\'Interests\' | translate}}: <a class=\"interest\" ng-repeat=\"interest in user.Interests.split(\';\')\" ng-click=\"setSearchTerm(\'Interests\', interest)\" ng-bind-html=\"(interest  + \', \' | wizdom365Highlight:(searchTerm | wizdom365ReplaceSearchTerm))\"></a>\r\n                </div>\r\n                <div class=\"birthday\" ng-show=\"user.w365Birthday\">\r\n                    {{\'Birthday\' | translate}}: {{user.w365Birthday | date:\'MMMM d\'}}\r\n                </div>\r\n                <div class=\"hireDate\" ng-show=\"user.w365HireDate\">\r\n                    {{\'Hiredate\' | translate}}: {{user.w365HireDate | date: \'longDate\'}}\r\n                </div>\r\n            </div>\r\n        </section>\r\n    </div>\r\n</section>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Email/Comments/Rich.html","<tr class=\"comment-overview {{IsUnread}}\">\r\n    <td width=\"20%\" style=\"border-top: 1px solid rgb(211, 211, 211);\">\r\n        <div class=\"col-xs-2 text-left comments-left\">\r\n            <img class=\"avatar comment-avatar\" src=\"{{CommentAuthorImage}}\">\r\n            <div class=\"inline\">\r\n                <div class=\"signature comment-signature\">{{CommentAuthorName}}</div>\r\n                <div class=\"small\">{{CommentPosted}}</div>\r\n                <span class=\"small\">\r\n                    <span class=\"comment glyphicon glyphicon-thumbs-up\">\r\n                        <img src=\"{{AppUrl}}/Base/Content/images/like.png\" />\r\n                    </span>\r\n                    <span class=\"small\">{{CommentLikesCount}}</span>\r\n                </span>\r\n            </div>\r\n        </div>\r\n    </td>\r\n    <td style=\"border-top: 1px solid rgb(211, 211, 211);\">\r\n        <div class=\"col-xs-10 comment-body\">\r\n            <span>{{CommentBody}}</span>\r\n        </div>\r\n    </td>\r\n</tr>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Email/Comments/TextOnly.html","<div class=\"signature comment-signature\">{{CommentAuthorName}}</div>\r\n<div class=\"small\">{{CommentPosted}}</div>\r\n<span>{{CommentBody}}</span>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Email/Overview/Rich.html","<body>\r\n    <style>\r\n        .container {\r\n            padding: 20px 10px 10px 10px;\r\n            margin-right: auto;\r\n            margin-left: auto;\r\n        }\r\n\r\n        .col-xs-2, .col-xs-10 {\r\n            position: relative;\r\n            min-height: 1px;\r\n            padding-left: 15px;\r\n            padding-right: 15px;\r\n        }\r\n\r\n        .text-center {\r\n            text-align: center;\r\n        }\r\n\r\n        .left {\r\n            padding-top: 25px;\r\n        }\r\n\r\n        .avatar {\r\n            width: 50px;\r\n            height: 50px;\r\n            margin: 0 auto;\r\n            -webkit-border-radius: 30px;\r\n            -moz-border-radius: 30px;\r\n            border-radius: 30px;\r\n            display: block;\r\n        }\r\n\r\n        .signature {\r\n            font-style: italic;\r\n            padding-left: 5px;\r\n            vertical-align: middle;\r\n            color: #808080;\r\n            font-size: 13px;\r\n            line-height: 1.4;\r\n            font-family: \"Segoe UI\",\"Segoe\",Tahoma,Helvetica,Arial,sans-serif;\r\n        }\r\n\r\n        .info {\r\n            text-align: center;\r\n            margin-top: 15px;\r\n            padding-bottom: 5px;\r\n            color: #808080;\r\n            font-size: 13px;\r\n            line-height: 1.4;\r\n            font-family: \"Segoe UI\",\"Segoe\",Tahoma,Helvetica,Arial,sans-serif;\r\n        }\r\n\r\n        .clock {\r\n            color: rgb(0, 114, 198);\r\n            width: 17px;\r\n            height: 16px;\r\n            font-size: 13px;\r\n        }\r\n\r\n        .social {\r\n            border-top: 1px solid rgb(211, 211, 211);\r\n            padding: 5px;\r\n        }\r\n\r\n        .comment {\r\n            color: rgb(0, 114, 198);\r\n            font-size: 16px;\r\n            height: 16px;\r\n            margin-left: 3.2px;\r\n            margin-right: 3.2px;\r\n            cursor: pointer;\r\n        }\r\n\r\n        .channel {\r\n            color: rgb(68, 68, 68);\r\n            font-family: \'Segoe UI\', Segoe, Tahoma, Helvetica, Arial, sans-serif;\r\n            font-size: 15px;\r\n            padding: 5px 0 15px 0;\r\n        }\r\n\r\n        .content {\r\n            color: rgb(68, 68, 68);\r\n            font-family: \'Segoe UI\', Segoe, Tahoma, Helvetica, Arial, sans-serif;\r\n            font-size: 15px;\r\n            line-height: 25px;\r\n        }\r\n\r\n        .content img {\r\n            width: 100% !important;\r\n            height: auto !important;\r\n        }\r\n\r\n        .comments-panel {\r\n            background-color: #f2f3f6;\r\n        }\r\n\r\n        .comment-overview {\r\n        }\r\n\r\n        .comments-header {\r\n            border-top: 1px solid rgb(217, 218, 221);\r\n            border-bottom: 1px solid rgb(217, 218, 221);\r\n            color: rgb(68, 68, 68);\r\n            font-family: \'Segoe UI\', Segoe, Tahoma, Helvetica, Arial, sans-serif;\r\n            font-size: 19.5px;\r\n            font-weight: bold;\r\n            line-height: 21.45px;\r\n            padding-bottom: 30px;\r\n            padding-top: 30px;\r\n            margin-top: 10px;\r\n            margin-bottom: 0;\r\n        }\r\n\r\n        .inline {\r\n            display: inline-block;\r\n        }\r\n\r\n        .comments-left {\r\n            padding-top: 5px;\r\n            padding-bottom: 5px;\r\n        }\r\n\r\n        .comment-avatar {\r\n            display: inline-block;\r\n            vertical-align: top;\r\n        }\r\n\r\n        .comment-signature {\r\n            vertical-align: top;\r\n            padding: 0;\r\n        }\r\n\r\n        .small {\r\n            color: rgb(68, 68, 68);\r\n            font-family: \'Segoe UI\', Segoe, Tahoma, Helvetica, Arial, sans-serif;\r\n            font-size: 11.05px;\r\n            line-height: 20px;\r\n        }\r\n\r\n        .comment-body {\r\n            padding-top: 5px;\r\n            padding-bottom: 5px;\r\n        }\r\n\r\n        .unread {\r\n             background-color: #ffe4a2;\r\n        }\r\n\r\n        .img-thumbnail {\r\n            width: 100%;\r\n            padding: 4px;\r\n            line-height: 1.42857;\r\n            background-color: #fff;\r\n            border: 1px solid #ddd;\r\n            border-radius: 4px;\r\n            display: inline-block;\r\n            height: auto;\r\n        }\r\n\r\n    </style>\r\n\r\n    <div class=\"container\">\r\n        <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\r\n            <tbody>\r\n                <tr>\r\n                    <td width=\"20%\" style=\"vertical-align: sub;\">\r\n                        <div class=\"col-xs-2 left\">\r\n                            <div class=\"text-center\">\r\n                                <img class=\"avatar\" src=\"{{AuthorImage}}\">\r\n                                <div class=\"signature\">{{AuthorName}}</div>\r\n                                <!--<div class=\"signature\">{{AuthorNameOnly}}</div>-->\r\n                                <div class=\"info\">\r\n                                    <span>{{ItemPosted}}</span>\r\n                                </div>\r\n                                <!--<div class=\"social\">\r\n                                    <span class=\"inline\">\r\n                                        <span class=\"comment glyphicon glyphicon-bullhorn\">\r\n                                            <img src=\"{{AppUrl}}Base/Content/images/comment.png\" />\r\n                                        </span>\r\n                                        <span>{{CommentsCount}}</span>\r\n                                    </span>\r\n                                    <span class=\"inline\">\r\n                                        <span class=\"comment glyphicon glyphicon-thumbs-up\">\r\n                                            <img src=\"{{AppUrl}}Base/Content/images/like.png\" />\r\n                                        </span>\r\n                                        <span>{{ItemLikesCount}}</span>\r\n                                    </span>\r\n                                </div>-->\r\n                            </div>\r\n                        </div>\r\n                    </td>\r\n                    <td>\r\n                        <div class=\"col-xs-10\">\r\n                            <h1>{{ItemHeading}}</h1>\r\n                            <span class=\"channel\">{{ChannelName}}</span>\r\n                            <hr />\r\n                            {?Thumbnail<img class=\'img-thumbnail\' src=\'{{Thumbnail}}\' />Thumbnail?}\r\n                            {?VideoUrl<a href=\'{{VideoUrl}}\' style=\'display:block;\'>\r\n                                {{VideoUrl}}\r\n                                {?VideoThumbnail<img class=\'img-thumbnail\' src=\'{{VideoThumbnail}}\' />VideoThumbnail?}\r\n                            </a>VideoUrl?}\r\n                            {?RssUrl<a href=\'{{RssUrl}}\' style=\'display:block;\'>{{RssUrl}}</a>RssUrl?}\r\n                            <span class=\"content\">{{ItemBody}}</span>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n        <!--<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\r\n            <tbody>\r\n                <tr>\r\n                    <td>\r\n                        <div class=\"row comments-panel\">\r\n                            <h5 class=\"comments-header text-center\">\r\n                                <span class=\"comment glyphicon glyphicon-bullhorn\">\r\n                                    <img src=\"{{AppUrl}}Base/Content/images/comment.png\" />\r\n                                </span>\r\n                                <span>COMMENTS</span>\r\n                            </h5>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n        <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"comments-panel\">\r\n            <tbody>\r\n                {{CommentOverview}}\r\n            </tbody>\r\n        </table>-->\r\n    </div>\r\n</body>\r\n");$templateCache.put("Noticeboard/Templates/ViewTemplates/Email/Overview/TextOnly.html","<style>\r\n    img {\r\n        display: none;\r\n    }\r\n</style>\r\n\r\n<div>Author: {{AuthorNameOnly}}</div>\r\n<div>Date: {{ItemPosted}}</div>\r\n<div>Channel: {{ChannelName}}</div>\r\n<div>Title: {{ItemHeading}}</div>\r\n<div>Content: {{ItemBody}}</div>\r\n<div>Externail links:</div>\r\n<div>{?VideoUrl<a href=\'{{VideoUrl}}\'>{{VideoUrl}}</a>VideoUrl?}</div>\r\n<div>{?RssUrl<a href=\'{{RssUrl}}\'>{{RssUrl}}</a>RssUrl?}</div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/ArchiveOverview/default.html","<div class=\"noticeboard-template-archive\">\r\n <!-- top control content -->\r\n\r\n <div class=\"noticeboard-archive-commands\">\r\n\r\n  <nav class=\"noticeboard-archive-commands\" ng-if=\"view\" ng-show=\"dataReady\">\r\n   <form class=\"navbar-form navbar-left\" role=\"search\">\r\n    <div class=\"row\">\r\n     <div class=\"col-xs-12\">\r\n      <div class=\"noticeboard-archive-filterRow pull-right\">\r\n       <i class=\"glyphicon glyphicon-filter wt-icon\" ng-click=\"showFilter()\"></i>\r\n       <span class=\"wt-linkText\" ng-click=\"showFilter()\">{{\'Filter\' | translate}}</span>\r\n      </div>\r\n     </div>\r\n    </div>\r\n    <div class=\"form-group row\">\r\n     <div class=\"col-xs-12\">\r\n      <div class=\"input-group\">\r\n       <input class=\"form-control\"\r\n           type=\"text\"\r\n           ng-model=\"searchObj.text\"\r\n           ng-pattern=\"word\"\r\n           ng-trim=\"false\"\r\n           wizdom365-enter=\"search()\" />\r\n       <span class=\"input-group-btn\">\r\n        <button class=\"btn btn-default\" type=\"button\" ng-click=\"search()\">\r\n         <span class=\"glyphicon glyphicon-search\" aria-hidden=\"true\"></span>\r\n         <!-- {{\'Search\' | translate}} -->\r\n        </button>\r\n       </span>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </form>\r\n  </nav>\r\n\r\n  <!-- Filters -->\r\n  <div class=\"alert alert-info\"\r\n    ng-if=\"channelFilter.length>\r\n   0 ||\r\n   personFilter.length>0 ||\r\n   (dateFilter && startdateFilter!=null && startdateFilter != \'\') ||\r\n   (dateFilter && enddateFilter!=null && enddateFilter != \'\')\">\r\n\r\n   <div ng-if=\"channelFilter.length>0\">\r\n    {{\'Filtering by channel(s)\' | translate}}:\r\n    <div class=\"channel\" ng-repeat=\"channel in channelFilter\">\r\n     <div class=\"label label-primary\">\r\n      <span>{{::channel.name}}</span>\r\n      <a class=\"remove\" href=\"\" ng-click=\"removeChannelFilterItem(channel)\">&times;</a>\r\n     </div>\r\n    </div>\r\n   </div>\r\n\r\n   <div ng-if=\"personFilter.length>0\">\r\n    {{\'Filtering by person\' | translate}}:\r\n    <div class=\"channel\" ng-repeat=\"person in personFilter\">\r\n     <div class=\"label label-primary\">\r\n      <span>{{::person.displayName}}</span>\r\n      <a class=\"remove\" href=\"\" ng-click=\"removePersonFilter()\">&times;</a>\r\n     </div>\r\n    </div>\r\n   </div>\r\n\r\n   <div ng-if=\"(dateFilter && startdateFilter!=null && startdateFilter != \'\')\">\r\n    {{\'Filtering by from date\' | translate}}:\r\n    <div class=\"channel\">\r\n     <div class=\"label label-primary\">\r\n      <span am-time-ago=\"startdateFilter\"></span>\r\n      <a class=\"remove\" href=\"\" ng-click=\"removeStartDateFilter()\">&times;</a>\r\n     </div>\r\n    </div>\r\n   </div>\r\n\r\n   <div ng-if=\"(dateFilter && enddateFilter!=null && enddateFilter != \'\')\">\r\n    {{\'Filtering by to date\' | translate}}:\r\n    <div class=\"channel\">\r\n     <div class=\"label label-primary\">\r\n      <span am-time-ago=\"enddateFilter\"></span>\r\n      <a class=\"remove\" href=\"\" ng-click=\"removeEndDateFilter()\">&times;</a>\r\n     </div>\r\n    </div>\r\n   </div>\r\n  </div>\r\n\r\n\r\n </div>\r\n\r\n <!-- main content -->\r\n\r\n <div class=\"noticeboard-archive-results wizdom-fullwidth media-list\" ng-show=\"searchReady\">\r\n  <div class=\"NoticeBoardItem\" ng-repeat=\"item in data | limitTo: numPerPage\">\r\n\r\n   <div class=\"media-list\">\r\n    <div class=\"media wd-noticeboard-media {{(item.isRead ? \'wd-noticeboard-mediaRead\' : \'wd-noticeboard-mediaUnread\')}}\">\r\n     <div class=\"media-left\">\r\n      <div class=\"presence media-object\"\r\n        wizdom365-presence-picture\r\n        size=\"AVATAR\"\r\n        accountname=\"::(item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName)\"\r\n        name=\"::(item.alternateAuthor ? item.alternateAuthor.principalID : item.author.principalID)\"\r\n        image=\"::item.metadata.ImageUrl\">\r\n      </div>\r\n\r\n     </div>\r\n     <div class=\"media-body\">\r\n      <div class=\"container-fluid\">\r\n       <div class=\"row\">\r\n        <div class=\"col-xs-12 mediaAdjustablePadding\">\r\n         <div class=\"mobile-heading noticeboard-authorRow\">\r\n          <span class=\"presence media-object text-muted\"\r\n             wizdom365-presence-picture\r\n             size=\"SMALL\"\r\n             type=\"defaultrender\"\r\n             accountname=\"::(item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName)\"\r\n             image=\"::item.metadata.ImageUrl\"\r\n             name=\"::(item.alternateAuthor ? ((\'on behalf of: \' | translate) + item.alternateAuthor.displayName) : item.author.displayName)\">\r\n          </span>\r\n          <span class=\"text-muted\"> | </span>\r\n          <span class=\"text-muted text-center\" am-time-ago=\"(item.startDate | wizdom365FormatDate)\"></span>\r\n          <span class=\"pull-right markReadUnreadSection\">\r\n           <span ng-show=\"item.isRead\">\r\n            <span class=\"wt-linkText hidden-xs\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as unread\' | translate}}\">{{\'Read\' | translate}}</span><i class=\"glyphicon glyphicon-check wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{::\'Mark as unread\' | translate}}\"></i>\r\n           </span>\r\n           <span ng-hide=\"item.isRead\">\r\n            <span class=\"wt-linkText hidden-xs\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as read\' | translate}}\">{{\'Read\' | translate}}</span><i class=\"glyphicon glyphicon-unchecked wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{::\'Mark as read\' | translate}}\"></i>\r\n           </span>\r\n          </span>\r\n\r\n         </div>\r\n         <div class=\"noticeboard-media-headingRow\">\r\n          <a class=\"media-heading wd-noticeboard-media-heading\" href=\"\" ng-click=\"ShowItem(item.id)\"><strong>{{::item.heading}}</strong></a>\r\n         </div>\r\n         <div class=\"noticeboard-media-channelRow\">\r\n          <span class=\"text-muted\" ng-repeat=\"channel in item.channels\">{{::channel.name}}<span ng-hide=\"$last\">, </span></span>\r\n         </div>\r\n         <div class=\"media noticeboard-media-TextRow\">\r\n          <!--ng-show=\"item.metadata.picture || item.metadata.videoImage\"-->\r\n          <div class=\"media-left\" ng-if=\"item.contentType && item.metadata\">\r\n           <div class=\"media-item\"\r\n             ng-if=\"::(item.contentType.name.indexOf(\'Video\') >= 0 && item.metadata.link)\"\r\n             wizdom365-video-player\r\n             videolink=\"::item.metadata.link\"\r\n             thumbnail=\"::item.metadata.videoImage\">\r\n           </div>\r\n           <img ng-click=\"showPicture(item.metadata.picture)\" class=\"media-item img-thumbnail img-responsive cursor-pointer\"\r\n             ng-if=\"::((item.contentType.name == \'News\' || item.contentType.name == \'RSS\') && item.metadata.picture)\"\r\n             ng-src=\"{{::item.metadata.picture}}\"\r\n             alt=\"...\" />\r\n          </div>\r\n          <div class=\"media-body word-break\">\r\n                                            <p ng-bind-html=\"::(item.content | checkForLongLinkTextV2:300:45)\" ng-click=\"ShowItem(item.id)\" style=\"cursor: pointer;\"></p>\r\n           <p wizdom365-item-social-container\r\n              item=\"::item\"\r\n              itemid=\"::item.id\"\r\n              itemtype=\"item\"\r\n              tooltipposition=\"top\"\r\n                                               template-url=\"::view.extendedProperties.socialSummaryTemplate\"\r\n              ng-if=\"::(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\">\r\n           </p>\r\n          </div>\r\n          <div class=\"text-muted\"\r\n            ng-if=\"::socialFeatureEnabled\"\r\n            item-social-preview\r\n            item=\"::item\"\r\n            tooltipposition=\"top\">\r\n          </div>\r\n         </div>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n\r\n    <div data-wizdom365-comments-panel\r\n      data-item=\"::item\"\r\n      commentlimit=\"0\"\r\n      itemid=\"::item.id\"\r\n      itemtype=\"item\"\r\n                     defaultfocus=\"true\"\r\n                     template-url=\"::view.extendedProperties.socialCommentsTemplate\"\r\n      ng-if=\"::(socialFeatureEnabled && socialOverviewComments && ((item.metadata.allowComments == null && enableSocialOnOldItems) || item.metadata.allowComments))\">\r\n    </div>\r\n   </div>\r\n\r\n  </div>\r\n </div>\r\n <!-- end class noticeboard-archive-results -->\r\n\r\n\r\n\r\n <div class=\"alert alert-info\" ng-if=\"::(data && data.length === 0 && searchedAtleastOnce)\">{{\'Nothing matches your search\' | translate}}</div>\r\n\r\n <!-- paging content -->\r\n\r\n <div class=\"container-fluid wd-noticeboard-pagination-container wizdom-fullwidth text-center\" ng-if=\"(data.length && totalPages > numPerPage)\">\r\n  <div class=\"wd-noticeboard-pagination-inner-container row\">\r\n   <pagination total-items=\"::totalPages\"\r\n      ng-change=\"setcurrentPage(currentPage)\"\r\n      ng-model=\"currentPage\"\r\n      items-per-page=\"numPerPage\"\r\n      max-size=\"5\"\r\n      boundary-links=\"false\"\r\n      previous-text=\"&lsaquo;\"\r\n      next-text=\"&rsaquo;\"\r\n      first-text=\"&laquo;\"\r\n      last-text=\"&raquo;\"></pagination>\r\n  </div>\r\n </div>\r\n\r\n</div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/ArchiveOverview/defaultSmall.html","<div class=\"noticeboard-template-archiveSmall\">\r\n <!-- top control content -->\r\n\r\n <div class=\"noticeboard-archive-commands\">\r\n\r\n  <nav class=\"noticeboard-archive-commands\" ng-if=\"view\" ng-show=\"dataReady\">\r\n   <form class=\"navbar-form navbar-left\" role=\"search\">\r\n    <div class=\"row\">\r\n     <div class=\"col-xs-12\">\r\n      <div class=\"noticeboard-archive-filterRow pull-right\">\r\n       <i class=\"glyphicon glyphicon-filter wt-icon\" ng-click=\"showFilter()\"></i>\r\n       <span class=\"wt-linkText\" ng-click=\"showFilter()\">{{\'Filter\' | translate}}</span>\r\n      </div>\r\n     </div>\r\n    </div>\r\n    <div class=\"form-group row\">\r\n     <div class=\"col-xs-12\">\r\n      <div class=\"input-group\">\r\n       <input class=\"form-control\"\r\n           type=\"text\"\r\n           ng-model=\"searchObj.text\"\r\n           ng-pattern=\"word\"\r\n           ng-trim=\"false\"\r\n           wizdom365-enter=\"search()\" />\r\n       <span class=\"input-group-btn\">\r\n        <button class=\"btn btn-default\" type=\"button\" ng-click=\"search()\">\r\n         <span class=\"glyphicon glyphicon-search\" aria-hidden=\"true\"></span>\r\n         <!-- {{\'Search\' | translate}} -->\r\n        </button>\r\n       </span>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </form>\r\n  </nav>\r\n\r\n  <!-- Filters -->\r\n  <div class=\"alert alert-info\"\r\n    ng-if=\"channelFilter.length>\r\n   0 ||\r\n   personFilter.length>0 ||\r\n   (dateFilter && startdateFilter!=null && startdateFilter != \'\') ||\r\n   (dateFilter && enddateFilter!=null && enddateFilter != \'\')\">\r\n\r\n   <div ng-if=\"channelFilter.length>0\">\r\n    {{\'Filtering by channel(s)\' | translate}}:\r\n    <div class=\"channel\" ng-repeat=\"channel in channelFilter\">\r\n     <div class=\"label label-primary\" ng-if=\"channelFilter.length>1\">\r\n      <a href=\"\" ng-click=\"filterOnChannel(channel)\">{{::channel.name}}</a>\r\n      <a class=\"remove\" href=\"\" ng-click=\"removeChannelFilterItem(channel)\">&times;</a>\r\n     </div>\r\n     <div class=\"label label-primary\" ng-if=\"channelFilter.length==1\">\r\n      <span>{{::channel.name}}</span>\r\n      <a class=\"remove\" href=\"\" ng-click=\"removeChannelFilterItem(channel)\">&times;</a>\r\n     </div>\r\n    </div>\r\n   </div>\r\n\r\n   <div ng-if=\"personFilter.length>0\">\r\n    {{\'Filtering by person\' | translate}}:\r\n    <div class=\"channel\" ng-repeat=\"person in personFilter\">\r\n     <div class=\"label label-primary\">\r\n      <span>{{::person.displayName}}</span>\r\n      <a class=\"remove\" href=\"\" ng-click=\"removePersonFilter()\">&times;</a>\r\n     </div>\r\n    </div>\r\n   </div>\r\n\r\n   <div ng-if=\"(dateFilter && startdateFilter!=null && startdateFilter != \'\')\">\r\n    {{\'Filtering by from date\' | translate}}:\r\n    <div class=\"channel\">\r\n     <div class=\"label label-primary\">\r\n      <span am-time-ago=\"startdateFilter\"></span>\r\n      <a class=\"remove\" href=\"\" ng-click=\"removeStartDateFilter()\">&times;</a>\r\n     </div>\r\n    </div>\r\n   </div>\r\n\r\n   <div ng-if=\"(dateFilter && enddateFilter!=null && enddateFilter != \'\')\">\r\n    {{\'Filtering by to date\' | translate}}:\r\n    <div class=\"channel\">\r\n     <div class=\"label label-primary\">\r\n      <span am-time-ago=\"enddateFilter\"></span>\r\n      <a class=\"remove\" href=\"\" ng-click=\"removeEndDateFilter()\">&times;</a>\r\n     </div>\r\n    </div>\r\n   </div>\r\n  </div>\r\n\r\n\r\n </div>\r\n\r\n <!-- main content -->\r\n\r\n <div class=\"noticeboard-archive-results wizdom-fullwidth\" ng-show=\"searchReady\">\r\n  <div class=\"NoticeBoardItem\" ng-repeat=\"item in data | limitTo: numPerPage\">\r\n\r\n   <div class=\"media-list\">\r\n    <div class=\"media wd-noticeboard-media {{(item.isRead ? \'wd-noticeboard-mediaRead\' : \'wd-noticeboard-mediaUnread\')}}\">\r\n     <div class=\"media-body\">\r\n      <div class=\"container-fluid\">\r\n       <div class=\"row\">\r\n        <div class=\"col-xs-12 mediaAdjustablePadding\">\r\n         <div class=\"mobile-heading noticeboard-authorRow\">\r\n          <span class=\"presence media-object text-muted\"\r\n             wizdom365-presence-picture\r\n             size=\"SMALL\"\r\n             type=\"defaultrender\"\r\n             email=\"item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName\"\r\n             name=\"item.alternateAuthor ? ((\'on behalf of: \' | translate) + item.alternateAuthor.displayName) : item.author.displayName\">\r\n          </span>\r\n          <span class=\"text-muted\"> | </span>\r\n          <span class=\"text-muted text-center\" am-time-ago=\"::(item.startDate | wizdom365FormatDate)\"></span>\r\n          <span class=\"pull-right\">\r\n           <!--<span><a class=\"wizdom-link wizdom-icon ng-class:item.isRead ? \'icon-mail-read-1\' : \'icon-mail-1\'\" ng-click=\"changeReadStatus(item)\"></a></span>-->\r\n           <span ng-show=\"item.isRead\">\r\n            <i class=\"glyphicon glyphicon-check wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as unread\' | translate}}\"></i>\r\n           </span>\r\n           <span ng-hide=\"item.isRead\">\r\n            <i class=\"glyphicon glyphicon-unchecked wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as read\' | translate}}\"></i>\r\n           </span>\r\n          </span>\r\n\r\n         </div>\r\n         <div class=\"noticeboard-media-headingRow\">\r\n          <a class=\"media-heading wd-noticeboard-media-heading\" href=\"\" ng-click=\"ShowItem(item.id)\" title=\"{{::item.heading}}\">{{::item.heading}}</a>\r\n         </div>\r\n         <div class=\"noticeboard-media-channelRow\">\r\n          <span class=\"text-muted\" ng-repeat=\"channel in item.channels\">{{::channel.name}}<span ng-hide=\"$last\">, </span></span>\r\n         </div>\r\n         <div class=\"media noticeboard-media-TextRow\">\r\n          <!--ng-show=\"item.metadata.picture || item.metadata.videoImage\"-->\r\n          <div class=\"media-left\" ng-if=\"::(item.contentType && item.metadata)\">\r\n           <div class=\"media-item\"\r\n             ng-if=\"::(item.contentType.name.indexOf(\'Video\') >= 0 && item.metadata.link)\"\r\n             wizdom365-video-player\r\n             videolink=\"::item.metadata.link\"\r\n             thumbnail=\"::item.metadata.videoImage\">\r\n           </div>\r\n           <img ng-click=\"showPicture(item.metadata.picture)\" class=\"media-item img-thumbnail img-responsive cursor-pointer\"\r\n             ng-if=\"::((item.contentType.name == \'News\' || item.contentType.name == \'RSS\') && item.metadata.picture)\"\r\n             ng-src=\"{{::item.metadata.picture}}\"\r\n             alt=\"...\" />\r\n          </div>\r\n          <div class=\"media-body word-break\">\r\n                                            <p ng-bind-html=\"::(item.content | checkForLongLinkTextV2:300:45)\" ng-click=\"ShowItem(item.id)\" style=\"cursor: pointer;\"></p>\r\n           <p wizdom365-item-social-container\r\n              item=\"::item\"\r\n              itemid=\"::item.id\"\r\n              itemtype=\"item\"\r\n              tooltipposition=\"top\"\r\n                                               template-url=\"::view.extendedProperties.socialSummaryTemplate\"\r\n              ng-if=\"::(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\">\r\n           </p>\r\n          </div>\r\n          <div class=\"text-muted\"\r\n            ng-if=\"::socialFeatureEnabled\"\r\n            item-social-preview\r\n            item=\"item\"\r\n            tooltipposition=\"top\">\r\n          </div>\r\n         </div>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n\r\n    <div data-wizdom365-comments-panel\r\n      data-item=\"::item\"\r\n      itemid=\"::item.id\"\r\n      itemtype=\"item\"\r\n                     defaultfocus=\"true\"\r\n                     template-url=\"::view.extendedProperties.socialCommentsTemplate\"\r\n      ng-if=\"::(socialFeatureEnabled && socialOverviewComments && ((item.metadata.allowComments == null && enableSocialOnOldItems) || item.metadata.allowComments))\">\r\n    </div>\r\n   </div>\r\n\r\n  </div>\r\n </div>\r\n <!-- end class noticeboard-archive-results -->\r\n\r\n\r\n\r\n <div class=\"alert alert-info\" ng-if=\"data && data.length === 0 && searchedAtleastOnce\">{{\'Nothing matches your search\' | translate}}</div>\r\n\r\n <!-- paging content -->\r\n\r\n <div class=\"container-fluid wd-noticeboard-pagination-container wizdom-fullwidth text-center\" ng-if=\"data.length && totalPages > numPerPage\">\r\n  <div class=\"wd-noticeboard-pagination-inner-container row\">\r\n   <pagination total-items=\"totalPages\"\r\n      ng-change=\"setcurrentPage(currentPage)\"\r\n      ng-model=\"currentPage\"\r\n      items-per-page=\"numPerPage\"\r\n      max-size=\"5\"\r\n      boundary-links=\"false\"\r\n      previous-text=\"&lsaquo;\"\r\n      next-text=\"&rsaquo;\"\r\n      first-text=\"&laquo;\"\r\n      last-text=\"&raquo;\"></pagination>\r\n  </div>\r\n </div>\r\n\r\n</div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/NewEditForm/CreateAndEdit.html","<div ng-class=\"{ \'wt-noticeboard-create-item-video\': isVideoEnabled,\'wt-noticeboard-create-item\': !isVideoEnabled }\">\r\n    <form role=\"form\" class=\"col-md-12\" ng-controller=\"Wizdom365NoticeboardCreateEditController\">\r\n        <style>\r\n            .peoplePickerDialog {\r\n                background-color: red;\r\n                width: 80%;\r\n                height: 80%;\r\n                position: fixed;\r\n                top: 10%;\r\n                left: 10%;\r\n                z-index: 2;\r\n            }\r\n        </style>\r\n        <div class=\"form-group\">\r\n            <label for=\"newsTitle\">{{\'Title\' | translate}}</label>\r\n            <input type=\"text\" class=\"form-control ie11focusfix\" id=\"newsTitle\" ng-model=\"newsTitle\" placeholder=\"{{\'Title\' | translate}}\" required />\r\n        </div>\r\n        <div class=\"form-group\" ng-show=\"isVideoEnabled\">\r\n            <label>{{\'Video link\' | translate}}</label>\r\n            <input type=\"text\" class=\"form-control\" placeholder=\"{{\'Supported video formats: youtube vimeo .mp4 .webm .ogg\' | translate}}\" ng-model=\"videoLink\" ng-change=\"checkUrl()\" required>\r\n            <span class=\"label label-danger\" ng-show=\"invalidUrl\">{{\'This video format is not supported. Please provide valid link (youtube vimeo .mp4 .webm .ogg)\' | translate}}</span>\r\n        </div>\r\n\r\n        <div class=\"form-group\" ng-show=\"isVideoEnabled\">\r\n            <label>{{\'Video poster\' | translate}}</label>\r\n            <wizdom365-image-picker ng-model=\"videoImage\"></wizdom365-image-picker>\r\n            <img ng-src=\"{{videoImage}}\" style=\"max-width: 200px; max-height: 200px\" ng-show=\"videoImage\" />\r\n            <span class=\"glyphicon glyphicon-trash\" aria-hidden=\"true\" ng-show=\"videoImage\" ng-click=\"deleteVideoImage()\"></span>\r\n        </div>\r\n\r\n        <div class=\"form-group\" wizdom-Lazy-Load=\"ui.tinymce\">\r\n            <label for=\"newsContent\">{{\'Content\' | translate}}</label>\r\n            <textarea class=\"form-control\" ng-attr-placeholder=\"{{\'Content\' | translate}}\" ng-model=\"newsContent\" style=\"height:200px\"\r\n                      ui-tinymce=\"tinyMceOptions\"\r\n                      toolbar-configuration=\"Noticeboard\"\r\n                      mentio-iframe-element=\"iframeElement\"\r\n                      mentio\r\n                      mentio-trigger-char=\"\'@\'\"\r\n                      mentio-require-leading-space=\"true\"\r\n                      mentio-items=\"searchPrincipals\"\r\n                      mentio-template-url=\"/mentionTemplate.html\"\r\n                      mentio-search=\"searchForMention(term)\"\r\n                      mentio-select=\"selectUser(item)\" />\r\n            <script type=\"text/ng-template\" id=\"/mentionTemplate.html\">\r\n                <ul class=\"list-group user-search\" style=\"padding-left:0; z-index:1000\">\r\n                    <li mentio-menu-item=\"principal\" ng-repeat=\"principal in items\" class=\"list-group-item\">\r\n                        <div style=\"display:inline-block; vertical-align:middle\" class=\"presence\" wizdom365-presence-picture=\"\" size=\"AVATAR\" accountname=\"::principal.loginName\" name=\"::principal.principalID\"></div>\r\n                        <span class=\"text-primary\" ng-bind-html=\"::(principal.displayName | mentioHighlight:typedTerm:\'menu-highlighted\' | unsafe)\"></span>\r\n                    </li>\r\n                </ul>\r\n            </script>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n            <div class=\"form-group col-md-6\">\r\n                <label for=\"startDate\">{{\'Start date\' | translate}}</label>\r\n                <div style=\"margin-top:-30px;\" wizdom365-datetime-picker=\"\" disable-previously-dates=\"true\" date=\"startDate\" disable-weekends=\"false\" show-date-picker=\"true\" show-time-picker=\"true\"></div>\r\n            </div>\r\n\r\n            <div class=\"form-group col-md-6\">\r\n                <label for=\"endDate\">{{\'End date\' | translate}}</label>\r\n                <div style=\"margin-top:-30px;\" wizdom365-datetime-picker=\"\" min-date=\"startDate\" date=\"endDate\" disable-weekends=\"false\" show-date-picker=\"true\" show-time-picker=\"true\"></div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\" ng-show=\"selectedcontenttype.metaData.useAlternativeAuthor\">\r\n            <label>{{\'Alternate author\' | translate}}</label> &nbsp;&nbsp;\r\n            <span ng-show=\"altAuthor != null\">\r\n                {{(altAuthor.category? \'(\'+altAuthor.category+\') \':\'\')}}{{altAuthor.displayName}}<span ng-if=\"altAuthor.loginName\">&nbsp;&lt;{{altAuthor.loginName}}&gt;</span> <b class=\"text-danger pointer\" ng-click=\"removeAltAuthor();\" ng-show=\"altAuthor != null\">{{\'Remove\' | translate}}</b>\r\n            </span>\r\n            <div ng-show=\"altAuthor == null\">\r\n\r\n                <input type=\"text\" ng-model=\"asyncSelected\"\r\n                       placeholder=\"{{\'Select alternate author\' | translate}}\"\r\n                       typeahead-on-select=\"addAltAuthor($item, $model, $label);\"\r\n                       typeahead=\"user as (user.category? \'(\'+user.category+\') \':\'\')+user.displayName + (user.loginName ? \' <\' + user.loginName + \'>\' : \'\') for user in searchForPrincipal($viewValue,true) | limitTo:5\" typeahead-loading=\"loadingLocations\" typeahead-template-url=\"customTemplate.html\" class=\"form-control\" typeahead-min-length=\"2\">\r\n                <i ng-show=\"loadingLocations\" class=\"glyphicon glyphicon-refresh\"></i>\r\n            </div>\r\n            <script type=\"text/ng-template\" id=\"customTemplate.html\">\r\n                <a>\r\n                    <div style=\"display:inline-block; vertical-align:middle\" class=\"presence\" wizdom365-presence-picture=\"\" size=\"AVATAR\" accountname=\"match.model.loginName\" name=\"match.model.principalID\"></div>\r\n                    <span bind-html-unsafe=\"match.label | typeaheadHighlight:query\"></span>\r\n                </a>\r\n            </script>\r\n        </div>\r\n        <div class=\"form-group\" ng-show=\"!isVideoEnabled && selectedcontenttype.metaData.useRollupImage\">\r\n            <label>{{\'Publishing image\' | translate}}</label>\r\n            <wizdom365-image-picker ng-model=\"newsImage\"></wizdom365-image-picker>\r\n            <img ng-src=\"{{newsImage}}\" style=\"max-width: 200px; max-height: 200px\" ng-show=\"newsImage\" />\r\n            <span class=\"glyphicon glyphicon-trash\" aria-hidden=\"true\" ng-show=\"newsImage\" ng-click=\"deleteImage()\"></span>\r\n        </div>\r\n        <div class=\"checkbox form-group\" ng-show=\"socialFeatureEnabled\">\r\n            <label>\r\n                <input type=\"checkbox\" ng-model=\"allowComments\" />{{\'Allow social (likes and comments)\' | translate}}\r\n            </label>\r\n        </div>\r\n\r\n    </form>\r\n</div>\r\n");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/NewEditForm/news.html","<!-- DEPRECATED: This Template has been deprecated and will be removed in the future. Please use CreateAndEdit.html instead -->\r\n<div class=\"wt-noticeboard-create-item\">\r\n    <form role=\"form\" class=\"col-md-12\" ng-controller=\"Wizdom365NoticeboardCreateNewsController\">\r\n        <style>\r\n            .peoplePickerDialog {\r\n                background-color: red;\r\n                width: 80%;\r\n                height: 80%;\r\n                position: fixed;\r\n                top: 10%;\r\n                left: 10%;\r\n                z-index: 2;\r\n            }\r\n        </style>\r\n\r\n        <div class=\"form-group\">\r\n            <label for=\"newsTitle\">{{\'Title\' | translate}}</label>\r\n            <input type=\"text\" class=\"form-control ie11focusfix\" id=\"newsTitle\" ng-model=\"newsTitle\" placeholder=\"{{\'Title\' | translate}}\" required>\r\n        </div>\r\n\r\n        <div class=\"form-group\" wizdom-Lazy-Load=\"ui.tinymce\">\r\n            <label for=\"newsContent\">{{\'Content\' | translate}}</label>\r\n            <textarea class=\"form-control\" ng-model=\"newsContent\" style=\"height:200px\"\r\n                      ui-tinymce=\"tinyMceOptions\"\r\n                      toolbar-configuration=\"Noticeboard\"\r\n                      mentio-iframe-element=\"iframeElement\"\r\n                      mentio\r\n                      mentio-trigger-char=\"\'@\'\"\r\n                      mentio-require-leading-space=\"true\"\r\n                      mentio-items=\"searchPrincipals\"\r\n                      mentio-template-url=\"/mentionTemplate.html\"\r\n                      mentio-search=\"searchForMention(term)\"\r\n                      mentio-select=\"selectUser(item)\" />\r\n            <script type=\"text/ng-template\" id=\"/mentionTemplate.html\">\r\n                <ul class=\"list-group user-search\" style=\"padding-left:0; z-index:1000\">\r\n                    <li mentio-menu-item=\"principal\" ng-repeat=\"principal in items\" class=\"list-group-item\">\r\n                        <div style=\"display:inline-block; vertical-align:middle\" class=\"presence\" wizdom365-presence-picture=\"\" size=\"AVATAR\" accountname=\"::principal.loginName\" name=\"::principal.principalID\"></div>\r\n                        <span class=\"text-primary\" ng-bind-html=\"::(principal.displayName | mentioHighlight:typedTerm:\'menu-highlighted\' | unsafe)\"></span>\r\n                    </li>\r\n                </ul>\r\n            </script>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n            <div class=\"form-group col-md-6\">\r\n                <label for=\"startDate\">{{\'Start date\' | translate}}</label>\r\n                <div style=\"margin-top:-30px;\" wizdom365-datetime-picker=\"\" disable-previously-dates=\"true\" date=\"startDate\" disable-weekends=\"false\" show-date-picker=\"true\" show-time-picker=\"true\"></div>\r\n            </div>\r\n\r\n            <div class=\"form-group col-md-6\">\r\n                <label for=\"endDate\">{{\'End date\' | translate}}</label>\r\n                <div style=\"margin-top:-30px;\" wizdom365-datetime-picker=\"\" min-date=\"startDate\" date=\"endDate\" disable-weekends=\"false\" show-date-picker=\"true\" show-time-picker=\"true\"></div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\" ng-show=\"selectedcontenttype.metaData.useAlternativeAuthor\">\r\n            <label>{{\'Alternate author\' | translate}}</label> &nbsp;&nbsp;\r\n            <span ng-show=\"altAuthor != null\">\r\n                {{(altAuthor.category? \'(\'+altAuthor.category+\') \':\'\')}}{{::altAuthor.displayName}}<span ng-if=\"altAuthor.loginName\">&nbsp;&lt;{{altAuthor.loginName}}&gt;</span> <b class=\"text-danger pointer\" ng-click=\"removeAltAuthor();\" ng-show=\"altAuthor != null\">{{\'Remove\' | translate}}</b>\r\n            </span>\r\n            <div ng-show=\"altAuthor == null\">\r\n\r\n                <input type=\"text\" ng-model=\"asyncSelected\" \r\n                       placeholder=\"{{\'Select alternate author\' | translate}}\" \r\n                       typeahead-on-select=\"addAltAuthor($item, $model, $label);\" \r\n                       typeahead=\"user as (user.category? \'(\'+user.category+\') \':\'\')+user.displayName + (user.loginName ? \' - \' + user.loginName : \'\') for user in searchForPrincipal($viewValue,true) | limitTo:5\" typeahead-loading=\"loadingLocations\" typeahead-template-url=\"customTemplate.html\" class=\"form-control\" typeahead-min-length=\"2\">\r\n                <i ng-show=\"loadingLocations\" class=\"glyphicon glyphicon-refresh\"></i>\r\n            </div>\r\n            <script type=\"text/ng-template\" id=\"customTemplate.html\">\r\n                <a>\r\n                    <div style=\"display:inline-block; vertical-align:middle\" class=\"presence\" wizdom365-presence-picture=\"\" size=\"AVATAR\" accountname=\"::match.model.loginName\" name=\"::match.model.principalID\"></div>\r\n                    <span bind-html-unsafe=\"match.label | typeaheadHighlight:query\"></span>\r\n                </a>\r\n            </script>\r\n        </div>\r\n\r\n        <div class=\"form-group\" ng-show=\"selectedcontenttype.metaData.useRollupImage\">\r\n            <label>{{\'Publishing image\' | translate}}</label>\r\n            <wizdom365-image-picker ng-model=\"newsImage\"></wizdom365-image-picker>\r\n            <img ng-src=\"{{newsImage}}\" style=\"max-width: 200px; max-height: 200px\" ng-show=\"newsImage\" />\r\n            <span class=\"glyphicon glyphicon-trash\" aria-hidden=\"true\" ng-show=\"newsImage\" ng-click=\"deleteImage()\"></span>\r\n        </div>\r\n\r\n        <div class=\"checkbox form-group\" ng-show=\"socialFeatureEnabled\">\r\n            <label>\r\n                <input type=\"checkbox\" ng-model=\"allowComments\" />{{\'Allow social (likes and comments)\' | translate}}</label>\r\n        </div>\r\n\r\n    </form>\r\n</div>\r\n");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/NewEditForm/video.html","<!-- DEPRECATED: This Template has been deprecated and will be removed in the future. Please use CreateAndEdit.html instead -->\r\n<div class=\"wt-noticeboard-create-item-video\">\r\n    <form role=\"form\" class=\"col-md-12\" ng-controller=\"Wizdom365NoticeboardCreateVideoController\">\r\n\r\n        <div class=\"form-group\">\r\n            <label for=\"newsTitle\">{{\'Title\' | translate}}</label>\r\n            <input type=\"text\" class=\"form-control ie11focusfix\" id=\"newsTitle\" ng-model=\"newsTitle\" placeholder=\"{{\'Title\' | translate}}\" required>\r\n        </div>\r\n        <div class=\"form-group\">\r\n            <label>{{\'Video link\' | translate}}</label>\r\n            <input type=\"text\" class=\"form-control\" placeholder=\"{{\'Supported video formats: youtube vimeo .mp4 .webm .ogg\' | translate}}\" ng-model=\"videoLink\" ng-change=\"checkUrl()\" required>\r\n            <span class=\"label label-danger\" ng-show=\"invalidUrl\">{{\'This video format is not supported. Please provide valid link (youtube vimeo .mp4 .webm .ogg)\' | translate}}</span>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n            <label>{{\'Video poster\' | translate}}</label>\r\n            <wizdom365-image-picker ng-model=\"videoImage\"></wizdom365-image-picker>\r\n            <img ng-src=\"{{videoImage}}\" style=\"max-width: 200px; max-height: 200px\" ng-show=\"videoImage\" />\r\n            <span class=\"glyphicon glyphicon-trash\" aria-hidden=\"true\" ng-show=\"videoImage\" ng-click=\"deleteVideoImage()\"></span>\r\n        </div>\r\n\r\n        <div class=\"form-group\" wizdom-Lazy-Load=\"ui.tinymce\">\r\n            <label for=\"newsContent\">{{\'Content\' | translate}}</label>\r\n            <textarea class=\"form-control\" ng-attr-placeholder=\"{{\'Content\' | translate}}\" ng-model=\"newsContent\" style=\"height:200px\" \r\n                      ui-tinymce=\"tinyMceOptions\"\r\n                      toolbar-configuration=\"Noticeboard\"\r\n                      mentio-iframe-element=\"iframeElement\"\r\n                      mentio\r\n                      mentio-trigger-char=\"\'@\'\"\r\n                      mentio-require-leading-space=\"true\"\r\n                      mentio-items=\"searchPrincipals\"\r\n                      mentio-template-url=\"/mentionTemplate.html\"\r\n                      mentio-search=\"searchForMention(term)\"\r\n                      mentio-select=\"selectUser(item)\" />\r\n            <script type=\"text/ng-template\" id=\"/mentionTemplate.html\">\r\n                <ul class=\"list-group user-search\" style=\"padding-left:0; z-index:1000\">\r\n                    <li mentio-menu-item=\"principal\" ng-repeat=\"principal in items\" class=\"list-group-item\">\r\n                        <div style=\"display:inline-block; vertical-align:middle\" class=\"presence\" wizdom365-presence-picture=\"\" size=\"AVATAR\" accountname=\"principal.loginName\" name=\"principal.principalID\"></div>\r\n                        <span class=\"text-primary\" ng-bind-html=\"principal.displayName | mentioHighlight:typedTerm:\'menu-highlighted\' | unsafe\"></span>\r\n                    </li>\r\n                </ul>\r\n            </script>\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n            <div class=\"form-group col-md-6\">\r\n                <label for=\"startDate\">{{\'Start date\' | translate}}</label>\r\n                <div style=\"margin-top:-30px;\" wizdom365-datetime-picker=\"\" disable-previously-dates=\"true\" date=\"startDate\" disable-weekends=\"false\" show-date-picker=\"true\" show-time-picker=\"true\"></div>\r\n            </div>\r\n\r\n            <div class=\"form-group col-md-6\">\r\n                <label for=\"endDate\">{{\'End date\' | translate}}</label>\r\n                <div style=\"margin-top:-30px;\" wizdom365-datetime-picker=\"\" min-date=\"startDate\" date=\"endDate\" disable-weekends=\"false\" show-date-picker=\"true\" show-time-picker=\"true\"></div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"form-group\" ng-show=\"selectedcontenttype.metaData.useAlternativeAuthor\">\r\n            <label>{{\'Alternate author\' | translate}}</label> &nbsp;&nbsp;\r\n            <span ng-show=\"altAuthor != null\">\r\n                {{(altAuthor.category? \'(\'+altAuthor.category+\') \':\'\')}}{{altAuthor.displayName}}<span ng-if=\"altAuthor.loginName\">&nbsp;&lt;{{altAuthor.loginName}}&gt;</span> <b class=\"text-danger pointer\" ng-click=\"removeAltAuthor();\" ng-show=\"altAuthor != null\">{{\'Remove\' | translate}}</b>\r\n            </span>\r\n            <div ng-show=\"altAuthor == null\">\r\n\r\n                <input type=\"text\" ng-model=\"asyncSelected\" \r\n                       placeholder=\"{{\'Select alternate author\' | translate}}\" \r\n                       typeahead-on-select=\"addAltAuthor($item, $model, $label);\" \r\n                       typeahead=\"user as (user.category? \'(\'+user.category+\') \':\'\')+user.displayName + (user.loginName ? \' - \' + user.loginName : \'\') for user in searchForPrincipal($viewValue,true) | limitTo:5\" typeahead-loading=\"loadingLocations\" typeahead-template-url=\"customTemplate.html\" class=\"form-control\" typeahead-min-length=\"2\">\r\n                <i ng-show=\"loadingLocations\" class=\"glyphicon glyphicon-refresh\"></i>\r\n            </div>\r\n            <script type=\"text/ng-template\" id=\"customTemplate.html\">\r\n                <a>\r\n                    <div style=\"display:inline-block; vertical-align:middle\" class=\"presence\" wizdom365-presence-picture=\"\" size=\"AVATAR\" accountname=\"match.model.loginName\" name=\"match.model.principalID\"></div>\r\n                    <span bind-html-unsafe=\"match.label | typeaheadHighlight:query\"></span>\r\n                </a>\r\n            </script>\r\n        </div>\r\n\r\n        <div class=\"checkbox form-group\" ng-show=\"socialFeatureEnabled\">\r\n            <label>\r\n                <input type=\"checkbox\" ng-model=\"allowComments\" />{{\'Allow social (likes and comments)\' | translate}}</label>\r\n        </div>\r\n\r\n    </form>\r\n</div>\r\n");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/Overview/cards.html","<div class=\"noticeboard-template-default\">\r\n <!-- top control content -->\r\n\r\n <div class=\"topIconBar {{view.extendedProperties.hideToolbar ? \'topIconBarWithNoToolbar\' : \'topIconBarWithToolbar\'}}\">\r\n  <div ng-if=\"view\">\r\n\r\n   <div class=\"topIconBarLeftSection\">\r\n    <span ng-hide=\"selection==\'Mine\'\" class=\"hidden-xs\">\r\n     <a class=\"unreadCommentsLink\" ng-click=\"toggleDisplayMode()\" title=\"{{\'Unread elements\' | translate}}{{unreadActionTooltip}}\">\r\n      <span class=\"badge\" title=\"{{\'Unread elements\' | translate}}\" ng-hide=\"unreadNewsCount == \'\'\">{{unreadNewsCount}}</span>\r\n      {{\'Unread elements\' | translate}}\r\n     </a>\r\n    </span>\r\n    &nbsp;\r\n    <span ng-if=\"socialFeatureEnabled\" ng-hide=\"selection == \'Mine\'\" class=\"hidden-xs\">\r\n     <a class=\"unreadCommentsLink\" ng-click=\"showUnreadComments();\" title=\"{{\'Unread comments\' | translate}}\">\r\n      <span class=\"badge\" title=\"{{\'Unread comments\' | translate}}\" ng-hide=\"unreadCommentsCount == \'\'\">{{unreadCommentsCount}}</span>\r\n      {{\'Unread comments\' | translate}}\r\n     </a>\r\n    </span>\r\n   </div>\r\n\r\n   <div class=\"topIconBarRightSection\">\r\n    <div class=\"btn-group\" ng-show=\"!view.extendedProperties.hideToolbar\">\r\n     <div dropdown>\r\n\r\n      <span class=\"wt-linkText\" ng-click=\"createNews()\" title=\"{{\'Create\' | translate}}\">\r\n       <span class=\"wt-linkText wizdom-icon icon-plus wt-icon\" style=\"\" title=\"{{\'Create\' | translate}}\">\r\n        <span class=\"hidden-xs\">{{\'Create\' | translate}}</span>\r\n       </span>\r\n      </span>\r\n      <span class=\"topIconsSpacing\"></span>\r\n      <span class=\"archiveLinkDiv\">\r\n       <span class=\"wt-linkText wizdom-icon icon-cabinet wt-icon\" title=\"{{\'Archive\' | translate}}\" ng-click=\"goToArchive()\" ng-if=\"archiveLink\" aria-hidden=\"true\">\r\n        <span class=\"hidden-xs\">{{\'Archive\' | translate}}</span>\r\n       </span>\r\n      </span>\r\n      <span class=\"topIconsSpacing\"></span>\r\n      <span class=\"wt-linkText settingsLinkDiv\" dropdown-toggle ng-click=\"showSettings = !showSettings\" aria-expanded=\"false\" title=\"{{\'Settings\' | translate}}\">\r\n       <span class=\"wt-linkText glyphicon glyphicon-cog\" title=\"{{\'Settings\' | translate}}\"><span class=\"hidden-xs\">{{\'Settings\' | translate}}</span></span>\r\n      </span>\r\n      <ul class=\"dropdown-menu pull-right\" role=\"menu\">\r\n       <li ng-class=\"{active: selection==\'Unread\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Unread\')\">{{\'Show unread\' | translate}}</a></li>\r\n       <li ng-class=\"{active: selection==\'All\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'All\')\">{{\'Show all\' | translate}}</a></li>\r\n       <li ng-class=\"{active: selection==\'Mine\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Mine\')\">{{\'Show my\' | translate}}</a></li>\r\n       <li class=\"divider\"></li>\r\n       <li><a href=\"\" ng-click=\"selectPersonalChannels()\">{{\'Choose channels\' | translate}}</a></li>\r\n       <li><a href=\"\" ng-click=\"changeReadStatusForAll()\">{{\'Mark all as read\' | translate}}</a></li>\r\n      </ul>\r\n     </div>\r\n    </div>\r\n   </div>\r\n\r\n  </div>\r\n </div>\r\n    <div ng-show=\"!autoUpdatesRunning || restartingTimer\" ng-click=\"reStartAutoUpdateTimer();\" class=\"checkForNewPosts\">\r\n        <span class=\"badge\">\r\n            <span class=\"glyphicons glyphicons-refresh\">{{restartingTimer ? \'Checking\':\'Check for new posts\' | translate}}</span>\r\n        </span>\r\n    </div>\r\n <!-- main content -->\r\n\r\n <div class=\"container-fluid\">\r\n  <div vertilize-container class=\"row\">\r\n   <!-- Card Projects -->\r\n   <div ng-repeat=\"item in items | filter: filter\" class=\"col-xs-12 col-sm-6 col-md-4 col-lg-3\">\r\n    <div class=\"card\">\r\n     <div vertilize class=\"card-responsive\">\r\n      <div class=\"card-image\">\r\n\r\n       <div ng-if=\"item.contentType && item.metadata && item.contentType.name.indexOf(\'Video\') >= 0 && item.metadata.link\"\r\n         wizdom365-video-player\r\n         videolink=\"item.metadata.link\"\r\n         thumbnail=\"item.metadata.videoImage\">\r\n       </div>\r\n       <img ng-click=\"showPicture(item.metadata.picture)\" class=\"img-responsive cursor-pointer\"\r\n         ng-if=\"item.contentType && item.metadata && (item.contentType.name == \'News\' || item.contentType.name == \'RSS\') && item.metadata.picture\"\r\n         ng-src=\"{{item.metadata.picture}}\"\r\n         alt=\"...\" />\r\n\r\n       <!--<img class=\"img-responsive\" src=\"http://material-design.storage.googleapis.com/publish/v_2/material_ext_publish/0Bx4BSt6jniD7TDlCYzRROE84YWM/materialdesign_introduction.png\">-->\r\n       <span class=\"card-title\">\r\n        <a class=\"media-heading wd-noticeboard-media-heading\" href=\"\" ng-click=\"ShowItem(item.id)\" title=\"{{item.heading}}\">{{item.heading}}</a>\r\n       </span>\r\n      </div>\r\n      <div class=\"card-user\">\r\n       <div class=\"img-responsive userpic\"\r\n         wizdom365-presence-picture\r\n         size=\"AVATAR\"\r\n         accountname=\"item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName\"\r\n         name=\"item.alternateAuthor ? item.alternateAuthor.principalID : item.author.principalID\"\r\n         image=\"item.metadata.ImageUrl\">\r\n       </div>\r\n      </div>\r\n      <div class=\"card-content\">\r\n       <p ng-bind-html=\"item.content | wizdom365SmartHtmlStrip:300\" ng-click=\"ShowItem(item.id)\" style=\"cursor: pointer;\"></p>\r\n      </div>\r\n      <div class=\"card-action\">\r\n       <a href=\"#\" target=\"new_blank\">Link</a>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n\r\n <!--<div class=\"wd-noticeboard-results wizdom-fullwidth media-list\" ng-if=\"view\">\r\n  <div ng-repeat=\"item in items | filter: filter\" class=\"NoticeBoardItem\">\r\n   <div class=\"media wd-noticeboard-media {{(item.isRead ? \'wd-noticeboard-mediaRead\' : \'wd-noticeboard-mediaUnread\')}}\">\r\n    <div class=\"media-left\">\r\n     <div class=\"presence media-object\"\r\n       wizdom365-presence-picture\r\n       size=\"AVATAR\"\r\n       accountname=\"item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName\"\r\n       name=\"item.alternateAuthor ? item.alternateAuthor.principalID : item.author.principalID\"\r\n       image=\"item.metadata.ImageUrl\">\r\n     </div>\r\n    </div>\r\n    <div class=\"media-body\">\r\n     <div class=\"container-fluid\">\r\n      <div class=\"row\">\r\n       <div class=\"col-xs-12 mediaAdjustablePadding\">\r\n        <div class=\"mobile-heading noticeboard-authorRow\">\r\n         <span class=\"presence media-object text-muted\"\r\n            wizdom365-presence-picture\r\n            size=\"SMALL\"\r\n            type=\"defaultrender\"\r\n            accountname=\"item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName\"\r\n            image=\"item.metadata.ImageUrl\"\r\n            name=\"item.alternateAuthor ? ((\'on behalf of: \' | translate) + item.alternateAuthor.displayName) : item.author.displayName\">\r\n         </span>\r\n         <span class=\"text-muted\"> | </span>\r\n         <span class=\"text-muted text-center\" am-time-ago=\"(item.startDate | wizdom365FormatDate)\"></span>\r\n         <span class=\"pull-right markReadUnreadSection\">\r\n          <span ng-show=\"item.isRead\">\r\n           <span class=\"wt-linkText hidden-xs\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as unread\' | translate}}\">{{\'Mark as unread\' | translate}}</span><i class=\"glyphicon glyphicon-check wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as unread\' | translate}}\"></i>\r\n          </span>\r\n          <span ng-hide=\"item.isRead\">\r\n           <span class=\"wt-linkText hidden-xs\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as read\' | translate}}\">{{\'Mark as read\' | translate}}</span><i class=\"glyphicon glyphicon-unchecked wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as read\' | translate}}\"></i>\r\n          </span>\r\n         </span>\r\n        </div>\r\n        <div class=\"noticeboard-media-headingRow\">\r\n         <a class=\"media-heading wd-noticeboard-media-heading\" href=\"\" ng-click=\"ShowItem(item.id)\" title=\"{{item.heading}}\">{{item.heading}}</a>\r\n        </div>\r\n        <div class=\"noticeboard-media-channelRow\">\r\n         <span class=\"text-muted\" ng-repeat=\"channel in item.channels\">{{channel.name}}<span ng-hide=\"$last\">, </span></span>\r\n        </div>\r\n        <div class=\"media noticeboard-media-TextRow\">\r\n         <div class=\"media-left\" ng-if=\"item.contentType && item.metadata\">\r\n          <div class=\"media-item\"\r\n            ng-if=\"item.contentType.name.indexOf(\'Video\') >= 0 && item.metadata.link\"\r\n            wizdom365-video-player\r\n            videolink=\"item.metadata.link\"\r\n            thumbnail=\"item.metadata.videoImage\">\r\n          </div>\r\n          <img class=\"media-item img-thumbnail img-responsive\"\r\n            ng-if=\"item.contentType.name == \'News\' && item.metadata.picture\"\r\n            ng-src=\"{{item.metadata.picture}}\"\r\n            alt=\"...\" />\r\n         </div>\r\n         <div class=\"media-body word-break\">\r\n          <p ng-bind-html=\"item.content | wizdom365SmartHtmlStrip:300\" ng-click=\"ShowItem(item.id)\" style=\"cursor: pointer;\"></p>\r\n          <p wizdom365-item-social-container\r\n             item=\"item\"\r\n             itemid=\"item.id\"\r\n             itemtype=\"item\"\r\n             tooltipposition=\"top\"\r\n             ng-if=\"socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnOldItems) || item.metadata.allowComments)\">\r\n          </p>\r\n         </div>\r\n         <div class=\"text-muted\"\r\n           ng-if=\"socialFeatureEnabled\"\r\n           item-social-preview\r\n           item=\"item\"\r\n           tooltipposition=\"top\">\r\n         </div>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </div>\r\n   <div>\r\n    <div data-wizdom365-comments-panel\r\n      data-item=\"item\"\r\n      itemid=\"item.id\"\r\n      itemtype=\"item\"\r\n      ng-if=\"socialFeatureEnabled && socialOverviewComments && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments)\">\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>-->\r\n <!-- paging content -->\r\n <div class=\"container-fluid wd-noticeboard-pagination-container wizdom-fullwidth text-center\" ng-if=\"view && count > view.extendedProperties.itemsPerPage\">\r\n  <div class=\"wd-noticeboard-pagination-inner-container row\">\r\n   <pagination total-items=\"count\"\r\n      ng-change=\"setPage(currentPage - 1)\"\r\n      ng-model=\"currentPage\"\r\n      items-per-page=\"view.extendedProperties.itemsPerPage\"\r\n      max-size=\"view.extendedProperties.maxNumberOfPages\"\r\n      boundary-links=\"true\"\r\n      previous-text=\"&lsaquo;\"\r\n      next-text=\"&rsaquo;\"\r\n      first-text=\"&laquo;\"\r\n      last-text=\"&raquo;\"></pagination>\r\n  </div>\r\n </div>\r\n\r\n</div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/Overview/clickList.html","<div class=\"noticeboard-template-default wizdom-fullview clickListV1\" ng-if=\"view && items.length>0\" click-list-animation>\r\n <div class=\"wd-noticeboard-results wizdom-fullwidth media-list\">\r\n  <div class=\"col-lg-6 visible-lg-block no-right-padding\">\r\n\r\n   <div ng-repeat=\"item in items | filter: filter\" class=\"imgpanel NoticeBoardItem\" ng-show=\"currentItemId == item.id || isFirstLoad(item, $index)\">\r\n    <img ng-click=\"showPicture(item.metadata.picture)\" class=\"media-item img-responsive cursor-pointer\"\r\n      ng-if=\"::((item.contentType.name == \'News\' || item.contentType.name == \'RSS\') && item.metadata.picture)\"\r\n      ng-src=\"{{::item.metadata.picture}}\"\r\n      alt=\"...\" />\r\n   </div>\r\n\r\n  </div>\r\n  <div class=\"col-xs-12 col-sm-12 col-md-12 col-lg-6 no-left-padding\">\r\n   <div ng-repeat=\"item in items | filter: filter\" class=\"NoticeBoardItemList\">\r\n    <div ng-click=\"showNewsItem(item)\" class=\"media wd-noticeboard-media {{((currentItemId == 0 && $index == 0) || currentItemId == item.id ? \'noticeboard-item-active\' : \'noticeboard-item\')}}\">\r\n     <div class=\"noticeboard-panel\" ng-class=\"{top: $index==0}\">\r\n      <a href=\"javascript:void(0);\">\r\n       <h2 class=\"noticeboard-item-click\" ng-show=\"(currentItemId == 0 && $index == 0) || currentItemId == item.id\" ng-click=\"ShowItem(item.id)\">{{::item.heading | wizdom365SmartHtmlStrip:60}}</h2>\r\n       <h2 class=\"noticeboard-item-nonclick\">{{::item.heading  | wizdom365SmartHtmlStrip:60}}</h2>\r\n       <div class=\"contents\">\r\n                                <p ng-click=\"ShowItem(item.id)\" ng-bind-html=\"::((item.content | wizdom365SmartHtmlStrip:75).toString() | checkForLongLinkText)\">\r\n                                </p>\r\n        <span ng-click=\"ShowItem(item.id)\" style=\"float:right;\"><i class=\"glyphicons glyphicons-chevron-right\"></i></span>\r\n        <div class=\"row bottom extended-info\">\r\n\r\n         <div class=\"col-md-6 no-left-padding no-right-padding\">\r\n          <span class=\"date\">\r\n           <i class=\"glyphicons glyphicons-clock\"></i> <span am-time-ago=\"::(item.startDate | wizdom365FormatDate)\"></span>\r\n          </span>\r\n         </div>\r\n         <div class=\"col-md-6 no-left-padding no-right-padding\">\r\n\r\n          <div class=\"channelsV1\">\r\n           <i class=\"glyphicons glyphicons-tag\"></i>\r\n           <span ng-repeat=\"channel in item.channels | limitTo:3\">\r\n            <span>{{::channel.name}}<span ng-hide=\"$last\">, </span></span>\r\n           </span>\r\n          </div>\r\n         </div>\r\n\r\n        </div>\r\n\r\n       </div>\r\n\r\n      </a>\r\n     </div>\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n\r\n</div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/Overview/default.html","<div class=\"noticeboard-template-default\">\r\n <!-- top control content -->\r\n\r\n <div class=\"topIconBar {{::view.extendedProperties.hideToolbar ? \'topIconBarWithNoToolbar\' : \'topIconBarWithToolbar\'}}\">\r\n  <div ng-if=\"view\">\r\n\r\n   <div class=\"topIconBarLeftSection\">\r\n    <span ng-hide=\"selection==\'Mine\'\" class=\"hidden-xs\">\r\n     <a class=\"unreadCommentsLink\" ng-click=\"toggleDisplayMode()\" title=\"{{\'Unread elements\' | translate}}{{unreadActionTooltip}}\">\r\n      <i class=\"glyphicon glyphicon-bell\"></i>\r\n      <span title=\"{{\'Unread elements\' | translate}}\">{{unreadNewsCount}}</span>\r\n     </a>\r\n    </span>\r\n    &nbsp;\r\n    <span ng-if=\"::socialFeatureEnabled\" ng-hide=\"selection == \'Mine\'\" class=\"hidden-xs\">\r\n     <a class=\"unreadCommentsLink\" ng-click=\"showUnreadComments();\" title=\"{{\'Unread comments\' | translate}}\">\r\n      <i class=\"glyphicon glyphicon-comment\"></i>\r\n      <span title=\"{{\'Unread comments\' | translate}}\">{{unreadCommentsCount}}</span>\r\n     </a>\r\n    </span>\r\n   </div>\r\n\r\n   <div class=\"topIconBarRightSection\">\r\n    <div class=\"btn-group\" ng-show=\"::!view.extendedProperties.hideToolbar\">\r\n     <div dropdown>\r\n\r\n      <span class=\"wt-linkText\" ng-click=\"createNews()\" title=\"{{\'Create\' | translate}}\">\r\n       <span class=\"wt-linkText wizdom-icon icon-plus wt-icon\" style=\"\" title=\"{{\'Create\' | translate}}\">\r\n        <span class=\"hidden-xs\">{{\'Create\' | translate}}</span>\r\n       </span>\r\n      </span>\r\n      <span class=\"topIconsSpacing\"></span>\r\n      <span class=\"archiveLinkDiv\">\r\n       <span class=\"wt-linkText wizdom-icon icon-cabinet wt-icon\" title=\"{{\'Archive\' | translate}}\" ng-click=\"goToArchive()\" ng-if=\"::archiveLink\" aria-hidden=\"true\">\r\n        <span class=\"hidden-xs\">{{\'Archive\' | translate}}</span>\r\n       </span>\r\n      </span>\r\n      <span class=\"topIconsSpacing\"></span>\r\n      <span class=\"wt-linkText settingsLinkDiv\" dropdown-toggle ng-click=\"showSettings = !showSettings\" aria-expanded=\"false\" title=\"{{\'Settings\' | translate}}\">\r\n       <span class=\"wt-linkText glyphicon glyphicon-cog\" title=\"{{\'Settings\' | translate}}\"><span class=\"hidden-xs\">{{\'Settings\' | translate}}</span></span>\r\n      </span>\r\n      <ul class=\"dropdown-menu pull-right\" role=\"menu\">\r\n       <li ng-class=\"{active: selection==\'Unread\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Unread\')\">{{\'Show unread\' | translate}}</a></li>\r\n       <li ng-class=\"{active: selection==\'All\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'All\')\">{{\'Show all\' | translate}}</a></li>\r\n       <li ng-class=\"{active: selection==\'Mine\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Mine\')\">{{\'Show my\' | translate}}</a></li>\r\n       <li class=\"divider\"></li>\r\n       <li><a href=\"\" ng-click=\"selectPersonalChannels()\">{{\'Choose channels\' | translate}}</a></li>\r\n       <li><a href=\"\" ng-click=\"changeReadStatusForAll()\">{{\'Mark all as read\' | translate}}</a></li>\r\n      </ul>\r\n     </div>\r\n    </div>\r\n   </div>\r\n\r\n  </div>\r\n </div>\r\n\r\n    <div ng-show=\"!autoUpdatesRunning || restartingTimer\" ng-click=\"reStartAutoUpdateTimer();\" class=\"checkForNewPosts\">\r\n        <span class=\"badge\">\r\n            <span class=\"glyphicons glyphicons-refresh\">{{restartingTimer ? \'Checking\':\'Check for new posts\' | translate}}</span>\r\n        </span>\r\n    </div>\r\n <!-- main content -->\r\n\r\n <div class=\"wd-noticeboard-results wizdom-fullwidth media-list\" ng-if=\"view\">\r\n  <div ng-repeat=\"item in items | filter: filter\" class=\"NoticeBoardItem\">\r\n   <div class=\"media wd-noticeboard-media {{(item.isRead ? \'wd-noticeboard-mediaRead\' : \'wd-noticeboard-mediaUnread\')}}\">\r\n    <div class=\"media-left\">\r\n     <div class=\"presence media-object\"\r\n       wizdom365-presence-picture\r\n       size=\"AVATAR\"\r\n       accountname=\"::(item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName)\"\r\n       name=\"::(item.alternateAuthor ? item.alternateAuthor.principalID : item.author.principalID)\"\r\n       image=\"::item.metadata.ImageUrl\">\r\n     </div>\r\n    </div>\r\n    <div class=\"media-body\">\r\n     <div class=\"container-fluid\">\r\n      <div class=\"row\">\r\n       <div class=\"col-xs-12 mediaAdjustablePadding\">\r\n        <div class=\"mobile-heading noticeboard-authorRow\">\r\n         <span class=\"presence media-object text-muted\"\r\n            wizdom365-presence-picture\r\n            size=\"SMALL\"\r\n            type=\"defaultrender\"\r\n            accountname=\"::(item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName)\"\r\n            image=\"::item.metadata.ImageUrl\"\r\n            name=\"::(item.alternateAuthor ? ((\'on behalf of: \' | translate) + item.alternateAuthor.displayName) : item.author.displayName)\">\r\n         </span>\r\n         <span class=\"text-muted\"> | </span>\r\n         <span class=\"text-muted text-center\" am-time-ago=\"::(item.startDate | wizdom365FormatDate)\"></span>\r\n         <span class=\"pull-right markReadUnreadSection\">\r\n          <span ng-if=\"item.isRead\">\r\n           <span class=\"wt-linkText hidden-xs\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as unread\' | translate}}\">{{\'Read\' | translate}}</span><i class=\"glyphicon glyphicon-check wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{::\'Mark as unread\' | translate}}\"></i>\r\n          </span>\r\n          <span ng-if=\"!item.isRead\">\r\n           <span class=\"wt-linkText hidden-xs\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as read\' | translate}}\">{{\'Read\' | translate}}</span><i class=\"glyphicon glyphicon-unchecked wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{::\'Mark as read\' | translate}}\"></i>\r\n          </span>\r\n         </span>\r\n        </div>\r\n        <div class=\"noticeboard-media-headingRow\">\r\n         <a class=\"media-heading wd-noticeboard-media-heading\" href=\"\" ng-click=\"ShowItem(item.id)\" title=\"{{::item.heading}}\">{{::item.heading}}</a>\r\n        </div>\r\n        <div class=\"noticeboard-media-channelRow\">\r\n         <span class=\"text-muted\" ng-repeat=\"channel in item.channels\">{{::channel.name}}<span ng-hide=\"::$last\">, </span></span>\r\n        </div>\r\n        <div class=\"media noticeboard-media-TextRow\">\r\n         <div class=\"media-left\" ng-if=\"::(item.contentType && item.metadata)\">\r\n          <div class=\"media-item\"\r\n            ng-if=\"::(item.contentType.name.indexOf(\'Video\') >= 0 && item.metadata.link)\"\r\n            wizdom365-video-player\r\n            videolink=\"::item.metadata.link\"\r\n            thumbnail=\"::item.metadata.videoImage\">\r\n          </div>\r\n          <img ng-click=\"showPicture(item.metadata.picture)\" class=\"media-item img-thumbnail img-responsive cursor-pointer\"\r\n            ng-if=\"::((item.contentType.name == \'News\' || item.contentType.name == \'RSS\') && item.metadata.picture)\"\r\n            ng-src=\"{{::item.metadata.picture}}\"\r\n            alt=\"...\" />\r\n         </div>\r\n                                    <div class=\"media-body word-break\">\r\n                                        <p ng-bind-html=\"item.content | checkForLongLinkTextV2 : 300 : 45\" ng-click=\"ShowItem(item.id)\" style=\"cursor: pointer;\"></p>\r\n                                        <p wizdom365-item-social-container\r\n                                           item=\"::item\"\r\n                                           itemid=\"::item.id\"\r\n                                           itemtype=\"item\"\r\n                                           tooltipposition=\"top\"\r\n                                           template-url=\"::view.extendedProperties.socialSummaryTemplate\"\r\n                                           ng-if=\"::(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnOldItems) || item.metadata.allowComments))\">\r\n                                        </p>\r\n                                    </div>\r\n         <div class=\"text-muted\"\r\n           ng-if=\"::(socialFeatureEnabled && item)\"\r\n           item-social-preview\r\n           item=\"::item\"\r\n           tooltipposition=\"top\">\r\n         </div>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </div>\r\n   <div>\r\n    <div data-wizdom365-comments-panel\r\n      data-item=\"::item\"\r\n      itemid=\"::item.id\"\r\n      itemtype=\"item\"\r\n                     defaultfocus=\"true\"\r\n                     template-url=\"::view.extendedProperties.socialCommentsTemplate\"\r\n      ng-if=\"::(socialFeatureEnabled && socialOverviewComments && item && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\">\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n <!-- paging content -->\r\n <div class=\"container-fluid wd-noticeboard-pagination-container wizdom-fullwidth text-center\" ng-if=\"view && count > view.extendedProperties.itemsPerPage\">\r\n  <div class=\"wd-noticeboard-pagination-inner-container row\">\r\n   <pagination total-items=\"count\"\r\n      ng-change=\"setPage(currentPage - 1)\"\r\n      ng-model=\"currentPage\"\r\n      items-per-page=\"view.extendedProperties.itemsPerPage\"\r\n      max-size=\"view.extendedProperties.maxNumberOfPages\"\r\n      boundary-links=\"false\"\r\n      previous-text=\"&lsaquo;\"\r\n      next-text=\"&rsaquo;\"\r\n      first-text=\"&laquo;\"\r\n      last-text=\"&raquo;\"></pagination>\r\n  </div>\r\n </div>\r\n</div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/Overview/defaultSmall.html","<div class=\"noticeboard-template-small\">\r\n\r\n <!-- top control content -->\r\n\r\n <div class=\"topIconBar {{::view.extendedProperties.hideToolbar ? \'topIconBarWithNoToolbar\' : \'topIconBarWithToolbar\'}}\">\r\n  <div ng-if=\"view\">\r\n\r\n   <div class=\"btn-group pull-right\" style=\"display:inline;\" ng-show=\"::!view.extendedProperties.hideToolbar\">\r\n    <div dropdown>\r\n     <span class=\"wt-linkText\" ng-click=\"createNews()\" title=\"{{\'Create\' | translate}}\">\r\n      <span class=\"wt-linkText wizdom-icon icon-plus wt-icon\" style=\"\" title=\"{{\'Create\' | translate}}\">\r\n       <span class=\"hidden-xs\">{{\'Create\' | translate}}</span>\r\n      </span>\r\n     </span>\r\n     <span class=\"topIconsSpacing\"></span>\r\n     <span class=\"archiveLinkDiv\">\r\n      <span class=\"wt-linkText wizdom-icon icon-cabinet wt-icon\" title=\"{{\'Archive\' | translate}}\" ng-click=\"goToArchive()\" ng-if=\"::archiveLink\" aria-hidden=\"true\">\r\n       <span class=\"hidden-xs\">{{\'Archive\' | translate}}</span>\r\n      </span>\r\n     </span>\r\n     <span class=\"topIconsSpacing\"></span>\r\n     <span class=\"wt-linkText settingsLinkDiv\" dropdown-toggle ng-click=\"showSettings = !showSettings\" aria-expanded=\"false\" title=\"{{\'Settings\' | translate}}\">\r\n      <span class=\"wt-linkText glyphicon glyphicon-cog\" title=\"{{\'Settings\' | translate}}\"><span class=\"hidden-xs\">{{\'Settings\' | translate}}</span></span>\r\n     </span>\r\n     <ul class=\"dropdown-menu pull-right\" role=\"menu\">\r\n      <li ng-class=\"{active: selection==\'Unread\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Unread\')\">{{\'Show unread\' | translate}}</a></li>\r\n      <li ng-class=\"{active: selection==\'All\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'All\')\">{{\'Show all\' | translate}}</a></li>\r\n      <li ng-class=\"{active: selection==\'Mine\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Mine\')\">{{\'Show my\' | translate}}</a></li>\r\n      <li class=\"divider\"></li>\r\n      <li><a href=\"\" ng-click=\"selectPersonalChannels()\">{{\'Choose channels\' | translate}}</a></li>\r\n      <li><a href=\"\" ng-click=\"changeReadStatusForAll()\">{{\'Mark all as read\' | translate}}</a></li>\r\n     </ul>\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n    <div ng-show=\"!autoUpdatesRunning || restartingTimer\" ng-click=\"reStartAutoUpdateTimer();\" class=\"checkForNewPosts\">\r\n        <span class=\"badge\">\r\n            <span class=\"glyphicons glyphicons-refresh\">{{restartingTimer ? \'Checking\':\'Check for new posts\' | translate}}</span>\r\n        </span>\r\n    </div>\r\n <!-- main content -->\r\n\r\n <div class=\"wd-noticeboard-results wizdom-fullwidth media-list\" ng-if=\"view\">\r\n  <div ng-repeat=\"item in items | filter: filter\" class=\"NoticeBoardItem\">\r\n   <div class=\"media wd-noticeboard-media {{(item.isRead ? \'wd-noticeboard-mediaRead\' : \'wd-noticeboard-mediaUnread\')}}\">\r\n\r\n    <div class=\"media-body\">\r\n     <div class=\"container-fluid\">\r\n      <div class=\"row\">\r\n       <div class=\"col-xs-12 mediaAdjustablePadding\">\r\n        <div class=\"mobile-heading noticeboard-authorRow\">\r\n         <span class=\"presence media-object text-muted\"\r\n            wizdom365-presence-picture\r\n            size=\"SMALL\"\r\n            type=\"defaultrender\"\r\n            accountname=\"::(item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName)\"\r\n            name=\"::(item.alternateAuthor ? ((\'on behalf of: \' | translate) + item.alternateAuthor.displayName) : item.author.displayName)\">\r\n         </span>\r\n         <span class=\"text-muted\"> | </span>\r\n         <span class=\"text-muted text-center\" am-time-ago=\"::(item.startDate | wizdom365FormatDate)\"></span>\r\n         <span class=\"pull-right\">\r\n          <!--<span><a class=\"wizdom-link wizdom-icon ng-class:item.isRead ? \'icon-mail-read-1\' : \'icon-mail-1\'\" ng-click=\"changeReadStatus(item)\"></a></span>-->\r\n          <span ng-if=\"item.isRead\">\r\n           <i class=\"glyphicon glyphicon-check wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as unread\' | translate}}\"></i>\r\n          </span>\r\n          <span ng-if=\"!item.isRead\">\r\n           <i class=\"glyphicon glyphicon-unchecked wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as read\' | translate}}\"></i>\r\n          </span>\r\n         </span>\r\n\r\n        </div>\r\n        <div class=\"noticeboard-media-headingRow\">\r\n         <a class=\"media-heading wd-noticeboard-media-heading\" href=\"\" ng-click=\"ShowItem(item.id)\" title=\"{{::item.heading}}\">{{::item.heading}}</a>\r\n        </div>\r\n        <div class=\"noticeboard-media-channelRow\">\r\n         <span class=\"text-muted\" ng-repeat=\"channel in item.channels\">{{::channel.name}}<span ng-hide=\"::$last\">, </span></span>\r\n        </div>\r\n        <div class=\"media noticeboard-media-TextRow\">\r\n         <!--ng-show=\"item.metadata.picture || item.metadata.videoImage\"-->\r\n         <!-- ng-if=\"item.contentType.name == \'Video\' && item.metadata.videoImage\" -->\r\n         <!-- ng-if=\"item.contentType.name == \'News\' && item.metadata.picture\" -->\r\n         <div class=\"media-left\" ng-if=\"::(item.contentType && item.metadata)\">\r\n          <div class=\"media-item\"\r\n            ng-if=\"::(item.contentType.name.indexOf(\'Video\') >= 0 && item.metadata.link)\"\r\n            wizdom365-video-player\r\n            videolink=\"::item.metadata.link\"\r\n            thumbnail=\"::item.metadata.videoImage\">\r\n\r\n          </div>\r\n          <img ng-click=\"showPicture(item.metadata.picture)\" class=\"media-item img-thumbnail img-responsive cursor-pointer\"\r\n            ng-if=\"::((item.contentType.name == \'News\' || item.contentType.name == \'RSS\') && item.metadata.picture)\"\r\n            ng-src=\"{{::item.metadata.picture}}\"\r\n            alt=\"...\" />\r\n         </div>\r\n                                    <div class=\"media-body word-break\">\r\n                                        <p ng-bind-html=\"item.content | checkForLongLinkTextV2 : 200 : 45\" ng-click=\"ShowItem(item.id)\" style=\"cursor: pointer;\"></p>\r\n                                        <p wizdom365-item-social-container\r\n                                           item=\"::item\"\r\n                                           itemid=\"::item.id\"\r\n                                           itemtype=\"item\"\r\n                                           tooltipposition=\"top\"\r\n                                           template-url=\"::view.extendedProperties.socialSummaryTemplate\"\r\n                                           ng-if=\"::(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnOldItems) || item.metadata.allowComments))\">\r\n                                        </p>\r\n                                    </div>\r\n         <div class=\"text-muted\"\r\n           ng-if=\"::socialFeatureEnabled\"\r\n           item-social-preview\r\n           item=\"::item\"\r\n           tooltipposition=\"top\">\r\n         </div>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </div>\r\n   <div>\r\n    <div data-wizdom365-comments-panel\r\n      data-item=\"::item\"\r\n      itemid=\"::item.id\"\r\n      itemtype=\"item\"\r\n                     defaultfocus=\"true\"\r\n                     template-url=\"::view.extendedProperties.socialCommentsTemplate\"\r\n      ng-if=\"::(socialFeatureEnabled && socialOverviewComments && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\">\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n\r\n <!-- paging content -->\r\n\r\n <div class=\"container-fluid wd-noticeboard-pagination-container wizdom-fullwidth text-center\" ng-if=\"view && count > view.extendedProperties.itemsPerPage\">\r\n  <div class=\"wd-noticeboard-pagination-inner-container row\">\r\n   <pagination total-items=\"count\"\r\n      ng-change=\"setPage(currentPage - 1)\"\r\n      ng-model=\"currentPage\"\r\n      items-per-page=\"view.extendedProperties.itemsPerPage\"\r\n      max-size=\"view.extendedProperties.maxNumberOfPages\"\r\n      boundary-links=\"false\"\r\n      previous-text=\"&lsaquo;\"\r\n      next-text=\"&rsaquo;\"\r\n      first-text=\"&laquo;\"\r\n      last-text=\"&raquo;\"></pagination>\r\n  </div>\r\n </div>\r\n\r\n</div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/Overview/defaultSmall2.html","<div class=\"noticeboard-template-small v2\">\r\n\r\n <!-- top control content -->\r\n\r\n <div class=\"topIconBar {{::view.extendedProperties.hideToolbar ? \'topIconBarWithNoToolbar\' : \'topIconBarWithToolbar\'}}\">\r\n  <div ng-if=\"view\">\r\n\r\n   <div class=\"btn-group pull-right\" style=\"display:inline;\" ng-show=\"::!view.extendedProperties.hideToolbar\">\r\n    <div dropdown>\r\n     <span class=\"wt-linkText\" ng-click=\"createNews()\" title=\"{{\'Create\' | translate}}\">\r\n      <span class=\"wt-linkText wizdom-icon icon-plus wt-icon\" style=\"\" title=\"{{\'Create\' | translate}}\">\r\n       <span class=\"hidden-xs\">{{\'Create\' | translate}}</span>\r\n      </span>\r\n     </span>\r\n     <span class=\"topIconsSpacing\"></span>\r\n     <span class=\"archiveLinkDiv\">\r\n      <span class=\"wt-linkText wizdom-icon icon-cabinet wt-icon\" title=\"{{\'Archive\' | translate}}\" ng-click=\"goToArchive()\" ng-if=\"::archiveLink\" aria-hidden=\"true\">\r\n       <span class=\"hidden-xs\">{{\'Archive\' | translate}}</span>\r\n      </span>\r\n     </span>\r\n     <span class=\"topIconsSpacing\"></span>\r\n     <span class=\"wt-linkText settingsLinkDiv\" dropdown-toggle ng-click=\"showSettings = !showSettings\" aria-expanded=\"false\" title=\"{{\'Settings\' | translate}}\">\r\n      <span class=\"wt-linkText glyphicon glyphicon-cog\" title=\"{{\'Settings\' | translate}}\"><span class=\"hidden-xs\">{{\'Settings\' | translate}}</span></span>\r\n     </span>\r\n     <ul class=\"dropdown-menu pull-right\" role=\"menu\">\r\n      <li ng-class=\"{active: selection==\'Unread\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Unread\')\">{{\'Show unread\' | translate}}</a></li>\r\n      <li ng-class=\"{active: selection==\'All\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'All\')\">{{\'Show all\' | translate}}</a></li>\r\n      <li ng-class=\"{active: selection==\'Mine\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Mine\')\">{{\'Show my\' | translate}}</a></li>\r\n      <li class=\"divider\"></li>\r\n      <li><a href=\"\" ng-click=\"selectPersonalChannels()\">{{\'Choose channels\' | translate}}</a></li>\r\n      <li><a href=\"\" ng-click=\"changeReadStatusForAll()\">{{\'Mark all as read\' | translate}}</a></li>\r\n     </ul>\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n    <div ng-show=\"!autoUpdatesRunning || restartingTimer\" ng-click=\"reStartAutoUpdateTimer();\" class=\"checkForNewPosts\">\r\n        <span class=\"badge\">\r\n            <span class=\"glyphicons glyphicons-refresh\">{{restartingTimer ? \'Checking\':\'Check for new posts\' | translate}}</span>\r\n        </span>\r\n    </div>\r\n <!-- main content -->\r\n\r\n <div class=\"wd-noticeboard-results wizdom-fullwidth media-list\" ng-if=\"view\">\r\n  <div ng-repeat=\"item in items | filter: filter\" class=\"NoticeBoardItem\">\r\n   <div class=\"media wd-noticeboard-media {{(item.isRead ? \'wd-noticeboard-mediaRead\' : \'wd-noticeboard-mediaUnread\')}}\">\r\n\r\n    <div class=\"media-body\">\r\n     <div class=\"container-fluid\">\r\n      <div class=\"row\">\r\n       <div class=\"col-xs-12 mediaAdjustablePadding\">\r\n        <div class=\"mobile-heading noticeboard-authorRow\">\r\n         <span class=\"presence media-object text-muted\"\r\n            wizdom365-presence-picture\r\n            size=\"SMALL\"\r\n            type=\"defaultrender\"\r\n            accountname=\"::(item.alternateAuthor ? item.alternateAuthor.loginName : item.author.loginName)\"\r\n            name=\"::(item.alternateAuthor ? ((\'on behalf of: \' | translate) + item.alternateAuthor.displayName) : item.author.displayName)\">\r\n         </span>\r\n         <span class=\"text-muted\"> | </span>\r\n         <span class=\"text-muted text-center\" am-time-ago=\"::(item.startDate | wizdom365FormatDate)\"></span>\r\n         <span class=\"pull-right\">\r\n          <!--<span><a class=\"wizdom-link wizdom-icon ng-class:item.isRead ? \'icon-mail-read-1\' : \'icon-mail-1\'\" ng-click=\"changeReadStatus(item)\"></a></span>-->\r\n          <span ng-if=\"item.isRead\">\r\n           <i class=\"glyphicon glyphicon-check wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as unread\' | translate}}\"></i>\r\n          </span>\r\n          <span ng-if=\"!item.isRead\">\r\n           <i class=\"glyphicon glyphicon-unchecked wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as read\' | translate}}\"></i>\r\n          </span>\r\n         </span>\r\n\r\n        </div>\r\n        <div class=\"noticeboard-media-headingRow\">\r\n         <a class=\"media-heading wd-noticeboard-media-heading\" href=\"\" ng-click=\"ShowItem(item.id)\" title=\"{{::item.heading}}\">{{::item.heading}}</a>\r\n        </div>\r\n        <div class=\"noticeboard-media-channelRow\">\r\n         <span class=\"text-muted\" ng-repeat=\"channel in item.channels\">{{::channel.name}}<span ng-hide=\"::$last\">, </span></span>\r\n        </div>\r\n        <div class=\"media noticeboard-media-TextRow\">\r\n         <!--ng-show=\"item.metadata.picture || item.metadata.videoImage\"-->\r\n         <!-- ng-if=\"item.contentType.name == \'Video\' && item.metadata.videoImage\" -->\r\n         <!-- ng-if=\"item.contentType.name == \'News\' && item.metadata.picture\" -->\r\n         <div class=\"media-left\" ng-if=\"::(item.contentType && item.metadata)\">\r\n          <div class=\"media-item\"\r\n            ng-if=\"::(item.contentType.name.indexOf(\'Video\') >= 0 && item.metadata.link)\"\r\n            wizdom365-video-player\r\n            videolink=\"::item.metadata.link\"\r\n            thumbnail=\"::item.metadata.videoImage\">\r\n\r\n          </div>\r\n          <img ng-click=\"showPicture(item.metadata.picture)\" class=\"media-item img-thumbnail img-responsive cursor-pointer\"\r\n            ng-if=\"::((item.contentType.name == \'News\' || item.contentType.name == \'RSS\') && item.metadata.picture)\"\r\n            ng-src=\"{{::item.metadata.picture}}\"\r\n            alt=\"...\" />\r\n         </div>\r\n                                    <div class=\"media-body word-break\">\r\n                                        <p ng-bind-html=\"item.content | checkForLongLinkTextV2 : 100 : 45\" ng-click=\"ShowItem(item.id)\" style=\"cursor: pointer;\"></p>\r\n                                        <p wizdom365-item-social-container\r\n                                           item=\"item\"\r\n                                           itemid=\"item.id\"\r\n                                           itemtype=\"item\"\r\n                                           tooltipposition=\"top\"\r\n                                           template-url=\"::view.extendedProperties.socialSummaryTemplate\"\r\n                                           ng-if=\"::(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnOldItems) || item.metadata.allowComments))\">\r\n                                        </p>\r\n                                    </div>\r\n         <div class=\"text-muted\"\r\n           ng-if=\"::socialFeatureEnabled\"\r\n           item-social-preview\r\n           item=\"::item\"\r\n           tooltipposition=\"top\">\r\n         </div>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </div>\r\n   <div>\r\n    <div data-wizdom365-comments-panel\r\n      data-item=\"::item\"\r\n      itemid=\"::item.id\"\r\n      itemtype=\"item\"\r\n                     defaultfocus=\"true\"\r\n                     template-url=\"::view.extendedProperties.socialCommentsTemplate\"\r\n      ng-if=\"::(socialFeatureEnabled && socialOverviewComments && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\">\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n\r\n <!-- paging content -->\r\n\r\n <div class=\"container-fluid wd-noticeboard-pagination-container wizdom-fullwidth text-center\" ng-if=\"view && count > view.extendedProperties.itemsPerPage\">\r\n  <div class=\"wd-noticeboard-pagination-inner-container row\">\r\n   <pagination total-items=\"count\"\r\n      ng-change=\"setPage(currentPage - 1)\"\r\n      ng-model=\"currentPage\"\r\n      items-per-page=\"view.extendedProperties.itemsPerPage\"\r\n      max-size=\"5\"\r\n      boundary-links=\"false\"\r\n      previous-text=\"&lsaquo;\"\r\n      next-text=\"&rsaquo;\"\r\n      first-text=\"&laquo;\"\r\n      last-text=\"&raquo;\"></pagination>\r\n  </div>\r\n </div>\r\n\r\n</div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/Overview/onlyHeading.html","<div class=\"noticeboard-template-onlyHeading\">\r\n\r\n <!-- top control content -->\r\n\r\n <div class=\"topIconBar {{::view.extendedProperties.hideToolbar ? \'topIconBarWithNoToolbar\' : \'topIconBarWithToolbar\'}}\">\r\n  <div ng-if=\"view\">\r\n\r\n   <div class=\"btn-group pull-right\" style=\"display:inline;\" ng-show=\"::!view.extendedProperties.hideToolbar\">\r\n    <div dropdown>\r\n     <span class=\"wt-linkText\" ng-click=\"createNews()\" title=\"{{\'Create\' | translate}}\">\r\n      <span class=\"wt-linkText wizdom-icon icon-plus wt-icon\" style=\"\" title=\"{{\'Create\' | translate}}\">\r\n       <span class=\"hidden-xs\">{{\'Create\' | translate}}</span>\r\n      </span>\r\n     </span>\r\n     <span class=\"topIconsSpacing\"></span>\r\n     <span class=\"archiveLinkDiv\">\r\n      <span class=\"wt-linkText wizdom-icon icon-cabinet wt-icon\" title=\"{{\'Archive\' | translate}}\" ng-click=\"goToArchive()\" ng-if=\"::archiveLink\" aria-hidden=\"true\">\r\n       <span class=\"hidden-xs\">{{\'Archive\' | translate}}</span>\r\n      </span>\r\n     </span>\r\n     <span class=\"topIconsSpacing\"></span>\r\n     <span class=\"wt-linkText settingsLinkDiv\" dropdown-toggle ng-click=\"showSettings = !showSettings\" aria-expanded=\"false\" title=\"{{\'Settings\' | translate}}\">\r\n      <span class=\"wt-linkText glyphicon glyphicon-cog\" title=\"{{\'Settings\' | translate}}\"><span class=\"hidden-xs\">{{\'Settings\' | translate}}</span></span>\r\n     </span>\r\n     <ul class=\"dropdown-menu pull-right\" role=\"menu\">\r\n      <li ng-class=\"{active: selection==\'Unread\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Unread\')\">{{\'Show unread\' | translate}}</a></li>\r\n      <li ng-class=\"{active: selection==\'All\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'All\')\">{{\'Show all\' | translate}}</a></li>\r\n      <li ng-class=\"{active: selection==\'Mine\'}\"><a href=\"\" ng-click=\"changeDisplayMode(\'Mine\')\">{{\'Show my\' | translate}}</a></li>\r\n      <li class=\"divider\"></li>\r\n      <li><a href=\"\" ng-click=\"selectPersonalChannels()\">{{\'Choose channels\' | translate}}</a></li>\r\n      <li><a href=\"\" ng-click=\"changeReadStatusForAll()\">{{\'Mark all as read\' | translate}}</a></li>\r\n     </ul>\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n    <div ng-show=\"!autoUpdatesRunning || restartingTimer\" ng-click=\"reStartAutoUpdateTimer();\" class=\"checkForNewPosts\">\r\n        <span class=\"badge\">\r\n            <span class=\"glyphicons glyphicons-refresh\">{{restartingTimer ? \'Checking\':\'Check for new posts\' | translate}}</span>\r\n        </span>\r\n    </div>\r\n <!-- main content -->\r\n\r\n <div class=\"wd-noticeboard-results wizdom-fullwidth media-list\" ng-if=\"view\">\r\n  <div ng-repeat=\"item in items | filter: filter\" class=\"NoticeBoardItem\">\r\n   <div class=\"media wd-noticeboard-media {{(item.isRead ? \'wd-noticeboard-mediaRead\' : \'wd-noticeboard-mediaUnread\')}}\">\r\n\r\n    <div class=\"media-body\">\r\n     <div class=\"container-fluid\">\r\n      <div class=\"row\">\r\n       <div class=\"col-xs-12 mediaAdjustablePadding\">\r\n        <div class=\"noticeboard-media-headingRow\">\r\n         <a class=\"media-heading wd-noticeboard-media-heading\" href=\"\" ng-click=\"ShowItem(item.id)\" title=\"{{::item.heading}}\">{{::item.heading}}</a>\r\n         <span class=\"pull-right\">\r\n          <span ng-if=\"item.isRead\">\r\n           <i class=\"glyphicon glyphicon-check wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as unread\' | translate}}\"></i>\r\n          </span>\r\n          <span ng-if=\"!item.isRead\">\r\n           <i class=\"glyphicon glyphicon-unchecked wt-linkText wt-checkUncheck\" ng-click=\"changeReadStatus(item)\" title=\"{{\'Mark as read\' | translate}}\"></i>\r\n          </span>\r\n         </span>\r\n        </div>\r\n       </div>\r\n      </div>\r\n     </div>\r\n    </div>\r\n   </div>\r\n  </div>\r\n </div>\r\n\r\n <!-- paging content -->\r\n\r\n <div class=\"container-fluid wd-noticeboard-pagination-container wizdom-fullwidth text-center\" ng-if=\"view && count > view.extendedProperties.itemsPerPage\">\r\n  <div class=\"wd-noticeboard-pagination-inner-container row\">\r\n   <pagination total-items=\"count\"\r\n      ng-change=\"setPage(currentPage - 1)\"\r\n      ng-model=\"currentPage\"\r\n      items-per-page=\"view.extendedProperties.itemsPerPage\"\r\n      max-size=\"5\"\r\n      boundary-links=\"false\"\r\n      previous-text=\"&lsaquo;\"\r\n      next-text=\"&rsaquo;\"\r\n      first-text=\"&laquo;\"\r\n      last-text=\"&raquo;\"></pagination>\r\n  </div>\r\n </div>\r\n\r\n</div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/ShowItem/default.html","<div class=\"modal-header\">\r\n    <button type=\"button\" class=\"close closebtn\" data-ng-click=\"cancel()\" aria-hidden=\"true\">&times;</button>\r\n\r\n    <div class=\"modal-body\" ng-if=\"!dataReady\">\r\n        {{\'loading...\' | translate}}\r\n    </div>\r\n\r\n    <div class=\"row\" ng-hide=\"!dataReady\">\r\n        <div wizdom365-pagetranslation></div>\r\n        <div class=\"pull-left col-sm-5 hidden-xs\">\r\n            <button type=\"button\"\r\n                    class=\"btn btn-default\"\r\n                    ng-click=\"loadItem(backId)\"\r\n                    ng-disabled=\"dataReady && backId==null\">\r\n                {{\'Previous\' | translate}}\r\n            </button>\r\n            <div style=\"width:5px;display:inline-block;\">&nbsp;</div>\r\n            <button type=\"button\"\r\n                    class=\"btn btn-default\"\r\n                    ng-click=\"loadItem(forwardId)\"\r\n                    ng-disabled=\"dataReady && forwardId==null\">\r\n                {{\'Next\' | translate}}\r\n            </button>\r\n            <div style=\"width:5px;display:inline-block;\">&nbsp;</div>\r\n        </div>\r\n        <div ng-if=\"!shouldNotMarkRead\" class=\"markAsReadSection pull-right\">\r\n            <div class=\"shareItemDiv\">\r\n                <input class=\"shareLinkInput\" type=\"text\" focus-me=\"showShareLink\" ng-show=\"showShareLink\" ng-model=\"item.shareLinkUrl\" readonly />\r\n                <span ng-click=\"showShareLink = !showShareLink\">\r\n                    <i class=\"glyphicon glyphicon-share wt-icon\" title=\"{{\'Share\' | translate}}\"></i>\r\n                    <span class=\"wt-linkText\" title=\"{{\'Share\' | translate}}\">{{\'Share\' | translate}}</span>\r\n                </span>\r\n            </div>\r\n            <span class=\"headerLinkSpacer\"></span>\r\n            <div class=\"editItemDiv\" ng-if=\"item.canEdit\">\r\n                <i class=\"glyphicon glyphicon-pencil wt-icon\" ng-click=\"editNewsItem(item.id)\" title=\"{{\'Edit\' | translate}}\"></i>\r\n                <span class=\"wt-linkText\" ng-click=\"editNewsItem(item.id)\" title=\"{{\'Edit\' | translate}}\">{{\'Edit\' | translate}}</span>\r\n            </div>\r\n            <span class=\"headerLinkSpacer\"></span>\r\n            <div class=\"printItemDiv\">\r\n                <i class=\"glyphicon glyphicon-print wt-icon\" ng-click=\"print()\" title=\"{{\'Print\' | translate}}\"></i>\r\n                <span class=\"wt-linkText\" ng-click=\"print()\" title=\"{{\'Print\' | translate}}\">{{\'Print\' | translate}}</span>\r\n            </div>\r\n            <span class=\"headerLinkSpacer\"></span>\r\n            <div class=\"checkboxReadUnread\"\r\n                 ng-click=\"markRead ? unReadStatus() : readStatus()\">\r\n                <i class=\"glyphicon wt-linkText wt-checkUncheck\"\r\n                   style=\"color:white;\"\r\n                   ng-class=\"{\'glyphicon-check\': markRead, \'glyphicon-unchecked\': !markRead}\"\r\n                   title=\"{{(markRead ?  \'Mark as unread\' : \'Mark as read\') | translate}}\"></i>\r\n                <span title=\"{{(markRead ?  \'Mark as unread\' : \'Mark as read\') | translate}}\">{{\'Read\' | translate}}</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal-body\" ng-if=\"dataReady\">\r\n    <div class=\"noticeboard-showitem\">\r\n        <div wizdom-include=\"template\"></div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal-footer wd-noticeboard text-left\" ng-if=\"::(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\" ng-show=\"dataReady\">\r\n    <div data-wizdom365-comments-panel data-item=\"item\" itemid=\"item.id\" itemtype=\"item\" defaultfocus=\"false\" template-url=\"webpartProperties.extendedProperties.socialCommentsTemplate\"></div>\r\n</div>\r\n\r\n");$templateCache.put("Wizdom365/Templates/ViewTemplates/Social/CommentsPanel/CommentsPanel.html","<div class=\"wd-noticeboard-comments-panel\" ng-show=\"showComments\" style=\"padding:10px 0 10px 10px;border:none;\">\r\n    <div class=\"comment-item\" ng-repeat=\"comment in comments | orderBy:datePosted:true\">\r\n        <div class=\"commentItemContainer comment-level-1\" wizdom-include=\"\'commentItem\'\"></div>\r\n    </div>\r\n    <script type=\"text/ng-template\" id=\"/customTemplate.html\">\r\n        <ul class=\"list-group user-search\" style=\"padding-left:0\">\r\n            <li class=\"list-group-item\" mentio-menu-item=\"principal\" ng-repeat=\"principal in items\">\r\n                <div style=\"display:inline-block; vertical-align:middle\"\r\n                     class=\"presence\"\r\n                     wizdom365-presence-picture\r\n                     size=\"AVATAR\"\r\n                     accountname=\"principal.loginName\"\r\n                     name=\"principal.principalID\">\r\n                </div>\r\n                <span class=\"text-primary\" ng-bind-html=\"principal.displayName | mentioHighlight:typedTerm:\'menu-highlighted\' | unsafe\"></span>\r\n            </li>\r\n        </ul>\r\n    </script>\r\n    <script type=\"text/ng-template\" id=\"commentItem\">\r\n        <div class=\"media\" style=\"border-bottom:none;\"\r\n             ng-class=\"{commentItemHover: hover}\" ng-mouseenter=\"hover = true\" ng-mouseleave=\"hover = false\" ng-show=\"comment.author\">\r\n            <div class=\"media-left\">\r\n                <div class=\"presence media-object\"\r\n                     wizdom365-presence-picture\r\n                     size=\"AVATAR\"\r\n                     accountname=\"comment.author.loginName\"\r\n                     name=\"comment.author.displayName\">\r\n                </div>\r\n            </div>\r\n            <div class=\"media-body\">\r\n                <div class=\"normal-mode\" ng-hide=\"comment.editing\">\r\n                    <div class=\"container-fluid\" style=\"padding-left:10px;\">\r\n                        <div class=\"comments-author-content\">\r\n                            <a>\r\n                                <span class=\"presence text-center\"\r\n                                      wizdom365-presence-picture\r\n                                      type=\"defaultrender\"\r\n                                      size=\"SMALL\"\r\n                                      accountname=\"comment.author.loginName\"\r\n                                      name=\"comment.author.displayName\"></span>\r\n                            </a><br/>\r\n                            <span class=\"previewTextPosted pre\" ng-if=\"(comment.status != 2)\" ng-bind-html=\"(comment.content | linky:\'_blank\' | checkForLongLinks | wizdom365TrustHtml)\"></span>\r\n                        </div>\r\n                        <a ng-click=\"showPicture(comment.picture)\" href=\"#\" ng-if=\"(comment.picture && comment.status != 2)\">\r\n                            <img class=\"comment-picture\"\r\n                                 ng-src=\"{{comment.picture}}\"\r\n                                 ng-if=\"(comment.picture && comment.status != 2)\" />\r\n                        </a>\r\n                        <span data-wizdom365-link-preview\r\n                              ng-if=\"(comment.preview && comment.previewMetadata && comment.status != 2)\"\r\n                              data-link-metadata=\"comment.previewMetadata\">\r\n                        </span>\r\n\r\n                        <div class=\"previewTextPostedEmpty\" ng-if=\"comment.status == 2\"></div>\r\n                        <div class=\"socialPanel previewTextPosted\">\r\n                            <small>\r\n                                <a class=\"wizdom-link\" ng-click=\"comment.status != 2 && likeItem(comment);\" tooltip-html-unsafe=\"{{getTooltipText(comment)}}\" ng-style=\"{\'color\':comment.isLiked?\'#0078d7\':\'#666666\', \'cursor\':comment.status == 2?\'not-allowed\':\'pointer\'}\">\r\n                                    <span class=\"wizdom-icon icon-hand-like-2\" ng-style=\"{\'color\':comment.isLiked?\'#0078d7\':\'#a6a6a6\'}\"></span> {{comment.likes.length}}\r\n                                </a>\r\n                                <a ng-if=\"comment.childCommentsCount >0\" class=\"wizdom-link\" title=\"{{\'Number of comments\' | translate}}\" style=\"color:#0078d7;\" ng-style=\"{\'cursor\':comment.status == 2?\'not-allowed\':\'pointer\'}\">\r\n                                    <span class=\"wizdom-icon icon-bubble-2\" style=\"color:#0078d7;\"></span> {{comment.childCommentsCount}}\r\n                                </a>\r\n                                <span> &bull; </span>\r\n                                <a ng-if=\"comment.level+1 < allowedlevel\" href=\"\" ng-click=\"comment.status != 2 && addComment(comment);\" ng-attr-title=\"{{\'Reply\' | translate }}\" style=\"color:#0078d7\" ng-style=\"{\'cursor\':comment.status == 2?\'not-allowed\':\'pointer\'}\">{{ \'Reply\' | translate }}</a>\r\n                                <span ng-if=\"comment.level+1 < allowedlevel\"> &bull; </span>\r\n                                <i class=\"glyphicon glyphicon-time\"></i>\r\n                                <span am-time-ago=\"(comment.status == 1 ? comment.dateModified : comment.datePosted | wizdom365FormatDate)\"></span>\r\n                                <span ng-if=\"comment.status != 0\">{{getCommentDetails(comment)}} <span>&bull;</span></span>\r\n                            </small>\r\n                        </div>\r\n                        <div class=\"commentItem-action\">\r\n                            <label ng-if=\"comment.status != 2 && comment.canDelete\" style=\"cursor: pointer;\"><span class=\"glyphicon glyphicon-remove\" ng-click=\"deleteComment(comment);\" title=\"{{\'Delete\' | translate}}\"></span></label>\r\n                            <label ng-if=\"comment.status != 2 && comment.canEdit\" style=\"cursor: pointer;\"><span class=\"glyphicon glyphicon-pencil\" ng-click=\"editComment(comment);\" title=\"{{\'Edit\' | translate}}\"></span></label>\r\n                            <label ng-if=\"comment.preview && comment.previewMetadata && comment.status != 2 && comment.canEdit\" style=\"cursor: pointer;\"><span class=\"glyphicon glyphicon-ban-circle\" ng-click=\"removePreview(comment);\" title=\"{{\'Remove Preview\' | translate }}\"></span></label>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"edit-mode\" ng-show=\"comment.editing\">\r\n                    <div class=\"edit-comment-panel row\" style=\"padding-top:2px;margin-left:0;margin-right:0;\">\r\n                        <div class=\"edit-comment-placeholder\">\r\n                            <div class=\"container-fluid\">\r\n                                <div class=\"row\">\r\n                                    <div class=\"edit-comment col-sm-12\">\r\n                                        <textarea class=\"edit-comment-textarea txtComment_{{$index}}_{{autofocus ? \'\' : \'manualfocus\'}}\" ng-style=\"{\'min-height\':comment.targetID==itemid? \'52px\': \'none\'}\"\r\n                                                  rows=\"{{comment.rows}}\"\r\n                                                  auto-expand\r\n                                                  ng-keypress=\"keypress($event,comment)\"\r\n                                                  ng-model=\"comment.editingContent\"\r\n                                                  ng-focus=\"(autofocus && comment.editing) || (comment.editing && !$index == 0)\"\r\n                                                  id=\"txtComment\"\r\n                                                  wizdom365-set-focus=\"(autofocus && comment.editing) || (comment.editing && !$index == 0)\"\r\n                                                  ng-attr-placeholder=\"{{\'Write a comment...\' | translate}}\"\r\n                                                  mentio\r\n                                                  mentio-trigger-char=\"\'@\'\"\r\n                                                  mentio-require-leading-space=\"true\"\r\n                                                  mentio-items=\"searchPrincipals\"\r\n                                                  mentio-template-url=\"/customTemplate.html\"\r\n                                                  mentio-search=\"searchForPrincipal(term)\"\r\n                                                  mentio-select=\"selectUser(item)\"\r\n                                                  ng-model-options=\"{ debounce: 800 }\"\r\n                                                  style=\"padding-right: 97px!important;min-height: 52px;\"></textarea>\r\n\r\n                                        <div style=\"position: absolute; right: 0px;top: 0px;height:44px;\">\r\n                                            <a style=\"float:right;margin-top:2px;\" href=\"\" ng-click=\"cancelEdit(comment)\" ng-hide=\"comment.commentID==0 && comment.targetID==itemid\" title=\"{{\'Cancel Edit\' | translate}}\">\r\n                                                <span class=\"glyphicon glyphicon-remove\"></span>\r\n                                            </a>\r\n                                            <a style=\"position:relative; height: 44px;\" class=\"wizdom-link\" title=\"Picture\">\r\n                                                <wizdom365-image-picker ng-model=\"comment.selectedImage\" imageclass=\"picture\" imagecolor=\"#a6a6a6\" style=\"height: 44px!important; max-height: 44px!important; position: absolute; width: 98px!important; margin-top: 5px; right: 7px;\"></wizdom365-image-picker>\r\n                                            </a>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"row\" style=\"margin-bottom:5px;\">\r\n                                    <div class=\"edit-comment edit-comment-controls\" style=\"margin:5px 0; padding:0 10px;\">\r\n                                        <button type=\"button\" class=\"btn btn-primary pull-left wiz-btn-padding\" ng-disabled=\"loading\" ng-click=\"postComment(comment);\">{{(comment.commentID >0 ? \'Save Changes\' : \'Add\') | translate}}</button>\r\n                                    </div>\r\n                                    <div ng-show=\"comment.commentSaving == \'loading\'\" class=\"edit-comment edit-comment-controls pull-left\">\r\n                                        <div class=\"pull-left padding\">\r\n                                            <div class=\"edit-comment edit-comment-controls\">\r\n                                                <div class=\"loader\" />\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"row\" style=\"margin-left:0;\">\r\n                                    <div class=\"selected-image\" ng-if=\"comment.selectedImage\">\r\n                                        <img ng-src=\"{{comment.selectedImage}}\" style=\"max-width: 200px;\" />\r\n                                        <a href=\"\" ng-click=\"removeImage(comment)\" aria-hidden=\"true\"><span class=\"glyphicon glyphicon-remove\"></span></a>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div ng-show=\"comment.editing && comment.targetID == itemid\">\r\n                <div ng-if=\"comments.length > 0 && comments.length-1 < targetTotalComments\" class=\"load-more\">\r\n                    <a href=\"\" ng-click=\"showMorePreviousComments();\" ng-disabled=\"loadingMore\">{{\'View previous comments\' | translate}}</a>\r\n                    <span class=\"loader pull-left\" ng-show=\"loadingMore\"></span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div ng-if=\"comment.comments.length > 0 && comment.comments.length < comment.childCommentsCount\" style=\"margin-left:40px;\">\r\n            <a href=\"\" ng-click=\"showMorePreviousChildComments(comment);\" ng-disabled=\"comment.loadingMore\">{{\'View previous comments\' | translate}}</a>\r\n            <span class=\"loader pull-left\" ng-show=\"comment.loadingMore\"></span>\r\n        </div>\r\n        <div ng-repeat=\"comment in comment.comments | orderBy:datePosted:true\" style=\"margin-left:40px;\">\r\n            <div class=\"commentItemContainer comment-level-gt-1\" wizdom-include=\"\'commentItem\'\"></div>\r\n        </div>\r\n    </script>\r\n\r\n</div>\r\n");$templateCache.put("Wizdom365/Templates/ViewTemplates/Social/SocialPreview/itemSocialPreview.html","<span class=\"socialPanel\">\r\n <small>\r\n  <span ng-show=\"item !== undefined\">\r\n   <a class=\"wizdom-link\"  ng-click=\"showComments(item, true);\" title=\"{{\'Number of comments\' | translate }}\"><span class=\"wizdom-icon icon-bubble-2 strong\"></span><span>{{item.comments.length}}</span></a>\r\n   <span class=\"wt-linkText hidden-xs\" ng-if=\"socialOverviewComments\" ng-click=\"showComments(item, true)\">{{\'Write a comment...\' | translate}}</span>\r\n               \r\n   <span class=\"socialPanelIconSpacer\"></span>\r\n  </span>\r\n  <span ng-show=\"item !== undefined\">\r\n   <a class=\"wizdom-link\" ng-click=\"likeItem();\" tooltip-html-unsafe=\"{{toolTipText}}\" tooltip-placement=\"{{tooltipposition}}\" ng-attr-title=\"{{(liked ? \'Unlike\' : \'Like\') | translate }}\"><span class=\"wizdom-icon icon-hand-like-2 {{(liked ? \'wt-alreadyLikedByMe\' : \'\')}}\"></span><span>{{item.likes.length}}</span></a>\r\n   <span class=\"wt-linkText hidden-xs\" ng-click=\"likeItem()\" title=\"{{(liked ? \'Unlike\' : \'Like\') | translate }}\">{{(liked ? \'Unlike\' : \'Like\') | translate }}</span>\r\n  </span>\r\n </small>\r\n</span>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/ShowItem/ContentTypes/Default.html","<div class=\"container-fluid newsitem\">\r\n    <div class=\"row\">\r\n        <div class=\"col-sm-3\">\r\n            <div class=\"news-author wt-pagecontrol hidden-xs\"\r\n                 wizdom365-news-author\r\n                 size=\"large\"\r\n                 date=\"item.startDate\"\r\n                 author=\"(item.alternateAuthor || item.author)\"\r\n                 is-alternate-author=\"(item.alternateAuthor ? true : false)\"></div>\r\n            <div class=\"wt-pagecontrol visible-xs\"\r\n                 wizdom365-news-author\r\n                 size=\"small\"\r\n                 date=\"item.startDate\"\r\n                 author=\"(item.alternateAuthor || item.author)\"\r\n                 is-alternate-author=\"(item.alternateAuthor ? true : false)\"></div>\r\n\r\n            <div class=\"container-fluid wd-noticeboard\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-sm-12 item-socialbar text-center\">\r\n                        <span wizdom365-item-social-container\r\n                              item=\"item\"\r\n                              itemid=\"item.id\"\r\n                              itemtype=\"item\"\r\n                              tooltipposition=\"bottom\"\r\n                              template-url=\"view.extendedProperties.socialSummaryTemplate\"\r\n                              ng-if=\"(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\">\r\n                        </span>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"col-sm-9 newsitem-top\">\r\n            <h1>{{item.heading}}</h1>\r\n            <span class=\"channel\" ng-repeat=\"channel in item.channels\">\r\n                {{channel.name}}\r\n                <span ng-if=\"!$last\">, </span>\r\n            </span>\r\n            <hr />\r\n            <div class=\"word-break\">\r\n                <img ng-click=\"showPicture(item.metadata.picture)\" style=\"margin-right: 10px; max-width: 100%\"\r\n                     class=\"newsitem-img pull-left img-thumbnail img-responsive cursor-pointer\" ng-show=\"item.metadata.picture\"\r\n                     ng-src=\"{{item.metadata.picture}}\"\r\n                     alt=\"...\" />\r\n            </div>\r\n            <div class=\"newsitem-content wt-wordBreak fr-view\" ng-bind-html=\"(item.content | wizdom365TrustHtml)\"></div>\r\n\r\n            <div class=\"form-group\" ng-repeat=\"field in item.contentType.metaData.fields | filter : {isBuiltIn: false} | orderBy:\'sortOrder\'\">\r\n                <div><b>{{field.label | translate}}</b></div>\r\n                <div ng-switch=\"field.type\">\r\n                    <div ng-switch-when=\"text\">{{item.metadata.fieldValues[field.key]}}</div>\r\n                    <div ng-switch-when=\"textarea\" class=\"newsitem-content wt-wordBreak fr-view\" ng-bind-html=\"(item.metadata.fieldValues[field.key] | wizdom365TrustHtml)\"></div>\r\n                    <div ng-switch-when=\"html\" class=\"newsitem-content wt-wordBreak fr-view\" ng-bind-html=\"(item.metadata.fieldValues[field.key] | wizdom365TrustHtml)\"></div>\r\n                    <div ng-switch-when=\"number\">{{item.metadata.fieldValues[field.key]}}</div>\r\n                    <div ng-switch-when=\"date\" class=\"wtsite-pagemodified-editeddate\">{{ item.metadata.fieldValues[field.key] | date: \'mediumDate\' }}</div>\r\n                    <div ng-switch-when=\"checkbox\" class=\"checkbox\"><label><input type=\"checkbox\" ng-model=\"item.metadata.fieldValues[field.key]\" /></label></div>\r\n                    <div ng-switch-when=\"radio\">{{item.metadata.fieldValues[field.key]}}</div>\r\n                    <div ng-switch-when=\"select\" ng-if=\"!field.allowMultiple\">{{item.metadata.fieldValues[field.key]}}</div>\r\n                    <div ng-switch-when=\"select\" ng-if=\"field.allowMultiple\" ng-repeat=\"value in item.metadata.fieldValues[field.key]\">{{value}}</div>\r\n\r\n                    <div ng-switch-when=\"image\" class=\"word-break\">\r\n                        <img ng-click=\"showPicture(item.metadata.fieldValues[field.key])\" style=\"margin-right: 10px; max-width: 100%\"\r\n                             class=\"newsitem-img pull-left img-thumbnail img-responsive cursor-pointer\" ng-show=\"item.metadata.fieldValues[field.key]\"\r\n                             ng-src=\"{{item.metadata.fieldValues[field.key]}}\"\r\n                             alt=\"...\" />\r\n                    </div>\r\n                    <div ng-switch-when=\"principals\" ng-repeat=\"author in item.metadata.fieldValues[field.key]\">\r\n                        <a ng-href=\"{{author.displayNameLink}}\">{{author.displayName}}</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/ShowItem/ContentTypes/News.html","<div class=\"container-fluid newsitem\">\r\n    <div class=\"row\">\r\n        <div class=\"col-sm-3\">\r\n            <div class=\"news-author wt-pagecontrol hidden-xs\"\r\n                 wizdom365-news-author\r\n                 size=\"large\"\r\n                 date=\"item.startDate\"\r\n                 author=\"(item.alternateAuthor || item.author)\"\r\n                 is-alternate-author=\"(item.alternateAuthor ? true : false)\"></div>\r\n            <div class=\"wt-pagecontrol visible-xs\"\r\n                 wizdom365-news-author\r\n                 size=\"small\"\r\n                 date=\"item.startDate\"\r\n                 author=\"(item.alternateAuthor || item.author)\"\r\n                 is-alternate-author=\"(item.alternateAuthor ? true : false)\"></div>\r\n\r\n            <div class=\"container-fluid wd-noticeboard\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-sm-12 item-socialbar text-center\">\r\n                        <span wizdom365-item-social-container\r\n                              item=\"item\"\r\n                              itemid=\"item.id\"\r\n                              itemtype=\"item\" \r\n                              tooltipposition=\"bottom\" \r\n                              template-url=\"view.extendedProperties.socialSummaryTemplate\"\r\n                              ng-if=\"(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\">\r\n                        </span>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"col-sm-9 newsitem-top\">\r\n            <h1>{{item.heading}}</h1>\r\n            <span class=\"channel\" ng-repeat=\"channel in item.channels\">\r\n                {{channel.name}}\r\n                <span ng-if=\"!$last\">, </span>\r\n            </span>\r\n            <hr />\r\n            <div class=\"word-break\">\r\n                <img ng-click=\"showPicture(item.metadata.picture)\" style=\"margin-right: 10px; max-width: 100%\"\r\n                     class=\"newsitem-img pull-left img-thumbnail img-responsive cursor-pointer\" ng-show=\"item.metadata.picture\"\r\n                     ng-src=\"{{item.metadata.picture}}\"\r\n                     alt=\"...\" />\r\n            </div>\r\n            <div class=\"newsitem-content wt-wordBreak fr-view\" ng-bind-html=\"(item.content  | wizdom365TrustHtml)\"></div>\r\n\r\n        </div>\r\n    </div>\r\n</div>\r\n");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/ShowItem/ContentTypes/Office365Video.html","<div wizdom-include=\'::\"Noticeboard/Templates/ViewTemplates/Webpart/ShowItem/ContentTypes/Video.html\"\'></div>");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/ShowItem/ContentTypes/RSS.html","<div class=\"container-fluid newsitem\">\r\n    <div class=\"row\">\r\n        <div class=\"col-sm-3\">\r\n            <div class=\"news-author wt-pagecontrol hidden-xs\"\r\n                 wizdom365-news-author\r\n                 size=\"large\"\r\n                 date=\"::item.startDate\"\r\n                 author=\"::(item.alternateAuthor || item.author)\"\r\n                 is-alternate-author=\"::(item.alternateAuthor ? true : false)\"\r\n                 alterante-image=\"::item.metadata.ImageUrl\"></div>\r\n\r\n            <div class=\"container-fluid wd-noticeboard\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-sm-12 item-socialbar text-center\">\r\n                        <span wizdom365-item-social-container\r\n                              item=\"::item\"\r\n                              itemid=\"::item.id\"\r\n                              itemtype=\"item\" \r\n                              tooltipposition=\"bottom\"\r\n                              template-url=\"::view.extendedProperties.socialSummaryTemplate\" \r\n                              ng-if=\"::(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\">\r\n                        </span>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"col-sm-9 newsitem-top\">\r\n            <h1>{{::item.heading}}</h1>\r\n\r\n            <span class=\"channel\" ng-repeat=\"channel in item.channels\">\r\n                {{::channel.name}}\r\n                <span ng-if=\"::!$last\">, </span>\r\n            </span>\r\n            <hr />\r\n            <div class=\"word-break\">\r\n                <img ng-click=\"showPicture(item.metadata.picture)\" style=\"margin-right: 10px; max-width: 100%\"\r\n                     class=\"newsitem-img pull-left img-thumbnail img-responsive cursor-pointer\" ng-show=\"::item.metadata.picture\"\r\n                     ng-src=\"{{::item.metadata.picture}}\"\r\n                     alt=\"...\" />\r\n                <span class=\"newsitem-content fr-view\" ng-bind-html=\"::(item.content  | wizdom365TrustHtml)\"></span>\r\n                <span class=\"newsitem-content\">\r\n                    <a href=\"{{::item.metadata.ItemUrl}}\" target=\"_blank\">{{::item.metadata.ItemUrl}}</a>\r\n                </span>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n");$templateCache.put("Noticeboard/Templates/ViewTemplates/Webpart/ShowItem/ContentTypes/Video.html","<div class=\"container-fluid newsitem\">\r\n    <div class=\"row\">\r\n        <div class=\"col-sm-3\">\r\n            <div class=\"news-author wt-pagecontrol hidden-xs\"\r\n                 wizdom365-news-author\r\n                 size=\"large\"\r\n                 date=\"::item.startDate\"\r\n                 author=\"::(item.alternateAuthor || item.author)\"\r\n                 is-alternate-author=\"::(item.alternateAuthor ? true : false)\"></div>\r\n            <div class=\"wt-pagecontrol visible-xs\"\r\n                 wizdom365-news-author\r\n                 size=\"small\"\r\n                 date=\"::item.startDate\"\r\n                 author=\"::(item.alternateAuthor || item.author)\"\r\n                 is-alternate-author=\"::(item.alternateAuthor ? true : false)\"></div>\r\n\r\n            <div class=\"container-fluid wd-noticeboard\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-sm-12 item-socialbar text-center\">\r\n                        <span wizdom365-item-social-container\r\n                              item=\"::item\"\r\n                              itemid=\"::item.id\"\r\n                              itemtype=\"item\" \r\n                              tooltipposition=\"bottom\" \r\n                              template-url=\"::view.extendedProperties.socialSummaryTemplate\"\r\n                              ng-if=\"::(socialFeatureEnabled && ((item.metadata.allowComments == null && enableSocialOnItemByDefault) || item.metadata.allowComments))\">\r\n                        </span>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"col-sm-9 newsitem-top\">\r\n            <h1>{{::item.heading}}</h1>\r\n\r\n            <span class=\"channel\" ng-repeat=\"channel in item.channels\">\r\n                {{::channel.name}}\r\n                <span ng-if=\"::!$last\">, </span>\r\n            </span>\r\n            <hr />\r\n            <div class=\"word-break\">\r\n                <div wizdom365-video-player videolink=\"::item.metadata.link\" thumbnail=\"::item.metadata.videoImage\"></div>\r\n            </div>\r\n            <div class=\"newsitem-content wt-wordBreak fr-view\" ng-bind-html=\"::(item.content | wizdom365TrustHtml)\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n");}]);